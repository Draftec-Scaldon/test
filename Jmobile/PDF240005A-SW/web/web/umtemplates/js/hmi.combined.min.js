/*
 version 4.5.1.523, Copyright (c) 2014, Exor International SpA., http://www.jmobile.net
*/
'use strict';var $hmi=function(){function Ja(){}function qa(){this.cache.tags={};this.cache.props={}}function Wa(){this.date=moment();this.start()}function H(c,a,b,e,h){this.setState(c,a,b,e,h)}function ra(c,a){this.name=c;this.value=a}function fa(c,a,b,e){this.setState(c,a,b,e)}function Tb(){}function la(c,a,b,e,h,d,f){this.id=c;this.Name=a;this.Status=b;this.RecipeSetList=e;this.selSet=h;this.lastSet=d;f&&(this.rcList=f)}function sa(c,a,b,e){this.id=c;this.Name=a;this.Value=b;this.elemList=e}function ya(c,
a,b){this.id=c;this.Name=a;this.Value=b}function y(c){c&&(this.code=this.status[c])}function Hc(){}function ca(c){var a=new XMLHttpRequest,b=Object.assign({},hc,c.headers);c.asycn=!1;c=Ic(c);a.open(c.type,c.url,c.async);if(b)for(var e in b)a.setRequestHeader(e,b[e]);var h,d,f=!1;a.onload=function(){h=a.status;d=a.responseText};a.ontimeout=function(){h=a.status;d=a.responseText;f=!0};a.onerror=function(){h=a.status;d=a.responseText};"GET"===c.type?a.send():a.send(c.search);return{status:h,data:d,timeout:f}}
function Jc(c){hc=c}function Kc(c){this.idSeed=0;this.resolves={};this.rejects={};this.worker=c;var a=this;this.worker.addEventListener("message",function(b){var e=b.data;if(e&&"API"==e.e){b=e.id;var c=e.err,e=e.data;c?(e=a.rejects[b])&&e(c):(c=a.resolves[b])&&c(e);delete a.resolves[b];delete a.rejects[b]}})}function Lc(c){var a="top:"+window.innerHeight/2+"px;left:"+window.innerWidth/2+"px;",b=g.getActiveProject().getNode("container"),e=document.createElement("div");e.setAttribute("style",a);e.setAttribute("class",
"jm-errLoadPage");e.textContent=c;b.appendChild(e);setTimeout(function(){var b=document.getElementsByClassName(".jm-errLoadPage");0<b.length&&b[0].parentNode.removeChild(b[0])},2E3)}function Mc(c){var a=c[0][0],b=c[1][0],e=c[0][1],h=c[1][1],d=c[0][2];c=c[1][2];var f=a*h-b*e;return[[h/f,-e/f,(e*c-h*d)/f],[-b/f,a/f,-(a*c-b*d)/f],[0,0,1]]}function Xa(c,a){for(var b=[[1,0,0],[0,1,0],[0,0,1]],e=0,h=c.length;e<h;e++)for(var d=0,f=a[0].length;d<f;d++){for(var k=0,g=0,m=c[0].length;g<m;g++)k+=c[e][g]*a[g][d];
b[e][d]=k}return b}function Nc(c){if(c&&-1!=c.indexOf("matrix")){var a=c.indexOf("("),b=c.indexOf(")");c=c.substring(a+1,b).split(",");return[[parseFloat(c[0]),parseFloat(c[2]),parseFloat(c[4])],[parseFloat(c[1]),parseFloat(c[3]),parseFloat(c[5])],[0,0,1]]}return[[1,0,0],[0,1,0],[0,0,1]]}function Ka(c){return"matrix("+c[0][0]+","+c[1][0]+","+c[0][1]+","+c[1][1]+","+c[0][2]+","+c[1][2]+")"}function Oc(c){for(var a=[[1,0,0],[0,1,0],[0,0,1]],b=0;b<c.length;b++)for(var e=0;e<c[b].length;e++)if(c[b][e]!=
a[b][e])return!1;return!0}function Ya(c,a){c&&(c.style.transition=a,c.style["-webkit-transition"]=a,c.style["-ms-transition"]=a,c.style["-moz-transition"]=a)}function ga(c,a){c&&(c.style.transform=a,c.style["-webkit-transform"]=a,c.style["-ms-transform"]=a,c.style["-moz-transform"]=a)}function Pc(c,a){c&&(c.style["-webkit-transform"]=a,c.style["-moz-transform"]=a,c.style["-ms-transform"]=a,c.style.transform=a)}function Ta(c,a,b){c&&(c.style["webkit"+a]=b,c.style["moz"+a]=b,c.style["ms"+a]=b,c.style["o"+
a]=b)}function ha(c,a){c&&(c.style.transformOrigin=a,c.style["-webkit-transform-origin"]=a,c.style["-ms-transform-origin"]=a,c.style["-moz-transform-origin"]=a)}function Za(){window.Scrollbar.ScrollbarPlugin.apply(this,arguments)}function ic(c){return 1===c[0][0]&&0===c[0][1]&&0===c[0][2]&&0===c[0][0]&&1===c[0][1]&&0===c[0][2]&&0===c[0][0]&&0===c[0][1]&&1===c[0][2]}function ma(c,a){return[[c[0][0]*a[0][0]+c[0][1]*a[1][0]+c[0][2]*a[2][0],c[0][0]*a[0][1]+c[0][1]*a[1][1]+c[0][2]*a[2][1],c[0][0]*a[0][2]+
c[0][1]*a[1][2]+c[0][2]*a[2][2]],[c[1][0]*a[0][0]+c[1][1]*a[1][0]+c[1][2]*a[2][0],c[1][0]*a[0][1]+c[1][1]*a[1][1]+c[1][2]*a[2][1],c[1][0]*a[0][2]+c[1][1]*a[1][2]+c[1][2]*a[2][2]],[c[2][0]*a[0][0]+c[2][1]*a[1][0]+c[2][2]*a[2][0],c[2][0]*a[0][1]+c[2][1]*a[1][1]+c[2][2]*a[2][1],c[2][0]*a[0][2]+c[2][1]*a[1][2]+c[2][2]*a[2][2]]]}function Qc(c){this.size=c;this.root3x1={m:[[0],[0],[0]],prev:null,next:null};this.root3={m:[[0,0,0],[0,0,0],[0,0,0]],prev:null,next:null};this.tail3x1=this.root3x1;this.tail3=
this.root3;for(c=1;c<this.size;c++){var a={m:[[0],[0],[0]],prev:this.tail3x1,next:null};this.tail3x1=this.tail3x1.next=a;a={m:[[0,0,0],[0,0,0],[0,0,0]],prev:this.tail3,next:null};this.tail3=this.tail3.next=a}}function D(c,a,b){this.canvas=c;this.ctx=c.getContext("2d");this.strWidth=a.strokeWidth;""!==a.stroke&&(this.strStyle=a.stroke);this.wSize={width:a.width||300,height:a.height||250};this.pathLimitBuffer=100>this.wSize.width?Math.floor(this.wSize/2):100;this.xSize={min:a.minX,max:a.maxX};this.ySize=
{min:a.minY,max:a.maxY};this._drawable=this._isNativeCompatible=!0;c=navigator.userAgent;if(-1!=c.indexOf("iPhone")||-1!=c.indexOf("iPad")||-1!=c.indexOf("WebKit/534")||-1!=c.indexOf("Safari")&&-1==c.indexOf("Chrome"))this._isNativeCompatible=!1;this.drawStatus={brushType:D.BrushType.LINE,prevPoint:{x:void 0,y:void 0},currPoint:{x:void 0,y:void 0,selected:!1},lineBufferSize:0,operation:0};this.curveWgt=b;this.prevYDuration=this.prevXDuration=-1}function S(c,a){this.canvas=c;this.ctx=c.getContext("2d");
this.strokeColor=a.cursorColor;this.strokeWidth=a.cursorWidth;this.xCursorShow=a.xCursorShow;this.yCursorShow=a.yCursorShow;this._xSize={};this._ySize={};this._wSize={width:a.width||300,height:a.height||250};this._pos={x:this._wSize.width/2,y:a.yCursorPos||this._wSize.height}}function Y(c,a){S.call(this,c,a)}function Ga(c,a){this.ctx=document.getElementById(c).getContext("2d");this.id=c;this.wSize={width:a.width||300,height:a.height||250};this.xSize={min:a.minX||0,max:a.maxX||1};this.ySize={min:a.minY||
0,max:a.maxY||1};this.bands=a.bands}function oa(c,a){this.canvas=c;this.ctx=c.getContext("2d");this.gridX=a.gridX;this.gridY=a.gridY;this.colorX=a.colorX;this.colorY=a.colorY;this.xanchor=a.xanchor;this.yanchor=a.yanchor;this.xspacing=a.xspacing;this.yspacing=a.yspacing;this.wSize={width:a.width||300,height:a.height||250};this.xSize={min:a.minX,max:a.maxX};this.ySize={min:a.minY,max:a.maxY}}function Ub(c){var a=document.createElement("div"),b=document.createElement("div"),e=document.createElement("a"),
h=document.createTextNode("X");a.setAttribute("class","jm-hmi-button-close jm-hacklayer");b.setAttribute("class","jm-round-button-rect");e.appendChild(h);b.appendChild(e);a.appendChild(b);this.baseWgt=c;this.elem=a}function P(c){this.initEmptyElem=!1;this.isBaseMsgTextWgt="MsgTextWgt"===c.getJMType();this.isBaseComboBox="ComboBoxWgt"===c.getJMType();this.baseParentPage=c.parentPage;this.baseParentWidget=c.parentWidget;this.select=c.select;this.frame=!0===c.frame;this.frameSize=this.isBaseMsgTextWgt?
this.frame?c.frameSize:0:0;this.baseWgt=c;this.forceRenderStyle=!1;void 0!==c.dropMode&&0!==c.dropMode&&(this.forceRenderStyle=!0,this.upDir=2==c.dropMode);this.updateOffsets();this.init()}function r(c,a,b,e,h){var d=null;null!=c&&(d=c.wgtId);l.call(this,d,null,b,e,h);this.event=a;null==this.wgtId&&(this.wgtId="act_"+g.import("IDGenerator").generateRandomID());"undefined"!==typeof b&&"undefined"!==typeof b.p&&"undefined"!==typeof b.p.actionGroup&&(this.actionGroup=b.p.actionGroup);this.parentWidget&&
this.parentWidget.addAction(a,this)}function sb(c,a,b,e,h){r.call(this,c,a,b,e,h)}function tb(c,a,b,e,h){r.call(this,c,a,b,e,h)}function $a(c,a,b,e,h){r.call(this,c,a,b,e,h);this.select=!1}function ub(c,a,b,e,h){r.call(this,c,a,b,e,h)}function vb(c,a,b,e,h){r.call(this,c,a,b,e,h)}function wb(c,a,b,e,h){r.call(this,c,a,b,e,h)}function xb(c,a,b,e,h){r.call(this,c,a,b,e,h)}function yb(c,a,b,e,h){r.call(this,c,a,b,e,h)}function zb(c,a,b,e,h){r.call(this,c,a,b,e,h)}function Ab(c,a,b,e,h){r.call(this,c,
a,b,e,h)}function Bb(c,a,b,e,h){r.call(this,c,a,b,e,h)}function Cb(c,a,b,e,h){r.call(this,c,a,b,e,h)}function Db(c,a,b,e,h){r.call(this,c,a,b,e,h)}function Eb(c,a,b,e,h){r.call(this,c,a,b,e,h)}function Fb(c,a,b,e,h){r.call(this,c,a,b,e,h)}function Gb(c,a,b,e,h){r.call(this,c,a,b,e,h)}function Hb(c,a,b,e,h){r.call(this,c,a,b,e,h)}function ab(c,a,b,e,h){r.call(this,c,a,b,e,h)}function Ib(c,a,b,e,h){r.call(this,c,a,b,e,h)}function Jb(c,a,b,e,h){r.call(this,c,a,b,e,h)}function Kb(c,a,b,e,h){r.call(this,
c,a,b,e,h)}function Lb(c,a,b,e,h){r.call(this,c,a,b,e,h)}function Mb(c,a,b,e,h){r.call(this,c,a,b,e,h)}function l(c,a,b,e,h){this.wgtId=c;this.studioId=a;this.parentPage=e;this.wgtsOrder=this.wgts=null;this.js=this;this.initInvMtxChain=this.isWgtActive=!1;this.enableRendering=!0;this.dynamicFieldProperties=[];this.mapId={};h&&(this.parentWidget=h);b&&this.setOptions(b);this.isClone?(this.elem=Vb.getFragmentById(c),this.updateCloneMLIds()):this.elem=document.getElementById(c);this.parentPage||(this.parentPage=
null);if(this.elem){null==this.mtx&&(this.mtx=[[1,0,0],[0,1,0],[0,0,1]]);this.cx=parseFloat(this.elem.getAttribute("data-cx"));this.cy=parseFloat(this.elem.getAttribute("data-cy"));if(void 0===this.left||isNaN(this.left))this.x=this.left=0;if(void 0===this.top||isNaN(this.top))this.y=this.top=0;this.parentPage&&(this._baseRenderMask|=this._baseRenderFlags.REMOVE_IC_QUALITY,g.addToRender(this));this.elem.getAttribute("class")&&-1!=this.elem.getAttribute("class").indexOf("jm-blink")&&(this.blink=1)}this.parentWidget?
(this.isClone||("TableGroupWgt"!=this.parentWidget.jmType||!this.parentWidget.hasDataSource())&&this.parentWidget.enableRendering||(this.enableRendering=!1),this.isClone&&this.parentWidget.isClone&&this.parentWidget.addWidget(this.wgtId,this),this.isClone||this.parentWidget.isClone||(this.parentWidget.addWidget(this.wgtId,this),this.parentWidget!==this.parentPage&&this.parentPage.addWidget(this.wgtId,this)),this.parentWidget.isModuleInstance()?this.module=this.parentWidget:this.module=this.parentWidget.getModule()):
g.addWidget(this.wgtId,this);if((c=this.project=g.activeProject)&&null!=this.elem){this.umgr=c.getWidget("_UserGroupMgr",!0);var d;this.umgr&&this.getAuthorizations()==this.umgr.getWidgetAuthorizationCodes().HIDE?this.constructor==R?(this.elem.style.backgroundImage=null,d=!0):d=!1:"none"==this.elem.style.display&&1==this.visible?d=!0:"none"!=this.elem.style.display&&0==this.visible&&(d=!1);null!=d&&this.visible!==d&&(this.visible=d,this._baseRenderMask|=this._baseRenderFlags.VISIBLE,g.addToRender(this))}this._subscriptions=
{};this.adIconVisible=this.destroyed=!1;this.core=g}function Nb(c,a){this.w=c;this.cb=[a]}function J(c,a,b,e,h){l.call(this,c.wgtId,a,b,e,h);this.trnWndId&&(this.trnWnd=this.parentWidget.getWidgetByClass(Wb),this.trnWnd.subscribeWgt(this,function(){}));g.cache.hasWgtProps(this.elem.id)&&(c=g.cache.getWgtProp(this.elem.id,"crsVisible"),this.yCursorPos=g.cache.getWgtProp(this.elem.id,"yCursorPos"),this.xCursorShow=c);this._initXCursor=!1;this._initObjects();this._renderMask=this._renderFlags.GRID;g.addToRender(this)}
function B(c,a,b,e,h){l.call(this,c.wgtId,a,b,e,h);this.image=this.elem.querySelector("[data-widget='ImageWgt']");this.draggingTimeOut=null;this.writeTagDelay=180;this.tooltipy=this.tooltipx=0;this.mtxChain=this.mtx;1==this.wrMode&&(this.ndlToolTip=document.getElementById(this.parentPage.wgtId+"_ndltooltip"),this.ndlToolTip||(this._renderMask|=this._renderFlags.CREATETOOLTIP));this._currMouseAction=-1;this.authCode=this.getAuthorizations();this.image&&(this.imageW=parseFloat(this.image.style.width),
this.imageH=parseFloat(this.image.style.height),this.imageX=parseFloat(this.image.style.left),this.imageY=parseFloat(this.image.style.top));this.imageRot=0;if(c=this.image.getAttribute("rot"))this.imageRot=parseFloat(c);this.range=this.max-this.min;"vertical"==this.form?(this.length=this.height-2*(this.height-this.cy),this.imageSize=this.imageH,this.offset=this.height-this.cy):"horizontal"==this.form&&(this.length=this.width-2*this.cx,this.imageSize=this.imageW,this.offset=this.cx);this.type="vertical"==
this.form?1:"horizontal"==this.form?2:0;this.value>this.max?this.value=this.max:this.value<this.min&&(this.value=this.min);b.acceptClick&&(this.disabled=!1);b.disabled&&(this.disabled=b.disabled);this.handleEvent();this._renderMask|=this._renderFlags.VALUE;g.addToRender(this)}function C(c,a,b,e,h){l.call(this,c.wgtId,a,b,e,h);this.trnWndId&&(this.trnWnd=this.parentWidget.getWidgetByClass(Wb),this.trnWnd.subscribeWgt(this,function(){}),this.cursorTs=this.trnWnd.getValue("cursor-timestamp"),this.curveType=
this.trnWnd.getTrendType(),this.width=this.trnWnd.width,this.height=this.trnWnd.height);this.currPageDuration=this.trnWnd.xPageSize;this.getLineChartObj(this.parentWidget.elem.querySelector(".jm-trend_crv"));this.trnWnd&&this.trnWnd.isScatter()&&(this.graph.isScatter=!0);if(g.getEventMgr()){var d=this;this.deactivateHandler=function(){d.executeDeactivationCallback()&&(d.unload(),d.isWgtActive=!1)};this.bindEvents({unloadWgt:this.deactivateHandler})}}function U(c,a,b,e,h){C.call(this,c,a,b,e,h);c=
[];c.push(this.xTag);c.push(this.yTag);this.isInitCurveRenderDone=!1;this.value=Array(this.maxLimit);if(g.getEventMgr()){var d=this;this.activateHandler=function(){l.prototype.executeActivationCallback.call(d)&&(d.load(),d.isWgtActive=!0)};l.prototype.bindEvents.call(this,{loadWgt:this.activateHandler})}this.srv=g.activeProject.getCommunticationObj();this.srv.subscribeTags(c,function(b){})}function La(c,a,b,e,h){l.call(this,c.wgtId,a,b,e,h)}function Rc(c,a,b){var e=c.toHsv();c=e.h;var h=e.s,d=e.v,
e=e.a;.1>d&&(a+=.1-d);return b?d>1-a?window.tinycolor({h:c,s:h,v:d-a,a:e}):window.tinycolor({h:c,s:h,v:d+a,a:e}):d<a?window.tinycolor({h:c,s:h,v:d+a,a:e}):window.tinycolor({h:c,s:h,v:d-a,a:e})}function N(c){this.wgt=c;var a=this.wgt.getInvokablePropsList();if(a)for(c=0;c<a.length;c++)Object.defineProperty(this,a[c],this._generateGetterAndSetter(a[c]));if(a=this.wgt.getInvokableFunList())for(c=0;c<a.length;c++){var b=a[c];this[b]=this._generateFun(b)}}function Z(c,a){N.call(this,c);this._timeoutIDs=
{};this.isTemplate=a}function E(c){Z.call(this,c);this.wgt=c}function Ha(c){N.call(this,c);this.wgt=c}Ja.prototype.modulesMap={};Ja.prototype.addModule=Ja.prototype.export=function(c,a){this.modulesMap[c]=a};Ja.prototype.getModule=Ja.prototype.import=function(c){var a=this.modulesMap[c];return a?a:this.loadWebpackModule(c)};Ja.prototype.loadWebpackModule=function(c){var a;if(c in this._wpModulesGlobalName){var b=this._wpModulesGlobalName[c];a=this.modulesMap[c]=window[b];!a&&window.exports&&window.exports[b]&&
(a=this.modulesMap[c]=window.exports[b])}return a};Ja.prototype._wpModulesGlobalName={JMGestures:"__JMModule_JMGesture",JMTicksRender:"__JMModule_TicksRender"};var t=new Ja;qa.prototype.constructor=qa;qa.prototype.cache={};qa.prototype.updateTag=function(c,a){var b=this.cache.tags[c];if(null==b)return this.cache.tags[c]=new Ma(a.n,-1,a.v.v,"S_OK",a.v.q,a.v.ts,a.v.t,a.id),!0;if(a.constructor===Ma){if(a.ts<b.ts&&a.getEventId()<=b.getEventId()||a.isQualityGood()&&b.isQualityGood()&&a.value==b.value&&
null!=b.ts)return!1;this.cache.tags[c]=a}else{if(a.v.ts<b.ts&&a.id<=b.getEventId()||za.isQualityGood(a.v.q)&&b.isQualityGood()&&a.v.v==b.value&&null!=b.ts)return!1;this.cache.tags[c].setEventId(a.id);this.cache.tags[c].setState(a.n,-1,a.v.v,"S_OK",a.v.q,a.v.ts)}return!0};qa.prototype.getTag=function(c){return this.cache.tags[c]};qa.prototype.clone=function(){var c={};if(this.cache)for(var a in this.cache.tags)c[a]=this.cache.tags[a].clone();return c};qa.prototype.setWgtProp=function(c,a,b){this.cache.props[c]||
(this.cache.props[c]={});this.cache.props[c][a]=b};qa.prototype.getWgtProp=function(c,a){if(this.cache.props[c])return this.cache.props[c][a]};qa.prototype.hasWgtProps=function(c){return this.cache.props[c]?!0:!1};qa.prototype.clear=function(){this.cache.tags={};this.cache.props={}};var bb;(function(c){c[c.QUALITY_BAD=0]="QUALITY_BAD";c[c.QUALITY_UNCERTAIN=1]="QUALITY_UNCERTAIN";c[c.QUALITY_GOOD=3]="QUALITY_GOOD"})(bb||(bb={}));var Sc;(function(c){c[c.SUBSTATUS_NON_SPECIFIC=0]="SUBSTATUS_NON_SPECIFIC";
c[c.SUBSTATUS_CONFIGURATION_ERROR=1]="SUBSTATUS_CONFIGURATION_ERROR";c[c.SUBSTATUS_NOT_CONNECTED=2]="SUBSTATUS_NOT_CONNECTED";c[c.SUBSTATUS_DEVICE_FAILURE=3]="SUBSTATUS_DEVICE_FAILURE";c[c.SUBSTATUS_TIMEOUT_FAILURE=4]="SUBSTATUS_TIMEOUT_FAILURE";c[c.SUBSTATUS_COMMUNICATION_FAILURE=6]="SUBSTATUS_COMMUNICATION_FAILURE";c[c.SUBSTATUS_NOBOUNDS=7]="SUBSTATUS_NOBOUNDS";c[c.SUBSTATUS_NODATA=8]="SUBSTATUS_NODATA"})(Sc||(Sc={}));var Tc;(function(c){c[c.SUBSTATUS_ENGINEERING_UNITS_EXCEEDED=5]="SUBSTATUS_ENGINEERING_UNITS_EXCEEDED"})(Tc||
(Tc={}));var Uc;(function(c){c[c.LT_NOT_LIMITED=0]="LT_NOT_LIMITED";c[c.LT_LOW_LIMITED=1]="LT_LOW_LIMITED";c[c.LT_HIGH_LIMITED=2]="LT_HIGH_LIMITED";c[c.LT_CONSTANT=3]="LT_CONSTANT"})(Uc||(Uc={}));var za=function(){function c(a){a&&(this.qual=(a&c.MASKQUALITY)>>6,this.substatus=(a&c.MASKSUBSTATUS)>>2,this.limit=a&c.MASKLIMITS)}c.prototype.getStatus=function(){return this.qual};c.prototype.setState=function(a){a instanceof c?(this.qual=a.qual,this.substatus=a.substatus,this.limit=a.limit):(this.qual=
(a&c.MASKQUALITY)>>6,this.substatus=(a&c.MASKSUBSTATUS)>>2,this.limit=a&c.MASKLIMITS)};c.prototype.setStatus=function(a){this.qual=a};c.prototype.clone=function(){var a=new c;a.qual=this.qual;a.substatus=this.substatus;a.limit=this.limit;return a};c.prototype.toString=function(){return new String(this.qual<<6|this.substatus<<2|this.limit)};c.prototype.isQualityGood=function(){return this.qual==bb.QUALITY_GOOD};c.isQualityGood=function(a){return(a&c.MASKQUALITY)>>6==bb.QUALITY_GOOD};c.prototype.isQualityUncertain=
function(){return this.qual==bb.QUALITY_UNCERTAIN};c.prototype.isQualityBad=function(){return this.qual==bb.QUALITY_BAD};c.MASKQUALITY=192;c.MASKSUBSTATUS=60;c.MASKLIMITS=3;return c}();t.addModule("Quality",za);var v;(function(c){c[c.EMPTY=-1]="EMPTY";c[c.BOOLEAN=0]="BOOLEAN";c[c.BYTE=1]="BYTE";c[c.SHORT=2]="SHORT";c[c.INT=3]="INT";c[c.UNSIGNEDBYTE=4]="UNSIGNEDBYTE";c[c.UNSIGNEDSHORT=5]="UNSIGNEDSHORT";c[c.UNSIGNEDINT=6]="UNSIGNEDINT";c[c.FLOAT=7]="FLOAT";c[c.DOUBLE=8]="DOUBLE";c[c.STRING=9]="STRING";
c[c.BINARY=10]="BINARY";c[c.TIME=11]="TIME";c[c.INT64=12]="INT64";c[c.UINT64=13]="UINT64";c[c.INT64A=14]="INT64A";c[c.UINT64A=15]="UINT64A"})(v||(v={}));var Na;(function(c){c[c.EMPTY=0]="EMPTY";c[c.BIT=1]="BIT";c[c.BYTE=2]="BYTE";c[c.SHORT=3]="SHORT";c[c.INT=4]="INT";c[c.UNSIGNED_BYTE=5]="UNSIGNED_BYTE";c[c.UNSIGNED_SHORT=6]="UNSIGNED_SHORT";c[c.UNSIGNED_INT=7]="UNSIGNED_INT";c[c.FLOAT=8]="FLOAT";c[c.DOUBLE=9]="DOUBLE";c[c.STRING=10]="STRING";c[c.BINARY=11]="BINARY";c[c.TIME=12]="TIME";c[c.ARRAY_BIT=
13]="ARRAY_BIT";c[c.ARRAY_BYTE=14]="ARRAY_BYTE";c[c.ARRAY_SHORT=15]="ARRAY_SHORT";c[c.ARRAY_INT=16]="ARRAY_INT";c[c.ARRAY_UNSIGNED_BYTE=17]="ARRAY_UNSIGNED_BYTE";c[c.ARRAY_UNSIGNED_SHORT=18]="ARRAY_UNSIGNED_SHORT";c[c.ARRAY_UNSIGNED_INT=19]="ARRAY_UNSIGNED_INT";c[c.ARRAY_FLOAT=20]="ARRAY_FLOAT";c[c.ARRAY_DOUBLE=21]="ARRAY_DOUBLE";c[c.ARRAY_TIME=22]="ARRAY_TIME";c[c.UINT64=23]="UINT64";c[c.INT64=24]="INT64";c[c.ARRAY_UINT64=25]="ARRAY_UINT64";c[c.ARRAY_INT64=26]="ARRAY_INT64";c[c.OBJECT=27]="OBJECT"})(Na||
(Na={}));var Ma=function(){function c(a,b,e,c,d,f,k,g){this._isArray=!1;this.name="";this.valueType=void 0!==this.valueType?this.valueType:0;this.index=-1;this.ts=this.value=this.quality=this.code=null;this.id=g||-1;this.setState(a,b,e,c,d,f)}c.prototype.getQuality=function(){return this.quality};c.getNumberOfBits=function(a){switch(a){case v.BOOLEAN:return 1;case v.UNSIGNEDBYTE:case v.BYTE:return 8;case v.UNSIGNEDSHORT:case v.SHORT:return 16;case v.DOUBLE:case v.UINT64:return 64;case v.STRING:case v.BINARY:case v.TIME:return 0;
case v.INT64:case v.UINT64:case v.INT64A:case v.UINT64A:return 64}return 32};c.prototype.getValueType=function(){return this.valueType};c.prototype.getTagType=function(){return this.type};c.prototype.isArrayTag=function(){return this._isArray};c.getTypeRange=function(a){switch(a){case v.BOOLEAN:return{min:0,max:1};case v.BYTE:return{min:-128,max:127};case v.SHORT:return{min:-32768,max:32767};case v.INT:return{min:-2147483648,max:2147483647};case v.UNSIGNEDBYTE:return{min:0,max:255};case v.UNSIGNEDSHORT:return{min:0,
max:65535};case v.UNSIGNEDINT:return{min:0,max:4294967295};case v.FLOAT:return{min:-3.4E38,max:3.4E38};case v.DOUBLE:return{min:-1.79E308,max:1.79E308};case v.STRING:case v.BINARY:case v.TIME:return null;case v.INT64A:case v.INT64:return{min:-Math.pow(2,63),max:Math.pow(2,63)-1};case v.UINT64A:case v.UINT64:return{min:0,max:Math.pow(2,64)-1}}return{min:NaN,max:NaN}};c.prototype.is64Bit=function(a){return v.INT64==a||v.INT64A==a||v.UINT64==a||v.UINT64A==a};c.prototype.is32Bit=function(a){switch(a){case v.BOOLEAN:case v.BYTE:case v.SHORT:case v.INT:case v.UNSIGNEDBYTE:case v.UNSIGNEDSHORT:case v.UNSIGNEDINT:case v.FLOAT:case v.DOUBLE:return!0;
default:return!1}};c.prototype.toLong=function(a,b){return b===v.UINT64?fromString(a,!0,10):fromString(a)};c.prototype.setQuality=function(a){this.quality=a};c.prototype.manageTagType=function(a,b){var e=g.getActiveProject().getTagMgr();if(e){var h=e.getTagInfo(a);h&&(e=h.t,h=h.s,this.type=e,this._stringTagType=c.enumTypeName[e],-1!=h&&(this._isArray=!0,this._stringTagType+="-"+h),e==v.TIME&&"string"==typeof b&&(this.value=(new Date(b)).getTime()/1E3))}};c.prototype.setState=function(a,b,e,c,d,f){this.name=
a;this.index=b;this.value=e;this.manageTagType(a,e);null!=this.code?this.code.setState(c):this.code=new y(c);null!=this.quality?this.quality.setState(d):this.quality=new za(d);this.ts=f;return this};c.prototype.setEventId=function(a){this.id=a};c.prototype.getEventId=function(){return this.id};c.prototype.clone=function(a){var b=this.value;this.value instanceof Array&&(b=void 0==a||a?b.slice():this.value);a=new c;a.name=this.name;a.index=this.index;a.value=b;a.code=this.code.clone();a.quality=this.quality.clone();
return a};c.prototype.getState=function(a){return new H(this.quality,this.getValue(a),"",this.code,this.ts)};c.prototype.getMessageStatus=function(){return this.code};c.prototype.getTimestamp=function(){return this.ts};c.prototype.getValue=function(a){return Array.isArray(this.value)&&0<=a?this.value[a]:this.value};c.prototype.getStringTagType=function(){return this._stringTagType};c.prototype.setValue=function(a){this.value=a};c.prototype.isQualityGood=function(){return this.quality.isQualityGood()};
c.prototype.compareTo=function(a){return a.value===this.value?0:-1};c.QUALITY_GOOD=new za(192);c.QUALITY_UNCERTAIN=new za(64);c.enumTypeName={0:"boolean",1:"byte",2:"short",3:"int",4:"unsignedByte",5:"unsignedShort",6:"unsignedInt",7:"float",8:"double",9:"string",10:"binary",11:"time",12:"int64",13:"uint64"};return c}();t.addModule("Tag",Ma);var Ob=function(){function c(){this.tags=this.info=null;this.nTags=0}c.prototype.setState=function(a,b,e){this.info={name:a,code:new y(b)};if(e instanceof Array)for(this.tags=
{},this.nTags=e.length,a=0,b=e.length;a<b;a++){var c=e[a];this.tags[c.name]=(new Ma).setState(c.name,-1,c.value,c.code,c.quality)}else null!=e&&(this.tags=e,this.nTags=Object.keys(this.tags).length);return this};c.prototype.getTag=function(a){for(var b in this.tags)if(b==a)return this.tags[b].value};c.prototype.getCount=function(){return this.nTags};c.prototype.getTags=function(){var a=[],b;for(b in this.tags)a.push(this.tags[b].name);return a};c.prototype.getTagArray=function(){var a=[],b;for(b in this.tags)a.push(this.tags[b]);
return a};c.prototype.getTagsMap=function(){return this.tags};c.prototype.getMessageStatus=function(){return this.info.code};return c}();t.addModule("Group",Ob);var Q;(function(c){c[c.INT=0]="INT";c[c.FLOAT=1]="FLOAT";c[c.HEXL=2]="HEXL";c[c.HEXU=3]="HEXU";c[c.EXP=4]="EXP";c[c.EXPD=5]="EXPD";c[c.THOUSAND=6]="THOUSAND"})(Q||(Q={}));var V;(function(c){c[c.TEXT=0]="TEXT";c[c.NUMBER=1]="NUMBER";c[c.DATETIME=2]="DATETIME"})(V||(V={}));var Xb;(function(c){c[c.TIME_ONLY=0]="TIME_ONLY";c[c.DATE_ONLY=1]="DATE_ONLY";
c[c.DATE_SEP_TIME=2]="DATE_SEP_TIME";c[c.TIME_SEP_DATE=3]="TIME_SEP_DATE"})(Xb||(Xb={}));var cb=function(){function c(a,b,e){this.date=void 0!==a?a:new Date;this.format=b;this.configuration=e;void 0!==this.format&&(this.options=t.import("TextFormatUtil").parseDateTimeFormat(b,e))}c.prototype.setDate=function(a){this.date=new Date(a)};c.prototype.setFormat=function(a,b){this.format=a;this.options=t.import("TextFormatUtil").parseDateTimeFormat(a,void 0!==b?b:this.configuration);this.configuration=b};
c.prototype.setConfiguration=function(a){var b=!1;this.configuration.longDateFormat!=a.longDateFormat&&(this.configuration.longDateFormat=a.longDateFormat,b=!0);this.configuration.shortDateFormat!=a.shortDateFormat&&(this.configuration.shortDateFormat=a.shortDateFormat,b=!0);this.configuration.serverOffset!=a.serverOffset&&(this.configuration.longDateFormat=a.longDateFormat,b=!0);b&&(this.options=t.import("TextFormatUtil").parseDateTimeFormat(this.format,this.configuration));return b};c.prototype.showMilliSeconds=
function(){this.options.milliseconds=!0};c.prototype.getSeparator=function(){return this.options.sep};c.prototype.getOrder=function(){return this.options.order};c.prototype.splitFormat=function(a){for(var b=-1,e=-1,c=-1,d=-1,f=-1,k=-1,g=0,m=a.length;g<m;g++){var n=a.charAt(g),z="M"==n||"d"==n||"D"==n||"y"==n||"Y"==n,n="s"==n||"h"==n||"H"==n||"m"==n||"A"==n||"P"==n;-1==b&&z&&(-1!=d&&(f=g-1),b=g);-1==d&&n&&(-1!=b&&(e=g-1),d=g);z&&(c=g);n&&(k=g)}-1!=b&&-1==e&&(e=a.length);-1!=d&&-1==f&&(f=a.length);
return[-1!=b&&-1!=e?a.substring(b,c+1):"",-1!=d&&-1!=f?a.substring(d,k+1):""]};c.prototype.formatDateTimeAndSplit=function(a,b){if(void 0===this.format)return[];var e=this.splitFormat(this.options.format),c=this.options.format;this.options.format=e[0];var d=t.import("TextFormatUtil").formatDateTime(this.date,a,this.options,b?b:this.configuration);this.options.format=e[1];e=t.import("TextFormatUtil").formatDateTime(this.date,a,this.options,b?b:this.configuration);this.options.format=c;return[d,e]};
c.prototype.formatDateTime=function(a,b){return void 0===this.format?"":t.import("TextFormatUtil").formatDateTime(this.date,a,this.options,b?b:this.configuration)};c.prototype.formatDateTimeValue=function(){var a=this.format,b=!1;a.match(/(ap|a)/i)&&(b=!0);b=this.computeTimeParams(b);a=a.replace(/(ap|a)/i,b.amPm);a=a.replace(/MMM/,b.months[b.dt.getMonth()]);a=a.replace(/DD/,b.cdate);a=a.replace(/YYYY/,b.cyear4);a=a.replace(/YY/,b.cyear2);a=a.replace(/MM/,b.cmonth);a=a.replace(/(hh|h)/,b.hrs);a=a.replace(/mm/,
b.mts);a=a.replace(/ss/,b.sec);return a.trim()};c.prototype.computeTimeParams=function(a){var b={months:"Jan Feb Mar Apr May June July Aug Sep Oct Nov Dec".split(" ")};if(!(this.date instanceof Date))return null;b.dt=this.date;b.cdate=10>this.date.getDate()?"0"+this.date.getDate().toString():this.date.getDate().toString();b.cmonth=10>this.date.getMonth()+1?"0"+(this.date.getMonth()+1).toString():(this.date.getMonth()+1).toString();b.cyear2=this.date.getFullYear().toString().slice(2);b.cyear4=this.date.getFullYear().toString();
b.hrs=10>this.date.getHours()?"0"+this.date.getHours().toString():this.date.getHours().toString();b.mts=10>this.date.getMinutes()?"0"+this.date.getMinutes():this.date.getMinutes().toString();b.sec=10>this.date.getSeconds()?"0"+this.date.getSeconds():this.date.getSeconds().toString();a&&(b.amPm=12>parseInt(b.hrs)?"AM":"PM",b.hrs=13>parseInt(b.hrs)?b.hrs:10>parseInt(b.hrs)-12?"0"+(parseInt(b.hrs)-12).toString():(parseInt(b.hrs)-12).toString());return b};return c}(),ie=function(){function c(a,b,e,c,
d,f){this.setState(a,b,e,c,d,f)}c.prototype.setState=function(a,b,e,c,d,f){this.type=a;this.subtype=b;this.evtType=e;this.time=c;this.data=d;this.code=new y(f);return this};c.prototype.getMessageStatus=function(){return this.code};c.prototype.setData=function(a){this.data=a};c.prototype.isAlarmEvent=function(){return 14==this.type&&(1==this.evtType||4==this.evtType||5==this.evtType||6==this.evtType)};c.prototype.getType=function(){return this.type};c.prototype.getSubtype=function(){return this.subtype};
c.prototype.getEvtType=function(){return this.evtType};c.prototype.getTime=function(){return this.time};c.prototype.getData=function(){return this.data};c.prototype.getCode=function(){return this.code};return c}();t.addModule("IDALEvent",ie);var Aa;(function(c){c[c.AL_EVENT_TRIGGERED=1]="AL_EVENT_TRIGGERED";c[c.AL_EVENT_NOT_TRIGGERED=2]="AL_EVENT_NOT_TRIGGERED";c[c.AL_EVENT_ACKED=4]="AL_EVENT_ACKED";c[c.AL_EVENT_RESET=8]="AL_EVENT_RESET";c[c.AL_EVENT_ENABLED=16]="AL_EVENT_ENABLED";c[c.AL_EVENT_DISABLED=
32]="AL_EVENT_DISABLED";c[c.AL_EVENT_BOTH=64]="AL_EVENT_BOTH"})(Aa||(Aa={}));var je=function(){function c(a,b,e,h,d,f,k,g){this.dirty=!1;this.alDescription=this.alDate=this.alTime=this.alDateTime="";this.alEnable=!1;this.alName="";this.alSelect=!1;this.alState=c.stateType.STATE_DISABLED;this.alCustomField2=this.alCustomField1=this.alGroups=this.comment=this.alValue="";this.xmlOrder=0;this.toggleShowAlarm=!0;this.blinkTimer=null;this.blinkInterval=1E3;this.usrActs=[];this.acts=[];this.setState(a,b,
e,h,d,f,k,g);this.setDefaultColors()}c.prototype.setDefaultColors=function(){var a=g.activeProject.getAlarmsMgr().getAlarmsConfiguration(),b=a.defaultColors;this.aBG=(a=a.alarms[this.alName])&&a.aBG||b.aBG;this.aTC=a&&a.aTC||b.aTC;this.dBG=a&&a.dBG||b.dBG;this.dTC=a&&a.dTC||b.dTC;this.tABG=a&&a.tABG||b.tABG;this.tATC=a&&a.tATC||b.tATC;this.nTNABG=a&&a.nTNABG||b.nTNABG;this.nTNATC=a&&a.nTNATC||b.nTNATC;this.nTABC=a&&a.nTABC||b.nTABC;this.nTATC=a&&a.nTATC||b.nTATC;this.tNABC=a&&a.tNABC||b.tNABC;this.tNATC=
a&&a.tNATC||b.tNATC;this.tBG=a&&a.tBG||b.tBG;this.tTC=a&&a.tTC||b.tTC;this.nTBC=a&&a.nTBC||b.nTBC;this.nTTC=a&&a.nTTC||b.nTTC;this.BGColor=this.dBG;this.FGColor=this.dTC};c.prototype.stateToString=function(a){switch(a){case c.stateType.STATE_NOT_TRIGGERED:return"Not Triggered";case c.stateType.STATE_TRIGGERED:return"Triggered";case c.stateType.STATE_TRIGGERED_NOT_ACKED:return"Triggered Not Acked";case c.stateType.STATE_NOT_TRIGGERED_ACKED:return"Not Triggered Acked";case c.stateType.STATE_NOT_TRIGGERED_NOT_ACKED:return"Not Triggered Not Acked";
case c.stateType.STATE_TRIGGERED_ACKED:return"Triggered Acked";default:return"Disabled"}};c.prototype.getColorsByStateCode=function(a){switch(a){case c.stateType.STATE_NOT_TRIGGERED:return{bg:this.nTBC,fg:this.nTTC};case c.stateType.STATE_TRIGGERED:return{bg:this.tBG,fg:this.tTC};case c.stateType.STATE_TRIGGERED_NOT_ACKED:return{bg:this.tNABC,fg:this.tNATC};case c.stateType.STATE_NOT_TRIGGERED_ACKED:return{bg:this.nTABC,fg:this.nTATC};case c.stateType.STATE_NOT_TRIGGERED_NOT_ACKED:return{bg:this.nTNABG,
fg:this.nTNATC};case c.stateType.STATE_TRIGGERED_ACKED:return{bg:this.tABG,fg:this.tATC};default:return{bg:this.dBG,fg:this.dTC}}};c.prototype.setColorsByState=function(){switch(this.alState){case c.stateType.STATE_NOT_TRIGGERED:this.BGColor=this.nTBC;this.FGColor=this.nTTC;break;case c.stateType.STATE_TRIGGERED:this.BGColor=this.tBG;this.FGColor=this.tTC;break;case c.stateType.STATE_TRIGGERED_NOT_ACKED:this.BGColor=this.tNABC;this.FGColor=this.tNATC;break;case c.stateType.STATE_NOT_TRIGGERED_ACKED:this.BGColor=
this.nTABC;this.FGColor=this.nTATC;break;case c.stateType.STATE_NOT_TRIGGERED_NOT_ACKED:this.BGColor=this.nTNABG;this.FGColor=this.nTNATC;break;case c.stateType.STATE_TRIGGERED_ACKED:this.BGColor=this.tABG;this.FGColor=this.tATC;break;default:this.BGColor=this.dBG,this.FGColor=this.dTC}};c.prototype.isTriggered=function(){return this.alState===c.stateType.STATE_TRIGGERED||this.alState===c.stateType.STATE_TRIGGERED_ACKED||this.alState===c.stateType.STATE_TRIGGERED_NOT_ACKED};c.prototype.isAcked=function(){return this.alState!==
c.stateType.STATE_NOT_TRIGGERED_NOT_ACKED&&this.alState!==c.stateType.STATE_TRIGGERED_NOT_ACKED};c.prototype.isPrevStateTriggered=function(){return this.prevState===c.stateType.STATE_TRIGGERED||this.prevState===c.stateType.STATE_TRIGGERED_ACKED||this.prevState===c.stateType.STATE_TRIGGERED_NOT_ACKED};c.prototype.isPrevStateAcked=function(){return this.prevState!==c.stateType.STATE_NOT_TRIGGERED_NOT_ACKED&&this.prevState!==c.stateType.STATE_TRIGGERED_NOT_ACKED};c.prototype.setState=function(a,b,e,
h,d,f,k,g){this.alName=a;void 0!==b&&null!==b&&(this.alState=b);void 0!==e&&null!==e&&(this.alValue=e);this.alEnable=this.alState==c.stateType.STATE_DISABLED?!1:!0;h&&(this.alDateTime=h,this.alDate=d,this.alTime=f);this.code=new y(k);this.liveTags=g;return this};c.prototype.startBlinking=function(){var a=this;null===this.blinkTimer&&(this.blinkTimer=setInterval(function(){g.activeProject.getAlarmsMgr().setValue("fill",a.toggleShowAlarm?a.FGColor:a.BGColor,null,0,!0,a.alName);a.toggleShowAlarm=!a.toggleShowAlarm},
this.blinkInterval))};c.prototype.stopBlinking=function(){clearInterval(this.blinkTimer);g.activeProject.getAlarmsMgr().setValue("fill",this.FGColor,null,0,!0,this.alName);this.blinkTimer=null;this.toggleShowAlarm=!0};c.prototype.update=function(a){var b=!1;this.alEnable!==a.alEnable&&(this.alEnable=a.alEnable,this.checkIfEnableTriggerAction()&&this.doActions(),b=!0);this.alState!==a.alState&&(this.prevState=this.alState,this.alState=a.alState,this.setColorsByState(),this.checkIfStateTriggerAction()&&
this.doActions(),this.isBlinkEnabled()&&(this.isAcked()?this.stopBlinking():this.startBlinking()),b=!0);this.alValue!==a.alValue&&(this.alValue=a.alValue,b=!0);this.alDateTime!==a.alDateTime&&(this.alDateTime=a.alDateTime,this.alDate=a.alDate,this.alTime=a.alTime,b=!0);if(this.liveTags)for(var e in this.liveTags)if(this.liveTags[e]!==a.liveTags[e]){b=!0;break}this.liveTags=a.liveTags;return b};c.prototype.updateProperty=function(a,b){return"undefined"!=typeof this[a]&&this[a]!=b?(this[a]=b,!0):!1};
c.prototype.getMessageStatus=function(){return this.code};c.prototype.isDirty=function(a){return null!=this.dirtyState&&null!=this.dirtyState[a]};c.prototype.setDirty=function(a,b){null==this.dirtyState&&(this.dirtyState={});this.dirty=this.dirtyState[a]=b};c.prototype.getDirtyValue=function(a){return null!=this.dirtyState?this.dirtyState[a]:this[a]};c.prototype.getValue=function(a){return this[a]};c.prototype.getDescriptionTags=function(){var a=this.liveData.d[this.getCurrentLanguage()];return a instanceof
Array?a:this.liveData.d[a]};c.prototype.getCustomField1Tags=function(){var a=this.liveData.cF1[this.getCurrentLanguage()];return a instanceof Array?a:this.liveData.cF1[a]};c.prototype.getCustomField2Tags=function(){var a=this.liveData.cF2[this.getCurrentLanguage()];return a instanceof Array?a:this.liveData.cF2[a]};c.prototype.commitDirtyValue=function(a){this[a]=this.dirtyState[a];this.dirtyState[a]=null};c.prototype.addAction=function(a){this.acts.push(a)};c.prototype.addUserAction=function(a){this.usrActs.push(a)};
c.prototype.doActions=function(){for(var a=0;a<this.acts.length;a++)g.doAction(g.activeProject.getAlarmsMgr().wgtId,this.acts[a])};c.prototype.doUserActions=function(){for(var a=0;a<this.usrActs.length;a++)g.doAction(g.activeProject.getAlarmsMgr().wgtId,this.usrActs[a])};c.prototype.getConfiguration=function(){return g.activeProject.getAlarmsMgr().getAlarmsConfiguration().alarms[this.alName]};c.prototype.getCurrentLanguage=function(){return g.activeProject.getAlarmsMgr().getCurrentLanguage()};c.prototype.isBlinkEnabled=
function(){return this.getConfiguration().blinkTxt};c.prototype.setActionMask=function(a){this.actionMask=a};c.prototype.checkIfStateTriggerAction=function(){var a=this.isTriggered()&&!this.isPrevStateTriggered(),b=!this.isTriggered()&&this.isPrevStateTriggered(),e=this.isAcked()&&!this.isPrevStateAcked(),c=!1;this.actionMask&Aa.AL_EVENT_TRIGGERED&&a&&(c=!0);this.actionMask&Aa.AL_EVENT_NOT_TRIGGERED&&b&&(c=!0);this.actionMask&Aa.AL_EVENT_ACKED&&e&&(c=!0);this.actionMask&Aa.AL_EVENT_BOTH&&(a||b)&&
(c=!0);return c};c.prototype.checkIfEnableTriggerAction=function(){return this.actionMask&Aa.AL_EVENT_ENABLED?1==this.alEnable:this.actionMask&Aa.AL_EVENT_DISABLED?0==this.alEnable:!1};c.prototype.checkIfResetTriggerAction=function(){return this.actionMask&Aa.AL_EVENT_RESET?!0:!1};c.prototype.reset=function(){this.actionMask&Aa.AL_EVENT_RESET&&this.doActions()};c.stateType={STATE_NOT_TRIGGERED:0,STATE_DISABLED:1,STATE_TRIGGERED:2,STATE_TRIGGERED_NOT_ACKED:3,STATE_NOT_TRIGGERED_ACKED:4,STATE_NOT_TRIGGERED_NOT_ACKED:5,
STATE_TRIGGERED_ACKED:6,STATE_ALARM_MAX:7};return c}();t.export("Alarm",je);var ke=function(){function c(){}c.applyPadding=function(a,b){if(!a.isPadding)return b;var e=!1;"-"==b.charAt(0)&&(e=!0,b=b.substring(1));for(var c=b.indexOf("."),c=-1!=c?c:-1!=a.ePos?b.indexOf(a.eSymbol):b.length,c=a.leadingDigits-c,d=0;d<c;d++)"0"==a.format.charAt(d)&&(b="0"+b);return e?"-"+b:b};c.formatINTValue=function(a,b,e,c){if(null!=b)return""===b?b:"string"==typeof b||"object"==typeof b?this.applyStyle(this.applyPadding(a,
b),e,c):this.applyStyle(this.applyPadding(a,Math.round(b)+""),e,c)};c.applyStyle=function(a,b,e){if(b){var c="."!=b.decimalSymbol&&""!=b.decimalSymbol;if(!c&&!e)return a;var d=a.indexOf("."),f=a;if(e)for(var f="",k=-1!=d?a.substring(0,d):a,g=k.length-1,m=g;0<=m;m--){var n=k.charAt(m);e&&m<g&&0==(g-m)%b.digitsGrouping&&(f=b.thousandSymbol+f);f=n+f}return-1!=d?c?e?f+b.decimalSymbol+a.substring(d+1):a.replace(".",b.decimalSymbol):e?f+a.substring(d):a:f}return a};c.formatDecimalPlaces=function(a,b){var e=
a.optionalDecimals,c=a.decimalPlaces;if(0==b%1&&c==e)return b.toString();if(0!=e)for(var d=b*Math.pow(10,c),f=!1,k=1;k<=e&&!f;k++)0==d%Math.pow(10,k)?c--:f=!0;return b.toFixed(c)};c.formatFLOATValue=function(a,b,e,c){return null!=b?("number"!=typeof b&&(b=parseFloat(b)),this.applyStyle(this.applyPadding(a,this.formatDecimalPlaces(a,b)),e,c)):""};c.formatHexadecimalValue=function(a,b,e){b=parseInt(b);var c=0>b;e!=v.INT64&&e!=v.INT64A&&(b=c?b>>>0:b);var d=a.numericFormat==Q.HEXL,f=d?b.toString(16):
b.toString(16).toUpperCase();if(c)switch(e){case v.BYTE:f=f.slice(-2);break;case v.SHORT:f=f.slice(-4);break;case v.INT:f=f.slice(-8);break;case v.INT64:case v.INT64A:f=b.toString(16).slice(1);break;case v.FLOAT:case v.DOUBLE:f=d?"ffffffff"+f:"FFFFFFFF"+f}return this.applyPadding(a,f)};c.formatExponentialValue=function(a,b,e,h,d){b=c.scientificNotation(b,a.decimalPlaces,a.magnitudeDegree,e);0<a.format.indexOf("E")&&(b=b.replace("e","E"));return this.applyStyle(this.applyPadding(a,b),h,d)};c.scientificNotation=
function(a,b,e,c){var d=1==e?10:Math.pow(10,e),f=0,k=0<=a?1:-1;a*=k;for(var g=0<a&&1>a?1/d:d;(1>a||a>=d)&&0!==a;)a/=g,f+=e;return(k*a).toFixed(b)+"e"+(g==d?"+":"-")+(0<c?"0":"")+f};c.formatText=function(a,b,e,c,d){switch(a.numericFormat){case Q.INT:a=this.formatINTValue(a,b,e,c);break;case Q.FLOAT:a=this.formatFLOATValue(a,b,e,c);break;case Q.HEXL:case Q.HEXU:a=this.formatHexadecimalValue(a,b,d);break;case Q.EXP:a=this.formatExponentialValue(a,b,0,e,c);break;case Q.EXPD:a=this.formatExponentialValue(a,
b,1,e,c);break;default:a=this.applyPadding(a,b+"")}return a};c.getIndexesOfSeparators=function(a){for(var b={e:-1,E:-1,"+":-1,"-":-1,",":-1,h:-1,H:-1,".":-1,0:-1,"#":-1},e=0,c=a.length;e<c;e++){var d=a.charAt(e);switch(d){case "e":case "E":case "+":case "-":case ",":case "h":case "H":case ".":case "0":case "#":b[d]=e}}return b};c.countOptionalDecimalDigits=function(a,b){for(var e=0,c=!1,d=a.length-1;d>b&&!c;d--)"#"==a.charAt(d)?e++:c=!0;return e};c.countOptionalLeadingDigits=function(a,b){for(var e=
0,c=-1!=b?b:a.length,d=0;d<c;d++)"#"==a.charAt(d)&&e++;return e};c.parseFormat=function(a){var b=V.NUMBER,e=Q.INT,h=0,d=0,f=0,k=0,g=-1,m=1,n="",z=-1,l=-1;if("none"==a.toLowerCase())b=V.TEXT;else{var O=c.getIndexesOfSeparators(a),p=-1!=O.e?O.e:O.E;-1!=p?(n=-1!=O.e?"e":"E",e=Q.EXP,-1!=O["."]?(m=g=O["."],h=p-g-1,k=O["."]):(m=p,h=0,k=p),m=0<m?m:1,-1!=O["+"]&&2<=a.length-1-O["+"]&&(e=Q.EXPD)):-1!=O["."]?(e=Q.FLOAT,g=O["."],h=a.length-1-g,d=c.countOptionalDecimalDigits(a,g),k=g):-1!=O.h||-1!=O.H?(e=-1!=
O.h?Q.HEXL:Q.HEXU,k=z=-1!=O.h?O.h:O.H):-1!=O["#"]||O["0"]?(e=Q.INT,k=a.length,f=this.countOptionalLeadingDigits(a,-1),-1!=O[","]&&(l=a.length-1-O[","])):b=V.TEXT}return{format:a,formatType:b,numericFormat:e,decimalPlaces:h,isPadding:0<k&&k>f,magnitudeDegree:m,dotPos:g,leadingDigits:k,hPos:z,ePos:-1,eSymbol:n,oldDigitsGrouping:l,optionalDecimals:d,optionalLeading:f}};c.format=function(a,b,e,h){return c.formatText(a,b,e,h,-1)};c.addDecimalDigitsToFormat=function(a,b){a+=".";for(var e=0;e<b;e++)a+="0";
return a};c.addLeadingDigitsToFormat=function(a,b){for(var e=1;e<b;e++)a="0"+a;return a};c.generateDynamicFormat=function(a){var b=a.format,b=0<=b.indexOf("h")?"#h":0<=b.indexOf("H")?"#H":"#";void 0!==a.decimalPlaces&&"#"===b&&0<a.decimalPlaces&&(b=c.addDecimalDigitsToFormat(b,a.decimalPlaces));void 0!==a.leadingDigits&&0<a.leadingDigits&&(b=this.addLeadingDigitsToFormat(b,a.leadingDigits));return b};c.containsD=function(a,b){var e=b.length,c=a.indexOf(b);if(-1!=c){var d=a.length;return(0<c-1&&"d"!=
a.charAt(c-1)||-1==c-1)&&(c+e<d-e&&"d"!=a.charAt(c+e)||c+e==d)}return!1};c.parseDateTimeFormat=function(a,b){"LONG-DATE"==a?a=void 0!=b.longDateFormat?b.longDateFormat:a:"SHORT-DATE"==a&&(a=void 0!=b.shortDateFormat?b.shortDateFormat:a);var e={format:a,formatType:V.DATETIME},h=e.format.indexOf("AP"),d=e.format.indexOf("ap");-1!=h||-1!=d?(e.format=-1!=h?e.format.replace("AP","A"):e.format.replace("ap","a"),e.format=e.format.replace("HH","hh")):e.format=e.format.replace("hh","HH");e.format=e.format.replace(/y/g,
"Y");if(c.containsD(e.format,"dd")||c.containsD(e.format,"d"))e.format=e.format.replace(/d/g,"D");e.format=e.format.replace(/m{4}/,"MMMM");e.format=e.format.replace(/D{4}/,"dddd");e.format=e.format.replace(/D{3}/,"ddd");return e};c.formatDateTime=function(a,b,e,h){a=moment(a);switch(b){case "global":a.utcOffset(0);break;case "server":void 0!==h.serverOffset?(h=h.serverOffset,720<h&&(h-=65536)):h=0,a.utcOffset(h)}h=e.format;h==c.ISO8601Placeholder?h="YYYY-MM-DDTHH:mm:ss"+("global"==b||"server"==b?
"[Z]":"Z"):h==c.UnixTSPlaceHolder&&(h="X");e.milliseconds&&(h=e.format.replace(/ss/i,"ss.SSS"));return a.format(h)};c.timeFormatValidator=/(((\s*h+\s*:\s*mm\s*:s+\s*)|(\s*mm\s*:s+\s*)|(\s*h+\s*:\s*mm\s*)|(\s*s+\s*)|(\s*mm^m\s*)|(\s*h+\s*))((AP\s*|A\s*|ap\s*|a\s*)?))/g;c.dateFormatValidator=/(((M+|mmmm)(.+)?(D+|d+)(.+)?(Y+|y+)(\s+)?)|((D+|d+)(.+)?(M+|mmmm)(.+)?(Y+|y+)(\s+)?)|((D+|d+)(.+)?(Y+|y+)(.+)?(M+|mmmm)(\s+)?)|((M+|mmmm)(.+)?(Y+|y+)(.+)?(D+|d+)(\s+)?)|((Y+|y+)(.+)?(M+|mmmm)(.+)?(D+|d+)(\s+)?)|((Y+|y+)(.+)?(D+|d+)(.+)?(M+|mmmm)(\s+)?)|((M+|mmmm)(.+)?(D+|d+)?(.+)?(Y+|y+)?(\s+)?)|((Y+|y+)(.+)?(D+|d+)?(.+)?(M+|mmmm)?(\s+)?)|((D+|d+)(.+)?(M+|mmmm)?(.+)?(Y+|y+)?(\s+)?))/g;
c.ISO8601Placeholder="2021-07-29T14:30:12.752+02:00";c.UnixTSPlaceHolder="1636988025";return c}();t.addModule("TextFormatUtil",ke);var Oa;(function(c){c[c.ASCENDING=0]="ASCENDING";c[c.DESCENDING=1]="DESCENDING";c[c.TOGGLE=100]="TOGGLE"})(Oa||(Oa={}));var db;(function(c){c[c.ALPHABET=0]="ALPHABET";c[c.NUMERIC=1]="NUMERIC"})(db||(db={}));var Yb=function(){function c(a){this.sortings=this.resolvedSortings=a._s||[];this.filter=this.resolvedFilter=a._f;this.header=a._h;this.isHeader=!0===a._h?!0:!1;this.isProps=
a._h instanceof Array?!0:!1;this.type=a._t;this.value=a._v;this.bg=a._bg;this._originalIndex=a.index;this.proxy=a.parent;this.visible=a.visible}Object.defineProperty(c.prototype,"resolvedSortings",{get:function(){return this._resolvedSortings},set:function(a){this._resolvedSortings=a},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"originalIndex",{get:function(){return this._originalIndex},set:function(a){this._originalIndex=a},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,
"visible",{get:function(){return this._visible},set:function(a){this._visible=a},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"resolvedFilter",{get:function(){return this._resolvedFilter},set:function(a){this._resolvedFilter=a},enumerable:!1,configurable:!0});c.prototype.updateToggleMap=function(){var a=this;if(this.isProps)for(var b=function(b){var c=e.sortings[b]._c;if(e.sortings[b]._m==Oa.TOGGLE){var h=g.getWidget(e.proxy.wgtId),q=function(e,c){h.sortingToggleMap.set(e,c);
a.sortings[b]._m=h.sortingToggleMap.get(e)};if(h.sortingToggleMap.has(c))return q(c,1==h.sortingToggleMap.get(c)?0:1),"continue";q(c,0)}},e=this,c=0;c<this.sortings.length;c++)b(c)};c.prototype.applyMl=function(){var a=g.activeProject.getMultiLanguageMgr().getCurrentLangCode();if(this.value)for(var b=0;b<this.value.length;b++)this.value[b]instanceof Object&&"ml"==this.value[b]._c&&(this.value[b]=this.value[b].mltext[a])};c.prototype.getBooleanFilterValue=function(a){var b=!1;void 0===a&&(b=!0);"number"==
typeof a&&(b=Boolean(a));"string"==typeof a&&(b=isNaN(Number(a))?!0:Boolean(Number(a)));"boolean"==typeof a&&(b=a);return b};c.prototype.initFilter=function(){this.resolvedFilter=this.filter instanceof Object?!1:this.filter=this.getBooleanFilterValue(this.filter)};c.prototype.isDatalink=function(a){return a._c&&"dl"==a._c?!0:!1};c.prototype.getDirectFormulaXForm=function(a){var b=this.proxy.getTableGroup(),e=b.getDatalink("filter"),b=b.filterSrcType;return e&&e.xforms&&(e=e.xforms[0],"Formula"==b&&
a.v&&"="==a.v.charAt(0))?e:null};c.prototype.getExpressionParams=function(a,b){var e=a.getMapAttrLink();a.getNumAttrLink();var c={},d;for(d in e){var f=e[d];f.tagType===v.INT64?c[d]="fromString('"+b.get(d)+"')":f.tagType===v.UINT64?c[d]="fromString('"+b.get(d)+"',true,10)":(f.tagType!==v.STRING&&b.get(d),c[d]=b.get(d))}return c};c.prototype.createDatalink=function(a,b,e,c){try{var d=g.createDataLink(b,a,{attr:c});d.readFromString(e);d.mount();this.proxy.setDynamicDatalinkToMap(d);"Tag"==d.srcType&&
this.proxy.addTagToSubscribe(d.tag)}catch(f){g.showErrorMessage("model_item_"+this._originalIndex,"TableGroupProxy: 'createDatalink' function",f.message)}};c.prototype.createSortingsDatalinks=function(){for(var a=g.getWidget(this.proxy.wgtId),b=0;b<this.sortings.length;b++){var e=this.sortings[b];this.isDatalink(e)&&this.createDatalink(null,a,e.v,"sort%"+this._originalIndex+"%"+b)}};c.prototype.resolveFilterFormulaValuesAtIndex=function(a){var b=this,e=this.proxy.getFilterXFormulaRows().get(this._originalIndex);
e.forEach(function(e,c,f){var k=a.getMapAttrLink()[c],q=e;if(k&&k.dataSrc.isTableDataSource){var k=b.proxy.getDynamicDatalinkFromMap("filter%"+b._originalIndex+"%"+c),m=e instanceof Object&&"dl"==e._c;k?q=(e=g.cache.getTag(k.tag))?e.getValue(e.tagIndex):"":m&&b.createDatalink(null,b.proxy,e.v,"filter%"+b._originalIndex+"%"+c)}else q=a.getVarValue(c);f.set(c,q)});return e};c.prototype.executeCompiledExpression=function(a){if(null===this.proxy.compiledFilterFunction){var b=this.getDirectFormulaXForm(this.filter);
this.proxy.setCompiledFunction(a,b.getCompiledExpression())}return this.proxy.compiledFilterFunction(a)};c.prototype.createFilterDatalinks=function(){this.isDatalink(this.filter)&&this.updateDatalinkFilter();this._visible=!0===this.resolvedFilter?!0:!1};c.prototype.updateStaticFilter=function(a){this.resolvedFilter=this.getBooleanFilterValue(a);this._visible=!0===this.resolvedFilter?!0:!1};c.prototype.updateDatalinkFilter=function(){var a=this.getDirectFormulaXForm(this.filter);if(a){var b=this.resolveFilterFormulaValuesAtIndex(a),
a=this.getExpressionParams(a,b);this.updateStaticFilter(this.executeCompiledExpression(a))}else null==this.proxy.getDatalink("filter%"+this._originalIndex)&&this.createDatalink(null,this.proxy,this.filter.v,"filter%"+this._originalIndex)};c.prototype.init=function(){this.updateToggleMap();this.initFilter();this.applyMl();this.createSortingsDatalinks();this.createFilterDatalinks()};c.prototype.setSortingValueAtIndex=function(a,b){this.resolvedSortings[b]=a};c.prototype.clone=function(){var a=g.import("deepClonePlainObject");
return new c(a({_bg:this.bg,_h:this.header,_v:this.value,_t:this.type,_f:this.resolvedFilter,_s:this.resolvedSortings,index:this.originalIndex,parentId:this.proxy.wgtId,visible:this.visible}))};c.prototype.toJSON=function(){var a={_bg:this.bg,_v:this.value,_t:this.type,_f:this.resolvedFilter,_s:this.resolvedSortings};if(this.isProps||this.isHeader)a._h=this.header;return a};return c}();Wa.prototype.setTime=function(c,a){this.date.hour(c);this.date.minutes(a)};Wa.prototype.setDate=function(c,a,b){this.date.dates(c);
this.date.month(a);this.date.year(b)};Wa.prototype.getValue=function(c,a,b){return this.date.clone().toDate()};Wa.prototype.getUTCValue=function(c,a,b){return this.date.clone().utc().toDate()};Wa.prototype.start=function(){var c=this;this.interval=setInterval(function(){c.date.add(1,"s")},1E3)};Wa.prototype.stop=function(){clearInterval(this.interval)};H.prototype.constructor="State";H.prototype.timestamp=null;H.prototype.value=null;H.prototype.quality=null;H.prototype.type=null;H.prototype.setState=
function(c,a,b,e,h){this.quality=c&&c.constructor==za?c:new za(c);this.value=void 0;this.quality.isQualityGood()&&(this.value=a);this.type=b;this.ts=new Date(h);this.code=new y(e);return this};H.prototype.setValue=function(c){this.value=c};H.prototype.getValue=function(){return this.value};H.prototype.getQuality=function(){return this.quality};H.prototype.getTimestamp=function(){return this.ts.getTime()};H.prototype.setTimestamp=function(c){this.ts=new Date(c)};H.prototype.isQualityGood=function(){return this.quality.isQualityGood()};
H.prototype.setQualityStatus=function(c){if(this.quality)this.quality.setStatus(c);else{var a=new za;a.setStatus(c);this.quality=a}};H.prototype.getQualityBits=function(){return this.quality.qual<<6|this.quality.substatus<<2|this.quality.limit};H.prototype.setMessageCode=function(c){"string"==typeof c?this.code=new y(c):"number"==typeof c?(this.code=new y,this.code.setValue(c)):this.code=new y};H.prototype.getMessageStatus=function(){return this.code};t.addModule("State",H);ra.prototype.name=null;
ra.prototype.value=null;ra.prototype.setState=function(c,a,b){this.name=c;this.value=a;this.code=new y(b);return this};ra.prototype.getMessageStatus=function(){return this.code};ra.prototype.getValue=function(){return this.value};ra.prototype.constructor=ra;fa.prototype.selected=!1;fa.prototype.drw=!0;fa.prototype.setState=function(c,a,b){this.x=c;this.y=a;this.q=b;return this};fa.prototype.setDrawable=function(c){this.drw=c};fa.prototype.select=function(c){this.selected=c};fa.prototype.getValue=
function(){return this.y};fa.prototype.setValue=function(c){this.y=c};fa.prototype.constructor=fa;la.prototype=Object.create(Tb.prototype);la.prototype.Name=null;la.prototype.Status=null;la.prototype.RecipeSetList=null;la.prototype.selSet=null;la.prototype.lastSet=null;la.prototype.rcList=null;la.prototype.constructor=la;sa.prototype=Object.create(Tb.prototype);sa.prototype.id=null;sa.prototype.Name=null;sa.prototype.Value=null;sa.prototype.elemList=null;sa.prototype.constructor=sa;ya.prototype=Object.create(Tb.prototype);
ya.prototype.id=null;ya.prototype.Name=null;ya.prototype.Value=null;ya.prototype.constructor=ya;y.prototype.code=null;y.prototype.status=y.status={E_FAIL:0,S_OK:1,E_INVALIDARG:-2,E_NO_SESSION_EXIST:-3,E_NEED_LOGIN:-4,E_UNKNOWNGROUP:-5,E_INACTIVEGROUP:-6,E_PROPERTY_NOT_MAPPED:-7,E_RESOURCE_LOCATOR_NOT_FOUND:-8,E_CONFIG_FILE_NOT_FOUND:-9,E_INVALID_PROPERTY:-10,E_READ_FORBIDDEN:-11,E_INACTIVETAG:-12,E_NOT_BINDED_TO_PROTOCOL:-13,E_UNKNOWNTAG:-14,E_TIMEOUT:-15,E_INIT:-16,E_WRITE_FORBIDDEN:-18};y.status=
y.prototype.status;y.prototype.setState=function(c){this.code=this.status[c]};y.getCode=function(c){return y.status[c]};y.prototype.toString=function(){switch(this.code){case this.status.E_FAIL:return"Request Failed";case this.status.S_OK:return"Success";case this.status.E_INVALIDARG:return"Invalid Arguments";case this.status.E_NO_SESSION_EXIST:return"No Session Exists";case this.status.E_NEED_LOGIN:return"Need New Login";case this.status.E_UNKNOWNGROUP:return"Unknown Group";case this.status.E_INACTIVEGROUP:return"Inactive Group";
case this.status.E_PROPERTY_NOT_MAPPED:return"Property Not Mapped";case this.status.E_RESOURCE_LOCATOR_NOT_FOUND:return"Resource Not Found";case this.status.E_CONFIG_FILE_NOT_FOUND:return"Configuration File Not Found";case this.status.E_INVALID_PROPERTY:return"Invalid Property";case this.status.E_READ_FORBIDDEN:return"Read Forbidden";case this.status.E_INACTIVETAG:return"Tag is not active";case this.status.E_NOT_BINDED_TO_PROTOCOL:return"Protocol is not binded";case this.status.E_UNKNOWNTAG:return"Tag Name Is Not Known";
case this.status.E_TIMEOUT:return"Timeout Request";case this.status.E_INIT:return"Error on Initialization"}};y.prototype.setValue=function(c){this.code=c};y.prototype.getValue=function(){return this.code};y.prototype.clone=function(){var c=new y;c.code=this.code;return c};Hc.prototype.createServer=function(c){switch(c.active){case "PollingInterface":this.serverClass=PollingInterface;break;case "SSEInterface":this.serverClass=Vc;break;case "offline":this.serverClass=Vc}return new this.serverClass(c)};
var hc={},Ic=function(c){var a={type:c.type,url:c.url,async:!1===c.asycn?!1:!0,search:""},b=c.data;if(b&&"string"==typeof b)a.search=b;else if(b&&"object"==typeof b){var e=[],h;for(h in b)e.push(encodeURIComponent(h)+"="+encodeURIComponent(b[h]));a.search=e.join("&")}a.search=c.nocache?""==a.search?a.search+"nocache=1":a.search+"&nocache=1":""==a.search?a.search+(new Date).getTime():a.search+("&"+(new Date).getTime());a.type=void 0===a.type?"GET":a.type;c="";"GET"===a.type&&a.search&&(c=-1!=a.url.indexOf("?")?
"&"+a.search:"?"+a.search);a.url+=c;return a},x=function(c){return new Promise(function(a,b){var e=new XMLHttpRequest,h=Object.assign({},hc,c.headers),d=Ic(c);e.open(d.type,d.url,d.async);if(h)for(var f in h)e.setRequestHeader(f,h[f]);c.async&&(e.timeout="4000");e.onload=function(){200<=e.status&&400>e.status?a(e.responseText):b(e.responseText);e.abort()};e.ontimeout=function(){b(e.responseText);e.abort()};e.onerror=function(){b(e.responseText);e.abort()};"GET"===d.type?e.send():e.send(d.search)})},
p=this&&this.__extends||function(){var c=function(a,b){c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return c(a,b)};return function(a,b){function e(){this.constructor=a}c(a,b);a.prototype=null===b?Object.create(b):(e.prototype=b.prototype,new e)}}(),jc=function(){function c(a){var b;this.getTableDataSource=function(b){var a;return $.ajax({type:"GET",dataType:"json",url:this.webProjectUrl+"/datasources/"+
b,headers:{"X-CSRF-TOKEN":null===(a=window.localStorage)||void 0===a?void 0:a.getItem("csrf")}})};this.configuration={};this.defConf=null;this.projectPath="";this.loginStatus=!1;this.conf={exception:{ipad1:!1},ssemode:0};this.url=window.location.protocol+"//"+window.location.host;this.pathName=window.location.pathname;this.projectName=a.projectName;var e=-1,e=this.pathName.indexOf("/web/web/pages");-1==e&&(e=this.pathName.indexOf("/web/web/umtemplates"));-1==e&&(e=this.pathName.indexOf("/web/web/_"));
this.endpoint="";-1<e&&(e=this.pathName.substring(0,e).split("/"),this.endpoint=e.slice(0,e.length-1).join("/"),this.url+=this.endpoint);for(var c in a)this[c]=a[c];Jc({"X-CSRF-TOKEN":null===(b=window.localStorage)||void 0===b?void 0:b.getItem("csrf")})}c.prototype.loadLoginUI=function(a,b){location.href=this.url+"/index.html"+(a?"?denyDefUser=true":"?denyDefUser=false")+(b?"&forceLogin=true":"&forceLogin=false")};c.prototype.loadIndex=function(){location.href=this.url+"/index.html"};c.prototype.getProjectInformation=
function(){var a=this;return-1!=this[this.active].status?this.getProperty("projectRelativePath",!1).then(function(b){var e=b.getMessageStatus().getValue();e==y.status.S_OK?(a.projectPath=b.getValue().substring(10),a.webProjectUrl=a.url+"/"+a.projectPath+"/web/web",a.loginStatus=!0):e==y.status.E_PROPERTY_NOT_MAPPED&&(a.webProjectUrl=a.url+"/web",a.loginStatus=!0)},function(b){b.getMessageStatus().getValue()==y.status.E_NEED_LOGIN&&(location.href=a.url+a.getLoginRoute())}):Promise.resolve(void 0)};
c.prototype.getOptions=function(){return this.conf};c.prototype.setUrl=function(a){this.url=a};c.prototype.isLogged=function(){return this.loginStatus};c.prototype.getProperty=function(a,b){return x({url:this.url+"/cgi/getProperties",data:"n=1&it1="+a,async:!b,cache:!1}).then(function(b){var a=new ra;b=b.split("\t");var c=b[1].trim();return"S_OK"==c?a.setState(b[0],b[2],c):a.setState(b[0],null,c)},function(b){var a=new ra;return b.responseText?a.setState(null,null,b.responseText.trim().replace("#",
"")):a.setState(null,null,"E_TIMEOUT")})};c.prototype.activateTag=function(a,b,e){return x({type:"POST",url:this.url+"/cgi/"+(b?"":"de")+"activateTags",data:"n=1&t1="+a,async:e})};c.prototype.activateTagSync=function(a,b){return ca({type:"GET",url:this.url+"/cgi/"+(b?"":"de")+"activateTags",data:"n=1&t1="+a,cache:!1})};c.prototype.requestConf=function(){this.defConf=x({type:"GET",url:this.webProjectUrl+"/config/conf.json",cache:!1}).then(function(a){return a?JSON.parse(a):{}})};c.prototype.getConf=
function(){return this.defConf};c.prototype.getAlarmConf=function(){return x({type:"GET",url:this.webProjectUrl+"/config/alarms.json",cache:!1}).then(function(a){return null!=a?JSON.parse(a):{}},function(){return{}})};c.prototype._getConf=function(a){return x({type:"GET",url:this.webProjectUrl+"/config/"+a,cache:!1}).then(function(b){return b?JSON.parse(b):{}})};c.prototype.getPropsMap=function(){return this._getConf("propsMap.json")};c.prototype.getGroupsConf=function(){return this._getConf("groups.json")};
c.prototype.getTagsConf=function(){return this._getConf("tags.json")};c.prototype.getTrendsConf=function(){return this._getConf("trends.json")};c.prototype.getRecipesConf=function(){return this._getConf("recipes.json")};c.prototype.getSchedulesConf=function(){return this._getConf("schedules.json")};c.prototype.readTags=function(a,b){for(var e="",c=a.length,d=0;d<c;d++)e+="&t"+(d+1)+"="+a[d];var e="n="+c+e+"&nocache=1",f=this,k=t.getModule("Tag");return this.activateTags(a,b).then(function(a){var c;
if(0<=a.indexOf("S_OK"))return $.ajax({type:"POST",dataType:"json",url:f.url+"/cgi/readTags.json",data:e,async:!b,headers:{"X-CSRF-TOKEN":null===(c=window.localStorage)||void 0===c?void 0:c.getItem("csrf")}})}).then(function(b){var a=[];if(null!=b)for(var e=0;e<b.tgs.length;e++){var c=b.tgs[e];a.push((new k).setState(c.name,-1,c.value,c.code,c.quality))}return a})["catch"](function(b){return[]})};c.prototype.activateTags=function(a,b){return this._activateTags(a,!0,b)};c.prototype.deactivateTags=
function(a,b){return this._activateTags(a,!1,b)};c.prototype._activateTags=function(a,b,e){for(var c="",d=a.length,f=0;f<d;f++)c+="&t"+(f+1)+"="+a[f];return x({type:"POST",url:this.url+"/cgi/"+(b?"":"de")+"activateTags",data:"n="+d+c,async:!e})};c.prototype.readTag=function(a){return this._readTagsJsonAsynch(a.name,a.index)};c.prototype.readTagSync=function(a){return this._readTagsJsonSync(a.name,a.index)};c.prototype._readTagsJsonSync=function(a,b){var e=this.url+"/cgi/readTags.json",c="returnType=true&returnTS=true&n=1&t1="+
encodeURIComponent(a)+"."+b+"&nocache=1",d=new H,f=this.activateTagSync(a,!0);200<=f.status&&400>f.status?(f=f.data,0<=f.indexOf("S_OK")?(e=ca({url:e,data:c}),200<=e.status&&400>e.status?(e=e.data,null!=e?(e=JSON.parse(e).tgs[0],d.setState(e.quality,e.value,e.type,e.code,e.ts),this.activateTag(a,!1,!0)):d.setMessageCode(y.status.E_FAIL)):d.setMessageCode(y.status.E_TIMEOUT)):0<=f.indexOf("E_UNKNOWNTAG")?d.setMessageCode(y.status.E_UNKNOWNTAG):d.setMessageCode(y.status.E_FAIL)):d.setMessageCode(y.status.E_TIMEOUT);
return d};c.prototype._readTagsJsonAsynch=function(a,b){var e=this.url+"/cgi/readTags.json",c="returnType=true&returnTS=true&n=1&t1="+encodeURIComponent(a)+"."+b+"&nocache=1",d=this;return this.activateTag(a,!0,!0).then(function(b){if(0<=b.indexOf("S_OK"))return $.getJSON(e,c);if(0<=b.indexOf("E_UNKNOWNTAG")){b=b.split("\t");var a=new y("E_UNKNOWNTAG");g.showErrorMessage("ServerInterface","ActivateTag",a.toString()+": "+b[0])}return null}).then(function(b){var e=new H;null!=b&&(b=b.tgs[0],e.setState(b.quality,
b.value,b.type,b.code,b.ts),d.activateTag(a,!1,!0));return e})["catch"](function(){var b=new H;b.setMessageCode(y.status.E_TIMEOUT);return b})};c.prototype.writeTag=function(a,b,e,c){return c?this._writeTagSync(a,b,e):this._writeTagAsync(a,b,e)};c.prototype._writeTagAsync=function(a,b,e){a="n=1&t1="+encodeURIComponent(a.name)+"."+a.index+"&v1="+encodeURIComponent(b)+"&nocache=1";return x({type:"POST",url:this.url+"/cgi/writeTags.json",data:a,timeout:3E4,async:!0}).then(function(b){if(null!=b){var a=
JSON.parse(b);e.setState(a.tgs[0])}return a})};c.prototype._writeTagSync=function(a,b,e){e=this.url+"/cgi/writeTags.json";b="n=1&t1="+encodeURIComponent(a.name)+"."+a.index+"&v1="+encodeURIComponent(b)+"&nocache=1";a=new H;e=ca({type:"POST",url:e,data:b,timeout:3E4});200<=e.status&&400>e.status?(e=e.data,null!=e?(e=JSON.parse(e).tgs[0],a.setState(e.quality,e.value,e.type,e.code,e.ts)):a.setMessageCode(y.status.E_FAIL)):a.setMessageCode(y.status.E_TIMEOUT);return a};c.prototype.readGroup=function(a,
b,e){return e?this.readGroupJsonSync(a,b):this.readGroupJsonAsync(a,b)};c.prototype.readGroupJsonAsync=function(a,b){return x({type:"GET",url:this.url+"/cgi/readGroups.json",data:"n=1&gr1="+encodeURIComponent(a),cache:!1,timeout:12E3}).then(function(a){return a?(a=JSON.parse(a).gs[0],b.setState(a.g.name,a.g.code,a.tgs),b):{}})};c.prototype.readGroupJsonSync=function(a,b){var e;return $.ajax({type:"GET",dataType:"JSON",url:this.url+"/cgi/readGroups.json",data:"n=1&gr1="+encodeURIComponent(a),cache:!1,
timeout:12E3,async:!1,headers:{"X-CSRF-TOKEN":null===(e=window.localStorage)||void 0===e?void 0:e.getItem("csrf")}}).then(function(a){if(a){a=JSON.parse(a);var e=a.gs[0];b.setState(e.g.name,e.g.code,e.tgs);return a}return{}})};c.prototype.readGroups=function(a,b,e){return e?this.readGroupsSync(a,b):this.readGroupsAsync(a,b)};c.prototype.readGroupsSync=function(a,b){for(var e=this,c,d=a.length,f="",k=1;k<=d;k++)f+="gr"+k+"="+a[k-1],k!=d&&(f+="&");return $.ajax({type:"GET",dataType:"JSON",url:this.url+
"/cgi/readGroups.json",data:"n="+d+"&"+encodeURIComponent(f),cache:!1,timeout:12E3,async:!1,headers:{"X-CSRF-TOKEN":null===(c=window.localStorage)||void 0===c?void 0:c.getItem("csrf")}}).then(function(a){a&&e.consumeReadGroups(a,b);return b})};c.prototype.readGroupsAsync=function(a,b){for(var e=this,c=a.length,d="",f=1;f<=c;f++)d+="gr"+f+"="+a[f-1],f!=c&&(d+="&");return x({type:"GET",url:this.url+"/cgi/readGroups.json",data:"n="+c+"&"+encodeURIComponent(d),cache:!1,async:!0,timeout:12E3}).then(function(a){a&&
(a=JSON.parse(a),e.consumeReadGroups(a,b));return b})};c.prototype.consumeReadGroups=function(a,b){for(var e=t.getModule("Tag"),c=0;c<a.gs.length;c++){var d=a.gs[c],f=[];if(d.tgs)for(var k=d.tgs.length,g=0;g<k;g++){var m=d.tgs[g];f.push((new e).setState(m.name,-1,m.value,m.code,m.quality))}b[c].setState(d.g.name,d.g.code,f)}};c.prototype.activateGroup=function(a,b,e){return e?this._activateGroupsJsonSync([a],[b],!0):this._activateGroupsJsonAsync([a],[b],!0)};c.prototype.deactivateGroup=function(a,
b,e){return e?this._activateGroupsJsonSync([a],[b],!1):this._activateGroupsJsonAsync([a],[b],!1)};c.prototype.activateGroups=function(a,b,e){return e?this._activateGroupsJsonSync(a,b,!0):this._activateGroupsJsonAsync(a,b,!0)};c.prototype.deactivateGroups=function(a,b,e){return e?this._activateGroupsJsonSync(a,b,!1):this._activateGroupsJsonAsync(a,b,!1)};c.prototype._activateGroupsJsonAsync=function(a,b,e){for(var c=this,d=this.url,f=a.length,k="",g=1;g<=f;g++)k+="gr"+g+"="+a[g-1],g!=f&&(k+="&");return x({type:"GET",
url:e?d+"/cgi/activateGroups.json":d+"/cgi/deactivateGroups.json",data:"n="+f+"&"+encodeURIComponent(k),async:!0}).then(function(a){a&&(a=JSON.parse(a),c.consumeActivateGroupResponse(a,e,b));return b})};c.prototype._activateGroupsJsonSync=function(a,b,e){for(var c=this,d,f=this.url,k=a.length,g="",m=1;m<=k;m++)g+="gr"+m+"="+a[m-1],m!=k&&(g+="&");return $.ajax({type:"GET",dataType:"JSON",url:e?f+"/cgi/activateGroups.json":f+"/cgi/deactivateGroups.json",data:"n="+k+"&"+encodeURIComponent(g),cache:!1,
timeout:12E3,async:!1,headers:{"X-CSRF-TOKEN":null===(d=window.localStorage)||void 0===d?void 0:d.getItem("csrf")}}).then(function(a){c.consumeActivateGroupResponse(a,e,b);return b})};c.prototype.consumeActivateGroupResponse=function(a,b,e){if(a)for(var c=0;c<a.gs.length;c++){var d=a.gs[c];b&&e[c].setState(d.name,d.code,null)}};c.prototype.getDLSSettings=function(a){return x({type:"GET",url:this.url+"/cgi/getDLSSettings",async:!a}).then(function(b){b=b.split("\n");var a={};"#S_OK"==b[0]?(a.status=
b[0],a.stdoff=parseFloat(b[1]),a.stdw=parseFloat(b[2]),a.stdd=parseFloat(b[3]),a.stdm=parseFloat(b[4]),a.stdhh=parseFloat(b[5]),a.stdmm=parseFloat(b[6]),a.dlsoff=parseFloat(b[7]),a.dlsw=parseFloat(b[8]),a.dlsd=parseFloat(b[9]),a.dlsm=parseFloat(b[10]),a.dlshh=parseFloat(b[11]),a.dlsmm=parseFloat(b[12]),a.mode=parseFloat(b[13])):a.status=b[0];return a})};c.prototype.getLocalTime=function(a){return x({type:"GET",url:this.url+"/cgi/getLocalTime",async:!a}).then(function(b){b=b.split("\n");var a={};"#S_OK"==
b[0]?(a.status=b[0],a.time=b[1]):a.status=b[0];return a})};c.prototype.setLocalTime=function(a,b,e,c,d,f,k){return x({type:"GET",url:this.url+"/cgi/setLocalTime",data:"sec="+a+"&min="+b+"&hour="+e+"&day="+c+"&month="+d+"&year="+f,async:!k}).then(function(b){return{status:b}})};c.prototype.getTime=function(a){return x({type:"GET",url:this.url+"/cgi/getTime?nocache=1",async:!a}).then(function(b){b=b.split("\n");var a={};"#S_OK"==b[0]?(a.status=b[0],a.time=1E3*parseFloat(b[1])):a.status=b[0];return a})};
c.prototype.setTime=function(a,b){return x({type:"GET",url:this.url+"/cgi/setTime",data:"time="+a,async:!b}).then(function(b){return{status:b}})};c.prototype.readAlarms=function(a,b){for(var e="",c=0,d=a.length,f=0;f<d;f++)e+="&al"+ ++c+"="+a[f];return x({type:"POST",url:this.url+"/cgi/readAlarms",data:"n="+c+e,timeout:12E3,async:!b}).then(function(b){return b})};c.prototype.resetAlarms=function(a,b){for(var e="",c=0,d=a.length,f=0;f<d;f++)e+="&al"+ ++c+"="+a[f];return x({type:"POST",url:this.url+
"/cgi/resetAlarms",data:"n="+c+e,async:!b})};c.prototype.acknowledgeAlarms=function(a,b){for(var e="",c=0,d=a.length,f=0;f<d;f++)e+="&al"+ ++c+"="+a[f];return x({type:"POST",url:this.url+"/cgi/acknowledgeAlarms",data:"n="+c+e,async:!b})};c.prototype.enableAlarms=function(a,b,e){for(var c="",d=0,f=a.length,k=0;k<f;k++)c+="&al"+ ++d+"="+a[k];return x({type:"POST",url:this.url+"/cgi/enableAlarms",data:"n="+d+c+"&enableflag="+b,async:!e})};c.prototype.saveConfiguration=function(a){return x({type:"GET",
url:this.url+"/cgi/saveConfiguration",cache:!1,async:!a})};c.prototype.readEvent=function(a,b){return this._GET(this.url+"/cgi/readEvent.json",a.toURL(),!1)};c.prototype.getLoginRoute=function(){return"/public/login.html?_="+(new Date).getTime()};c.prototype.deleteEventArchive=function(a){return x({type:"GET",url:this.url+"/cgi/deleteEventArchive",data:"archive="+a,timeout:12E3})};c.prototype.deleteTrend=function(a,b){return this._GET(this.url+"/cgi/deleteTrendFile.json","tr="+encodeURIComponent(a),
b)};c.prototype.dumpTrend=function(a,b){var e=this.url+"/cgi/dumpTrendFile.json",c="tr="+encodeURIComponent(a.n)+"&folder="+a.f+"&dformat="+a.fmt+"&dtPrefix="+a.dt+"&localTs="+a.dts;a.fnformat&&(c+="&fformat="+encodeURIComponent(a.fnformat));a.csvfields&&(c+="&csvfields="+a.csvfields);a.csvlogs&&(c+="&csvlogs="+a.csvlogs);a.dtformat&&(c+="&dtformat="+a.dtformat);a.langcode&&(c+="&lang="+a.langcode);return this._POST(e,c,b)};c.prototype.readTrend=function(a,b,e,c,d){a="tr="+encodeURIComponent(a)+"&returnTS=true&returnRT=false&startTime="+
parseInt((b/1E3).toString())+"&endTime="+parseInt((e/1E3).toString());a=c?a+("&nSamples="+c):a+"&nSamples=0";a=(d?a+("&deltaTime="+d):a+"&deltaTime=0")+"&bounds=true";var f=t.getModule("Quality");return x({type:"GET",url:this.url+"/cgi/readTrend.json",data:a,timeout:12E3}).then(function(b){b=JSON.parse(b);var a={n:b.n,d:null};if("S_OK"==b.code||"S_MOREDATA"==b.code){var e=b.d.length;a.d=Array(e);for(var c=0;c<e;c++){var h=b.d[c],d=new f(h.q);d.isQualityBad()&&(h.v=void 0);a.d[c]=new fa(1E3*h.rts,
h.v,d)}}return{s:a,c:b.code}})};c.prototype._GET=function(a,b,e){return this._request("GET",a,b,e)};c.prototype._POST=function(a,b,e){return this._request("POST",a,b,e)};c.prototype._request=function(a,b,e,c){return x({type:a,url:b,data:e,cache:!1,timeout:12E3,async:!c}).then(function(b){return JSON.parse(b)})};c.prototype._GET_SYNC=function(a,b){var e=ca({type:"GET",url:a,data:b,cache:!1,timeout:12E3});return JSON.parse(e.data)};c.prototype.downloadRecipe=function(a,b,e){return this._GET(this.url+
"/cgi/downloadRecipe.json","rc="+a+"&st="+b,e)};c.prototype.uploadRecipe=function(a,b,e){return this._GET(this.url+"/cgi/uploadRecipe.json","rc="+a+"&st="+b,e)};c.prototype.setCurrentRecipe=function(a,b,e){var c=this.url+"/cgi/setCurrRecipe.json";a="rc="+a;null!==b&&void 0!==b&&(a+="&st="+b);return this._GET(c,a,e)};c.prototype.setRecipeSet=function(a,b,e){return this._GET(this.url+"/cgi/setRecipeSet.json","rc="+a+"&st="+b,e)};c.prototype.resetRecipe=function(a,b){return this._GET(this.url+"/cgi/resetRecipe.json",
"rc="+a,b)};c.prototype.getRecipeList=function(a){return this._GET(this.url+"/cgi/getRecipeList.json","",a).then(function(b){return"S_OK"==b.code?b.rc:null})};c.prototype.addRecipeDataSet=function(a,b,e,c,d){return this._GET(this.url+"/cgi/addRecipeDataSet.json","rc="+a+"&cp="+b+"&ns="+e+"&nt="+c,d)};c.prototype.delRecipeDataSet=function(a,b,e){return this._GET(this.url+"/cgi/delRecipeDataSet.json","rc="+a+"&s="+b,e)};c.prototype.dumpRecipeData=function(a,b,e,c,d,f,k,g){var m=this.url+"/cgi/dumpRecipe.json";
a="rc="+a+"&ds="+b+"&path="+encodeURIComponent(e)+"&fname="+encodeURIComponent(c)+"&dt="+f+"&ts="+k;void 0!=d&&(a+="&tname="+d);return this._GET(m,a,g)};c.prototype.restoreRecipeData=function(a,b,e,c,d,f,k,g,m){var n=this.url+"/cgi/restoreRecipe.json";a="rc="+a+"&st="+b+"&path="+encodeURIComponent(e)+"&fname="+encodeURIComponent(c)+"&rt="+g+"&matchname="+k+"&browse="+f;void 0!=d&&(a+="&tname="+d);return this._GET(n,a,m)};c.prototype.getRecipeSetList=function(a,b){return this._GET(this.url+"/cgi/getRecipeSets.json",
"rc="+a,b)};c.prototype._decodeRecipe=function(a){var b;a.p&&a.p.s&&a.p.s.el?b=new ya(a.p.s.el.id,a.p.s.el.n,a.p.s.el.v):a.p&&a.p.s?b=new sa(a.p.s.id,a.p.s.n,a.p.s.v):a.p&&(b=new la(a.p.id,a.p.n,a.p.status,a.p.slist,a.p.selset,a.p.lastset));return b};c.prototype.getRecipeParams=function(a,b,e){var c=this.url+"/cgi/getRecipeParams.json",d="";"all"==b&&(d="rc="+a+"&getid=true&getlastdwnset=true&getselset=true&getstatus=true&getsetlist=true");var f=this;return this._GET(c,d,e).then(function(b){if("S_OK"==
b.code)return f._decodeRecipe(b)})};c.prototype.setRecipeParam=function(a,b,e){return this._GET(this.url+"/cgi/setRecipeParam.json","rc="+a+"&v="+b,e)};c.prototype.setRecipeSetParam=function(a,b,e,c,d){return this._GET(this.url+"/cgi/setRecipeSetParam.json","rc="+a+"&s="+b+"&a="+e+"&v="+c,d)};c.prototype.setRecipeElemParam=function(a,b,e,c,d,f){return this._GET(this.url+"/cgi/setRecipeElemParam.json","rc="+a+"&s="+b+"&e="+e+"&a="+c+"&v="+d,f)};c.prototype._getRFlag=function(a){var b="";a=a.toLowerCase();
"name"==a?b+="&getname=true":"status"==a?b+="&getstatus=true":"value"==a&&(b+="&getvalue=true");return b};c.prototype.getRecipeParam=function(a,b,e){var c=this,d=this.url+"/cgi/getRecipeParams.json",f="&getid=true"+this._getRFlag(b);return e?(a=this._GET_SYNC(d,"rc="+a+f))&&"S_OK"==a.code?{v:this._decodeRecipe(a)[b]}:{err:a.code}:this._GET(d,"rc="+a+f,e).then(function(a){return a&&"S_OK"==a.code?{v:c._decodeRecipe(a)[b]}:{err:a.code}})};c.prototype.getRecipeSetParam=function(a,b,e,c){var d=this,f=
this.url+"/cgi/getRecipeSetsParams.json",k="&getid=true"+this._getRFlag(e);return c?(a=this._GET_SYNC(f,"rc="+a+"&st="+b+k))&&"S_OK"==a.code?{v:this._decodeRecipe(a)[e]}:{err:a.code}:this._GET(f,"rc="+a+"&st="+b+k,!1).then(function(b){return b&&"S_OK"==b.code?{v:d._decodeRecipe(b)[e]}:{err:b.code}})};c.prototype.getRecipeElemParam=function(a,b,e,c){var d=this.url+"/cgi/getRecipeSetsParams.json",f="&getid=true&getelems=true"+this._getRFlag(c);return(a=this._GET_SYNC(d,"rc="+a+"&st="+b+"&i="+e+f))&&
"S_OK"==a.code?{v:this._decodeRecipe(a)[c]}:{err:a.code}};c.prototype.changePwd=function(a,b,e,c){return this._GET(this.url+"/cgi/changePassword","username="+a+"&oldpswd="+b+"&newpswd="+e,c)};c.prototype.logOut=function(){this.loginStatus=!1;return x({type:"GET",url:this.url+"/cgi/logout",cache:!1})};c.prototype.getResource=function(a){return x({type:"GET",url:"../modules/resources/"+a,cache:!1})};c.prototype.getPrecachedPages=function(){var a=window.location.href.substring(0,window.location.href.lastIndexOf("/")+
1);return x({type:"GET",url:a+"precached.html",cache:!1}).then(function(b){var a=document.createElement("div");a.innerHTML=b;return a})};c.formatTagOperationRequest=function(a){var b=Array(a.length+1);b[0]="n="+a.length;return a.reduce(function(b,a,c){c+=1;b[c]="t"+c+"="+a.name;void 0!==a.arrayIndex&&(b[c]+="."+a.arrayIndex);a=a.params;for(var f in a)b[c]+="&"+f+c+"="+a[f];return b},b).join("&")};c.prototype.stepTags=function(a){a=c.formatTagOperationRequest(a);return x({type:"POST",url:this.url+
"/cgi/stepTags.json",data:a,timeout:3E4,async:!0}).then(function(b){return null!=b?JSON.parse(b):null})};c.prototype.stepTagsSync=function(a){a=c.formatTagOperationRequest(a);a=ca({type:"POST",url:this.url+"/cgi/stepTags.json",data:a});return a.data?JSON.parse(a.data):null};c.prototype.setBitTags=function(a){a=c.formatTagOperationRequest(a);return x({type:"POST",url:this.url+"/cgi/setBitTags.json",data:a,timeout:3E4,async:!0}).then(function(b){return null!=b?JSON.parse(b):null})};c.prototype.setBitTagsSync=
function(a){a=c.formatTagOperationRequest(a);a=ca({type:"POST",url:this.url+"/cgi/setBitTags.json",data:a});return a.data?JSON.parse(a.data):null};c.prototype.resetBitTags=function(a){a=c.formatTagOperationRequest(a);return x({type:"POST",url:this.url+"/cgi/resetBitTags.json",data:a,timeout:3E4,async:!0}).then(function(b){return null!=b?JSON.parse(b):null})};c.prototype.resetBitTagsSync=function(a){a=c.formatTagOperationRequest(a);a=ca({type:"POST",url:this.url+"/cgi/resetBitTags.json",data:a});return a.data?
JSON.parse(a.data):null};c.prototype.toggleBitTags=function(a){a=c.formatTagOperationRequest(a);return x({type:"POST",url:this.url+"/cgi/toggleBitTags.json",data:a,timeout:3E4,async:!0}).then(function(b){return null!=b?JSON.parse(b):null})};c.prototype.toggleBitTagsSync=function(a){a=c.formatTagOperationRequest(a);a=ca({type:"POST",url:this.url+"/cgi/toggleBitTags.json",data:a});return a.data?JSON.parse(a.data):null};c.prototype.getClientID=function(){return x({type:"GET",url:this.url+"/cgi/getClientID.json"}).then(function(a){return null!=
a?JSON.parse(a):null})};c.prototype.writeMessage=function(a){var b=this.url+"/cgi/writeMessage";a="messageData="+encodeURIComponent(JSON.stringify(a));return x({type:"POST",url:b,data:a,timeout:3E4,async:!0}).then(function(b){return b})};c.prototype.readData=function(a){var b=this.url+"/cgi/ReadData.json";a="variables="+encodeURIComponent(JSON.stringify(a));return x({type:"POST",url:b,data:a,timeout:3E4,async:!0}).then(function(b){return b})};c.prototype.readAllTimer=function(){return x({type:"GET",
url:this.url+"/cgi/readalltimer.json",timeout:3E4,async:!0}).then(function(a){return JSON.parse(a)})};c.prototype.getNetworkInterfaces=function(){return x({type:"GET",url:this.url+"/cgi/SIOCTL?cmd=477",timeout:3E4,async:!0}).then(function(a){a=a.split("\n")[1];a=atob(a);a=a.substring(a.indexOf("{"),a.lastIndexOf("}")+1);return JSON.parse(a)})};c.prototype.subscribeNotification=function(a,b){return null};c.prototype.unsubscribeNotification=function(a,b){};c.prototype.subscribeAlarms=function(a,b){return null};
c.prototype.subscribeEvent=function(a,b){return null};c.prototype.unsubscribeEvent=function(a){};c.prototype.subscribeGroups=function(a,b){return null};c.prototype.unsubscribeGroups=function(a){};c.prototype.subscribeTags=function(a,b){return null};c.prototype.unsubscribeTags=function(a){};c.prototype.subscribeRecipe=function(a,b){return null};c.prototype.subscribeRecipeSetList=function(a,b){return null};c.prototype.subscribeRecipeSet=function(a,b,e){return null};c.prototype.subscribeRecipeSetElem=
function(a,b,e,c){return null};c.prototype.isSessionAlive=function(){return null};c.prototype.getConnectionStatus=function(){return null};c.prototype.onConnectionReady=function(a){};c.prototype.enableOption=function(a){};c.prototype.subscribeTrend=function(a,b){return null};c.prototype.unsubscribeTrend=function(a,b){return null};c.prototype.readSubTrends=function(a,b,e,c,d,f,k,g){};c.prototype.updateTrendSubscription=function(a){};c.prototype.unsubscribeRecipeSetList=function(a){};c.prototype.unsubscribeRecipe=
function(a){};c.prototype.unsubscribeRecipeSet=function(a,b){};c.prototype.unsubscribeRecipeSetElem=function(a,b,e){};c.prototype.setRecipeNotificationRate=function(a){};c.prototype.subscribeToMessageEvent=function(a){return!1};c.prototype.unsubscribeFromMessageEvent=function(){};return c}(),Vc=function(c){function a(b){var e=c.call(this,b)||this;e.resetSubscriptions=function(){this.resetTagsSubscriptions();this.resetGroupsSubscriptions();this.resetAlarmsSubscriptions()};e._sendMessage=function(b){0==
this.connSatus?this.rQueue.push(b):this.sseWorker.postMessage(b)};e.updateTrendSubscription=function(b){this.ttObj.id=b.wgtId;this.ttObj.start=b.getStartTime();this.ttObj.end=b.getStopTime();this.ttObj.trendName=b.getTrendName();this.ttObj.maxSamp=b.getMaxSamplesNum();this.ttObj.delta=b.getDeltaTime();this.ttObj.duration=b.getPageDuration();this._sendMessage(this.ttObj)};e.clientId=null;e.maxSize=1024;e.minPeriod=1E3;e.communicationWorker=null;e.tagsCallbacks={};e.recipeCb={};e.trendCb={};e.ttObj=
{c:a.WORKER_MSG_CODE.UPTRENDDATA,id:"",start:0,end:0,trendName:"",maxSamp:0,delta:0,duration:0};if(-1!=b[b.active].status){var h=e.projectName.split("/");e.currPrjName=h[h.length-1];e.projectPath=h.slice(0,h.length-1).join("/");e.lastConnStatus=1;e.event={};e.clientId=(new Date).getTime()+""+Math.floor(1E3*Math.random());e.sseRoute=e.url+"/cgi/sse";e.minPeriod=e.SSEInterface.pollRate;e.conf.exception.ipad1=-1!=navigator.userAgent.indexOf("AppleWebKit/534")&&-1!=navigator.userAgent.indexOf("Safari")&&
-1!=navigator.userAgent.indexOf("iPad;")&&-1!=navigator.userAgent.indexOf("Mac OS X")&&-1!=navigator.userAgent.indexOf("7534");var h=e.pathName.split("/"),d=void 0,d="web"==h[h.length-2]?"js/comWorker.min.js":"../js/comWorker.min.js";e.sseWorker=window.MSInputMethodContext&&document.documentMode?new PseudoWorker(d):new Worker(d);e.communicationWorker=e.sseWorker;e.RESTWorker=null;e.rQueue=[];e.connReadyQueue=[];e.connSatus=0;e.workerInit=!1;e.bIsWorkerReady=!1;e.subscriptions={notifications:{},tags:{},
groups:{},alarms:{},msg:{}};e.sseWorker.addEventListener("message",function(c){var h;c=c.data;if("ready"==c.e)if(e.bIsWorkerReady||(e.addTagListener(),e.addAlarmsListener(),e.addEventBufferListener(),e.addRecipeListener(),e.addTrendListener(),e.addSubTrendsListener(),e.addMessageEventListener(),e.RESTWorker=new Kc(e.sseWorker)),e.sseWorker.postMessage({c:a.WORKER_MSG_CODE.START,headers:{"X-CSRF-TOKEN":null===(h=window.localStorage)||void 0===h?void 0:h.getItem("csrf")}}),e.conf.ssemode=c.data.mode,
e.keepConnectionAlive(),e.bIsWorkerReady=!0,1==e.connSatus)e.resetSubscriptions();else{e.connSatus=1;h=0;for(c=e.rQueue.length;h<c;h++)e._sendMessage(e.rQueue[h]);h=0;for(c=e.connReadyQueue.length;h<c;h++)e.connReadyQueue[h]()}else"bootstrap"==c.e&&(e.sseWorker.postMessage({c:a.WORKER_MSG_CODE.INIT,url:e.url,pollRate:e.minPeriod,ttl:e.ttl,maxBandwidth:b.maxBandwidth,connectionMode:b.connectionMode}),e.workerInit=!0)})}return e}p(a,c);a.prototype.systemReadyForData=function(){null!==this.communicationWorker&&
this.workerInit&&this.communicationWorker.postMessage({c:a.WORKER_MSG_CODE.GETDATA})};a.prototype.onConnectionReady=function(b){"function"==typeof b&&this.connReadyQueue.push(b)};a.prototype.getConnectionStatus=function(){return this.connSatus};a.prototype.resetTagsSubscriptions=function(){var b=this.subscriptions.tags,e;for(e in b)b=e.split(";"),0<b.length&&this._sendMessage({c:a.WORKER_MSG_CODE.SBSTAGS,tags:b})};a.prototype.resetGroupsSubscriptions=function(){var b=this.subscriptions.groups,e=[],
c;for(c in b)e.push(c);this._sendMessage({c:a.WORKER_MSG_CODE.SBSGROUP,groups:e})};a.prototype.resetAlarmsSubscriptions=function(){var b=this.subscriptions.alarms,e;for(e in b)this._sendMessage({c:a.WORKER_MSG_CODE.SBSALARMS,alarms:e})};a.prototype.addTagListener=function(){var b=this.subscriptions.tags,a=this.subscriptions.groups,c=this.subscriptions.notifications;this.sseWorker.addEventListener("message",function(d){d=d.data;if("tags"==d.e){for(var f in c)if("function"==typeof c[f])c[f](d.data);
for(f in b)if("function"==typeof b[f])b[f](d.data);for(f in a)if("function"==typeof a[f])a[f](d.data)}})};a.prototype.addAlarmsListener=function(){var b=this,a=this.subscriptions.alarms;this.sseWorker.addEventListener("message",function(c){c=c.data;if("alarms"==c.e){c=b.decodeAlarms(c.data);for(var d in a)a[d](c)}})};a.prototype.addTrendListener=function(){var b=this;this.sseWorker.addEventListener("message",function(a){a=a.data;if("trend"==a.e&&"function"==typeof b.trendCb[a.id])b.trendCb[a.id](a.id,
a.data)})};a.prototype.addSubTrendsListener=function(){var b=this;this.sseWorker.addEventListener("message",function(a){a=a.data;if("subTrends"==a.e){for(var c=a.data,d=0;d<c.length;d++)c[d].n=c[d].n.split(".")[1];if("function"==typeof b.trendCb[a.id])b.trendCb[a.id](a.id,c)}})};a.prototype.addRecipeListener=function(){var b=this;this.sseWorker.addEventListener("message",function(e){e=e.data;if("recipe"==e.e){e=JSON.parse(e.data);var c=e.data,d=!1,f;if(c.p&&c.p.s&&c.p.s.el)f=new ya(c.p.s.el.id,c.p.s.el.n,
c.p.s.el.v);else if(c.p&&c.p.s)f=new sa(c.p.s.id,c.p.s.n,c.p.s.v);else if(c.p)f=new la(c.p.id,c.p.n,c.p.status,c.p.slist,c.p.selset,c.p.lastset,c.p.rclist),d=c.p.c;else return;d&&b.recipeCb.curRecipe.cb("curRecipe",f);for(var k in b.recipeCb)if("function"==typeof b.recipeCb[k].cb&&e.id==k){switch(b.recipeCb[k].type){case a.RCP_CB_TYPE.RC:b.recipeCb[k].cb(k+".Name",f);b.recipeCb[k].cb(k+".Status",f);break;case a.RCP_CB_TYPE.RC_LST:b.recipeCb[k].cb(k,f);break;case a.RCP_CB_TYPE.RC_SET:case a.RCP_CB_TYPE.RC_EL:b.recipeCb[k].cb(k+
".Name",f),b.recipeCb[k].cb(k+".Value",f)}break}}})};a.prototype.addMessageEventListener=function(){var b=this;this.sseWorker.addEventListener("message",function(a){a=a.data;var c=b.subscriptions.msg;"msgs"==a.e&&null!=c&&c(a.data)})};a.prototype.keepConnectionAlive=function(){var b,e=this;this.sseWorker.postMessage({c:a.WORKER_MSG_CODE.ALIVE,headers:{"X-CSRF-TOKEN":null===(b=window.localStorage)||void 0===b?void 0:b.getItem("csrf")}});this.bIsWorkerReady||this.sseWorker.addEventListener("message",
function(b){b=b.data;"connection"==b.e&&(e.lastConnStatus=b.data.status,b.data.prjName&&(e.currPrjName=b.data.prjName))});this.startPolling()};a.prototype.startPolling=function(){var b=this;clearInterval(this.timer);this.timer=setInterval(function(){var e;b.sseWorker.postMessage({c:a.WORKER_MSG_CODE.ALIVE,headers:{"X-CSRF-TOKEN":null===(e=window.localStorage)||void 0===e?void 0:e.getItem("csrf")}})},this.ttl)};a.prototype.stopPolling=function(){clearInterval(this.timer)};a.prototype.decodeTags=function(b){for(var a=
t.getModule("Tag"),c=[],d=0,f=b.length;d<f;d++){var k=b[d];c.push(new a(k.n,-1,k.v.v,"S_OK",k.v.q,k.v.ts))}return c};a.prototype.decodeAlarms=function(b){for(var a=[],c=t.getModule("Alarm"),d=0,f=b.length;d<f;d++){var k=b[d];a.push(new c(k.n,k.v.st,k.v.v1,k.v.dtt,k.v.dt,k.v.tm,"S_OK",k.v.d))}return a};a.prototype.subscribeTags=function(b,e){var c=b.join(";");this.subscriptions.tags[c]=e;0<b.length&&this._sendMessage({c:a.WORKER_MSG_CODE.SBSTAGS,tags:b});return c};a.prototype.unsubscribeTags=function(b){var e=
b.join(";");this.subscriptions.tags[e]&&delete this.subscriptions.tags[e];0<b.length&&this._sendMessage({c:a.WORKER_MSG_CODE.USBSTAGS,tags:b})};a.prototype.subscribeNotification=function(b,a){var c;if("tags"==b){var d=this.subscriptions.notifications;do c=(new Date).getTime();while(d[c]);d[c]=a}return c};a.prototype.unsubscribeNotification=function(b,a){"tags"==b&&delete this.subscriptions.notifications[a]};a.prototype.subscribeGroups=function(b,e){if(0==b.length)return["-1"];for(var c=this.subscriptions.groups,
d=0,f=b.length;d<f;d++)e&&"function"==typeof e[d]?c[b[d]]=e[d]:null===e&&(c[b[d]]=null);this._sendMessage({c:a.WORKER_MSG_CODE.SBSGROUP,groups:b,callbacks:e});return b};a.prototype.unsubscribeGroups=function(b){if(null!=b&&0!=b.length){for(var e=this.subscriptions.groups,c=0,d=b.length;c<d;c++)delete e[b[c]];this._sendMessage({c:a.WORKER_MSG_CODE.USBSGROUP,groups:b})}};a.prototype.subscribeAlarms=function(b,e){this.subscriptions.alarms[b]=e;this._sendMessage({c:a.WORKER_MSG_CODE.SBSALARMS,alarms:b});
return b};a.prototype.subscribeEvent=function(b,e){var c=b.getId();this.event[c]||(this.event[c]=[]);this.event[c].push({ref:b.getBufferId(),cb:e});this.sseWorker.postMessage({c:a.WORKER_MSG_CODE.ADDEVTBUFFLST,id:c,request:b.toURL()});return c};a.prototype.addEventBufferListener=function(){var b=this,a=t.getModule("IDALEvent");this.sseWorker.addEventListener("message",function(c){if("events"==c.data.e){c=JSON.parse(c.data.data);var d=c.data,f=[];if("S_NODATA"!=d.st)for(var d=d.data,k=0,g=d.length;k<
g;k++){var m=d[k];f.push(new a(m.t,m.s,m.at,m.ts,m.v))}for(var n in b.event)if(n==c.id)for(k=0,g=b.event[n].length;k<g;k++)b.event[n][k].cb(f)}})};a.prototype.unsubscribeEvent=function(b){var e=b.getId();if(this.event[e]){this.sseWorker.postMessage({c:a.WORKER_MSG_CODE.RMEVTBUFFLST,id:e});for(var c=0,d=this.event[e].length;c<d;c++)if(this.event[e][c].ref==b.getBufferId()){this.event[e].splice(c,1);break}0==this.event[e].length&&delete this.event[e]}};a.prototype.subscribeToMessageEvent=function(b){this.subscriptions.msg=
b;this._sendMessage({c:a.WORKER_MSG_CODE.SBSMSGEVT});return!0};a.prototype.unsubscribeFromMessageEvent=function(){this._sendMessage({c:a.WORKER_MSG_CODE.USBSMSGEVT})};a.prototype.isSessionAlive=function(){return{status:this.lastConnStatus,projectName:this.projectPath+"/"+this.currPrjName}};a.prototype.enableOption=function(b){"ipad1fix"==b&&this.sseWorker.postMessage({c:a.WORKER_MSG_CODE.RSTSSE})};a.prototype.setRecipeNotificationRate=function(b){this._sendMessage({c:a.WORKER_MSG_CODE.RCPRATE,r:b})};
a.prototype.subscribeRecipe=function(b,e){if(!this.recipeCb[b])return this.recipeCb[b]={cb:e,type:a.RCP_CB_TYPE.RC},this._sendMessage({c:a.WORKER_MSG_CODE.SBSRCP,en:!0,rc:b}),b};a.prototype.subscribeRecipeSetList=function(b,e){var c=b+".RecipeSetList";if(this.recipeCb[c])return null;this.recipeCb[c]={cb:e,type:a.RCP_CB_TYPE.RC_LST};this._sendMessage({c:a.WORKER_MSG_CODE.SBSRCPLST,en:!0,rc:b});return c};a.prototype.subscribeRecipeSet=function(b,e,c){var d=b+"."+e;if(this.recipeCb[d])return null;this.recipeCb[d]=
{cb:c,type:a.RCP_CB_TYPE.RC_SET};this._sendMessage({c:a.WORKER_MSG_CODE.SBSRCPSET,en:!0,rc:b,st:e});return d};a.prototype.subscribeRecipeSetElem=function(b,e,c,d){var f=b+"."+e+"."+c;if(this.recipeCb[f])return null;this.recipeCb[f]={cb:d,type:a.RCP_CB_TYPE.RC_EL};this._sendMessage({c:a.WORKER_MSG_CODE.SBSRCPSETEL,en:!0,rc:b,set:e,el:c});return f};a.prototype.unsubscribeRecipe=function(b){this._sendMessage({c:a.WORKER_MSG_CODE.SBSRCP,en:!1,rc:b});delete this.recipeCb[b];return b};a.prototype.unsubscribeRecipeSetList=
function(b){this._sendMessage({c:a.WORKER_MSG_CODE.SBSRCPLST,en:!1,rc:b});delete this.recipeCb[b+".RecipeSetList"];return b};a.prototype.unsubscribeRecipeSet=function(b,e){var c=b+"."+e;this._sendMessage({c:a.WORKER_MSG_CODE.SBSRCPSET,en:!1,rc:b,st:e});delete this.recipeCb[c];return c};a.prototype.unsubscribeRecipeSetElem=function(b,e,c){var d=b+"."+e+"."+c;this._sendMessage({c:a.WORKER_MSG_CODE.SBSRCPSETEL,en:!1,rc:b,set:e,el:c});delete this.recipeCb[d];return d};a.prototype.subscribeTrend=function(b,
e){if(this.trendCb[b.wgtId])return!1;this.trendCb[b.wgtId]=e;this._sendMessage({c:a.WORKER_MSG_CODE.SBSTRENDDATA,id:b.wgtId,start:b.getStartTime(),end:b.getStopTime(),trendName:b.getTrendName(),maxSamp:b.getMaxSamplesNum(),delta:b.getDeltaTime(),duration:b.getPageDuration()});return b.wgtId};a.prototype.unsubscribeTrend=function(b,e){this._sendMessage({c:a.WORKER_MSG_CODE.USBSTRENDDATA,id:b.wgtId});delete this.trendCb[b.wgtId];return b.wgtId};a.prototype.readSubTrends=function(b,e,c,d,f,k,g,m){this.trendCb[b]=
m;this._sendMessage({c:a.WORKER_MSG_CODE.READSUBTRENDS,id:b,start:e,end:c,trendName:d,maxSamp:f,delta:k,bounds:g});return b};a.prototype._readTagsJsonAsynch=function(b,e){return this.RESTWorker?this.RESTWorker.postMessage({id:0,c:a.WORKER_MSG_CODE.READTAG,tagName:b,index:e}).then(function(b){var a=new H;null!=b&&(b=JSON.parse(b).tgs[0],a.setState(b.quality,b.value,b.type,b.code,b.ts));return a})["catch"](function(b){b=new H;b.setMessageCode(y.status.E_TIMEOUT);return b}):c.prototype._readTagsJsonAsynch.call(this,
b,e)};a.prototype.writeTag=function(b,e,h,d){e=e!==e?"nan":e==Number.POSITIVE_INFINITY?"inf":e==Number.NEGATIVE_INFINITY?"-inf":e;return!this.RESTWorker||d?c.prototype.writeTag.call(this,b,e,h,d):this.RESTWorker.postMessage({id:0,c:a.WORKER_MSG_CODE.WRITETAG,name:b.name,index:b.index,value:e,sync:d}).then(function(b){if(null!=b)try{var a=JSON.parse(b),e={};a&&(e=JSON.parse(b).tgs[0]);h.setState(e);return a}catch(c){return null}else return null})};a.prototype.stepTags=function(b){return this.RESTWorker?
this.RESTWorker.postMessage({id:0,c:a.WORKER_MSG_CODE.STEPTAG,params:b}).then(function(b){try{return JSON.parse(b)}catch(a){return null}}):c.prototype.stepTags.call(this,b)};a.prototype.toggleBitTags=function(b){return this.RESTWorker?this.RESTWorker.postMessage({id:0,c:a.WORKER_MSG_CODE.TOGGLEBIT,params:b}).then(function(b){try{return JSON.parse(b)}catch(a){return null}}):c.prototype.toggleBitTags.call(this,b)};a.prototype.setBitTags=function(b){return this.RESTWorker?this.RESTWorker.postMessage({id:0,
c:a.WORKER_MSG_CODE.SETBIT,params:b}).then(function(b){try{return JSON.parse(b)}catch(a){return null}}):c.prototype.setBitTags.call(this,b)};a.prototype.resetBitTags=function(b){return this.RESTWorker?this.RESTWorker.postMessage({id:0,c:a.WORKER_MSG_CODE.RESETBIT,params:b}).then(function(b){try{return JSON.parse(b)}catch(a){return null}}):c.prototype.resetBitTags.call(this,b)};a.prototype.getTime=function(b){return!this.RESTWorker||b?c.prototype.getTime.call(this,b):this.RESTWorker.postMessage({id:0,
c:a.WORKER_MSG_CODE.GETTIME})};a.prototype.getPrecachedPages=function(){if(this.RESTWorker){var b=window.location.href.substring(0,window.location.href.lastIndexOf("/")+1)+"precached.html";return this.RESTWorker.postMessage({id:23,c:a.WORKER_MSG_CODE.GETPRECACHE,url:b}).then(function(b){if(null!=b){var a=document.createElement("div");a.innerHTML=b;return a}return null})}return c.prototype.getPrecachedPages.call(this)};a.prototype.writeMessage=function(b){return this.RESTWorker?this.RESTWorker.postMessage({id:0,
c:a.WORKER_MSG_CODE.WRITEMESSAGE,msgData:b}).then(function(b){return b}):c.prototype.writeMessage.call(this,b)};a.prototype.readData=function(b){return this.RESTWorker?this.RESTWorker.postMessage({id:0,c:a.WORKER_MSG_CODE.READDATA,variables:b}).then(function(b){return b}):c.prototype.readData.call(this,b)};a.prototype.readAllTimer=function(){return this.RESTWorker?this.RESTWorker.postMessage({id:0,c:a.WORKER_MSG_CODE.READALLTIMER}).then(function(b){return JSON.parse(b)}):c.prototype.readAllTimer.call(this)};
a.prototype.getNetworkInterfaces=function(){return this.RESTWorker?this.RESTWorker.postMessage({id:0,c:a.WORKER_MSG_CODE.GETNETINTERFACES}).then(function(b){b=b.split("\n")[1];b=atob(b);b=b.substring(b.indexOf("{"),b.lastIndexOf("}")+1);return JSON.parse(b)}):c.prototype.getNetworkInterfaces.call(this)};a.WORKER_MSG_CODE={INIT:0,START:1,SBSGROUP:2,USBSGROUP:3,GETDATA:4,SBSALARMS:5,ADDEVTBUFFLST:6,RMEVTBUFFLST:7,SBSTAGS:8,ALIVE:9,RSTSSE:10,SBSRCP:11,SBSRCPSET:12,SBSRCPSETEL:13,SBSRCPLST:14,RCPRATE:15,
SBSTRENDDATA:16,UPTRENDDATA:17,USBSTRENDDATA:18,USBSTAGS:19,READTAG:20,WRITETAG:21,GETTIME:22,GETPRECACHE:23,STEPTAG:24,TOGGLEBIT:25,SETBIT:26,RESETBIT:27,READSUBTRENDS:28,WRITEMESSAGE:29,READDATA:30,SBSMSGEVT:31,USBSMSGEVT:32,READALLTIMER:33,GETNETINTERFACES:34};a.RCP_CB_TYPE={RC:0,RC_LST:1,RC_SET:2,RC_EL:3};return a}(jc);Kc.prototype.postMessage=function(c){var a=this.idSeed++;c.id=a;var b=this;return new Promise(function(e,h){b.rejects[a]=h;b.resolves[a]=e;b.worker.postMessage(c)})};var g=function(c){return new g.fn.instantiate(c)};
g.activeProject=null;g.projectInterface=null;g.currentPage=null;g.prevPage=null;g.prevPageID=null;g.pagesBlock="hmi-pages-container";g.dlgsBlock="hmi-dlgs-container";g.pageNavigationOptions={pageToLeave:null,pageToLoad:null};g.isProjectReady=!1;g.fristPageLoaded=!1;g.isChangingPage=!1;g.EVENTS={PAGE:{BEFORE_CHANGE:"hmibeforechange",CONTENT_LOAD:"hmicontentload",PAGE_CHANGE:"hmichange",AFTER_CHANGE:"hmiafterchange",ERROR_LOADING:"hmiloadingerror"}};g.globalMouse=!1;g.mode=0;g.cache=new qa;g.wgts=null;
g.mapId={};g.isInited=!1;g.inActivity={timer:null,interval:6E5,callback:null};g.serverInterface=null;g.xforms={};g.initPageLogic=!1;g.renderingQueue={};g.globaID=0;g.debugMode=!1;g.defs={};g.cwJS={};g.urlParameters={usr:"",g:"",ot:""};g.dataLinkSeed=0;g.modules=t;g.keyboardType="normal";g.browserUserAgent=window.navigator.userAgent;g.browserWindow={width:window.innerWidth,height:window.innerHeight};g.browserOptimizations={nativeRenderLoop:!0,forceLayers:!0};g.initServerInterface=function(c){g.isTestModeActive()||
(g.serverInterface=(new Hc).createServer(c))};g.fps=10;g.then=Date.now();g.interval=1E3/g.fps;g.renderingStatus=0;g.rQueueLen=0;g.timerData=null;g.enablePjctWidgetServerReq=!0;g.umTemplates=["changepassword"];g.testModeActive=!1;g.Tag=Ma;g.Quality=za;g.ServerJMobile=jc;g.activateTestMode=function(){this.testModeActive=!0};g.disableTestMode=function(){this.testModeActive=!1};g.toggleTestMode=function(){this.testModeActive=!this.testModeActive};g.isTestModeActive=function(){return this.testModeActive};
g.setCurrentPage=function(c){this.currentPage=this};g.setProjectReady=function(){this.isProjectReady=!0};g.isFristPageLoaded=function(){return this.fristPageLoaded};g.setFristPageLoaded=function(){this.fristPageLoaded=!0};g.getWidgets=function(){return this.wgts};g.setUserAgent=function(c){this.testModeActive&&(g.browserUserAgent=c)};g.getUserAgent=function(){return this.browserUserAgent};g.getBrowserWindowSize=function(){return{width:g.browserWindow.width,height:g.browserWindow.height}};g.setBrowserWindowSize=
function(c,a){g.browserWindow.width=c;g.browserWindow.height=a};g.render=function(){var c=g.renderingQueue,a;for(a in c){var b=c[a];1==b.v&&(b.w.render(),b.v=0,0<g.rQueueLen&&g.rQueueLen--)}1>g.rQueueLen&&g.disableRendering()};g.getData=function(){g.isTestModeActive()||g.activeProject.srv.systemReadyForData()};g.disableData=function(){clearTimeout(g.timerData);g.timerData=null};g.renderingCycle=function(c){g.render();g.actionMgr.doActions();0<g.rQueueLen?g.globaID=requestAnimationFrame(g.renderingCycle):
g.renderingStatus=0};g.clearRenderingQueue=function(){this.renderingQueue={}};g.renderingCycleFixed=function(c){g.now=Date.now();g.delta=g.now-g.then;g.delta>g.interval&&(g.then=g.now,g.render(),g.actionMgr.doActions());0<g.rQueueLen?g.globaID=requestAnimationFrame(g.renderingCycleFixed):g.renderingStatus=0};g.addToRender=function(c){if(0!=c.enableRendering){var a=g.renderingQueue[c.wgtId];void 0===a?(g.renderingQueue[c.wgtId]={w:c,v:1},g.rQueueLen++):(null==a.w.elem&&null!=c.elem&&(a.w=c),0==a.v&&
(a.v=1,g.rQueueLen++));0===g.renderingStatus&&g.enableRendering()}};g.removeFromRender=function(c){g.renderingQueue[c.wgtId]&&(delete g.renderingQueue[c.wgtId],0<g.rQueueLen&&g.rQueueLen--)};g.getRenderingQueue=function(){return g.renderingQueue};g.clearRenderingQueue=function(){g.renderingQueue={};g.rQueueLen=0;g.disableRendering()};g.enableRendering=function(){0===g.renderingStatus&&(g.renderingStatus=1,g.globaID=requestAnimationFrame(g.browserOptimizations.nativeRenderLoop?g.renderingCycle:g.renderingCycleFixed))};
g.disableRendering=function(){g.renderingStatus=0;window.cancelAnimationFrame(g.globaID)};g.init=function(c){0==g.mode?(!1===this.isInited&&(this.mouseMgr.init(),this.mouseMgr.enableMouse(),this.globalMouse=!0,document.documentElement.style.webkitTapHighlightColor="rgba( 0,0,0,0 )",document.documentElement.style.webkitTouchCallout="none",document.documentElement.style.webkitUserSelect="none",this.isInited=!0),$(window).error(function(a){g.showErrorMessage("Unkown","General","<br>"+a.originalEvent.message+
"<br>url: "+a.originalEvent.filename+"<br>line: "+a.originalEvent.lineno+"<br>line: "+a.originalEvent.lineNumber+"<br>stack: "+a.originalEvent.stack)})):(this.mouseMgr.init(c),this.mouseMgr.enableMouse(),this.globalMouse=!1,this.isInited=!0)};g.getWidget=function(c,a){var b=null;null!==this.getFocusPage()&&null!==this.getActivePage()&&(b=this.getFocusPage().getWidget(c,a),null===b&&null!==this.getActivePage()&&this.getFocusPage().wgtId!==this.getActivePage().wgtId&&(b=this.getActivePage().getWidget(c,
a)));null===b&&null!==g.activeProject&&(b=g.activeProject.getWidget(c,a));a&&(c=this.mapId[c]);null===b&&this.wgts&&(b=this.wgts[c]);return b};g.addWidget=function(c,a){a&&a.wgtPage?a.wgtPage.addWidget(c,a):(null===this.wgts&&(this.wgts={}),this.wgts[c]=a);this.mapId[a.studioId]=c};g.setActivePage=function(c){var a;this.activeProject&&(a=this.activeProject.getPageMgr())&&a.setActivePage(c)};g.getActivePage=function(){var c;return this.activeProject&&(c=this.activeProject.getPageMgr())?c.getActivePage():
g.enablePjctWidgetServerReq?this.activeProject:g.changePasswordPage};g.getInputManager=function(){return this.mouseMgr};g.setFocusPage=function(c){var a;if(this.activeProject&&(a=this.activeProject.getPageMgr())){var b=g.getFocusPage();a.setFocusPage(c,function(){if(b.wgtId!=c.wgtId)c.onFocus()})}0==g.enablePjctWidgetServerReq&&(g.changePasswordPage=c)};g.getFocusPage=function(){var c;return this.activeProject&&(c=this.activeProject.getPageMgr())?c.getFocusPage():g.enablePjctWidgetServerReq?this.activeProject:
g.changePasswordPage};g.getPage=function(c){return this.wgts[c]};g.getActiveProject=function(){return this.activeProject};g.startInActivityTimer=function(c,a){0<c&&(this.inActivity.callback=a,this.inActivity.interval=c,this.inActivity.timer=setTimeout(a,c))};g.resetInActivityTimer=function(){this.inActivity.timer&&(clearTimeout(this.inActivity.timer),this.inActivity.timer=setTimeout(this.inActivity.callback,this.inActivity.interval))};g.initWidgetEngine=function(c,a,b){if(g.enablePjctWidgetServerReq){var e=
g.getPageInitFunction("_ProjectPage")(),h=e.getWidget("_UserGroupMgr",!0);e.initSSENotificationHandler();a&&h.setClientID(a.cID);var d=null;null!=c&&(h.isUMTemplate(c)?d=c:(a=e.getPageMgr(),d=a.getWebPage(c.toLowerCase()),!d&&a.hasWebPage(c)&&(d=c)));this.isCoreWidgetsReady().then(function(){e.loadHomePage(d,b)})}else this.initOfflineUMPage()};g.initOfflineUMPage=function(){var c=new eb({wgtId:"chPrj0"},g.urlParameters.pname,{prefix:"p0",projectName:g.urlParameters.ppath,timeout:6E5,pollRate:100,
maxBandwidth:0,modernBrowser:!0,optimizations:{nativeRenderCycle:!0,forceLayers:!0},connectionMode:null,hT:2E3,aRT:250,webSysIconDelay:0}),a=new Zb({wgtId:"chWgt0"},"_UserGroupMgr",{},c,c);new fb({wgtId:"chWgt1"},"_TagMgr",{},c,c);new kc({wgtId:"p0_wgt1"},"_PageMgr",{},c,c);new Pb({wgtId:"p0_wgt2"},"_IndexedTagSetMgr",{},c,c);null!=g.urlParameters.usr&&a.setCurrentUser(g.urlParameters.usr);c=c.getNode("container");a={prevPage:null,errorMessage:null,activePage:"changepassword",toPage:"changepassword"};
g.evtMgr.trigger(c,"hmichange",a);g.evtMgr.trigger(c,"hmiafterchange",a)};g.scrubId=function(c){var a=c;0==c.indexOf("#")&&(a=c.substring(1,c.length));return a};g.wgtPagePos=function(c){var a=0,b=0;do a+=c.offsetLeft,b+=c.offsetTop,c=c.offsetParent;while(c&&"BODY"!=c.nodeName);return{left:a,top:b}};g.addWidgetDefinition=function(c,a){this.defs[c]=a};g.getWidgetDefinition=function(c){return this.defs[c]};g.addAction=function(c,a){this.actionMgr.addActionDefinition(c,a)};g.getAction=function(c){return this.actionMgr.getActionInstance(c)};
g.doAction=function(c,a,b){var e=this.actionMgr.enActionType.NORMAL;"undefined"!=typeof a.t&&(e=a.t);var h=a.c,d=a.p;if(null!=h){var f="";e==this.actionMgr.enActionType.JS?(f=this.actionMgr.getActionInstance("hmiActionJS"))&&this.actionMgr.execute(f,d,c,h,b):this.actionMgr.execute(a,d,c,h)}};g.createDataLink=function(c,a,b){c=new $b(this.dataLinkSeed,c,a,b);this.dataLinkSeed++;return c};g.addPagePrefixId=function(c){this.getActivePage()&&(c=this.getActivePage()+"_"+c);return c};g.fn=g.prototype={constructor:g,
widget:function(){return this.hmiWgt},hmiAttachAlias:function(c,a,b){this.hmiWgt.dataLinks&&(c=this.hmiWgt.getDatalink(c))&&g.hmiAttach(g.getWidget(a),c.dataSrcId,{tag:c.tag,rw:c.rw,attr:b})},hmiSubscribeGroup:function(c,a){g.getActiveProject().getWidget("_TagMgr",!0).subscribeGroup(c,a)}};g.hmiAttach=function(c,a,b,e){if(null!=b){var h;if(void 0==c||c instanceof HTMLElement)return null;h=null;0==b.wT?h=this.activeProject.getWidget(a):-1==b.wT?(h=this.getWidget(a),null==h&&1==e&&(h=c.parentPage.getWidget(a))):
(h=c.getGraphicModule(),h="*"==a.charAt(0)&&null!=h?h.getWidget(a.replace("*.",h.wgtId+".")):c.parentPage.getWidget(a));return this.createAndMountDataLink(c,h,b,e)}return null};g.createAndMountDataLink=function(c,a,b,e){var h=!1;b.xforms&&1==b.xforms.length&&(h="FormulaXForm"==b.xforms[0].className);return(a||h)&&c?(c=this.createDataLink(c,a,b),1!==e&&c.update(),c.mount(),c):null};g.hmiSubscribeGroup=function(c,a,b){var e=g.activeProject;if(e){var h=e.getTagMgr(),d=1!==b;h?h.subscribeGroup(c,a,d):
e.getTagMgrInstance().then(function(b){b.subscribeGroup(c,a,d)})}};g._calculateOffsetMargin=function(c,a){var b={left:0,top:0},e;if(c.css("margin")){if(e=c.css("margin-left"))b.left=parseFloat(e.split("px")[0]);if(e=c.css("margin-top"))b.top=parseFloat(e.split("px")[0])}else{if(0==a.top&&c[0].parentNode==c[0].offsetParent)b.top=c[0].offsetTop;else if(e=c.css("margin-top"))b.top=parseFloat(e.split("px")[0]);if(0==a.left&&c[0].parentNode==c[0].offsetParent)b.left=c[0].offsetLeft;else if(e=c.css("margin-left"))b.left=
parseFloat(e.split("px")[0])}return b};g._getPointInWidgetCoordinateSystem=function(c,a,b){if(!c)return null;var e=[],h={chain:[],offset:[],pos:[]},d=null,f=c,k=g.computeGroupsScrollOffset(c,a,b);a+=k.x;b+=k.y;if(c&&!c.initInvMtxChain){do d=f,e.push(d),f=d.getParentWgt();while(!d.isRoot())}k=b;if(c.initInvMtxChain)for(b=0;b<c.invMtxChain.length;b++)e=c.wgtPos[b],f=c.wgtOffset[b],a-=e.left+f.left,k-=e.top+f.top,d=c.invMtxChain[b],k=Xa(d,[[a],[k],[1]]),a=k[0][0],k=k[1][0];else{for(b=e.length-1;0<=b;b--){var d=
e[b],q=e[b].getTransformMatrix(),m=d.left,n=d.top,f={},f="TableGroupWgt"==d.getJMType()&&c.isInHeader?{left:d.getOffsetLeft(),top:0}:{left:d.getOffsetLeft(),top:d.getOffsetTop()};a-=m+f.left;var k=k-(n+f.top),d=q[0][0],z=q[1][0],l=q[0][1],O=q[1][1],p=q[0][2],q=q[1][2],r=d*O-z*l,d=[[O/r,-l/r,(l*q-O*p)/r],[-z/r,d/r,-(d*q-z*p)/r],[0,0,1]],k=Xa(d,[[a],[k],[1]]);a=k[0][0];k=k[1][0];h.chain.push(d);h.offset.push(f);h.pos.push({left:m,top:n})}c.saveInvMtxChain(h)}return{x:a,y:k}};g.computeGroupsScrollOffset=
function(c,a,b){if(!c)return null;var e,h=c;b=a=0;e=!0;do{if(e=h){if("unknown"==e.getJMType()){e=!1;continue}"GroupWgt"!=e.getJMType()&&"TableGroupWgt"!=e.getJMType()||!e.hasGridLayout()||(h=e.getScrollbarOffsets(),a+=h.left,c.isInHeader||(b+=h.top))}h=e.parentWidget;e=!(e instanceof R)}while(e);return{x:a,y:b}};g.isPointInsideWidget=function(c,a,b){var e=c.elem.style.width.split("px")[0],h=c.elem.style.height.split("px")[0];return(c=this._getPointInWidgetCoordinateSystem(c,a,b))&&0<=c.x&&c.x<=e&&
0<=c.y&&c.y<=h?!0:!1};g.isPointInsideBoundingRect=function(c,a,b){if(!c)return!1;a-=window.pageXOffset;b-=window.pageYOffset;c=c.getBoundingClientRect();return a>=c.left&&a<=c.left+c.width&&b>=c.top&&b<=c.top+c.height};g.updateTagsCache=function(c,a){return this.cache.updateTag(c,a)};g.getTagFromCache=function(c){return this.cache.getTag(c)};g.clearCache=function(){this.cache.clearTags()};g.cloneCache=function(){return this.cache.clone()};g.getDialog=function(c){return g.getActiveProject()&&g.getActiveProject().isActiveDialog(c)?
this.getWidget(c):null};g.showErrorMessage=function(c,a,b){var e=g.activeProject;if(!e||e.isDebugMode()){var h="<p>Source:"+c+"</p><p>Type:"+a+"</p><p>Details:"+b+"</p>";g.getAction("hmiActionShowMessage").execute(null,{msg:h,format:"html"},1)}e&&e.getValue("webDebugLogs")&&e.jmLog("Source: "+c+" Type: "+a+" Details: "+b)};g.showMessage=function(c,a){var b="<p style='font-weight: bold;'>"+c+"</p><br>"+a;g.getAction("hmiActionShowMessage").execute(null,{msg:b,format:"html"},0);(b=g.activeProject)&&
b.getValue("webDebugLogs")&&b.jmLog(c+a)};g.isCoreWidgetsReady=function(){var c=this.activeProject,a=[c.getWidget("_AlarmsMgr",!0).waitWgtReady(),c.getWidget("_TagMgr",!0).waitWgtReady(),c.getWidget("_UserGroupMgr",!0).waitWgtReady(),c.getWidget("_IndexedTagSetMgr",!0).waitWgtReady(),c.waitWgtReady().then(function(){return c.getCWidgetMgr()?c.getCWidgetMgr().waitWgtReady():Promise.resolve()})];return Promise.all(a)};g.notifyWarning=function(c,a){var b=c+" : "+a;g.getAction("hmiActionShowMessage").execute(null,
{msg:b},3);(b=g.activeProject)&&b.getValue("webDebugLogs")&&b.jmLog(c+a)};g.getServerInterface=function(){return this.serverInterface};g.getEventMgr=function(){return this.evtMgr};g.getServerConf=function(){var c=window.location.href.substring(0,window.location.href.lastIndexOf("/web/")+5);return x({type:"GET",url:c+"config/server.json",cache:!1,notimestamp:!0}).then(function(a){return a?JSON.parse(a):{}},function(a){return{active:"offline",offline:{pollRate:"0",status:-1}}})};g.pagesAllocator={};
g.addPageInitFunction=function(c,a){g.pagesAllocator[c]=a};g.getPageInitFunction=function(c){return g.pagesAllocator[c]};g.removePageInitFunction=function(c){g.pagesAllocator[c]=null};g.addPagesScript=function(c){g.scripts=c};g.getPagesScript=function(){return g.scripts};g.getProjectInterface=function(){return g.projectInterface};g.setProjectInterface=function(c){g.projectInterface=c};g.registerPlugin=function(c,a){this.plugins||(this.plugins={});this.plugins[c]=a(this)};g.plugin=function(c){return this.plugins[c]};
g.addJSModule=g.export=function(c,a){this.modules.addModule(c,a)};g.getJSModule=g.import=function(c){return this.modules.getModule(c)};g.getKeyboardLayer=function(){return g.getFocusPage()};g.setDefaultAlert=function(c){this.defaulAlterAction=c};(g.fn.instantiate=function(c){void 0!=c&&(c.wgtId?(this.wgtId=c.wgtId,this.hmiWgt=c):(this.wgtId=g.scrubId(c),this.hmiWgt=g.getWidget(this.wgtId)),this.hmiElem=null)}).prototype=g.fn;window.hmiMgr=window.$hmi=g;g.attachPageEvents=function(){var c;c=this.activeProject?
this.activeProject.getNode("container"):document.getElementById("jm-container");$(c);var a=this;this.evtMgr.on(c,"hmibeforechange",function(b){if(g.getActivePage()&&g.getActivePage().wgtId==g.pageNavigationOptions.pageToLeave){for(var e=document.getElementsByClassName("jm-bad");0<e.length;)b=e.item(0),b.parentNode.removeChild(b);for(e=document.getElementsByClassName("hmi-access-denied");0<e.length;)b=e.item(0),b.parentNode.removeChild(b);g.activeProject.unsubscribeDynamicTags();g.getActivePage();
g.getActivePage().unload();a.evtMgr.trigger(g.getActivePage().elem,"unloadWgt")}});this.evtMgr.on(c,"hmicontentload",function(b){b=b.detail.activePage;""!=b&&(b=g.getNextPageId(g.pageNavigationOptions.pageToLoad?g.pageNavigationOptions.pageToLoad:b),null==document.querySelector("link[rel='stylesheet'][href='"+b+".css']")&&$("head").append($("<link rel='stylesheet' href='"+b+".css'>")))});this.evtMgr.on(c,"hmipageremoved",function(b){b=b.detail;b.removedPage&&$('link[rel=stylesheet][href="../css/pages/_'+
b.removedPage+'.css"]').remove()});this.evtMgr.on(c,"hmichange",function(b){b=b.detail;var e=b.prevPage;e&&e!=b.toPage&&(g.prevPageID=e);b.prevPage&&g.getActivePage().hide();e=document.getElementById("kpd");null!=e&&e.parentNode.removeChild(e);g.initPageLogic=!0;var e=b.activePage,c="_"+e;b.cachedPage?(b=g.getPage(e),g.setActivePage(b),g.setFocusPage(b),b.setCached(!0)):(b=g.getPageInitFunction(c)(),b.setCached(!1),b.bindCWJSClass(),g.activeProject.subscribeDynamicTags());b.show();a.evtMgr.trigger(b.elem,
"loadWgt");g.activeProject.hideLoadingPage();g.initPageLogic=!1});this.evtMgr.on(c,"hmiafterchange",function(b){b=b.detail;g.activeProject&&g.activeProject.srv&&0==g.activeProject.srv.getOptions().ssemode&&g.activeProject.srv.getOptions().exception.ipad1&&g.activeProject.srv.enableOption("ipda1fix");var a=g.getPage(b.activePage);g.activeProject.isProjectReady()?a.load():g.enablePjctWidgetServerReq?g.isCoreWidgetsReady().then(function(){a.load()}):a.load();setTimeout(function(){g.enablePjctWidgetServerReq&&
requestAnimationFrame(function(){g.activeProject.showSpinner(!1);g.isFristPageLoaded()||(g.setFristPageLoaded(),g.getActiveProject().getPageMgr().loadPrecache().then(function(){g.getActiveProject().triggerEvent("precacheend")}))})},0)})};g.loadLoginPage=function(){g.getFocusPage()&&$(g.getFocusPage().elem).trigger("pagestop");location.href="/public/login.html?_="+(new Date).getTime()};g.getNextPageId=function(c){var a=g.activeProject.getWidget("_UserGroupMgr",!0);c instanceof Array&&(c=c[0]);a&&a.isUMTemplate(c)?
(c=c.split("/"),c=c[c.length-1],a="../css/umtemplates/"):a="../css/pages/";return a+"_"+c};var p=this&&this.__extends||function(){var c=function(a,b){c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return c(a,b)};return function(a,b){function e(){this.constructor=a}c(a,b);a.prototype=null===b?Object.create(b):(e.prototype=b.prototype,new e)}}(),Qb;(function(c){c[c.LOCAL=0]="LOCAL";c[c.REMOTE=1]="REMOTE"})(Qb||
(Qb={}));var gb;(function(c){c[c.READY=0]="READY";c[c.CONFIRM=1]="CONFIRM";c[c.HEART=2]="HEART";c[c.BEAT=3]="BEAT";c[c.LOG=4]="LOG"})(gb||(gb={}));var le=function(){function c(a){void 0===a&&(this.mode=Qb.LOCAL);this.queue=[];this.idxMsg=0;this.mode=a;this.remote={address:"",port:"",socket:null,id:null};this.connectionReady=!1}c.prototype.log=function(a){switch(this.mode){case Qb.LOCAL:this.localLog(a);break;case Qb.REMOTE:this.remtoteLog(a)}};c.prototype.setMode=function(a){this.mode=a};c.prototype.getMode=
function(){return this.mode};c.prototype.getAddress=function(){return this.remote.address};c.prototype.getPort=function(){return this.remote.port};c.prototype.localLog=function(a){console.log(a)};c.prototype.remtoteLog=function(a){this.connectionReady?this.sendMessage({code:gb.LOG,id:this.remote.id,payload:a}):20>this.idxMsg&&(this.queue.push(a),this.idxMsg++)};c.prototype.setConnectionParameters=function(a,b){this.remote.address=a;this.remote.port=b};c.prototype.openConnection=function(){var a=this;
if(""!=this.remote.address&&""!=this.remote.port)try{var b=this.remote.socket=new WebSocket("ws://"+this.remote.address+":"+this.remote.port,"jm-console");b.addEventListener("open",function(){return a.handleConnectionOpen()});b.addEventListener("message",function(b){return a.handleMessage(b)});b.addEventListener("close",function(){a.handleConnectionClose()})}catch(e){window.setTimeout(function(){return a.openConnection()},1E3)}};c.prototype.handleConnectionOpen=function(){};c.prototype.handleMessage=
function(a){a=JSON.parse(a.data);switch(a.code){case gb.READY:this.sendConfirm(a),this.connectionReady=!0,this.flushQueue()}};c.prototype.sendMessage=function(a){var b=this.remote.socket;b&&1==b.readyState&&b.send(JSON.stringify(a))};c.prototype.sendConfirm=function(a){this.remote.id=a.id;this.sendMessage({code:gb.CONFIRM,id:this.remote.id,payload:""})};c.prototype.flushQueue=function(){if(0<this.queue.length){for(var a=0,b=this.queue;a<b.length;a++)this.sendMessage({code:gb.LOG,id:this.remote.id,
payload:b[a]});this.queue=[];this.idxMsg=0}};c.prototype.handleConnectionClose=function(){this.connectionReady=!1;this.openConnection()};return c}();t.addModule("JMVirtualConsole",le);var ta=null,Wc={},Vb=function(){function c(){}c.setFragment=function(a){ta=a};c.setGeometries=function(a){Wc=a};c.getFragment=function(){return ta};c.getGeometries=function(){return Wc};c.changeFragmentIds=function(a,b){var e=null;b&&(e=ta.id);ta.id+=null==a?"":"."+a;for(var c=ta.querySelectorAll(".jm-wgt, .jm-hmi-col, canvas"),
d=0,f=c.length;d<f;d++){var k=c[d];k.id=b?k.id.replace(e,null==a?e:e+"."+a):k.id+(null==a?"":"."+a)}};c.getFragmentById=function(a){return null==ta?null:ta.id==a?ta:ta.querySelector("#"+CSS.escape(a))};c.resetFragment=function(){ta=null};return c}();$.fn.onAvailable=function(c){var a=this.selector,b;0<this.length?c.call(this):b=setInterval(function(){0<$(a).length&&(c.call($(a)),clearInterval(b))},50)};g.changePage=function(c,a){var b=this;if(b.isChangingPage)return!1;b.isChangingPage=!0;b.render();
b.clearRenderingQueue();b.getInputManager().disableMouse();var e=b.getActiveProject(),h=e.getPageMgr(),d=h.getActivePage(),f=null,k=!1,q=g.EVENTS.PAGE,m={activePage:null,prevPage:null,toPage:null,errorMessage:null,cachedPage:!1},n=h.getPagesContainer(),z=h.getLastPageInDOM();if(d.getId()==e.getId())if(h.isDOMEmpty())if(e=c&&c.split("/"))m.activePage=e[e.length-1].split(".html")[0];else return b.getInputManager().enableMouse(),m.errorMessage="Cannot load page. Please verify your project configuration.",
b.evtMgr.trigger(n,q.BEFORE_CHANGE,m),!1;else m.activePage=z.getAttribute("id").substr(1),m.activePage==a.dst&&(z.setAttribute("data-url",c),k=!0);if(k)return b.evtMgr.trigger(n,q.BEFORE_CHANGE,m),b.evtMgr.trigger(n,q.CONTENT_LOAD,m),h.addLoadedPage(m.activePage),z=h.getLastPageInDOM(),null!=a.beautify&&a.beautify(z),b.evtMgr.trigger(n,q.PAGE_CHANGE,m),b.isChangingPage=!1,b.evtMgr.trigger(n,q.AFTER_CHANGE,m),b.getInputManager().enableMouse(),!0;if(b.getActivePage().getId()==a.dst)return b.isChangingPage=
!1,b.getInputManager().enableMouse(),!1;b.evtMgr.trigger(n,q.BEFORE_CHANGE,m);k=document.querySelector("div[data-url='"+c+"']");if(null!=k)m.activePage=k.getAttribute("id").substr(1),m.prevPage=d.getId(),m.toPage=m.activePage,m.cachedPage=!0,window.history.replaceState("state",document.title,c),b.evtMgr.trigger(n,q.CONTENT_LOAD,m),b.evtMgr.trigger(n,q.PAGE_CHANGE,m),b.isChangingPage=!1,b.evtMgr.trigger(n,q.AFTER_CHANGE,m),b.getInputManager().enableMouse();else if(h.isPageInFragment(a.dst))k=h.loadPageFromFragment(a.dst),
m.activePage=k.getAttribute("id").substr(1),m.prevPage=d.getId(),m.toPage=m.activePage,m.cachedPage=!0,window.history.replaceState("state",document.title,c),b.evtMgr.trigger(n,q.CONTENT_LOAD,m),a.src&&h.movePageToFragment(a.src),b.evtMgr.trigger(n,q.PAGE_CHANGE,m),b.isChangingPage=!1,b.evtMgr.trigger(n,q.AFTER_CHANGE,m),b.getInputManager().enableMouse();else x({type:"GET",url:c}).then(function(e){window.history.replaceState("state",document.title,c);b.evtMgr.trigger(n,q.CONTENT_LOAD,m);var k=document.createElement("div");
k.innerHTML=e;e=k.querySelector("div[data-role='page']");f=a.dst;for(var k=k.getElementsByTagName("script"),g,z,l=0,p=k.length;l<p;l++){var r=k[l].id;"hmi-page"===r?g=k[l].textContent:"hmi-init"===r&&(z=k[l].textContent)}e.setAttribute("data-url",c);null!=z&&eval(z);null!=a.beautify&&a.beautify(e);n.appendChild(e);null!=g&&eval(g);m.activePage=f;m.prevPage=d.getId();m.toPage=f;h.addLoadedPage(f);g=h.pagesGC(f,m);0!=g.length&&-1!=g.indexOf(m.prevPage)||h.movePageToFragment(m.prevPage);m.activePage=
f;m.prevPage=d.getId();m.toPage=f;b.evtMgr.trigger(n,q.PAGE_CHANGE,m);b.isChangingPage=!1;b.evtMgr.trigger(n,q.AFTER_CHANGE,m);b.getInputManager().enableMouse()})["catch"](function(){b.getInputManager().enableMouse();m.errorMessage="Cannot load page. Please verify your project configuration.";b.evtMgr.trigger(n,q.ERROR_LOADING,m)});return!0};$("#jm-container").on("hmiloadingerror",function(c){c.detail?Lc(c.detail.errorMessage):Lc("Error")});var lc=function(){function c(){this.dataLinks=null}c.prototype.addDataLink=
function(a){this.parentPage?this.parentPage.registerLink(a):this.registerLink&&this.registerLink(a);this.subscribeDataLink(a)};c.prototype.subscribeDataLink=function(a){void 0==this.dataLinks&&(this.dataLinks={});this.dataLinks[a.getId()]=a};c.prototype.removeDataLink=function(a){delete this.dataLinks[a.getId()]};c.prototype.registerLink=function(a){};c.prototype.getWidget=function(a,b,e){return null};c.prototype.setProperty=function(a,b){var e=t.getModule("Tag");this.setValue(a,b,e.QUALITY_GOOD)};
c.prototype.setValue=function(a,b,e,c,d){};c.prototype.getValue=function(a){return null};c.prototype.getId=function(){return""};c.prototype.destroy=function(){for(var a in this.dataLinks){var b=this.dataLinks[a];b.dataSrc.getId()!=this.getId()?b.dataSrc.removeDataLink(b):b.tgtWgt.getId()!=this.getId()&&b.tgtWgt.removeDataLink(b)}};c.prototype.unmountLinks=function(){for(var a in this.dataLinks)this.dataLinks[a].unmount()};c.prototype.mountLinks=function(){for(var a in this.dataLinks)this.dataLinks[a].mount(),
this.dataLinks[a].update()};return c}(),me=function(){function c(){this.enActionType={NORMAL:0,JS:1};this.defs={};this.queue=[];this.executionStatus=0}c.prototype.isActionAllowed=function(a,b,e){if(!this.umgr&&(this.umgr=g.activeProject.getWidget("_UserGroupMgr",!0),!this.umgr))return!0;var c;c=g.getFocusPage();c.getId()!=a&&((c=g.getFocusPage().getWidget(a))||(c=g.getWidget(a)));return(this.umgr.isSecurityEnabled()?this.umgr.getActionTreeAuthorizations(c,b+"Action",e.actID):this.umgr.getWidgetAuthorizationCodes().DEFAULT)==
this.umgr.getActionAuthorizationCodes().NOTALLOWED?!1:!0};c.prototype.execute=function(a,b,e,c,d){void 0===this.aggregator&&(this.aggregator=new (t.getModule("Aggregator")));this.isActionAllowed(e,c,b)&&this.aggregator.addActionToExecute(a,b,e,c,d);g.enableRendering()};c.prototype.doActions=function(){this.aggregator&&this.aggregator.doActions()};c.prototype.addActionDefinition=function(a,b){this.defs[a]=b};c.prototype.getActionDefinition=function(a){return this.defs[a]};c.prototype.getActionInstance=
function(a,b){return b?new this.defs[a](b.wgtId,b.event,b.options,b.parentPage,b.parentWidget):new this.defs[a]};c.prototype.notifyActionExecution=function(a,b){var e=t["import"]("ActionMessage"),c=a.getMsgEvtCode(),d=a.getParameters();c==e.EMessageEvent.eAction_dbQuery?(e=g.getWidget("_DBConnectorMgr",!0))&&e.executeDBQueryCb(b):this.execute(a,d.p,g.activeProject.wgtId,d.c,null)};return c}();g.actionMgr=new me;var ne=function(){function c(){this.startY=this.startX=0;this.isBrowserTouchCompatible=
this.oneTouch=!1;this.currentGestureArea=this.currentEventIdentifier=this.currentWgt=null;this.wgtPagePos={left:0,top:0};this.mouseDisable=this.holdIsFired=this.wgtIsMouseDown=!1;this.passthruTimer=null}c.prototype.init=function(a){var b=this;"ontouchstart"in window||window.hasOwnProperty("ontouchstart")||window.__proto__.ontouchstart||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints?(this.bindTouchEvents(a),this.isBrowserTouchCompatible=!0):this.bindMouseEvents(a);a=/firefox/i.test(navigator.userAgent)?
"DOMMouseScroll":"mousewheel";document.addEventListener(a,function(a){b.doMouseScroll(a)});window.addEventListener("blur",function(){b.doMouseUp(null)},!1);window.addEventListener("focus",function(){b.doMouseUp(null)},!1)};c.prototype.disableMouse=function(){this.mouseDisable=!0};c.prototype.enableMouse=function(){this.mouseDisable=!1};c.prototype.isMouseEnabled=function(){return!this.mouseDisable};c.prototype.bindMouseEvents=function(a){var b=this;void 0===a&&(a=document);a.addEventListener("mousedown",
function(a){b.doMouseDown(a)});a.addEventListener("mouseup",function(a){b.doMouseUp(a)});a.addEventListener("mousemove",function(a){b.doMouseMove(a)})};c.prototype.bindTouchEvents=function(a){var b=this,e={passive:!1};void 0===a&&(a=document);a.addEventListener("touchstart",function(a){b.oneTouch=!0;b.doMouseDown(a)},e);a.addEventListener("mousedown",function(a){b.oneTouch||b.doMouseDown(a);b.oneTouch=!1},e);a.addEventListener("touchend",function(a){b.oneTouch=!0;b.doMouseUp(a)},e);a.addEventListener("mouseup",
function(a){b.oneTouch||b.doMouseUp(a);b.oneTouch=!1;b.doMouseUp(a)},e);a.addEventListener("touchcancel",function(a){b.doMouseUp(a)},e);a.addEventListener("touchmove",function(a){b.doMouseMove(a)},e);a.addEventListener("mousemove",function(a){b.doMouseMove(a)},e)};c.prototype.getTargetOfParentWidget=function(a){for(a=a.parentElement;a;){if(null!=a.getAttribute("data-widget"))return a;a=a.parentElement}return null};c.prototype.identifyWhoCatchTheEvent=function(a,b,e,c,d,f){if(null==a&&null==c||d&&
d==a)return null;d=f&&a.getId()===f.getId();var k=null!=a?a.events:null;if(k&&(k.mousedown||k.touchstart)&&!d)return a;d=!1;null!=a?c=a.parentWidget:d=!0;if(null!=c&&void 0!==c.getChildrendNumber)for(var q=c.getChildrendNumber()-1;0<=q;q--){var m=c.getChild(q);if(d){if(g.isPointInsideBoundingRect(m.elem,b,e)){if("GroupWgt"==m.getJMType()&&(k=m.getChild(m.getChildrendNumber()-1),k=this.identifyWhoCatchTheEvent(k,b,e,null,m,f)))return k;k=m?m.events:null;f&&(m.getId(),f.getId());if(k&&(k.mousedown||
k.touchstart)&&g.isPointInsideWidget(m,b,e))return m}}else m==a&&(d=!0)}return null==a?null:this.identifyWhoCatchTheEvent(a.parentWidget,b,e,null,void 0,f)};c.prototype.checkPageFocus=function(a){var b,e;if(a.composedPath){a=a.composedPath();for(var c in a){var d=a[c],f="dialog-header"==(null===(b=d.dataset)||void 0===b?void 0:b.role);if(d instanceof HTMLElement){var k=d.getAttribute("data-widget");if("PageWgt"==k||"DialogWgt"==k||f){b=f?null===(e=d.dataset)||void 0===e?void 0:e.ref:d.getAttribute("id");
e=g.getWidget(b);b=g.activeProject.getActiveDialogsIds();c=e;a=!1;f=d=-1;for(k=b.length-1;0<=k;k--){var q=g.getWidget(b[k]);if(null!==q&&(q.wgtId==e.wgtId&&(d=k),q.isModal())){c=q;f=k;a=!0;break}}g.setFocusPage(a&&d<=f?c:e);break}}}}};c.prototype.doMouseDown=function(a){if(!this.mouseDisable&&a){this.holdIsFired=!1;var b=a.target,e=window.TouchEvent&&a instanceof TouchEvent?a.touches&&0<a.touches.length:!1;this.startY=e?a.touches[0].pageY:a.pageY?a.pageY:0;this.startX=e?a.touches[0].pageX:a.pageX?
a.pageX:0;this.checkPageFocus(a);if(this.currentWgt||null==b)this.currentWgt===this.currentGestureArea&&null!==this.currentGestureArea&&this.currentGestureArea.doMouseDown(null,a);else{var c=e=null;if(b!=document){var d=b.getAttribute("data-widget");void 0!==b.id&&null!=d?(e=g.getFocusPage().getWidget(b.id),null===e&&(b=this.getTargetOfParentWidget(b),null!=b&&(c=g.getFocusPage().getWidget(b.id)))):(b=this.getTargetOfParentWidget(b),null!=b&&(e=g.getFocusPage().getWidget(b.id)))}b=this.currentWgt=
this.identifyWhoCatchTheEvent(e,this.startX,this.startY,c,void 0,void 0);this.wgtIsMouseDown=!0;null!=b&&this.sendDoMouseDownEvent(b,a)}}};c.prototype.sendDoMouseDownEvent=function(a,b){var e=this,c;this.currentEventIdentifier=(c=window.TouchEvent&&b instanceof TouchEvent&&0<b.changedTouches.length?b.changedTouches[0]:b)&&void 0!==c.identifier?c.identifier:-1;"GestureAreaWgt"==a.getJMType()&&(this.currentGestureArea=this.currentWgt,this.currentGestureArea.isPassthruEnable()&&(this.passthruTimer=window.setTimeout(function(){e.currentGestureArea.enablePassthru();
e.currentWgt=e.identifyWhoCatchTheEvent(e.currentGestureArea,e.startX,e.startY,a.parentWidget,void 0,e.currentGestureArea);e.sendDoMouseDownEvent(e.currentWgt,b)},this.currentGestureArea.getPassthruTime())));b&&b.preventDefault&&a.isWgtEventsPreventDefault()&&"touchstart"!=b.type&&b.preventDefault();c=null;if(a.doMouseDown&&(c=this.wgtEventInfo(a,b),this.mouseInitX=c.x,this.mouseInitY=c.y,0==a.doMouseDown(c,b)))return;this.currentWgt!=this.currentGestureArea&&null!==this.currentGestureArea&&this.currentGestureArea.doMouseDown(null,
b);var d=a.getAutoRepeatMode(),f=a.getAutoRepeatPeriod();c=c||this.wgtEventInfo(a,b);var k=this.jsEventInfo(c);a.onMousePress&&this.doWidgetActions(a,"onMousePress",k);this.holdTimer=window.setTimeout(function(){e.holdIsFired=!0;a.onMouseHold&&(e.doWidgetActions(a,"onMouseHold",k),2==d&&a.onMouseHoldRepeat&&e.doMouseRepeat(a,d,f,k))},a.getHoldTime());1==d&&a.onMousePressRepeat&&(c=c||this.wgtEventInfo(a,b),k=k||this.jsEventInfo(c),this.doMouseRepeat(a,d,f,k))};c.prototype.doMouseRepeat=function(a,
b,e,c){var d=this;this.repeatTimer=window.setTimeout(function(){var f;1==b?f="onMousePressRepeat":2==b&&(f="onMouseHoldRepeat");d.doWidgetActions(a,f,c);d.doMouseRepeat(a,b,e,c)},e)};c.prototype.loseFocus=function(){clearTimeout(this.holdTimer);clearTimeout(this.repeatTimer);null!=this.currentWgt&&this.currentWgt.doMouseUp(null,null)};c.prototype.doWidgetActions=function(a,b,e){b=a[b];for(var c=0;c<b.length;c++)g.doAction(a.wgtId,b[c],e)};c.prototype.doMouseUp=function(a){if(!this.mouseDisable&&a){a&&
a.stopPropagation();this.wgtIsMouseDown=!1;clearTimeout(this.holdTimer);clearTimeout(this.repeatTimer);null!==this.passthruTimer&&(window.clearTimeout(this.passthruTimer),this.passthruTimer=null);var b;b=(b=window.TouchEvent&&a instanceof TouchEvent&&0<a.changedTouches.length?a.changedTouches[0]:a)&&void 0!==b.identifier?b.identifier:-1;if(null!=this.currentWgt&&b==this.currentEventIdentifier){b=this.currentWgt;this.currentWgt=null;var e=void 0,c=void 0;if(b.doMouseUp&&(e=this.wgtEventInfo(b,a),this.mouseInitY=
this.mouseInitX=0,0==b.doMouseUp(e,a)))return;this.currentWgt!=this.currentGestureArea&&null!==this.currentGestureArea&&this.currentGestureArea.doMouseUp(null,a);if(b.isClone){var d=this.wgtEventInfo(b.tableGroupWgt,a);b.tableGroupWgt.doMouseUp(d,a)}if(null!=b.onMouseClick||null!=b.onMouseRelease)e=e||this.wgtEventInfo(b,a),c=c||this.jsEventInfo(e);null==b.onMouseClick||this.holdIsFired||this.doWidgetActions(b,"onMouseClick",c);null!=b.onMouseRelease&&this.doWidgetActions(b,"onMouseRelease",c)}else null!=
this.currentGestureArea&&this.currentGestureArea.doMouseUp(null,a);null!=this.currentGestureArea&&this.currentGestureArea.disablePassthru();this.currentGestureArea=null;g.resetInActivityTimer();this.umgr||(this.umgr=g.activeProject.getWidget("_UserGroupMgr",!0));this.umgr&&this.umgr.resetTimer()}};c.prototype.doMouseMove=function(a){if(this.mouseDisable||!a)return!1;var b=this.currentWgt;if(null!=b){a&&a.preventDefault&&a.preventDefault();var e=void 0,e=void 0;if(b.doMouseMove&&(e=this.wgtEventInfo(b,
a),0==b.doMouseMove(e,a)))return!1;this.currentWgt!=this.currentGestureArea&&null!==this.currentGestureArea&&this.currentGestureArea.doMouseMove(null,a);if(b&&b.onMouseDrag){var c=b.onMouseDrag,e=this.wgtEventInfo(b,a),e=this.jsEventInfo(e);for(a=0;a<c.length;a++)g.doAction(b.wgtId,c[a],e)}}else null!==this.currentGestureArea&&this.currentGestureArea.doMouseMove(null,a);null!==this.passthruTimer&&this.currentGestureArea.isGestureDetected()&&(window.clearTimeout(this.passthruTimer),this.passthruTimer=
null);return!0};c.prototype.doMouseScroll=function(a){g.resetInActivityTimer();this.umgr||(this.umgr=g.activeProject.getWidget("_UserGroupMgr",!0));this.umgr&&this.umgr.resetTimer()};c.prototype.wgtEventInfo=function(a,b){var e=null,c=0,d=0;if(!a||!a.elem)return null;if(window.TouchEvent&&b instanceof TouchEvent)for(var f=0<b.touches.length?b.touches:b.changedTouches,k=0,q=f.length;k<q;k++){var d=f[k],c=d.pageX+document.body.scrollLeft+document.documentElement.scrollLeft,d=d.pageY+document.body.scrollTop+
document.documentElement.scrollTop,m=g._getPointInWidgetCoordinateSystem(a,c,d),n=m.x-this.mouseInitX,z=m.y-this.mouseInitY;0==k?e={wgt:a,isMouseDown:this.wgtIsMouseDown,pageX:c,pageY:d,x:m.x,y:m.y,deltaX:n,deltaY:z}:1==k&&(e.nxtPoints={x:m.x,y:m.y})}else c=b.pageX+document.body.scrollLeft+document.documentElement.scrollLeft,d=b.pageY+document.body.scrollTop+document.documentElement.scrollTop,m=g._getPointInWidgetCoordinateSystem(a,c,d),n=m.x-this.mouseInitX,z=m.y-this.mouseInitY,e={wgt:a,isMouseDown:this.wgtIsMouseDown,
pageX:c,pageY:d,x:m.x,y:m.y,deltaX:n,deltaY:z};return e};c.prototype.jsEventInfo=function(a){return{posX:Math.floor(a.x),posY:Math.floor(a.y),pagePosX:Math.floor(a.pageX),pagePosY:Math.floor(a.pageY),wheelDelta:null}};return c}();g.mouseMgr=new ne;var I;(function(c){c[c.NONE=0]="NONE";c[c.FITSIZE=1]="FITSIZE";c[c.FITPAGETOSCREENSIZE=2]="FITPAGETOSCREENSIZE"})(I||(I={}));var na;(function(c){c[c.NORMAL=0]="NORMAL";c[c.PRECACHE=1]="PRECACHE"})(na||(na={}));var R=function(c){function a(b,e,h,d){e=c.call(this,
b.wgtId,e,h,null,null)||this;e.visible=!1;e.setDefaultState();e.isCached=!1;e.invokablePropsList=["id","Id"];e.dialog=0;e.sFactor=0;e.callbacks={};e.loadMode=1===d?na.PRECACHE:na.NORMAL;e.currentPageColor=e.pageColor;e.constructor==a&&(g.setProjectReady(),g.setCurrentPage(e),(d=g.getActiveProject().getPageMgr())&&e.loadMode==na.NORMAL&&(g.setActivePage(e),d&&!d.isCurrentPageDefined()&&d.setCurrentPageFromName(e.wgtId)));e.project=g.getActiveProject();g.addWidget(b.wgtId,e);e.elem&&null!=e.project&&
2==e.project.getValue("bgColorOption")&&e.getId()==g.getActivePage().getId()&&(b=t.getModule("Quality"),e.project.setValue("color",e.currentPageColor,new b(192)));e.templateWebId&&(e.currentPageColor=e.templatePageColor,e.templatePagePrefix=e.templateWebId.split("_")[0]);e.cntMtx=[[1,0,0],[0,1,0],[0,0,1]];e.left=0;e.top=0;e.mtx||(e.mtx=[[1,0,0],[0,1,0],[0,0,1]]);0==g.mode&&e.constructor==a&&e.executeOnDemandFitToScreenSizeModality();e.elem&&e.loadFontsFace();g.activeProject&&(e.sysVars=g.activeProject.getWidget("_SysPropMgr",
!0));e.linksList={};e.initFocus();e._renderMask|=a._renderFlags.BGCOLOR;g.addToRender(e);return e}p(a,c);a.prototype.initFocus=function(){this.loadMode==na.NORMAL&&(g.setFocusPage(this),g.mouseMgr.loseFocus())};a.prototype.setDefaultState=function(){this.visible=void 0!==this.visible?this.visible:!1;this.fitCssTransform=void 0!==this.fitCssTransform?this.fitCssTransform:"";this.xPageOffset=void 0!==this.xPageOffset?this.xPageOffset:0;this.yPageOffset=void 0!==this.yPageOffset?this.yPageOffset:0;this.resizeTimer=
void 0!==this.resizeTimer?this.resizeTimer:null;this.templateWebId=void 0!==this.templateWebId?this.templateWebId:null;this.mlPage=void 0!==this.mlPage?this.mlPage:null;var b=this.project.getMultiLanguageMgr();this.exportedLang=void 0!==this.exportedLang?this.exportedLang:b&&b.getCurrentLanguage()};a.prototype.pageactivate=function(){var b=g.activeProject.getWidget("_IndexedTagSetMgr",!0);if(this.constructor==a&&(this.isCached&&(g.activeProject.getWidget("_TagMgr",!0).subscribePageGroups(g.getActivePage().wgtId),
this.executeOnDemandFitToScreenSizeModality()),"changepassword"==this.studioId.toLowerCase())){var e=g.activeProject.getWidget("_UserGroupMgr",!0);e.clearAll();e.checkMessages()}if(this.isCached){for(var c in this.linksList)this.linksList[c].update(),this.linksList[c].mount();this.project.subscribeDynamicTags()}this.execTemplateJS();this.execJS();this.tOnActivateActions();this.onActivateActions();b.loadIndexes()};a.prototype.load=function(){this.pageactivate()};a.prototype.pagedeactivate=function(){var b=
g.activeProject.getWidget("_IndexedTagSetMgr",!0);g.activeProject.getWidget("_TagMgr",!0).unsubscribePageGroups(this.wgtId);b&&b.unsubscribePageTags();g.activeProject.off("resize.page");this.tOnDeActivateActions();this.onDeActivateActions();this.executeActions();this.unmountDataLinks()};a.prototype.unload=function(){this.pagedeactivate()};a.prototype.registerLink=function(b){this.linksList&&!this.isCached&&(this.linksList[b.getId()]=b)};a.prototype.unregisterLink=function(b){this.linksList&&delete this.linksList[b.getId()]};
a.prototype.unmountDataLink=function(b){this.linksList[b.getId()].unmount()};a.prototype.unmountDataLinks=function(){for(var b in this.linksList)this.linksList[b].unmount()};a.prototype.destroy=function(){c.prototype.destroy.call(this);clearTimeout(this.resizeTimer);this.mlPage=this.mlTemplate=null;g.getWidgets()[this.wgtId]=null;this.project.removeGroupedButton(this.wgtId);this.linksList=null;return!0};a.prototype.render=function(){if(!c.prototype.render.call(this))return this._renderMask=0,!1;if(this._renderMask&
a._renderFlags.VISIBLE){var b=document.getElementById("_"+this.wgtId);this.visible?(Ta(b,"Transform",this.fitCssTransform),Ta(b,"TransformOrigin","0px 0px")):Ta(b,"Transform","translateZ(0)scale(0)")}if(this._renderMask&a._renderFlags.REDRAW){switch(this.fitsize){case I.FITPAGETOSCREENSIZE:this.executeFitPageToScreenSize();break;case I.FITSIZE:case I.NONE:this.executeFitToSize(),this.project.updateStatusBarPosition(this.yPageOffset)}this.forceRedraw=!1}this._renderMask&a._renderFlags.BGCOLOR&&this.elem&&
(b=g.activeProject.getUserGroupMgr(),this.templateStudioId&&(this.currentPageColor=b.isPageHidden(this.templateStudioId.toLowerCase())?this.pageColor:this.templatePageColor),this.elem.style.backgroundColor=this.currentPageColor);this._renderMask&a._renderFlags.APPLYFOCUS&&this.applyFocus();this._renderMask=0;return!0};a.prototype.onFocus=function(){this._renderMask|=a._renderFlags.APPLYFOCUS;g.addToRender(this)};a.prototype.applyFocus=function(){};a.prototype.executeOnDemandFitToScreenSizeModality=
function(){if(this.fitsize==I.FITSIZE||this.fitsize==I.FITPAGETOSCREENSIZE){var b=g.getBrowserWindowSize();this.adaptToBrowserViewport(b.width,b.height)}else this.sFactor=1,this._renderMask|=a._renderFlags.REDRAW,g.addToRender(this);this.bindResizeEvent();this.project.getValue("enableFitToScreenTransition")&&Ya(this.elem,"none")};a.prototype.executeFitToSize=function(){var b=document.getElementById("_"+this.wgtId),a=g.getBrowserWindowSize(),c=(a.width-this.width*this.sFactor)/2,a=(a.height-this.height*
this.sFactor)/2;.1>c&&(c=0);.1>a&&(a=0);this.xPageOffset=c;this.yPageOffset=a;this.fitCssTransform="translateY( "+a+"px ) translateX( "+c+"px ) scale( "+this.sFactor+" )";this.cntMtx[0][0]=this.cntMtx[1][1]=this.sFactor;this.cntMtx[0][2]=c;this.cntMtx[1][2]=a;null!=b&&(this.visible&&(ha(b,"left top"),ga(b,this.fitCssTransform)),b.style.position="absolute",b.style.left="0px",b.style.top="0px",this.executeGroupGridLayout())};a.prototype.executeFitPageToScreenSize=function(){var b=document.getElementById("_"+
this.wgtId);b.style.width=this.elem.style.width=this.width+"px";b.style.height=this.elem.style.height=this.height+"px";for(var a in this.wgts)if(b=this.wgts[a],b.elem&&b.parentWidget==this){var c=b.getParentBounds(this);b.setParentBounds(c.x*this.xScale,c.y*this.yScale,c.width*this.xScale,c.height*this.yScale,this)}};a.prototype.executeGroupGridLayout=function(){for(var b in this.wgts){var a=this.wgts[b];a.elem&&a.parentWidget==this&&a.hasGridLayout()&&a.executeGridLayout()}};a.prototype.bindResizeEvent=
function(){var b=this;this.forceRedraw=!1;this.invalidateMtxChain();g.activeProject.on("resize.page",function(a){clearTimeout(b.resizeTimer);b.resizeTimer=window.setTimeout(function(a,e){b.project.getValue("enableFitToScreenTransition")?Ya(b.elem,"0.3s"):Ya(b.elem,"none");b.adaptToBrowserViewport(a,e);b.invalidateMtxChain()},300,a.width,a.height)})};a.prototype.adaptToBrowserViewport=function(b,e){var c=this.getRatio(b,e);this.fitsize==I.FITSIZE?this.sFactor=Math.min(c.x,c.y):this.fitsize==I.FITPAGETOSCREENSIZE&&
(this.width=b,this.height=e,this.xScale=c.x,this.yScale=c.y);this.forceRedraw=!0;this._renderMask|=a._renderFlags.REDRAW;g.addToRender(this)};a.prototype.getRatio=function(b,a){return{x:0==this.width?0==b?1:b/1E-6:b/this.width,y:0==this.height?0==a?1:a/1E-6:a/this.height}};a.prototype.getScaleFactors=function(){var b={x:1,y:1};this.sFactor&&(b.x=b.y=this.sFactor);this.xScale&&this.yScale&&(b.x=this.xScale,b.y=this.yScale);return b};a.prototype.isFitToSizeEnable=function(){return this.fitsize==I.FITSIZE?
!0:!1};a.prototype.isFitPageToScreenSizeEnable=function(){return this.fitsize==I.FITPAGETOSCREENSIZE?!0:!1};a.prototype.loadFontsFace=function(){void 0!=this.fonts&&0<this.fonts.length&&g["import"]("_loadFontFace")(this.fonts)};a.prototype.onActivateActions=function(){if(this.onActivate)for(var b=this.onActivate,a=0;a<b.length;a++)g.doAction(this.wgtId,b[a])};a.prototype.tOnActivateActions=function(){if(this.tonActivate)for(var b=this.tonActivate,a=0;a<b.length;a++)g.doAction(this.wgtId,b[a])};a.prototype.executeActions=
function(){g.actionMgr.doActions()};a.prototype.onDeActivateActions=function(){if(this.onDeactivate)for(var b=this.onDeactivate,a=0;a<b.length;a++)g.doAction(this.wgtId,b[a])};a.prototype.tOnDeActivateActions=function(){if(this.tonDeactivate)for(var b=this.tonDeactivate,a=0;a<b.length;a++)g.doAction(this.wgtId,b[a])};a.prototype.setDialogElem=function(){this.dialog=(this.elem=document.getElementById(this.wgtId+"Dialog"))?1:0};a.prototype.getEventWidgets=function(){var b=[],a;for(a in this.wgts)"EventBufferWgt"==
this.wgts[a].getJMType()&&b.push(this.wgts[a]);return b};a.prototype.initialUpdate=function(){for(var b in this.wgts){var a=this.wgts[b].getDataLinks();if(a)for(var c in a){var d=a[c],f=d.dataSrc.getValue(d.tag);"object"!=typeof f&&0<=d.rw.indexOf("r")&&d.tgtWgt.setValue(d.attr,f,void 0)}}};a.prototype.bindCWCallbacks=function(){for(var b in this.callbacks){var a=this.callbacks[b],c=a.callbackString.indexOf(".");-1!=c&&"this"==a.callbackString.substring(0,c)&&(a.fn=a.wgt.findJSFunction(a.callbackString.substring(c+
1)))}};a.prototype.bindJSCallback=function(b){for(var e in this.callbacks){var c=this.callbacks[e];if(c.wgt.constructor==a||b==c.wgt.isTemplateWgt){var d=c.callbackString.indexOf(".");if(-1!=d)if("this"==c.callbackString.substring(0,d))c.fn=c.wgt.findJSFunction(c.callbackString.substring(d+1));else try{c.fn=this.__eval__(c.callbackString)}catch(f){}else try{c.fn=this.__eval__(c.callbackString)}catch(k){}}}};a.prototype.__eval__=function(b){};a.prototype.registerPageCallback=function(b,a,c){void 0===
c&&(c=!1);c=a&&0==b.indexOf("this.")?a.isClone?":"+a.protoWgtId+":"+b:":"+a.wgtId+":"+b:c||a.isTemplateWgt?this.templatePagePrefix+b:b;this.callbacks[c]||(this.callbacks[c]={callbackString:b,fn:null,wgt:a});return c};a.prototype.bindCWJSClass=function(){var b=g.getActiveProject().getCWidgetMgr();b&&b.bindCWLogicClass(this)};a.prototype.setValue=function(b,e,h,d){d=!1;if(null!=this.elem)switch(b){case "color":b="rgb(0,0,0)";isNaN(e)&&!this.isBadValue(e,!0,h)&&this.pageColor!=e&&(/^rgb\(\s*\d+,\s*\d+\s*,\s*\d+\s*\)$/.test(e)?
b=e:e&&0==e.indexOf("#")&&1<e.length&&8>=e.length&&(b=e));this.pageColor!=b&&(this.pageColor=b,this.currentPageColor=this.templateWebId?this.templatePageColor:b,2==this.project.getValue("bgColorOption")&&this.project.setValue("color",this.pageColor,h));break;case "visibility":case "visible":this.visible!=e&&(this.visible=e,this.getAuthorizations()===this.umgr.getWidgetAuthorizationCodes().HIDE&&(this.visible=!1),this._renderMask|=a._renderFlags.VISIBLE,this.forceRedraw&&(this._renderMask|=a._renderFlags.REDRAW),
d=!0);break;default:c.prototype.setValue.call(this,b,e,h)}d&&g.addToRender(this);return!0};a.prototype.getValue=function(b){return"backgroundColor"==b||"color"==b?this.pageColor:"id"==b||"Id"==b?this.studioId:l.prototype.getValue.call(this,b)};a.prototype.addWidget=function(b,a){c.prototype.addWidget.call(this,b,a);"PageMLTextMgrWgt"==a.getJMType()&&(a.isTemplateWgt?this.mlTemplate=a:this.mlPage=a)};a.prototype.getPageMLTextMgr=function(){return this.mlPage};a.prototype.getTemplateMLTextMgr=function(){return this.mlTemplate};
a.prototype.execTemplateJS=function(){if("undefined"!=typeof g.getPagesScript()&&this.templateWebId){var b=g.getPagesScript()[this.templateWebId];if(b)try{b()}catch(a){g.showErrorMessage(this.studioId,"Initialization",a.message)}}};a.prototype.execJS=function(){if(this.project.isProjectReady()){if("undefined"!=typeof g.getPagesScript()){var b=g.getPagesScript()[this.wgtId];if(b)try{b()}catch(a){g.showErrorMessage(this.studioId,"Initialization",a.message)}}}else{var c=this;setTimeout(function(){c.execJS()},
100)}};a.prototype.show=function(){this.setValue("visible",!0,null)};a.prototype.hide=function(){this.setValue("visible",!1,null)};a.prototype.setCached=function(b){this.isCached=b};a.prototype.getProject=function(){return this.project};a.prototype.getTransformMatrix=function(){return this.cntMtx};a.prototype.isPageCached=function(){return this.isCached};a.prototype.getPrefix=function(){return this.prefix};a.prototype.getTemplatePrefix=function(){return this.templatePagePrefix};a.prototype.getLoadingMode=
function(){return this.loadMode};a.prototype.isRoot=function(){return!0};a.prototype.getExportedLanguage=function(){return this.exportedLang};a.prototype.getWidgets=function(){return this.wgts};a.prototype.getCallbacks=function(){return this.callbacks};a.jmType="PageWgt";a._renderMask=0;a._renderFlags={VISIBLE:1,REDRAW:2,BGCOLOR:4,REDRAWDLG:8,UPDATEPOS:16,APPLYDLGPARAMS:32,APPLYDLGHDR:64,APPLYFITTOSCREENSIZE:128,APPLYFOCUS:256};return a}(l);Object.defineProperty(R.prototype,"backgroundColor",{get:function(){return this.elem?
this.getValue("color"):""},set:function(c){this.setValue("color",c,null,null)}});g.fn.hmiPage=function(c,a,b,e){return new R(this,c,a,e)};g.addWidgetDefinition("hmiPage",R);var Ba;(function(c){c[c.INIT_PRM=0]="INIT_PRM"})(Ba||(Ba={}));var mc=function(){function c(){this._prmWgtReady=null}c.prototype.resolveWgtReady=function(a){throw Ba.INIT_PRM;};c.prototype.rejectWgtReady=function(a){throw Ba.INIT_PRM;};c.prototype.initPromiseReady=function(){var a=this;this._prmWgtReady=new Promise(function(b,e){a.resolveWgtReady=
b;a.rejectWgtReady=e})};c.prototype.waitWgtReady=function(){if(this._prmWgtReady)return this._prmWgtReady;throw Ba.INIT_PRM;};return c}(),Ca;(function(c){c[c.NORMAL=0]="NORMAL";c[c.TEMPLATE=1]="TEMPLATE"})(Ca||(Ca={}));var Ua=function(c){function a(b){var a=c.call(this)||this;a.project=b;a.cwgts={};a.instancesMap={};a.HTMLTemplatePolyfillEnabled=HTMLTemplateElement.bootstrap instanceof Function;b=document.getElementById("hmi-templates");var h=!1;a.initPromiseReady();b&&(h=0!=b.childNodes.length);
if(g.isTestModeActive())a.resolveWgtReady(!0);else if(h)a.resolveWgtReady(!0);else a.project.getCommunticationObj().getResource("templates.xml").then(function(b){document.getElementById("hmi-templates").innerHTML=b;a.HTMLTemplatePolyfillEnabled&&HTMLTemplateElement.bootstrap(document);a.resolveWgtReady(!0)})["catch"](function(){a.resolveWgtReady(!1)});return a}p(a,c);a.prototype.setCWMap=function(b,a){null==this.instancesMap[b]&&(this.instancesMap[b]=a)};a.prototype.getCWMap=function(b){b=this.instancesMap[b];
return void 0!=b?b:null};a.prototype.freeCWInstances=function(b){delete this.instancesMap[b]};a.prototype.removeInstance=function(b,a){var c=this.instancesMap[b];if(!c)return!1;for(var c=c.p,d=null,f=0;f<c.length;f++)if(c[f].studioId==a){d=f;break}return null!==d?(c.splice(d,1),!0):!1};a.prototype.clearInstanceMap=function(){this.instancesMap={}};a.prototype.getAttributeLink=function(b,a){b=b.toLowerCase();return void 0!==this.cwgts[b]&&null!==this.cwgts[b].props?this.cwgts[b].props.attr[a]:[]};a.prototype.hasAttribute=
function(b,a){b=b.toLowerCase();return void 0!==this.cwgts[b]&&null!==this.cwgts[b].props};a.prototype.getParameters=function(b){b=b.toLowerCase();return void 0!==this.cwgts[b]&&null!==this.cwgts[b].props?this.cwgts[b].props.par:[]};a.prototype.isRegisteredModule=function(b){b=b.toLowerCase();return void 0!==this.cwgts[b]};a.prototype.hasGfxInheritance=function(b){b=b.toLowerCase();b=this.cwgts[b];return null!=b&&null!=b.conf&&null!=b.conf.w};a.prototype.findCustomWidget=function(b,a){var c=null,
d=null;void 0!=a&&(d=this.getCWMap(a));for(var f=b.querySelectorAll("[data-ctype]"),k=0,g=f.length;k<g;k++){var m=f[k],n=m.getAttribute("data-ctype"),z="1"==m.getAttribute("data-tmpl");this.isRegisteredModule(n)&&(null===c&&(c={p:[],t:[]}),m={webId:m.getAttribute("id"),studioId:m.getAttribute("data-sid"),moduleName:n},z?(c.t.push(m),null!=d&&d.t.push(m)):(c.p.push(m),null!=d&&d.p.push(m)))}return c};a.prototype.addModule=function(b){this.cwgts[b.name]=b};a.prototype.injectCWTemplates=function(b,a,
c){void 0===c&&(c=!1);var d=this.getCWMap(a),f=b.getAttribute("id")!=a;if(null==d||f||c){d=this.findCustomWidget(b,a);if(null==d)return;f||this.setCWMap(a,d)}this.injectCW(b,d.t,a,Ca.TEMPLATE);this.injectCW(b,d.p,a,Ca.NORMAL)};a.prototype.injectCW=function(b,a,c,d){if(void 0!==a)for(var f=0,k=a.length;f<k;f++){var g=a[f].webId,m=a[f].studioId,n=a[f].moduleName.toLowerCase(),z=this.cwgts[n];if(void 0!==z){null===z.template&&(z.template=document.getElementById(n));z=z.template;n=b.querySelector("#"+
CSS.escape(g));null!=z&&null!=n&&(z instanceof HTMLTemplateElement?n.appendChild(z.content.cloneNode(!0)):z instanceof DocumentFragment&&n.appendChild(z.cloneNode(!0)));for(var z=n.querySelectorAll(".jm-wgt, .jm-wgt>div, .jm-hmi-col, canvas"),l=0,O=z.length;l<O;l++){var p=z[l];if("*"===p.id.charAt(0)&&"."===p.id.charAt(1)){p.id=p.id.replace("*",g);var r=p.getAttribute("data-sid");null!=r&&p.setAttribute("data-sid",r.replace("*",m))}d==Ca.TEMPLATE&&p.setAttribute("data-tmpl","1")}this.injectCWTemplates(n,
c)}}};a.prototype.instantiateCW=function(b,a){var c;a=a.toLowerCase();var d=this.cwgts[a],f=this.project.getWidgetDefinitions(),k=this.project.getActionMgr(),q=(c={},c[a]=b,c);if(null!=d&&null!=d.conf&&null!=d.conf.w){b.setModule();d.conf.grid&&b.setGridLayout(d.conf.grid);c=d.conf.w;for(var m=g["import"]("deepClonePlainObject"),n=0,z=c.length;n<z;n++){var l=c[n],p=l.w.replace("*",b.wgtId),r=m(l.p),t=void 0,t=void 0!==l.s&&null!==l.s?l.s.replace("*",b.studioId):p,u=q[l.f.toLowerCase()];-1!=l.t.indexOf("hmiAction")?
(r.module=b,t=k.getActionDefinition(l.t),q[l.w]=new t({wgtId:p},l.e,r,this.project.getFocusPage(),u)):"hmiAttach"===l.t?(p=l.s,null!==p&&void 0!==p&&("*"==p&&(p=q[l.w].parentWidget.getId()),g.hmiAttach(q[l.w],p,r))):(r.isTemplateWgt=b.isTemplateWgt,r.module=b,b.isClone&&(r.isClone=b.isClone,r.protoWgtId=b.protoWgtId+"."+l.w.substring(2),r.tableGroupWgt=b.tableGroupWgt,r.ext=b.ext),"hmiCWMLTextMgr"==l.t&&d.tr&&this.applyMLPatch(r.texts,d.tr),void 0===u&&(u=b),q[l.w]=new f[l.t]({wgtId:p},t,r,this.project.getFocusPage(),
u))}this.subscribeAttributeLinks(d,b);k=f=void 0;Oc(b.mtx)?(f=b.width,k=b.height):(k=b._map(b.mtx,{x:b.width,y:b.height}),f=k.x,k=k.y);q=b.left;c=b.top;b.width=d.conf.br.width;b.height=d.conf.br.height;b.left=0;b.top=0;q==b.left&&b.top==c&&b.width==f&&b.height==k||b.setParentBounds(q,c,f,k,b.parentWidget)}};a.prototype.subscribeAttributeLinks=function(b,a){if(null!==b.props&&null!==b.props.attr)for(var c in b.props.attr){var d=b.props.attr[c];if(0<d.length)for(var f=0,k=d.length;f<k;f++){var g=d[f].lastIndexOf("."),
m=d[f].substring(0,g),g=a.getWidget(m,!0,a.isTemplateWgt);if(null==g){var n=m.replace(/[0-9]/g,""),m=parseInt(m.substring(n.length));isNaN(m)&&(m=1);var z=[];a.getWidgetsByJMClass(n,m,z);z.length==m&&(g=z[m-1])}null!=g&&g.subscribeWgt(a,function(b,a){return function(e,c){"mdup"==e&&b.sendUpdate(a,c.v,c.q)}}(a,c))}}};a.prototype.applyMLPatch=function(b,a){for(var c in a){var d=b[c],f=a[c],k;for(k in f)d[k]=f[k]}};a.prototype.bindJSClass=function(b){var a=this.cwgts[b.ctype.toLowerCase()];void 0!==
a&&null!=a.js&&a.js.call(b,b)};a.prototype.bindCWLogicClass=function(b,a){var c=this.getCWMap(a?a:"_"+b.wgtId);if(null!==c){for(var d=c.t,f=0,k=d.length;f<k;f++){var g=d[f];if(!this.hasGfxInheritance(g.moduleName)){var m=b.getWidget(g.webId);this.subscribeAttributeLinks(this.cwgts[m.ctype.toLowerCase()],m);this.bindJSClass(m)}}d=c.p;f=0;for(k=d.length;f<k;f++)g=d[f],m=b.getWidget(g.webId),this.hasGfxInheritance(g.moduleName)||this.subscribeAttributeLinks(this.cwgts[m.ctype.toLowerCase()],m),this.bindJSClass(m);
(0<c.t.length||0<c.p.length)&&b.bindCWCallbacks()}};return a}(mc),oe=function(){function c(){}c.trigger=function(a,b,e){b=new CustomEvent(b,{detail:e});null!=a&&a.dispatchEvent(b)};c.on=function(a,b,e){null!=a&&a.addEventListener(b,e)};c.off=function(a,b,e){null!=a&&a.removeEventListener(b,e)};return c}();g.evtMgr=oe;(function(c){c[c.EMPTY=-1]="EMPTY";c[c.BOOLEAN=0]="BOOLEAN";c[c.BYTE=1]="BYTE";c[c.SHORT=2]="SHORT";c[c.INT=3]="INT";c[c.UNSIGNEDBYTE=4]="UNSIGNEDBYTE";c[c.UNSIGNEDSHORT=5]="UNSIGNEDSHORT";
c[c.UNSIGNEDINT=6]="UNSIGNEDINT";c[c.FLOAT=7]="FLOAT";c[c.DOUBLE=8]="DOUBLE";c[c.STRING=9]="STRING";c[c.BINARY=10]="BINARY";c[c.TIME=11]="TIME";c[c.INT64=12]="INT64";c[c.UINT64=13]="UINT64";c[c.INT64A=14]="INT64A";c[c.UINT64A=15]="UINT64A"})(v||(v={}));(function(c){c[c.EMPTY=0]="EMPTY";c[c.BIT=1]="BIT";c[c.BYTE=2]="BYTE";c[c.SHORT=3]="SHORT";c[c.INT=4]="INT";c[c.UNSIGNED_BYTE=5]="UNSIGNED_BYTE";c[c.UNSIGNED_SHORT=6]="UNSIGNED_SHORT";c[c.UNSIGNED_INT=7]="UNSIGNED_INT";c[c.FLOAT=8]="FLOAT";c[c.DOUBLE=
9]="DOUBLE";c[c.STRING=10]="STRING";c[c.BINARY=11]="BINARY";c[c.TIME=12]="TIME";c[c.ARRAY_BIT=13]="ARRAY_BIT";c[c.ARRAY_BYTE=14]="ARRAY_BYTE";c[c.ARRAY_SHORT=15]="ARRAY_SHORT";c[c.ARRAY_INT=16]="ARRAY_INT";c[c.ARRAY_UNSIGNED_BYTE=17]="ARRAY_UNSIGNED_BYTE";c[c.ARRAY_UNSIGNED_SHORT=18]="ARRAY_UNSIGNED_SHORT";c[c.ARRAY_UNSIGNED_INT=19]="ARRAY_UNSIGNED_INT";c[c.ARRAY_FLOAT=20]="ARRAY_FLOAT";c[c.ARRAY_DOUBLE=21]="ARRAY_DOUBLE";c[c.ARRAY_TIME=22]="ARRAY_TIME";c[c.UINT64=23]="UINT64";c[c.INT64=24]="INT64";
c[c.ARRAY_UINT64=25]="ARRAY_UINT64";c[c.ARRAY_INT64=26]="ARRAY_INT64";c[c.OBJECT=27]="OBJECT"})(Na||(Na={}));var ua;(function(c){c[c.AL_EVENT_TRIGGERED=1]="AL_EVENT_TRIGGERED";c[c.AL_EVENT_NOT_TRIGGERED=2]="AL_EVENT_NOT_TRIGGERED";c[c.AL_EVENT_ACKED=4]="AL_EVENT_ACKED";c[c.AL_EVENT_RESET=8]="AL_EVENT_RESET";c[c.AL_EVENT_ENABLED=16]="AL_EVENT_ENABLED";c[c.AL_EVENT_DISABLED=32]="AL_EVENT_DISABLED";c[c.AL_FLAG_TRIGGER_CONDITION_CHANGED=64]="AL_FLAG_TRIGGER_CONDITION_CHANGED"})(ua||(ua={}));var Xc=function(c){function a(b,
a,h,d,f){var k=c.call(this,b.wgtId,a,h,d,f)||this;k.toggleSelectAll=!1;k.alarmCount=0;k.nDisabled=0;k.nRemoteEn=0;k.remoteEnReqBufferSize=100;k.alarmsConf={defaultColors:{},alarms:{},mlTexts:{}};k.alarmsBuffer={};k._nInitilizedAlarm=0;k._isAlarmsInitialized=!1;k.alarmNumber=h.alarmNumber;k.alarmCache={alDate:Array(k.alarmNumber),alDateTime:Array(k.alarmNumber),alDescription:Array(k.alarmNumber),alEnable:Array(k.alarmNumber),alName:Array(k.alarmNumber),alSelect:Array(k.alarmNumber),alSeverity:Array(k.alarmNumber),
alState:Array(k.alarmNumber),alTime:Array(k.alarmNumber),alValue:Array(k.alarmNumber),alUserAction:Array(k.alarmNumber),comment:Array(k.alarmNumber),BGColor:Array(k.alarmNumber),FGColor:Array(k.alarmNumber),blink:Array(k.alarmNumber),alGroups:Array(k.alarmNumber),alCustomField1:Array(k.alarmNumber),alCustomField2:Array(k.alarmNumber),alarmCount:0,alTriggeredList:[]};k.dataLinks={};k.mapDataLinkToVar={};k.mapAlarmId={};k.enableTags={};k.rmEnableAl=[];k.currLang=k.parentPage.getWidget("_MultiLangMgr",
!0).curLangId;k.initPromiseReady();g.isTestModeActive()?k.resolveWgtReady(!0):k.parentWidget.waitWgtReady().then(function(){k.srv=g.getActiveProject().getCommunticationObj();var b=g.getActiveProject().getTagMgr();b.isReady()?k._initAlarmConfiguration():b.subscribeWgt(k,function(b,a){k.trigger(b,a)})});k.isMl=!0;return k}p(a,c);a.prototype.trigger=function(b,a){"tagmgrready"==b&&this._initAlarmConfiguration()};a.prototype._initAlarmConfiguration=function(){var b=this;this.srv.getConf().then(function(a){b.alarmsConf=
a["alarms.json"];b.initAlarmBuffer();b.subscribeTagsForRemoteEnable();a=g.getActiveProject().getTagMgr();if(a.getGroupInfo("AlarmEnableTags@$AlarmMgrWgt@$0")){a.subscribeGroup("AlarmEnableTags@$AlarmMgrWgt@$0",b.parentPage);for(var c in b.enableTags)g.hmiAttach(b,a.wgtId,{tag:c,srcType:"Tag",rw:"r",attr:"__rmen__"+c,tagType:""})}b.srv.subscribeAlarms("*",function(a){b.onDataReady(a)});setTimeout(function(){b._isAlarmsInitialized=!0;b.resolveWgtReady(!0)},1E3)})["catch"](function(){g.getAction("hmiActionShowMessage").execute(null,
{msg:"Error loading alarms configuration. Reloading..."},3);setTimeout(function(){b.project.getCommunticationObj().loadIndex()},2E3)})};a.prototype.isDataReady=function(){return this._isAlarmsInitialized};a.prototype.updateTables=function(){var b=this.getAllSubscriptions();if(b)for(var a in b)b[a].getWidget().isTableDataSource||b[a].getWidget().updateData()};a.prototype.updateAlarmCache=function(b){var a=t["import"]("Alarm"),c=b.cacheIndex;b=b.al;var d=b.alName,f=b.alState;this.alarmCache.alState[c]=
b.stateToString(f);this.alarmCache.alEnable[c]=b.alEnable;this.alarmCache.alValue[c]=b.alValue;this.alarmCache.alDateTime[c]=b.alDateTime;this.alarmCache.alDate[c]=b.alDate;this.alarmCache.alTime[c]=b.alTime;this.alarmCache.BGColor[c]=b.BGColor;this.alarmCache.FGColor[c]=b.FGColor;this.alarmCache.blink[c]=f==a.stateType.STATE_TRIGGERED_NOT_ACKED||f==a.stateType.STATE_NOT_TRIGGERED_NOT_ACKED?this.alarmsConf.alarms[d].blinkTxt?!0:!1:!1;b.isTriggered()&&!b.isPrevStateTriggered()?(this.alarmCache.alTriggeredList.push(c),
this.alarmCache.alTriggeredList.sort()):!b.isTriggered()&&b.isPrevStateTriggered()&&this.alarmCache.alTriggeredList.splice(this.alarmCache.alTriggeredList.indexOf(c),1)};a.prototype.subscribeDataLink=function(b){c.prototype.subscribeDataLink.call(this,b);this.mapDataLinkToVar[b.tag]?this.mapDataLinkToVar[b.tag].splice(0,1,b):(this.mapDataLinkToVar[b.tag]=[],this.mapDataLinkToVar[b.tag].push(b))};a.prototype.getAlarmName=function(b){return this.alarmCache.alName[b]};a.prototype.getDataValues=function(b){return this.alarmCache[b]};
a.prototype.getDataValuesQuality=function(b){if("alEnable"==b){b={};for(var a=0,c=this.rmEnableAl.length;a<c;a++){var d=this.alarmsBuffer[this.rmEnableAl[a]],f=d.al.alRemoteEnable,k=g.getTagFromCache(f);void 0===k?(k=new H,this.parentWidget.getTag(f,k,-1,!0),b[d.cacheIndex]=k.quality):b[d.cacheIndex]=k.getQuality()}return b}return null};a.prototype.updateAlarmDataSources=function(){for(var b in this._subscriptions)if(this._subscriptions[b].getWidget().isTableDataSource)this._subscriptions[b].getCallbacks()[0]()};
a.prototype.onDataReady=function(b){for(var a=[],c=!1,d=0,f=b.length;d<f;d++){var k=b[d].alName,g=this.alarmsBuffer[k],m=g.al.update(b[d]);this._isAlarmsInitialized||this.alarmsBuffer[k].isInitialized||this._nInitilizedAlarm++;m&&(this.updateAlarmCache(g),a.push(k),!c&&m&&(c=!0))}this._isAlarmsInitialized&&c&&(this.sendUpdate(a),this.updateAlarmDataSources());this._nInitilizedAlarm>=this.alarmCount-this.nDisabled-this.nRemoteEn&&(this._isAlarmsInitialized=!0,this.resolveWgtReady(!0))};a.prototype.getDefaultColors=
function(){return this.alarmsConf.defaultColors};a.prototype.getAlarmsConfiguration=function(){return this.alarmsConf};a.prototype.getAlarmsCache=function(){return this.alarmCache};a.prototype.getAlarmsBuffer=function(){return this.alarmsBuffer};a.prototype.createAlarm=function(b){var a=new (g["import"]("Alarm"))(b),c=this.alarmCache.alarmCount;this.alarmsBuffer[b]={al:a,isInitialized:!1,cacheIndex:c};var d=this.alarmsConf.alarms[b];a.index=c;a.alDescription=this.getAlarmProperty(b,"d");a.xmlOrder=
parseFloat(d.xO);a.alGroups=void 0!==d.gr?d.gr:"";a.alSeverity=this.getAlarmServerity(b);a.alarmId=d.id;a.liveData=d.lD;a.userActions=d.usrActs;a.actions=d.acts;a.setActionMask(d.aM);a.alCustomField1=this.getAlarmProperty(b,"cF1");a.alCustomField2=this.getAlarmProperty(b,"cF2");this.mapAlarmId[a.alarmId]=a.alName;this.alarmCache.alName[c]=b;this.alarmCache.alSeverity[c]=a.alSeverity;this.alarmCache.alValue[c]=this.getAlarmProperty(b,"sourcevalue");this.alarmCache.BGColor[c]=this.getAlarmProperty(b,
"nTBC");this.alarmCache.FGColor[c]=this.getAlarmProperty(b,"nTTC");this.alarmCache.comment[c]=this.getAlarmProperty(b,"comment");this.alarmCache.blink[c]=this.getAlarmProperty(b,"blinkTxt");this.alarmCache.alGroups[c]=this.getAlarmProperty(b,"gr");this.alarmCache.alUserAction[c]=void 0!=this.getAlarmProperty(b,"usrActs")?1:0;this.alarmCache.alSelect[c]=!1;this.alarmCache.alDateTime[c]="1970/01/01 00:00:00";this.alarmCache.alDate[c]="1970/01/01";this.alarmCache.alTime[c]="00:00:00";this.alarmCache.alCustomField1[c]=
this.getCustomField1Text(a.alCustomField1);this.alarmCache.alCustomField2[c]=this.getCustomField2Text(a.alCustomField2);this.alarmCache.alState[c]="Disabled";var f=!1,d=d.eT;if(null!=d){this.rmEnableAl.push(b);a.alRemoteEnable=d;if(this.enableTags[d])this.enableTags[d].al.push(b);else{var k=t.getModule("Quality");this.enableTags[d]={al:[b],status:new k(192)}}this.nRemoteEn++;(b=g.getTagFromCache(d))&&b.isQualityGood()&&(f=b.getValue()?!0:!1)}(this.alarmCache.alEnable[c]=f)||this.nDisabled++;"undefined"!=
typeof this.alarmsConf.mlTexts[a.alDescription]&&(this.alarmCache.alDescription[c]=this.alarmsConf.mlTexts[a.alDescription][this.currLang]);c=[];if(a.userActions)for(var q in a.userActions)f=a.userActions[q],f.t===g.actionMgr.enActionType.JS&&(a.alAction=!0,c.push(f)),a.addUserAction(new g.actionMgr.defs[f.jsC]({wgtId:q},"onMouseRelease",{t:0,c:f.c,p:f.p},g.getFocusPage(),this));if(a.actions)for(var m in a.actions)f=a.actions[m],f.t===g.actionMgr.enActionType.JS&&(f.alAction=!0,c.push(f)),a.addAction(new g.actionMgr.defs[f.jsC]({wgtId:m},
"onMouseRelease",{t:0,c:f.c,p:f.p},g.getFocusPage(),this));this._registerJSActions(c);this.alarmCount=++this.alarmCache.alarmCount};a.prototype.getAlarmServerity=function(b){b=this.alarmsConf.alarms[b];var a="";switch(b.sv){case 0:a="-not important";break;case 1:a="-low";break;case 2:a="-below normal";break;case 3:a="-normal";break;case 4:a="-above normal";break;case 5:a="-high";break;case 6:a="-critical";break;default:a=""}return b.sv+a};a.prototype.getAlarmProperty=function(b,a){var c=this.alarmsConf.alarms[b];
return void 0!=c[a]?c[a]:this.alarmsConf.defaultColors[a]};a.prototype.initAlarmBuffer=function(){for(var b in this.alarmsConf.alarms)this.createAlarm(b)};a.prototype.subscribeTagsForRemoteEnable=function(){var b=this.enableTags,a=this.project.getTagMgr(),c=this.remoteEnReqBufferSize,d=Math.ceil(this.nRemoteEn/c),f=0,k=Array(1<d?c:this.nRemoteEn),g;for(g in b)f<c?(k[f]=g,f++):(a.subscribeForTagsNotification(k),d--,k=Array(1<d?c:this.nRemoteEn%c),k[0]=g,f=1);a.subscribeForTagsNotification(k)};a.prototype.sendUpdate=
function(b,a,c){var d=!0,f;for(f in this.dataLinks){var k=this.dataLinks[f],g=k.tag,m=this.alarmCache[g];if(m instanceof Array){for(var n=0;n<b.length;n++){var z=this.alarmsBuffer[b[n]].cacheIndex,l=k.tagIndex;!a&&"alSelect"==g||-1!==l&&z!==k.tagIndex||(k.setWgtValue(m[z],z,c),d=!0)}k.initialized=!1}}d&&this.updateTables()};a.prototype.setProperty=function(b,a,c){var d=t.getModule("Tag");this.setValue(b,a,d.QUALITY_GOOD,c)};a.prototype.setValue=function(b,a,c,d,f,k){var g,m=!1;void 0===k&&void 0!==
d&&0<=d&&d<this.alarmCache.alarmCount&&(k=this.alarmCache.alName[d]);"undefined"!=typeof k&&(g=this.alarmsBuffer[k].al,"alEnable"==b?(g.isDirty("alEnable")?g.getDirtyValue("alEnable"):g.getValue("alEnable"))!=a&&(g.setDirty("alEnable",a),m=!0):"alSelect"==b?(g.alSelect=a,m=!0):"alUserAction"==b?(g.alUserAction=a,g.doUserActions(),m=!0):m="fill"==b?!0:g.updateProperty(b,a));-1!=b.indexOf("__rmen__")&&(d=b.split("__rmen__")[1],this.checkEnableTagQuality(d,c));m&&(c=b,"fill"===b&&(c="FGColor"),this.alarmCache[c][this.alarmsBuffer[k].cacheIndex]=
a,this.sendUpdate([g.alName],f))};a.prototype.getValue=function(b,a){return this._isAlarmsInitialized&&void 0!==this.alarmCache[b]?void 0!==a&&this.alarmCache[b]instanceof Array?this.alarmCache[b][a]:this.alarmCache[b]:c.prototype.getValue.call(this,b)};a.prototype.checkEnableTagQuality=function(b,a){var c=this.enableTags[b],d=!1;if(c&&a){for(var f=a.isQualityGood(),k=0,q=c.al.length;k<q;k++){var m=this.alarmsBuffer[c.al[k]],n=m.al,m=m.cacheIndex;if(f){c.status||(d=!0);var z=g.getTagFromCache(b).getValue();
if(this.alarmCache.alEnable[m]!=z){d=this.getAlarmProperty(n.alName,"notifyMask");if(d&ua.AL_EVENT_ENABLED||d&ua.AL_EVENT_DISABLED)n.alEnable=z,this.alarmCache.alEnable[m]=z;d=!0}}else d=!0}c.status=a.isQualityGood();d&&this.sendUpdate(c.al,!0,a)}};a.prototype.updateAlarmByIndex=function(b,a,c){var d=this.alarmCache.alName[b];return d&&(d=this.alarmsBuffer[d].al,void 0!==d[a])?(d[a]=c,this.alarmCache[a][b]=c,!0):!1};a.prototype.setSelectAlarm=function(b,a){this.setValue("alSelect",a,null,0,!0,b)};
a.prototype.setEnableAlarm=function(b,a){this.setValue("alEnable",a,null,0,!0,b)};a.prototype.doSelectAlarms=function(b,a){if(void 0===a||null===a)a=this.getSelectedToggleStatus();if(void 0===b||null===b)b=this.alarmCache.alName;for(var c=0;c<b.length;c++)if(this.alarmsBuffer[b[c]]){var d=this.alarmsBuffer[b[c]].al;d.alSelect=this.alarmCache.alSelect[d.index]=a}this.sendUpdate(b,!0)};a.prototype.getSelectAlarmsByFilter=function(b,a,c,d){var f=[],k;for(k in this.alarmsBuffer){var g=this.alarmsBuffer[k].al,
m="alState"==b?g.stateToString(g.alState):g[b],n="alState"==c?g.stateToString(g.alState):g[c];m&&n&&a&&d?a.test(m)&&d.test(n)&&f.push(g.alName):m&&a?a.test(m)&&f.push(g.alName):n&&d?d.test(n)&&f.push(g.alName):f.push(g.alName)}return f};a.prototype.getEventTypeString=function(b){switch(b){case ua.AL_EVENT_TRIGGERED:return"Triggered";case ua.AL_EVENT_NOT_TRIGGERED:return"Not Triggered";case ua.AL_EVENT_ACKED:return"Acked";case ua.AL_EVENT_RESET:return"Reset";case ua.AL_EVENT_ENABLED:return"Enabled";
case ua.AL_EVENT_DISABLED:return"Disabled";case ua.AL_FLAG_TRIGGER_CONDITION_CHANGED:return"Flag Trigger Condition Changed";default:return""}};a.prototype.getTextFromAlarmProp=function(b,a){var c=this.getAlarmsConfiguration(),d=c.mlTexts;return(c=(c=c.alarms[b])&&c[a])&&d[c]?d[c][this.currLang]:""};a.prototype.getAlarmProp=function(b,a){var c=this.getAlarmsConfiguration().alarms[b];return(c=c&&c[a])?c:""};a.prototype.getAlarmNameById=function(b){return this.getAlarmById(b.toString()).alName};a.prototype.getAlarmById=
function(b){b=this.mapAlarmId[b];return void 0!==b?this.alarmsBuffer[b].al:null};a.prototype.getAlarmByName=function(b){return this.alarmsBuffer[b].al};a.prototype.getAlarmByIndex=function(b){return this.alarmsBuffer[this.alarmCache.alName[b]].al};a.prototype.getAlarmNameByIndex=function(b){return this.alarmCache.alName[b]};a.prototype.getUnorderedPosition=function(b){return this.getAlarmByIndex(b).xmlOrder};a.prototype.getIndexOfAlarm=function(b){return this.alarmsBuffer[b].cacheIndex};a.prototype.isAlarmSelected=
function(b){return this.alarmsBuffer[b].al.alSelect};a.prototype.getSelectedToggleStatus=function(){return this.toggleSelectAll=!this.toggleSelectAll};a.prototype.getSelectedAlarms=function(){for(var b=[],a=this.alarmCache.alSelect,c=this.alarmCache.alName,d=this.alarmCache.alSelect.length,f=0;f<d;f++)a[f]&&b.push(c[f]);return b};a.prototype.resetSelectedAlarms=function(){for(var b=[],a=this.alarmCache.alSelect,c=this.alarmCache.alName,d=this.alarmCache.alSelect.length,f=0;f<d;f++)a[f]&&b.push(c[f]);
this.srv.resetAlarms(b,!1);for(a=0;a<b.length;a++)this.alarmsBuffer[b[a]].al.reset()};a.prototype._getAlarmsEnableStatus=function(){for(var b={enabled:[],disabled:[]},a={},c=0,d=this.alarmCache.alEnable.length;c<d;c++){var f=this.alarmCache.alName[c],k=this.alarmsBuffer[f].al;if(k.isDirty("alEnable")){var g=this.alarmCache.alEnable[c];null!=k.alRemoteEnable?a[k.alRemoteEnable]?(a[k.alRemoteEnable].list.push(f),a[k.alRemoteEnable].status&&!g&&(a[k.alRemoteEnable].status=!1)):a[k.alRemoteEnable]={list:[f],
status:g}:g?b.enabled.push(f):b.disabled.push(f);k.commitDirtyValue("alEnable")}}for(var m in a)c=a[m],c.status?b.enabled=b.enabled.concat(c.list):b.disabled=b.disabled.concat(c.list);return b};a.prototype.ackSelectedAlarms=function(){var b=this.getSelectedAlarms();0<b.length&&this.srv.acknowledgeAlarms(b,!1)};a.prototype.ackSpecificAlarm=function(b){this.srv.acknowledgeAlarms([b],!1)};a.prototype.enableAlarms=function(){var b=this._getAlarmsEnableStatus();0<b.enabled.length&&this.srv.enableAlarms(b.enabled,
!0,!1);0<b.disabled.length&&this.srv.enableAlarms(b.disabled,!1,!1);this.updateTables()};a.prototype.saveConfiguration=function(){this.srv.saveConfiguration(!1)};a.prototype.updateLanguage=function(){var b=this.getPageMLTextMgr().getCurrentLanguage();if(b!=this.currLang){this.currLang=b;var b=[],a;for(a in this.alarmsBuffer){var c=this.alarmsBuffer[a],d=c.cacheIndex;this.alarmCache.alDescription[d]=this.getMLText(c.al.alDescription);this.alarmCache.alCustomField1[d]=this.getMLText(c.al.alCustomField1);
this.alarmCache.alCustomField2[d]=this.getMLText(c.al.alCustomField2);b.push(a)}this.sendUpdate(b)}};a.prototype.getCurrentLanguage=function(){return this.currLang};a.prototype.applyTrasformation=function(b,a){var c=t["import"]("TextFormatUtil"),d=a.indexOf("("),f=a.indexOf(")");if(-1!=d&&-1!=f){var k=a.substring(0,d),d=a.substring(d+2,f-1);"format"==k&&(b=c.format(c.parseFormat(d),b,null,!1))}else-1!=a.indexOf("#")&&(b=c.format(c.parseFormat(a),b,null,!1));return b};a.prototype.formatValue=function(b,
a){var c=g["import"]("hmiDataLink").parseString(a);"nan"!==b&&(0!=c.elemList.length||isNaN(b)||0==b%1||(c.elemList=['format("#.000000")']),b=c.elemList.reduce(this.applyTrasformation,b));return b};a.prototype.replaceHistLiveTags=function(b,a,c){if(!a||!c)return b;for(var d=c.length,f=0,k=a.length;f<k;f++){var g=new RegExp("\\[\\$"+f+"\\:[-]?\\d*\\]","g"),m=-1,n=b.search(g);if(-1!=n)var m=b.indexOf(":"),z=b.indexOf("]"),m=parseInt(b.substring(m+1,z));z="";-1!=n&&f<d&&(z=""===c[f]&&m!=v.STRING?"nan":
c[f]);b=b.replace(g,this.formatValue(z,a[f]))}return b};a.prototype.getMLTexts=function(){return g.activeProject.getAlarmsMgr().getAlarmsConfiguration().mlTexts};a.prototype.getMLText=function(b){var a=this.getMLTexts();return b&&a[b]?a[b][this.getCurrentLanguage()]:""};a.prototype.getDescriptionText=function(b){return this.getMLText(b)};a.prototype.getCustomField1Text=function(b){return this.getMLText(b)};a.prototype.getCustomField2Text=function(b){return this.getMLText(b)};a.prototype.destroy=function(){var b=
this.getAlarmsBuffer(),a;for(a in b)b[a].al.stopBlinking();return c.prototype.destroy.call(this)};a.jmType="AlarmsMgrWgt";return a}(l);g.fn.hmiAlarmsMgr=function(c,a,b,e){return new Xc(this,c,a,b,e)};g.addWidgetDefinition("hmiAlarmsMgr",Xc);var Yc;(function(c){c[c.LOCAL=1]="LOCAL";c[c.CLIENT=2]="CLIENT";c[c.WEB=4]="WEB"})(Yc||(Yc={}));var pa;(function(c){c[c.INFINITE=-1]="INFINITE"})(pa||(pa={}));var kc=function(c){function a(b,a,h,d,f){var k=c.call(this,b.wgtId,a,h,d,f)||this;k.currentPage=null;
k.invokableFunList=["getCurrentPageName","hasPage"];k.project=k.core.getActiveProject();k.container=k.project.getNode("container");k.loadedPages=[];k.precaching=!1;k.docFragment=document.createDocumentFragment();k.docFragmentLimit=5;k.userAgent=k.getDevice();k.currentCategory=k.resolveCurrentCategory();k.invalidateMtxChain();k.project.on("resize.pagemgr",function(b){k.project.waitWgtReady().then(function(){var b=k.currentCategory,a=k.resolveCurrentCategory();!a||b&&a.name==b.name||(k.currentCategory=
a,b=k.core.getActivePage(),b.getUserId()!=a.home&&k.project.changePage(b.getId(),k.getWebPage(a.home.toLowerCase())))})});return k}p(a,c);a.prototype.getDevice=function(){return/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)?"mobi":/iPad|RIM Tablet OS/i.test(navigator.userAgent)?"tablet":"web"};a.prototype.getHomePageId=function(){return this.currentCategory.home};a.prototype.setCurrentPageFromName=function(b){this.currentPage=b};a.prototype.isCurrentPageDefined=function(){return null!=
this.currentPage};a.prototype.getCurrentPageName=function(){return this.core.getActivePage().getUserId()};a.prototype.getCurrentPageId=function(){return this.core.getActivePage().getId()};a.prototype.hasPage=function(b){return b.toLowerCase()in this.map};a.prototype.hasWebPage=function(b){return this.currentCategory&&-1!=this.currentCategory.pages.indexOf(b)};a.prototype.getWebPage=function(b){return this.map[b]};a.prototype.getPageStudioId=function(b){for(var a in this.map)if(this.map[a]==b)return a;
return null};a.prototype.length=function(){var b=this.getCurrentCategory();return b?b.pages.length:0};a.prototype.parsePage=function(b,a){for(var c=b.querySelector("#_"+a),d=c.getElementsByTagName("script"),f,k,g=0,m=d.length;g<m;g++){var n=d[g].id;"hmi-page"===n?f=d[g].textContent:"hmi-init"===n&&(k=d[g].textContent)}return{element:c,scripts:{init:k,logic:f}}};a.prototype.loadPrecache=function(){var b=this;this.precaching=!0;var a=this.getCurrentCategory(),c=[];a&&(c=this.precached.filter(function(b){return-1!=
a.pages.indexOf(b)}));this.precache=new Promise(function(a,e){b.precached?(b.queue=c.slice(),b.project.getCommunticationObj().getPrecachedPages().then(function(e){b._loadPages(e,a)})["catch"](function(){e()})):a()});this.precache.then(function(){for(var a=function(){var a=c[e];if(b.activePage.getId()!=a){var d=g.getPage(a),a=t.getModule("Tag");d.setValue("visibility",!1,a.QUALITY_GOOD);requestAnimationFrame(function(){d.elem.parentElement.parentElement.style.top="0px";d.elem.parentElement.parentElement.style.left=
"0px"})}},e=0,k=c.length;e<k;e++)a();b.precaching=!1});this.precache["catch"](function(a){b.precaching=!1;throw a;});return this.precache};a.prototype.isPrecaching=function(){return this.precaching};a.prototype.waitPrecacheEnd=function(){return this.precache};a.prototype._loadPages=function(b,a){var c=this;if(0<this.queue.length){var d=this.queue.shift();if(this.activePage.getId()==d)requestAnimationFrame(function(){c._loadPages(b,a)});else{var f=this.parsePage(b,d);this.project.injectCWTemplatesToDOM(f.element);
f.element.setAttribute("data-url",this.project.getPageUrl(d)+d+".html");this.container.appendChild(f.element);d=this.core.getNextPageId(d);if(null==document.querySelector("link[rel='stylesheet'][href='"+d+".css']")){var k=document.createElement("link");k.setAttribute("rel","stylesheet");k.setAttribute("href",d+".css");document.querySelector("head").appendChild(k)}null!=f.scripts&&null!=f.scripts.logic&&eval(f.scripts.logic);var q=g.getPageInitFunction(f.element.getAttribute("id"))(1);this.addLoadedPage(q.getId());
q.render();f.element.style.top=g.browserWindow.height-2+"px";f.element.style.left=g.browserWindow.width-2+"px";g.getActiveProject().triggerEvent("precacheprogess",{totPages:this.precached.length,nPage:this.precached.length-this.queue.length});requestAnimationFrame(function(){c.project.onPageChange({recipes:!0});q.unmountDataLinks();c.movePageToFragment(q.getId());c._loadPages(b,a)})}}else a()};a.prototype.isPagePrecached=function(b){return-1!=this.precached.indexOf(b)};a.prototype.setActivePage=function(b){this.activePage=
b};a.prototype.getActivePage=function(){return null!=this.activePage?this.activePage:this.project};a.prototype.setFocusPage=function(b,a){this.focusPage=b;void 0!==a&&a()};a.prototype.getFocusPage=function(){return null!=this.focusPage?this.focusPage:this.getActivePage()};a.prototype.addLoadedPage=function(b){this.loadedPages.push(b)};a.prototype.removeLoadedPage=function(b){this.loadedPages.slice(this.loadedPages.indexOf(b),1)};a.prototype.isCached=function(b){return-1!==this.loadedPages.indexOf(b)};
a.prototype.getPagesElement=function(){return this.container.querySelectorAll("div[data-role='page']")};a.prototype.getLastPageInDOM=function(){var b=this.container.querySelectorAll("div[data-role='page']");return b[b.length-1]};a.prototype.isDOMEmpty=function(){return null==this.container.querySelector("div[data-role='page']")};a.prototype.getPagesContainer=function(){return this.container};a.prototype.isPageInFragment=function(b){return null!=this.docFragment.querySelector("#_"+b)};a.prototype.movePageToFragment=
function(b){(b=document.getElementById("_"+b))&&this.docFragment.appendChild(b);return b};a.prototype.loadPageFromFragment=function(b){(b=this.docFragment.querySelector("#_"+b))&&this.container.appendChild(b);return b};a.prototype.removePageFromFragment=function(b){return(b=this.docFragment.querySelector("#_"+b))?(b.parentNode.removeChild(b),!0):!1};a.prototype.pagesGC=function(b,a){var c=this.project.getValue("pagesCacheSize"),d=1,f=0,k=Array(d),q=this.loadedPages.length;if(q>c||!this.project.checkAvailableMemory()){for(c=
0;c<q&&0!==d;c++)if(this.loadedPages[c]!=b){var m=this.loadedPages[c];g.getPage(m).destroy();a.removedPage=k[f++]=m;g.evtMgr.trigger(this.project.getNode("container"),"hmipageremoved",a);var n="_"+m;g.removePageInitFunction(n);this.project.getCWidgetMgr().freeCWInstances(n);(n=document.getElementById(n))?n.parentNode.removeChild(n):this.isPageInFragment(m)&&this.removePageFromFragment(m);d--}if(0===d){d=0;for(f=k.length;d<f;d++)q=this.loadedPages.indexOf(k[d]),this.loadedPages.splice(q,1);return k}}return[]};
a.prototype.triggerBeforeChangeEvent=function(b){g.evtMgr.trigger(this.container,g.EVENTS.PAGE.BEFORE_CHANGE,b)};a.prototype.triggerBeforeContentLoaded=function(b){g.evtMgr.trigger(this.container,g.EVENTS.PAGE.CONTENT_LOAD,b)};a.prototype.triggerPageChange=function(b){g.evtMgr.trigger(this.container,g.EVENTS.PAGE.PAGE_CHANGE,b)};a.prototype.triggerAfterChange=function(b){g.evtMgr.trigger(this.container,g.EVENTS.PAGE.AFTER_CHANGE,b)};a.prototype.triggerErrorLoading=function(b){g.evtMgr.trigger(this.container,
g.EVENTS.PAGE.ERROR_LOADING,b)};a.prototype.getPages=function(){var b=this.getCurrentCategory();return b?b.pages:[]};a.prototype.maxValues=function(b,a,c){null==b.indexes?(b.max=a,b.indexes=[c]):a>b.max?(b.max=a,b.indexes=[c]):a==b.max&&b.indexes.push(c);return b};a.prototype.minValues=function(b,a,c){null==b.indexes?(b.min=a,b.indexes=[c]):a<b.min?(b.min=a,b.indexes=[c]):a==b.min&&b.indexes.push(c);return b};a.prototype.getCurrentCategory=function(){if(!this.categories)return null;this.currentCategory||
(this.currentCategory=this.resolveCurrentCategory());return this.currentCategory};a.prototype.filterByUserAgent=function(b){for(var a=g.getUserAgent(),c=[],d=[],f=0,k=0;k<b.length;k++){var q=b[k];if(".*"==q.useragent||"*"==q.useragent)c.push(q);else{var m=q.useragent.split("|").reduce(function(b,c){return-1!=a.indexOf(c)?++b:b},0);0==d.length?(d.push(q),f=m):m>f?(d=[],d.push(q),f=m):m==f&&d.push(q)}}return 0!=f?d:c};a.prototype.isCategoryContainedInViewportSize=function(b){var a=g.browserWindow.width,
c=g.browserWindow.height,d=b.minSize,f=d[1],k=b.maxSize;b=k[0];k=k[1];d=d[0]<=a&&f<=c;return b==pa.INFINITE&&k==pa.INFINITE?d:d&&(a<=b||b==pa.INFINITE)&&(c<=k||k==pa.INFINITE)};a.prototype.resolveCurrentCategory=function(){var b=this.categories,a=g.browserWindow.width,c=g.browserWindow.height,d=[],f=[],k;for(k in b){var q=b[k];0==q.minSize[0]&&0==q.minSize[1]&&q.maxSize[0]==pa.INFINITE&&q.maxSize[1]==pa.INFINITE?f.push(q):d.push(q)}if(1==d.length&&this.isCategoryContainedInViewportSize(d[0]))return d[0];
d=this.filterByUserAgent(d);d=d.filter(this.isCategoryContainedInViewportSize);if(1==d.length)return d[0];k=d.map(function(b){var d=b.minSize,f=d[0],d=d[1],k=b.maxSize;b=k[0];k=k[1];b==pa.INFINITE&&(b=a);k==pa.INFINITE&&(k=c);return(b-f)*(k-d)/(a*c)}).reduce(this.minValues,{min:-1,indexes:null});if(-1!=k.min){if(1==k.indexes.length)return d[k.indexes[0]];for(var b=Array(k.indexes.length),q=0,m=k.indexes.length;q<m;q++)b[q]=d[k.indexes[q]];d=b.map(function(b){var d=b.maxSize[0];if(d==pa.INFINITE||
d>a)d=b.minSize[0];var f=b.maxSize[1];if(f==pa.INFINITE||f>a)f=b.minSize[1];b=c-f;var k=a-d;b<=k?(b=f+b,k=d/f*b):(k=d+k,b=f/d*k);return k*b/(c*c)}).reduce(this.minValues,{min:-1,indexes:null});if(0<d.indexes.length)return b[d.indexes[0]]}f=this.filterByUserAgent(f);return 0<f.length?f[0]:null};a.prototype.setLastVisitedPage=function(b){var a=this.currentCategory;a&&-1!=a.pages.indexOf(b)&&(this.lastVisitedPage=b)};a.prototype.getLastVisitedPage=function(){var b=this.currentCategory;return b&&this.lastVisitedPage&&
-1!=b.pages.indexOf(this.lastVisitedPage)?this.lastVisitedPage:null};a.prototype.isUserManagmentPage=function(b){return this.currentCategory?-1!=this.currentCategory.umpages.indexOf(b.toLowerCase()):!1};return a}(l);g.fn.hmiPageMgr=function(c,a,b,e){return new kc(this,c,a,b,e)};g.addWidgetDefinition("hmiPageMgr",kc);var Zc=function(c,a,b,e,h){h=h*Math.PI/180;return{x:c-b*Math.cos(h),y:a-e*Math.sin(h)}},$c=function(c,a,b,e,h,d){var f=Zc(c,a,b,e,d);c=Zc(c,a,b,e,h);return["M",f.x,f.y,"A",b,e,0,180>=
d-h?"0":"1",0,c.x,c.y].join(" ")};Element.prototype.appendAfter=function(c){c.parentNode.insertBefore(this,c.nextSibling)};Element.prototype.appendBefore=function(c){c.parentNode.insertBefore(this,c)};Za.prototype=Object.create(window.Scrollbar.ScrollbarPlugin.prototype);Za.prototype.transformDelta=function(c){this.options.direction&&(c[this.options.direction]=0);return c};Za.pluginName="disableScroll";Za.defaultOptions={direction:null};g.resetViewport=function(){};g.parseRequest=function(){var c=
{};if(window.location.search)for(var a=window.location.search.substring(1).split("&"),b=0,e=a.length;b<e;b++){var h=a[b].split("=");c[decodeURIComponent(h[0])]=decodeURIComponent(h[1])}return c};Qc.prototype={getMatrix3x1:function(c,a,b){var e=this.tail3x1;e.m[0][0]=c;e.m[1][0]=a;e.m[2][0]=b;null!=e.prev&&(e.prev.next=null,this.tail3x1=e.prev,e.prev=null);return e},free3x1:function(c){c.prev=this.tail3x1;this.tail3x1=this.tail3x1.next=c},getMatrix3:function(c,a,b,e,h,d,f,k,g){var m=this.tail3;m.m[0][0]=
c;m.m[0][1]=a;m.m[0][2]=b;m.m[1][0]=e;m.m[1][1]=h;m.m[1][2]=d;m.m[2][0]=f;m.m[2][1]=k;m.m[2][2]=g;null!=m.prev&&(m.prev.next=null,this.tail3=m.prev,m.prev=null);return m},free3:function(c){c.prev=this.tail3;this.tail3=this.tail3.next=c}};g.matrixPool=new Qc(5);D.prototype.strStyle="rgb(0,0,0)";D.prototype.lineCap="butt";D.prototype.lineJoin="bevel";D.prototype.TYPE={STEP:1,LINE:0};D.prototype.pathLimitBuffer=100;D.prototype.curveWgt=null;D.prototype.setXRange=function(c,a){this.curveXRange={min:c,
max:a}};D.prototype.setYRange=function(c,a){this.curveYRange={min:c,max:a}};D.prototype.setStrokeColor=function(c){this.strStyle=c};D.prototype.setStrokeWidth=function(c){this.strWidth=c};D.prototype.mapToCoordinatesSystem=function(c){c.x=c.x;c.y=this.wSize.height-c.y};D.prototype.mapToRange=function(c,a,b){c.x=(a-this.curveXRange.min)*this.wSize.width/(this.curveXRange.max-this.curveXRange.min);c.y=(b-this.curveYRange.min)*this.wSize.height/(this.curveYRange.max-this.curveYRange.min)};D.prototype.updateCurve=
function(c,a,b){this.data=c;this.type=a;this._drawable=b};D.BrushType={LINE:0,DASHED:1};D.prototype._resetDrawStatus=function(){this.drawStatus.prevPoint.x=void 0;this.drawStatus.prevPoint.y=void 0;this.drawStatus.currPoint.x=void 0;this.drawStatus.currPoint.y=void 0;this._isNativeCompatible&&this.drawStatus.brushType!=D.BrushType.LINE&&this.ctx.setLineDash([0,0]);this.drawStatus.brushType=D.BrushType.LINE};D.prototype.drawCurve=function(){if(null!=this.curveWgt&&this.data){var c=this.data;if(this._drawable){this.ctx.lineWidth=
this.strWidth;this.ctx.strokeStyle=this.strStyle;this.ctx.lineCap=this.lineCap;this.ctx.lineJoin=this.lineJoin;this.drawStatus.lineBufferSize=this.pathLimitBuffer;for(var a=this.drawStatus.prevPoint,b=this.drawStatus.currPoint,e=this.drawStatus.brushType,h=c.length-1,d,f=0,k=c.length;f<k;f++)if(0==this.drawStatus.lineBufferSize&&this.endLine(),void 0!==c[f]&&c[f].q.isQualityGood()){var g=c[f].getValue();"string"==typeof g&&(g=parseFloat(g),g=isNaN(g)?0:g,c[f].setValue(g));g=this.curveWgt.getValue("cursor-ts");
if(f<k-1&&void 0!==c[f+1]){var m=c[f+1].x;g>=c[f].x&&g>=this.curveXRange.min&&g<=m&&g<=this.curveXRange.max&&(d=c[f].y)}b.selected=c[f].selected;this.mapToRange(b,c[f].x,c[f].y);this.mapToCoordinatesSystem(b);0>b.x&&!this.isScatter?(this.isOutFromBounds(b)&&!this.isScatter?(this.moveToBoundary(b),e=D.BrushType.DASHED):e=D.BrushType.LINE,a.x=b.x,a.y=b.y,a.selected=b.selected):(void 0!=a.x&&void 0!=b.x&&(this.isOutFromBounds(b)&&!this.isScatter?(this.moveToBoundary(b),e==D.BrushType.LINE&&(this.endLine(),
e=D.BrushType.DASHED,this.beginLine(a,e)),0==this.drawStatus.operation&&this.beginLine(a,e),this.appendSegment(a,b)):e==D.BrushType.DASHED?(this.appendSegment(a,b),this.endLine(),e=D.BrushType.LINE,this.beginLine(b,e)):(0==this.drawStatus.operation&&this.beginLine(a,e),this.appendSegment(a,b))),a.x=b.x,a.y=b.y,a.selected=b.selected,this.isOutFromBounds(a)&&!this.isScatter&&(e=D.BrushType.DASHED),f==h&&this.endLine())}else this.endLine(),a.x=a.y=void 0,e=D.BrushType.LINE;this.curveWgt.setValue("cursor-value",
d,null);this._resetDrawStatus()}}};D.prototype.isOutFromBounds=function(c){return 0>c.y||c.y>this.wSize.height?!0:!1};D.prototype.moveToBoundary=function(c){var a=0;0>c.y&&(c.y=0,a=-1);c.y>this.wSize.height&&(c.y=this.wSize.height,a=1);return a};D.prototype.beginLine=function(c,a){1==this.drawStatus.operation&&(this.ctx.stroke(),this.drawStatus.lineBufferSize=this.pathLimitBuffer);if(this._isNativeCompatible&&a!=this.drawStatus.brushType)if(a==D.BrushType.LINE)this.ctx.setLineDash([0,0]);else if(a==
D.BrushType.DASHED){var b=this.ctx.lineWidth;this.ctx.setLineDash([2*b,3*b])}this.drawStatus.brushType=a;c.selected&&this.drawBigPoint(c);this.ctx.beginPath();this.ctx.moveTo(c.x,c.y);this.drawStatus.operation=1};D.prototype.appendSegment=function(c,a){0==this.drawStatus.lineBufferSize&&(this.ctx.stroke(),this.drawStatus.lineBufferSize=this.pathLimitBuffer,c.selected&&this.drawBigPoint(c),this.ctx.beginPath(),this.ctx.moveTo(c.x,c.y));this.drawStatus.brushType==D.BrushType.LINE?(this.type==this.TYPE.STEP&&
c.x!=a.x&&this.ctx.lineTo(a.x,c.y),this.ctx.lineTo(a.x,a.y)):this.drawStatus.brushType==D.BrushType.DASHED&&(this._isNativeCompatible?(this.type==this.TYPE.STEP&&c.x!=a.x&&this.ctx.lineTo(a.x,c.y),this.ctx.lineTo(a.x,a.y)):(this.type==this.TYPE.STEP&&c.x!=a.x&&this.dashedLine(c.x,c.y,a.x,a.y),this.dashedLine(c.x,c.y,a.x,a.y)));this.drawStatus.lineBufferSize--;a.selected&&(this.ctx.stroke(),this.drawBigPoint(a),this.drawStatus.lineBufferSize=this.pathLimitBuffer,this.ctx.beginPath(),this.ctx.moveTo(a.x,
a.y))};D.prototype.endLine=function(){1==this.drawStatus.operation&&(this.ctx.stroke(),this.ctx.closePath(),this.drawStatus.operation=0)};D.prototype.drawBigPoint=function(c){this.ctx.beginPath();this.ctx.fillStyle=this.strStyle;this.ctx.arc(c.x,c.y,2.5*this.strWidth,0,2*Math.PI);this.ctx.fill();this.ctx.stroke()};D.prototype.dashedLine=function(c,a,b,e){for(var h=this.ctx.lineWidth+2,d=b-c,f=e-a,h=Math.floor(Math.sqrt(d*d+f*f)/h),d=d/h,f=f/h,k=0;k<h;)c+=d,a+=f,this.ctx[0==k%2?"moveTo":"lineTo"](c,
a),k++;this.ctx[0==k%2?"moveTo":"lineTo"](b,e)};D.prototype.enableDrawing=function(c){this._drawable=c};D.prototype.clearCanvasContext=function(){this.ctx.clearRect(0,0,this.wSize.width+5,this.wSize.height+5)};D.prototype.clearData=function(){this.data=null};D.prototype.updateCanvasContainerSize=function(c){var a=this.canvas.parentNode;a.style.width=c.width+"px";a.style.height=c.height+"px";a.style.left=c.x+"px";a.style.top=c.y+"px"};D.prototype.updateSize=function(c,a){this.canvas.width=c;this.canvas.height=
a;this.wSize.width=c;this.wSize.height=a};D.prototype.destroy=function(){this.ctx.clearRect(0,0,this.wSize.width,this.wSize.height);this.curveWgt=null};S.prototype.constructor=S;S.prototype.isVisible=!1;S.prototype.getLinePoints=function(c,a){var b=[];b.push({x:c,y:0});b.push({x:c,y:this._wSize.height});b.push({x:0,y:a});b.push({x:this._wSize.width,y:a});return b};S.prototype.mapToCoordinatesSystem=function(c,a,b){c.x=a;c.y=this._wSize.height-b};S.prototype.mapToRange=function(c,a,b){c.x=Math.floor((a-
this._xSize.min)*this._wSize.width/(this._xSize.max-this._xSize.min));c.y=Math.floor((b-this._ySize.min)*this._wSize.height/(this._ySize.max-this._ySize.min))};S.prototype.drawCursor=function(c){var a={x:0,y:0};c?a={x:this._pos.x,y:this._pos.y}:(this.mapToRange(a,this._pos.x,this._pos.y),this.mapToCoordinatesSystem(a,a.x,a.y));if(!this.xCursorShow&&!this.yCursorShow)return this.isVisible&&(this.ctx.clearRect(0,0,this._wSize.width,this._wSize.height),this.isVisible=!1),!1;this.isVisible=!0;c=this.getLinePoints(a.x,
a.y);this.ctx.clearRect(0,0,this._wSize.width,this._wSize.height);this.ctx.beginPath();this.xCursorShow&&(this.ctx.moveTo(c[0].x,c[0].y),this.ctx.lineTo(c[1].x,c[1].y));this.yCursorShow&&(this.ctx.moveTo(c[2].x,c[2].y),this.ctx.lineTo(c[3].x,c[3].y));this.ctx.lineWidth=this.strokeWidth;this.ctx.strokeStyle=this.strokeColor;this.ctx.stroke();this.ctx.closePath()};S.prototype.getValidValue=function(c){var a=-1;if(c<this._xSize.min||c>this._xSize.max){if(this._pos.x<this._xSize.min||this._pos.x>this._xSize.max)c=
(this._xSize.max-this._xSize.min)/2,a=this._xSize.max-c}else a=c;return a};S.prototype.setXCursorPos=function(c){this._pos.x=this.getValidValue(c)};S.prototype.setYCursorPos=function(c){this._pos.y=c};S.prototype.setCursorVisibility=function(c){this.xCursorShow=c};S.prototype.setXMin=function(c){this._xSize.min=c};S.prototype.setXMax=function(c){this._xSize.max=c};S.prototype.setYMin=function(c){this._ySize.min=c};S.prototype.setYMax=function(c){this._ySize.max=c};S.prototype.getXPosition=function(){if(this._pos)return this._pos.x};
S.prototype.getYPosition=function(){if(this._pos)return this._pos.y};S.prototype.isCursorVisible=function(){return this.xCursorShow};S.prototype.clearCanvasContext=function(){this.ctx.clearRect(0,0,this._wSize.width+5,this._wSize.height+5)};S.prototype.updateSize=function(c,a){this.canvas.width=c;this.canvas.height=a;this._wSize.width=c;this._wSize.height=a};Y.prototype=Object.create(S.prototype);Y.prototype.constructor=Y;Y.prototype.xyGrid=null;Y.prototype.xyIdx=null;Y.prototype.lowerSnap=null;Y.prototype.upperSnap=
null;Y.prototype.isOnTheGrid=!1;Y.prototype.stepXY=function(c,a){c=0==c?1:-1;var b=this._pos.x,e;if(this.isOnTheGrid)e=this.xyIdx;else{--a;var h=!1;1===c?b>this.xyGrid[this.xyGrid.length-1]?h=!0:e=this.xyGrid.indexOf(this.upperSnap):-1===c&&(b<this.xyGrid[0]?h=!0:e=this.xyGrid.lastIndexOf(this.lowerSnap));if(h)return{xvalue:"",yoccurence:0}}b=e+a*c;b>=this.xyGrid.length?b=this.xyGrid.length-1:0>b&&(b=0);this.xyIdx=b;this.isOnTheGrid=!0;b=this.xyGrid[b];this._pos.x=b;e=this.xyGrid.indexOf(b);e=0<this.xyGrid.lastIndexOf(b)-
e?this.xyIdx-e:0;return{xvalue:b,yoccurence:e}};Y.prototype.updateXYGrid=function(c){this.xyGrid=[];for(var a={},b=0,e=c.length;b<e;b++){var h=c[b].xvalue;if(void 0!==h&&null!==h)for(var d=0,f=h.length;d<f;d++){var k=h[d];if(h.indexOf(k)!=d){var g=c[b].wgtId;void 0===a[k]&&(a[k]={},a[k][g]=0);a[k][g]++}else this.insert(k),this.updateLowerUpperSnap(k)}}for(var m in a){b=a[m];c=0;for(g in b)b[g]>c&&(c=b[g]);for(b=0;b<c;b++)this.xyGrid.splice(this.xyGrid.indexOf(parseFloat(m)),0,parseFloat(m))}this.isOnTheGrid&&
(this.xyIdx=this.xyGrid.indexOf(this._pos.x))};Y.prototype.insert=function(c){if(-1==this.xyGrid.indexOf(c)){for(var a=this.xyGrid.length,b=0;b<a&&this.xyGrid[b]<c;)b++;this.xyGrid.splice(b,0,c);return b}return-1};Y.prototype.updateLowerUpperSnap=function(c){if(!this.isOnTheGrid){var a=this._pos.x;a===c?this.isOnTheGrid=!0:null===this.lowerSnap&&a>c?this.lowerSnap=c:null===this.upperSnap&&a<c?this.upperSnap=c:a>c&&Math.abs(a-c)<Math.abs(a-this.lowerSnap)?this.lowerSnap=c:a<c&&Math.abs(a-c)<Math.abs(a-
this.upperSnap)&&(this.upperSnap=c)}};Y.prototype.resetXYCursor=function(){if(null!==this.xyGrid){var c=this.xyGrid.indexOf(this._pos.x);this.xyIdx=(this.isOnTheGrid=-1!==this.xyGrid.indexOf(this._pos.x))?c:null}for(var c=0,a=this.xyGrid.length;c<a;c++)this.updateLowerUpperSnap(this.xyGrid[c])};Y.prototype.getValueXY=function(){return this.xyGrid[this.xyIdx]};Y.prototype.getOccurenceXY=function(){var c=this.xyGrid[this.xyIdx];if(void 0!==c){var a=this.xyGrid.indexOf(c);return 0<this.xyGrid.lastIndexOf(c)-
a?this.xyIdx-a:0}return 0};Y.prototype.getXPosition=function(){return null!==this.xyGrid&&null!==this.xyIdx?this.xyGrid[this.xyIdx]:""};Ga.prototype.setXRange=function(c,a){this.xSize.min=c;this.xSize.max=a};Ga.prototype.setYRange=function(c,a){this.ySize.min=c;this.ySize.max=a};Ga.prototype.mapToRange=function(c,a){return Math.floor((c-a)*this.wSize.width/(this.xSize.max-this.xSize.min))};Ga.prototype.drawBands=function(){var c=new Date(this.xSize.max),a=new Date(this.xSize.min),b=this.getPointsInWindow(a,
c);this.ctx.clearRect(0,0,this.wSize.width,this.wSize.height);var e;if(0==b.length)e=a.getDay(),a=a.getHours(),this.draw(0,this.wSize.width,e,a-2);else{for(var h=0,d=0,f=0;f<b.length;f++)h=b[f].x-d,e=b[f].d,a=b[f].h,this.draw(d,h,e,a-2),d=b[f].x;h=this.wSize.width-d;e=c.getDay();a=c.getHours();this.draw(d,h,e,a-1)}};Ga.prototype.getPointsInWindow=function(c,a){for(var b=[],e=new Date(c.getFullYear(),c.getMonth(),c.getDate(),c.getHours()+1,0);e<=a;)b.push({x:this.mapToRange(e,c),d:e.getDay(),h:e.getHours()}),
e=new Date(e.getTime()+36E5);return b};Ga.prototype.draw=function(c,a,b,e){if(b=this.bands.clrs[this.bands.tmtx[b][e]])this.ctx.beginPath(),this.ctx.rect(c,0,a,this.wSize.height),this.ctx.fillStyle=b,this.ctx.fill()};Ga.prototype.clearCanvasContext=function(){this.ctx.clearRect(0,0,this.wSize.width+5,this.wSize.height+5)};Ga.prototype.updateSize=function(c,a){var b=document.getElementById(this.id);b.width=c;b.height=a;this.wSize.width=c;this.wSize.height=a};oa.prototype.drawBGGrid=function(){var c=
1,a=1;this.ctx.clearRect(0,0,this.wSize.width,this.wSize.height);this.ctx.beginPath();this.ctx.fillStyle=this.colorX;for(var b=Math.ceil(this.wSize.width/(this.gridX+1-2)),e=Math.ceil(this.wSize.height/(this.gridY+1-2)),h=b,d=0;c<this.gridX-1;)this.ctx.fillRect(h,0,1,this.wSize.height),h+=b,c++;this.ctx.beginPath();for(this.ctx.fillStyle=this.colorY;a<this.gridY;)this.ctx.fillRect(0,d,this.wSize.width,1),d+=e,a++;this.ctx.closePath()};oa.prototype.setGridX=function(c){this.gridX=c};oa.prototype.setGridY=
function(c){this.gridY=c};oa.prototype.setColorX=function(c){this.colorX=c};oa.prototype.setColorY=function(c){this.colorY=c};oa.prototype.setXAnchor=function(c){this.xanchor=c};oa.prototype.setYAnchor=function(c){this.yanchor=c};oa.prototype.setXSpacing=function(c){this.xspacing=c};oa.prototype.setYSpacing=function(c){this.yspacing=c};oa.prototype.clearCanvasContext=function(){this.ctx.clearRect(0,0,this.wSize.width+5,this.wSize.height+5)};oa.prototype.updateSize=function(c,a){this.canvas.width=
c;this.canvas.height=a;this.wSize.width=c;this.wSize.height=a};Ub.prototype.constructor=Ub;Ub.prototype.updateBounds=function(){var c=this.baseWgt.left-30,a=this.baseWgt.top,b=!0===this.baseWgt.frame,b="MsgTextWgt"===this.baseWgt.getJMType()?b?this.baseWgt.frameSize:0:0;0>c&&(c=this.baseWgt.left+this.baseWgt.width+2*b);this.elem.style.left=c+"px";this.elem.style.top=a+"px"};P.prototype.constructor=P;P.prototype.init=function(){var c,a,b,e,h=this.baseWgt.elem;c=this.baseWgt.height;a=this.baseWgt.elem.style.fontFamily;
b=parseFloat(this.baseWgt.elem.style.fontSize);e="line-height:"+90*c/100+"px;";this.isBaseMsgTextWgt&&(e+="color:#000000");c=document.createElement("div");c.style.fontFamily=a;c.style.fontSize=b+"px";c.style.width=this.baseWgt.width+"px";c.style.height=this.baseWgt.height+"px";c.style.boxSizing="border-box";c.style.border=this.frame?"none":"1px solid";c.style.boxSizing="border-box";c.classList+="selectric";a=document.createElement("p");a.classList+="label";a.setAttribute("style",e);b=document.createElement("b");
b.classList+="button";this.isBaseComboBox&&(b.style.width=this.baseWgt.dropdownButtonWidth+"px",b.style.height="100%",b.style.backgroundColor=this.baseWgt.dropdownButtonBgColor,b.style.backgroundPositionX="50%",b.style.backgroundSize=this.baseWgt.dropdownButtonImageWidth+"px "+this.baseWgt.dropdownButtonImageWidth+"px",this.baseWgt.imgReference&&(b.classList+=" "+this.baseWgt.imgReference));e=document.createTextNode("");a.appendChild(e);c.appendChild(a);c.appendChild(b);this.select.style.display=
"none";$(h).prepend(c);this.updateComboStyle();this.lbl=a;this.sel=c};P.prototype.cloneCombobox=function(){this.clone=this.baseWgt.elem.cloneNode(!1);this.setMaxSelectricHeight();this.hasEmptyElem();this.clone.hasChildNodes()&&$(this.clone).children().remove();this.updateCloneStyles();this.clSelect=this.select.cloneNode(!0);this.clSelect.selectedIndex=this.select.selectedIndex;this.clone.appendChild(this.clSelect);var c=this,a={nativeOnMobile:!1,disableOnMobile:!1,onClose:function(){c.baseWgt.onClose()},
onChange:function(){c.baseWgt.onChange(c.clSelect.selectedIndex)}};if(this.isBaseComboBox){a.hoverBackgroundColor=this.baseWgt.dropdownSelBgColor;a.hoverFontColor=this.baseWgt.dropdownSelFontColor;var b="button";this.baseWgt.imgReference&&(b+=" "+this.baseWgt.imgReference);a.arrowButtonMarkup="<b class='"+b+"' style='width:"+this.baseWgt.dropdownButtonWidth+"px;height:100%;background-color:"+this.baseWgt.dropdownButtonBgColor+";background-position-x:50%;background-size:"+this.baseWgt.dropdownButtonImageWidth+
"px "+this.baseWgt.dropdownButtonImageWidth+"px";"'></b>"}$(this.clSelect).selectric(a);this.selectric=$(this.clSelect).data("selectric");this.appendCustomSelectricStyles();this.open()};P.prototype.updateCloneStyles=function(){this.clone&&(this.updateOffsets(this.baseParentWidget),this.clone.style.fontFamily=this.baseWgt.fontFamily,this.clone.style.fontSize=this.baseWgt.fontSize,this.clone.style.width=this.baseWgt.width+"px",this.clone.style.height=this.baseWgt.height+"px",this.clone.style.left=this.offsets.l+
"px",this.clone.style.top=this.offsets.t+"px",this.clone.style.overflow="visible",this.isBaseMsgTextWgt&&(this.clone.style.color="#000000"),this._isMsgTextWgt&&(this.clone.style.border="none",this.clone.style.overflow="visible",this.clone.style.backgroundColor="white",this.clone.style.color="black"))};P.prototype.open=function(){this.selectric.open();this.updateCloneStyles(this.baseWgt);this.baseParentPage.elem.appendChild(this.clone);"GroupWgt"!==this.baseParentWidget.getJMType()&&"TableGroupWgt"!==
this.baseParentWidget.getJMType()||this.baseParentWidget.addActiveElement(this.clone)};P.prototype.hasEmptyElem=function(){"empty"===this.select.firstChild.getAttribute("value")&&(this.initEmptyElem=!0)};P.prototype.appendCustomSelectricStyles=function(){$(".label",this.clone).css({lineHeight:90*this.baseWgt.height/100+"px",textDecoration:this.baseWgt.fontUnderline?"underline":"none"});$(".selectric-items",this.clone).css({width:"100%",height:this.maxH+"px",boxSizing:"border-box",textDecoration:this.baseWgt.fontUnderline?
"underline":"none"});$(".selectric",this.clone).css({boxSizing:"border-box",border:this.frame?"none":"1px solid"});this.upDir&&$(".selectric-items",this.clone).css("top",-this.maxH+"px");this.initEmptyElem&&($(".selectric-scroll",this.clone).children()[0].firstChild.style.display="none",this.initEmptyElem=!1);this.updateComboStyle()};P.prototype.updateComboStyle=function(){if(this.isBaseComboBox){$(".label",this.baseWgt.elem).css({textDecoration:this.baseWgt.fontUnderline?"underline":"none"});$(".selectric",
this.baseWgt.elem).css({border:this.baseWgt.borderWidth+"px solid "+this.baseWgt.borderColor,"background-color":this.baseWgt.bgColor,color:this.baseWgt.fontColor});var c=$(".selectric .button",this.baseWgt.elem);c.css({width:this.baseWgt.dropdownButtonWidth+"px",height:"100%",backgroundColor:this.baseWgt.dropdownButtonBgColor,backgroundPositionX:"50%",backgroundSize:this.baseWgt.dropdownButtonImageWidth+"px "+this.baseWgt.dropdownButtonImageWidth+"px"});this.baseWgt.imgReference&&!c.hasClass(this.baseWgt.imgReference)&&
c.addClass(this.baseWgt.imgReference);this.clone&&($(".selectric-wrapper .selectric",this.clone).css({border:this.baseWgt.borderWidth+"px solid "+this.baseWgt.borderColor,"background-color":this.baseWgt.bgColor,color:this.baseWgt.fontColor}),$(".selectric-wrapper .selectric-scroll",this.clone).css({"background-color":this.baseWgt.dropdownBgColor,color:this.baseWgt.dropdownFontColor}),$(".selectric-wrapper .selectric-scroll .selected",this.clone).css({"background-color":this.baseWgt.dropdownSelBgColor,
color:this.baseWgt.dropdownSelFontColor}),$(".selectric-wrapper .selectric-items",this.clone).css({border:this.baseWgt.dropdownBorderWidth+"px solid "+this.baseWgt.dropdownBorderColor}),$(".selectric-wrapper .button",this.baseWgt.elem).css({width:this.baseWgt.dropdownButtonWidth+"px",height:"100%",backgroundColor:this.baseWgt.dropdownButtonBgColor,backgroundPositionX:"50%"}),0<this.baseWgt.dropdownItemHeight&&$(".selectric-wrapper .selectric-items li",this.clone).css({height:this.baseWgt.dropdownItemHeight+
"px","text-align":"center","line-height":this.baseWgt.dropdownItemHeight+"px"}))}};P.prototype.setMaxSelectricHeight=function(){var c=parseFloat(this.baseWgt.elem.style.fontSize),a=this.baseParentPage.height-(this.offsets.t+this.baseWgt.height)-1,c=c+2,b=this.select.childNodes.length;this.baseParentPage.constructor==hb&&(a-=this.baseParentPage.hdrHeight);"empty"==this.select.firstChild.getAttribute("value")&&--b;b*=c;b>10*c&&(b=10*c);!this.forceRenderStyle&&this.offsets.t+(this.baseWgt.height+b)>
this.baseParentPage.height&&(a>2*c?(this.upDir=!1,b=a):(this.upDir=!0,b>this.offsets.t&&(b=0)));this.maxH=b};P.prototype.updateOffsets=function(){var c,a,b,e,h=this.baseParentWidget,d=this.baseWgt.left,f=this.baseWgt.top;c=a=b=e=0;isNaN(d)&&(d=0);isNaN(f)&&(f=0);h.constructor==La&&(isNaN(h.left)||(a=h.left),isNaN(h.top)||(e=h.top),h=h.parentWidget);for(;h!=R&&null!=h;){if("GroupWgt"==h.getJMType()||"TableGroupWgt"==h.getJMType()||"StackWgt"==h.getJMType())isNaN(h.left)||(c+=h.left),isNaN(h.top)||
(b+=h.top),"TableGroupWgt"==h.getJMType()&&h.hasHeader()&&!this.baseWgt.isInHeader&&(b+=h.getHeaderHeight()),h.hasScrollbar&&h.hasScrollbar()&&(c-=h.getXScrollPosition(),this.baseWgt.isInHeader||(b-=h.getYScrollPosition()));h=h.parentWidget}this.baseParentWidget.constructor==La?(c=d+c+a,b=f+b+e):(c=d+c,b=f+b);this.offsets={l:c,t:b}};P.prototype.updateCustomSelectricSize=function(){this.sel.style.width=this.baseWgt.width+"px";this.sel.style.height=this.baseWgt.height+"px"};P.prototype.updateCloneBounds=
function(){this.updateCloneStyles();this.refresh()};P.prototype.update=function(c){this.lbl.textContent=null==this.select.options[c]?"":this.select.options[c].textContent};P.prototype.bindEvents=function(){var c=this;$(this.sel).bind("touchstart click",function(a){a.preventDefault();a.stopPropagation();c.cloneCombobox()})};P.prototype.refresh=function(){this.updateComboStyle();this.selectric&&this.selectric.refresh()};P.prototype.unbindEvents=function(){$(this.sel).off()};P.prototype.showWrapper=
function(){this.baseWgt.disableAllTextAlignmentOnComboWrapper();this.sel.style.display="block"};P.prototype.hideWrapper=function(){this.baseWgt.applyVerticalTextAlignment();this.baseWgt.applyHorizontalTextAlignment();this.sel.style.display="none"};P.prototype.removeWrapper=function(){$(this.sel).remove()};P.prototype.detachClone=function(){this.clone&&$(this.clone).detach()};P.prototype.removeClone=function(){this.clone&&$(this.clone).remove()};P.prototype.removeObjects=function(){this.removeClone();
this.removeWrapper();this.unbindEvents();this.selectric&&this.selectric.destroy()};P.prototype.getOffsets=function(){return this.offsets};var nc=this&&this.__spreadArrays||function(){for(var c=0,a=0,b=arguments.length;a<b;a++)c+=arguments[a].length;for(var c=Array(c),e=0,a=0;a<b;a++)for(var h=arguments[a],d=0,f=h.length;d<f;d++,e++)c[e]=h[d];return c},ad=function(){function c(a,b){this._scrollbar=window.Scrollbar.use(Za);this._scrollbar=window.Scrollbar.init(a,b.lib);b.ext.disableX&&this.disableXScroll();
b.ext.disableY&&this.disableYScroll();b.ext.bgColor&&this.setBgColor(b.ext.bgColor);b.ext.color&&this.setColor(b.ext.color);b.ext.contentSize&&this.setContentSize(b.ext.contentSize)}c.prototype.addListener=function(a){this._callback=a;this._scrollbar.addListener(a)};c.prototype.removeListener=function(){this._scrollbar.removeListener(this._callback)};c.prototype.enableXScroll=function(){this._scrollbar.containerEl.appendChild(this._scrollbar.track.xAxis.element);this._scrollbar.options.plugins.disableScroll.direction=
null};c.prototype.enableYScroll=function(){this._scrollbar.containerEl.appendChild(this._scrollbar.track.yAxis.element);this._scrollbar.options.plugins.disableScroll.direction=null};c.prototype.disableXScroll=function(){this._scrollbar.track.xAxis.element.remove();this._scrollbar.options.plugins.disableScroll.direction="x"};c.prototype.disableYScroll=function(){this._scrollbar.track.yAxis.element.remove();this._scrollbar.options.plugins.disableScroll.direction="y"};c.prototype.setPosition=function(a,
b){this._scrollbar.setPosition(a,b)};c.prototype.setContentSize=function(a){this._scrollbar.setContentSize(a)};c.prototype.setBgColor=function(a){this._scrollbar.setXAxisColor(a);this._scrollbar.setYAxisColor(a)};c.prototype.setColor=function(a){this._scrollbar.setXThumbColor(a);this._scrollbar.setYThumbColor(a)};c.prototype.setSize=function(a){this._axisSize=a;this._scrollbar.setXAxisSize(a);this._scrollbar.setYAxisSize(a)};c.prototype.setAlwaysShowTracks=function(a){this._scrollbar.options.alwaysShowTracks=
a};c.prototype.getContainerSize=function(){return this._scrollbar.getSize().container};c.prototype.getContentSize=function(){return this._scrollbar.getSize().content};c.prototype.getLimit=function(){return this._scrollbar.limit};c.prototype.scrollTo=function(a,b){this._scrollbar.scrollTo(a,b)};c.prototype.update=function(){this._scrollbar.update()};c.prototype.getAxisSize=function(){return this._axisSize};c.prototype.getOffset=function(){return this._scrollbar.offset};c.prototype.getContentEl=function(){return this._scrollbar.contentEl};
c.prototype.getContainerEl=function(){return this._scrollbar.containerEl};c.prototype.getScrollTop=function(){return this._scrollbar.scrollTop};c.prototype.getScrollLeft=function(){return this._scrollbar.scrollLeft};c.prototype.destroy=function(){this._scrollbar.destroy()};return c}(),W;(function(c){c[c.ALL=0]="ALL";c[c.TOP=1]="TOP";c[c.BOTTOM=2]="BOTTOM";c[c.LEFT=3]="LEFT";c[c.RIGHT=4]="RIGHT"})(W||(W={}));var pe=function(){function c(){}c.prototype.createTableRowElement=function(a,b){var e=document.createElement("div"),
c=a.getGLColProps(),d=a.getGridColsNumber(),f=a.getGridSize(),f=b.getWidgetsInColsIdx(f),k=a.getRowProps(b.getType()).minHeight,g=0,m=0;e.classList.add("jm-gr-row");e.style.width="100%";e.style.height=k+"px";for(e.style.backgroundColor=b.getBgColor();g<d;){var k=f[g+1],n=a.getGridSize(),l=void 0!==k?k.getColSpan(n):1,n=void 0!==k?k.getGridPosition(n).cOcc:g+1,p=c[n-1+l].colPos-c[n-1].colPos,r=document.createElement("div");r.classList.add("jm-gr-cell");r.dataset.colStart=String(n);r.dataset.colEnd=
String(n+l-1);r.style.left=m+"px";r.style.width=p+"px";r.style.height="100%";k&&(r.style.backgroundColor=k.getLayout().lBgColor);e.appendChild(r);g+=k?l:1;m+=p}return e};c.prototype.applyRowElementStyles=function(a,b){var e=b.getGraphicGridRow(),c=b.getTStroke(),d=b.getBStroke(),f=b.getTStrokeColor(),k=b.getBStrokeColor(),g=a.currSelRow;b.getIndex()===g?this.applySelectionColor(b):this.restoreOriginalColor(b);e.style.top=b.getGeometryTop()+"px";for(var m=0;m<e.children.length;m++){var n=e.children[m],
l=Number(n.dataset.colStart)-1,p=Number(n.dataset.colEnd)-1,l=a.getGLColProps()[l],p=a.getGLColProps()[p];n.style.borderTop=c+"px solid "+f;n.style.borderBottom=d+"px solid "+k;n.style.borderLeft=l.lStroke+"px solid "+l.lStkColor;n.style.borderRight=p.rStroke+"px solid "+p.rStkColor}-1!==g&&(b.getIndex()===g?this.changeStrokeColor(b,W.ALL,b.getSelStkColor()):b.getIndex()===g-1&&a.isGlobalStrokeCollaptionActive()?this.changeStrokeColor(b,W.BOTTOM):b.getIndex()===g+1&&a.isGlobalStrokeCollaptionActive()&&
this.changeStrokeColor(b,W.TOP))};c.prototype.applyExternalBorderStyles=function(a){var b=a.getGridProperties();a.setTableBorder(b.grGStkWidth+"px solid "+b.grGStkColor)};c.prototype.changeStrokeColor=function(a,b,e){for(var c=a.getGraphicGridRow(),d=0;d<c.children.length;d++){var f=c.children[d];switch(b){case W.ALL:case W.TOP:f.style.borderTopColor=null==e?a.getTStrokeColor():e;case W.ALL:case W.BOTTOM:f.style.borderBottomColor=null==e?a.getBStrokeColor():e;case W.ALL:case W.LEFT:0==d&&(f.style.borderLeftColor=
null==e?a.getLStrokeColor():e);case W.ALL:case W.RIGHT:d==c.children.length-1&&(f.style.borderRightColor=null==e?a.getRStrokeColor():e)}}};c.prototype.applySelectionColor=function(a){for(var b=a.getSelBgColor(),e=a.getGraphicGridRow().children,c=0;c<e.length;c++)e[c].classList.add("jm-dynamic-grid-cellbg-sel");a.getGraphicGridRow().style.backgroundColor=b};c.prototype.restoreOriginalColor=function(a){for(var b=a.getBgColor(),e=a.getGraphicGridRow().children,c=0;c<e.length;c++)"none"==b?e[c].classList.remove("jm-dynamic-grid-cellbg-sel"):
e[c].classList.add("jm-dynamic-grid-cellbg-sel");a.getGraphicGridRow().style.backgroundColor="none"==b?"transparent":b};c.prototype.changeRowBackgroundColor=function(a){var b=a.getSelRowIndex(),e=a.getPrevSelRowIndex(),c=a.getRowAtIndex(e),d=a.getRowAtIndex(b),f=a.getRowAtIndex(b-1),k=a.getRowAtIndex(b+1),g=a.getRowAtIndex(e-1),m=a.getRowAtIndex(e+1);b!=e&&(null!=d&&(this.applySelectionColor(d),this.changeStrokeColor(d,W.ALL,d.getSelStkColor())),null!=c&&(this.restoreOriginalColor(c),this.changeStrokeColor(c,
W.ALL),null!=d&&a.isGlobalStrokeCollaptionActive()&&(g&&g.getIndex()!=d.getIndex()&&this.changeStrokeColor(g,W.BOTTOM),m&&m.getIndex()!=d.getIndex()&&this.changeStrokeColor(m,W.TOP))),a.isGlobalStrokeCollaptionActive()&&(f&&this.changeStrokeColor(f,W.BOTTOM),k&&this.changeStrokeColor(k,W.TOP)))};return c}();g.export("DynamicTableGrid",pe);var ac=function(){function c(){this._row=0;this._rowWidgets=[];this._graphicGridRow=null;this._rStrokeWidth=this._lStrokeWidth=this._bStrokeHeight=this._tStrokeHeight=
0;this._rStrokeColor=this._lStrokeColor=this._bStrokeColor=this._tStrokeColor="";this._rowType=-1;this._protoRStroke=this._protoLStroke=this._protoBStroke=this._protoTStroke=0;this._protoRStrokeColor=this._protoLStrokeColor=this._protoBStrokeColor=this._protoTStrokeColor="";this._rowGeometryHeight=this._height=this._rowGeometryTop=this._top=0;this._selStkColor=this._selFgColor=this._selBgColor=this._bgColor="";this._fgSelectionRow=this._bgSelectionRow=null;this._dynamicLinks=[];this._dynamicXForms=
[];this.isHeader=this.isGridInDOM=this.isWgtsInDOM=!1;this.isFree=!0}c.prototype.setIndex=function(a){this._row=a};c.prototype.setWidgets=function(a){this._rowWidgets=a};c.prototype.setType=function(a){this._rowType=a};c.prototype.setGraphicGridRow=function(a){this._graphicGridRow=a};c.prototype.setBgRowSelection=function(a){this._bgSelectionRow=a};c.prototype.setFgRowSelection=function(a){this._fgSelectionRow=a};c.prototype.setTStroke=function(a){this._tStrokeHeight=a};c.prototype.setBStroke=function(a){this._bStrokeHeight=
a};c.prototype.setLStroke=function(a){this._lStrokeWidth=a};c.prototype.setRStroke=function(a){this._rStrokeWidth=a};c.prototype.setTStrokeColor=function(a){this._tStrokeColor=a};c.prototype.setBStrokeColor=function(a){this._bStrokeColor=a};c.prototype.setLStrokeColor=function(a){this._lStrokeColor=a};c.prototype.setRStrokeColor=function(a){this._rStrokeColor=a};c.prototype.setTop=function(a){this._top=a};c.prototype.setGeometryTop=function(a){this._rowGeometryTop=a};c.prototype.setHeight=function(a){this._height=
a};c.prototype.setGeometryHeight=function(a){this._rowGeometryHeight=a};c.prototype.setAsHeader=function(a){this.isHeader=a};c.prototype.setDynamicLinks=function(a){this._dynamicLinks=a};c.prototype.setDynamicXForms=function(a){this._dynamicXForms=a};c.prototype.setBgColor=function(a,b){this._bgColor=b?b:a.getGridRowsProps()[this.getType()].bgColor};c.prototype.setSelBgColor=function(a){this._selBgColor=a.getGridRowsProps()[this.getType()].selBgColor};c.prototype.setSelFgColor=function(a){this._selFgColor=
a.getGridRowsProps()[this.getType()].selFgColor};c.prototype.setSelStrokeColor=function(a){this._selStkColor=a.getGridRowsProps()[this.getType()].selStkColor};c.prototype.setStrokes=function(a){var b=a.getGridRowsProps()[this.getType()],e=b.tStroke,b=b.bStroke,c=a.getGridColsProps(),d=a.getGridColsNumber();a=c[0].lStroke;c=c[d-1].rStroke;this._protoTStroke=e;this._protoBStroke=b;this._protoLStroke=a;this._protoRStroke=c;this.setTStroke(e);this.setBStroke(b);this.setLStroke(a);this.setRStroke(c)};
c.prototype.setStrokesColors=function(a){var b=a.getGridRowsProps()[this.getType()],e=b.tStkColor,b=b.bStkColor,c=a.getGridColsProps(),d=a.getGridColsNumber();a=c[0].lStkColor;c=c[d-1].rStkColor;this._protoTStrokeColor=e;this._protoBStrokeColor=b;this._protoLStrokeColor=a;this._protoRStrokeColor=c;this.setTStrokeColor(e);this.setBStrokeColor(b);this.setLStrokeColor(a);this.setRStrokeColor(c)};c.prototype.getIndex=function(){return this._row};c.prototype.getWidgets=function(){return this._rowWidgets};
c.prototype.getType=function(){return this._rowType};c.prototype.getGraphicGridRow=function(){return this._graphicGridRow};c.prototype.getBgSelectionRow=function(){return this._bgSelectionRow};c.prototype.getFgSelectionRow=function(){return this._fgSelectionRow};c.prototype.getTStroke=function(){return this._tStrokeHeight};c.prototype.getBStroke=function(){return this._bStrokeHeight};c.prototype.getLStroke=function(){return this._lStrokeWidth};c.prototype.getRStroke=function(){return this._rStrokeWidth};
c.prototype.getProtoTStroke=function(){return this._protoTStroke};c.prototype.getProtoBStroke=function(){return this._protoBStroke};c.prototype.getProtoLStroke=function(){return this._protoLStroke};c.prototype.getProtoRStroke=function(){return this._protoRStroke};c.prototype.getTStrokeColor=function(){return this._tStrokeColor};c.prototype.getBStrokeColor=function(){return this._bStrokeColor};c.prototype.getLStrokeColor=function(){return this._lStrokeColor};c.prototype.getRStrokeColor=function(){return this._rStrokeColor};
c.prototype.getProtoTStrokeColor=function(){return this._protoTStrokeColor};c.prototype.getProtoBStrokeColor=function(){return this._protoBStrokeColor};c.prototype.getProtoLStrokeColor=function(){return this._protoLStrokeColor};c.prototype.getProtoRStrokeColor=function(){return this._protoRStrokeColor};c.prototype.getTop=function(){return this._top};c.prototype.getGeometryTop=function(){return this._rowGeometryTop};c.prototype.getHeight=function(){return this._height};c.prototype.getGeometryHeight=
function(){return this._rowGeometryHeight};c.prototype.getSelBgColor=function(){return this._selBgColor};c.prototype.getSelFgColor=function(){return this._selFgColor};c.prototype.getSelStkColor=function(){return this._selStkColor};c.prototype.getBgColor=function(){return this._bgColor};c.prototype.getDynamicLinks=function(){return this._dynamicLinks};c.prototype.getDynamicXForms=function(){return this._dynamicXForms};c.prototype.getWidgetsInColsIdx=function(a){for(var b={},e=0,c=this.getWidgets();e<
c.length;e++){var d=c[e];b[d.getGridPosition(a).cOcc]=d}return b};c.prototype.pushDynamicLink=function(a){this._dynamicLinks.push(a)};c.prototype.pushDynamicXForms=function(a){this._dynamicXForms.push(a)};return c}(),bd=function(){function c(){this._rows=[];this._iteratorIndex=0}c.prototype.incrementIterator=function(){this._iteratorIndex+=1};c.prototype.resetIterator=function(){this._iteratorIndex=0};c.prototype.getCurrentRow=function(){return this._rows[this._iteratorIndex]};c.prototype.getPreviousRow=
function(){return this._rows[this._iteratorIndex-1]};c.prototype.getNextRow=function(){return this._rows[this._iteratorIndex+1]};c.prototype.getRows=function(){return this._rows};c.prototype.getRowsLen=function(){return this._rows.length};c.prototype.getIteratorIndex=function(){return this._iteratorIndex};c.prototype.appendRow=function(a){this._rows.push(a)};c.prototype.insertRow=function(a){this._rows.push(a);this._iteratorIndex=this._rows.length-1};c.prototype.swapRow=function(a){this.spliceRow(this._iteratorIndex,
0,a);this._rows.pop()};c.prototype.spliceRow=function(a,b,e){null==e?this._rows.splice(a,b):this._rows.splice(a,b,e)};return c}(),aa=new (function(){function c(){}c.prototype.getPropertyPathInfos=function(a,b){if(null!=a){var e=null,c=a.split("."),d=c[c.length-1];c.pop();c=c.join(".");""===c?e=b:"GroupWgt"==b.getJMType()&&(e="."==c[0]||"*"==c[0]?b.findWgt(b,c):b.findWgt(b,b.studioId+"."+c));return{w:e,p:d}}return null};c.prototype.createDataLink=function(a,b,e,c,d,f,k){f.isTagString()?(a=g.createDataLink(b,
null,{attr:d}),a.readFromString(f.getStringTagValue())):a=g.createDataLink(b,e,c);a.update();a.mount();return a};c.prototype.generateDataLink=function(a,b,e,c,d){var f=null,k=null;c.isTagString()||(f=c.getSourceWgt(),k={rw:c.getMode(),attr:e,tag:c.getTagName(),srcType:g.activeProject.getSrcType(f),dataSource:f.studioId,tagIndex:c.getTagIndex(),xforms:[],wT:"Project"==f.getWidgetType()?0:1});return this.createDataLink(a,b,f,k,e,c,d)};c.prototype.setWgtValue=function(a,b,e){a.setValue(b,e.getValue(),
null,null)};c.prototype.getWgtValue=function(a,b){return a.getValue(b)};c.prototype.getWgtTextIds=function(a){return a.getCloneTextIds()};c.prototype.setWgtTextIds=function(a,b){a.setCloneTextIds(b)};c.prototype.clonePrototypes=function(a,b,e){a.setOutOfViewPrototypes(b,e);a.setViewMap({});var c=e.endIndex;for(e=e.startIndex;e<c;e++){a.updateRowPrototypes(b,e);var d=a.getRowType(e+1),d=a.getRowPrototypesByRowType(d),f=d.getCurrentRow();if(f.isFree){var k=b.hasHeader()?e+2:e+1;a.setPreviousRow(k);
a.setNextRow(k);a.addNewRow(b,f,e)}a.updateViewMap(f);d.incrementIterator()}a.subscribeDynamicModelTags();b.renderView()};c.prototype.cloneWgt=function(a,b){return a.clone(b)};c.prototype.destroyWgt=function(a){a.destroy()};c.prototype.getSourceWgt=function(a,b){return a.getProject().getWidget(b,!0)};c.prototype.getXFormById=function(a){return g.getFocusPage().getXForm(a)};c.prototype.registerXForm=function(a,b){a.pushDynamicXForms(b);if(b.dataLinks)for(var e in b.dataLinks)a.pushDynamicLink(b.dataLinks[e])};
c.prototype.registerLink=function(a,b){a.pushDynamicLink(b);if(b.xforms)for(var e in b.xforms)this.registerXForm(a,b.xforms[e])};c.prototype.destroyDynamicData=function(a,b){for(var e=b.getDynamicLinks(),c=b.getDynamicXForms(),d=g.getFocusPage(),f=0;f<e.length;f++){var k=e[f];k.dataSrc&&"TagMgrWgt"==k.dataSrc.getJMType()&&a.tagsToUnsubscribe.push(k.tag);k.unmount();d.unregisterLink(k)}for(e=0;e<c.length;e++)c[e].destroy();b.setDynamicLinks([]);b.setDynamicXForms([]);a.unsubscribeDynamicModelTags()};
c.prototype.hasPropInDatalinks=function(a,b){for(var e=0,c=["Text"];e<c.length;e++){var d=c[e];b["has"+d+"PropInDatalinks"]&&(b["has"+d+"PropInDatalinks"]=!1)}};c.prototype.changeMLTextIds=function(a){a.changeMLTextIds()};c.prototype.getLiveTagsVariables=function(a){a=a.getDataLinks();for(var b in a){var e=a[b],c=e.dataSrc;if(null!==c&&"TableTrendSrcWgt"===c.getJMType())return c.getSubTrendMLVariables(e.tag)}return null};c.prototype.getCurrentLangId=function(){return g.activeProject.getWidget("_MultiLangMgr",
!0).getCurrentLanguage()};c.prototype.getCurrentLangCode=function(){return g.activeProject.getWidget("_MultiLangMgr",!0).getCurrentLangCode()};c.prototype.hasListProperty=function(a){return"MsgTextWgt"===a.getJMType()||"ComboBoxWgt"===a.getJMType()};c.prototype.setWgtDynamicLinkedProperty=function(a,b){a.setDynamicLinkedProperty(b)};return c}()),qe=function(){function c(){this._rows=[]}c.prototype.setRowTop=function(a,b){a.top=b};c.prototype.setRowHeight=function(a,b){a.height=b};c.prototype.getRowTop=
function(a){return this._rows[a]?this._rows[a].top:null};c.prototype.getRowHeight=function(a){return this._rows[a]?this._rows[a].height:null};c.prototype.getRows=function(){return this._rows};c.prototype.pushRow=function(a){this._rows.push(a)};c.prototype.clear=function(){this._rows=[]};return c}(),re=function(){function c(a,b){this._isJSONObject=this._isTagString=!1;if(b instanceof Object){this._isTagString=b.v?!0:!1;this._isJSONObject=!0;switch(b._c){case "dl":this._type=0;break;case "f":this._type=
1;break;case "ml":this._type=2}this._isTagString?this._stringTagValue=b.v:(this._mltext=b.mltext,this._tagName=b.a,this._tagIndex=b.i,this._mode=2!=b.m?0==b.m?"r":"w":"rw",this._sourceWgt=aa.getSourceWgt(a,b.s),this._xForm=b.xForm)}else this._value=b}c.prototype.isTagString=function(){return this._isTagString};c.prototype.isJSONObject=function(){return this._isJSONObject};c.prototype.getTagName=function(){return this._tagName};c.prototype.getTagIndex=function(){return this._tagIndex};c.prototype.getMode=
function(){return this._mode};c.prototype.getSourceWgt=function(){return this._sourceWgt};c.prototype.getStringTagValue=function(){return this._stringTagValue};c.prototype.getValue=function(){return this._value};c.prototype.getType=function(){return this._type};c.prototype.getMlText=function(){return this._mltext};c.prototype.getXForm=function(){return this._xForm};return c}(),oc;(function(c){c[c.DATALINK=0]="DATALINK";c[c.FILTER=1]="FILTER";c[c.MULTILANGUAGE=2]="MULTILANGUAGE"})(oc||(oc={}));var se=
function(){function c(){this._model=[];this._tableHeaderHeight=0;this._rowPrototypes=[];this._m_rowPrototypes=[];this._viewMap={};this._header=null;this._texts={};this._endIndex=this._startIndex=this._totalHeight=0;this._nextRowInView=this._previousRowInView=null;this.tagsToSubscribe=[];this.tagsToUnsubscribe=[];this.freeRows=[];this.debounceTime=500;this._m_table=new qe}c.prototype.setViewMap=function(a){this._viewMap=a};c.prototype.getMinRowsIndex=function(){return 0};c.prototype.getMaxRowsIndex=
function(){return this.hasHeader()?this._model.length-2:this._model.length-1};c.prototype.getStartIndex=function(){return this._startIndex};c.prototype.getEndIndex=function(){return this._endIndex};c.prototype.getTotalHeight=function(){return this._totalHeight};c.prototype.getViewMap=function(){return this._viewMap};c.prototype.getTableGeometryMap=function(){return this._m_table};c.prototype.getRowIndexByRowYPosition=function(a){return this.lowerBound({type:null,top:a,height:0})-1};c.prototype.getRowPrototypesByRowType=
function(a){return this._m_rowPrototypes[a]};c.prototype.getText=function(a,b){return this._texts[b.wgtId]&&this._texts[b.wgtId][a]?this._texts[b.wgtId][a][aa.getCurrentLangId()]:null};c.prototype.getRowAtIndex=function(a){var b=this.getViewMap();return null!=b[a]?b[a]:null};c.prototype.getRowsNumber=function(){return this._m_table.getRows().length};c.prototype.getHeader=function(){return this._header};c.prototype.getHeaderHeight=function(){return this._tableHeaderHeight};c.prototype.setNewHeader=
function(a){this._model[1]=a;this._header=null};c.prototype.hasHeader=function(){return null==this._model[1]?!1:this._model[1]._h};c.prototype.getRowType=function(a){this.hasHeader()&&(a+=1);if(null==this._model[a])throw c.ERROR_MSGS.MODEL_ROW_IDX_ERROR;if(null==this._model[a]._t)throw c.ERROR_MSGS.MODEL_ROW_KEY_ERROR;return this._model[a]._t};c.prototype.getRowValue=function(a){this.hasHeader()&&(a+=1);if(null==this._model[a])throw c.ERROR_MSGS.MODEL_ROW_IDX_ERROR;if(null==this._model[a]._v)throw c.ERROR_MSGS.MODEL_ROW_KEY_ERROR;
return this._model[a]._v};c.prototype.getRowBgColor=function(a){this.hasHeader()&&(a+=1);if(null==this._model[a])throw c.ERROR_MSGS.MODEL_ROW_IDX_ERROR;return this._model[a]._bg};c.prototype.getRowPropsHeader=function(){if(null==this._model[0])throw c.ERROR_MSGS.MODEL_ROW_IDX_ERROR;if(null==this._model[0]._h)throw c.ERROR_MSGS.MODEL_ROW_KEY_ERROR;return this._model[0]._h};c.prototype.getHeaderRowType=function(){return this._model[1]._t};c.prototype.getHeaderRowValue=function(){return this._model[1]._v};
c.prototype.getHeaderRowBgColor=function(){return this._model[1]._bg};c.prototype.getDynamicGridRow=function(a,b){return a.getDynamicGrid().createTableRowElement(a,b)};c.prototype.initNewPrototypes=function(a){var b=a.getGridRowsNumber();this._m_rowPrototypes=[];this._rowPrototypes=[];for(var e=0;e<b;e++){var c=new ac,d=new bd,f=a.getWidgetsOfRow(e+1);this._m_rowPrototypes[e]=d;c.isFree=!0;c.setIndex(-1);c.setWidgets(f);c.setType(e);c.setStrokes(a);c.setStrokesColors(a);c.setBgColor(a);c.setSelBgColor(a);
c.setSelFgColor(a);c.setSelStrokeColor(a);c.setGraphicGridRow(this.getDynamicGridRow(a,c));this._m_rowPrototypes[e]=new bd;this._m_rowPrototypes[e].appendRow(this.cloneRow(a,c,0));this._rowPrototypes.push(c)}};c.prototype.getRowPrototypesHeights=function(a){a=a.getGridRowsProps();var b=[],e;for(e in a)b.push(a[e].minHeight);return b};c.prototype.getRowPrototypeHeight=function(a,b){return this.getRowPrototypesHeights(a)[b]};c.prototype.defineNewGeometry=function(a){var b=0,e=this.getRowPrototypesHeights(a);
this._model=a.getProxyModel();this._totalHeight=0;this._m_table.clear();var c=nc(this._model);this.hasHeader()&&(this._tableHeaderHeight=e[this.getHeaderRowType()],c.splice(1,1));for(var d=0,c=c.length;d<c-1;d++){var f=this.getRowType(d+1),f={type:f,top:b,height:e[f]};this._m_table.pushRow(f);b+=this.hasHeader()?f.height:f.height+this._tableHeaderHeight;this._totalHeight+=f.height}a.setScrollContentSize(null,this._totalHeight)};c.prototype.setLastRowStrokesProperties=function(a,b){var e=a.getGlobalStrokeWidth(),
c=a.getGlobalStrokeColor(),d=b.getProtoBStroke(),f=b.getProtoBStrokeColor();b.setBStroke(d);e>=d?b.setBStrokeColor(c):b.setBStrokeColor(f)};c.prototype.setFirstRowStrokesProperties=function(a,b){var e=a.getGlobalStrokeWidth(),c=a.getGlobalStrokeColor(),d=b.getProtoTStroke(),f=b.getProtoTStrokeColor();b.setTStroke(d);e>=d?b.setTStrokeColor(c):b.setTStrokeColor(f)};c.prototype.setInTheMiddleRowStrokesProperties=function(a,b,e,c){var d=b.getProtoTStroke(),f=b.getProtoBStroke(),k=!1,g=!1;if(null!=e){var m=
e.getProtoBStroke(),n=e.getBStroke(),l=Math.max(d,m)/2;n!=l&&(e.setBStroke(Math.floor(l)),k||(k=!0));d!=l&&b.setTStroke(Math.ceil(l));n=b.getProtoTStrokeColor();l=e.getProtoBStrokeColor();m>d?(b.setTStrokeColor(l),e.setBStrokeColor(l)):(e.setBStrokeColor(n),b.setTStrokeColor(n),k||(k=!0))}null!=c&&(d=c.getProtoTStroke(),m=c.getTStroke(),n=Math.max(f,d)/2,m!=n&&(c.setTStroke(Math.ceil(n)),g||(g=!0)),f!=n&&b.setBStroke(Math.floor(n)),m=b.getProtoBStrokeColor(),n=c.getProtoTStrokeColor(),d>f?(b.setBStrokeColor(n),
c.setTStrokeColor(n)):(c.setTStrokeColor(m),b.setBStrokeColor(m),g||(g=!0)));k&&a.addTableRow(e);g&&a.addTableRow(c)};c.prototype.setRowStrokesProperties=function(a,b,e,c){var d=this._m_table.getRows().length-1,f=b.getIndex();0==f&&this.setFirstRowStrokesProperties(a,b);f==d&&this.setLastRowStrokesProperties(a,b);this.setInTheMiddleRowStrokesProperties(a,b,e,c)};c.prototype.rectifyRowBounds=function(a,b){var e=b.isHeader?null:this._previousRowInView,c=b.isHeader?null:this._nextRowInView;a.isGlobalStrokeCollaptionActive()&&
this.setRowStrokesProperties(a,b,e,c)};c.prototype.setRowBgColor=function(a,b,e){(e?this.getHeaderRowBgColor():this.getRowBgColor(b.getIndex()+1))?e?b.setBgColor(a,this.getHeaderRowBgColor()):b.setBgColor(a,this.getRowBgColor(b.getIndex()+1)):b.setBgColor(a,b.getBgColor())};c.prototype.lowerBound=function(a){for(var b=this._m_table.getRows(),e=0;e<b.length&&!(b[e].top>a.top);e++);return e};c.prototype.getMinMaxIndex=function(a,b){for(var e=this.lowerBound({type:null,top:a,height:0}),c=e,d=this._m_table.getRows();c<
d.length&&this._m_table.getRowTop(c)<b;c++);e=Math.max(e-1,0);return{startIndex:e,endIndex:c}};c.prototype.getComputedIndexes=function(a,b){var e=a.getPrecachedPages(),c=aa.getWgtValue(a,"height"),d=a.getGlobalStrokeWidth(),e=.5*e*c;return this.getMinMaxIndex(b-d-e,b+(c-this._tableHeaderHeight)+e+d)};c.prototype.setOutOfViewPrototypes=function(a,b){for(var e=b.startIndex,c=b.endIndex,d=0;d<this._m_rowPrototypes.length;d++){for(var f=this._m_rowPrototypes[d],k=f.getRows(),g=0;g<f.getRowsLen();){var m=
k[g],n=m.getIndex();if(m.isFree)break;if(n<e)a.removeTableRow(m),m.isFree=!0,m.setIndex(-1),this.removeRowWgtsTextIds(m),f.appendRow(m),f.spliceRow(g,1);else{if(n>=c){for(;g<f.getRowsLen();g++)m=k[g],a.removeTableRow(m),m.isFree=!0,m.setIndex(-1),this.removeRowWgtsTextIds(m);break}g++}}f.resetIterator()}a.deactivateDelegates()};c.prototype.cloneHeaderRow=function(a,b){var e=new ac,c=b.getWidgets(),d=[],f;for(f in c){var k=c[f],g={ext:"cl_header",tableGroupWgt:a,isInHeader:!0};Object.assign(g,aa.getLiveTagsVariables(k),
{liveTags:!0});d.push(aa.cloneWgt(k,g))}e.setAsHeader(!0);e.setType(b.getType());e.setStrokes(a);e.setStrokesColors(a);e.setBgColor(a);e.setSelBgColor(a);e.setSelFgColor(a);e.setSelStrokeColor(a);e.setWidgets(d);e.setGraphicGridRow(this.getDynamicGridRow(a,b));return e};c.prototype.cloneRow=function(a,b,e){var c=new ac,d=b.getWidgets(),f=[],k;for(k in d){var g=d[k],m=g.getLayout().cOcc;f.push(aa.cloneWgt(g,{ext:"cl"+e+""+m,tableGroupWgt:a,isInHeader:!1}))}c.setAsHeader(!1);c.setType(b.getType());
c.setStrokes(a);c.setStrokesColors(a);c.setBgColor(a);c.setSelBgColor(a);c.setSelFgColor(a);c.setSelStrokeColor(a);c.setWidgets(f);c.setGraphicGridRow(this.getDynamicGridRow(a,b));return c};c.prototype.removeRowWgtsTextIds=function(a){a=a.getWidgets();for(var b in a){var e=a[b];void 0!==this._texts[e.wgtId]&&delete this._texts[e.wgtId]}};c.prototype.escapeString=function(a){return a.replace(/(\\\[)/g,"\\\\[").replace(/(\\\])/g,"\\\\]")};c.prototype.getHeaderRowProps=function(a,b){return this.getRowPropsHeader()[a][b]};
c.prototype.getLastPropIndex=function(a,b){if(0==b)return 0;for(var e=this.getRowPropsHeader()[a],c=0,d=0;d<b;d++)for(var f=0;f<e[d].length;f++)c++;return c++};c.prototype.activateWidget=function(a,b,e,c){a.getGridSize();var d=e.getIndex(),f=e.isHeader?this.getHeaderRowType():this.getRowType(d+1),d=e.isHeader?this.getHeaderRowValue():this.getRowValue(d+1),k=this.getHeaderRowProps(f,c);c=this.getLastPropIndex(f,c);for(f=0;f<k.length;f++){var g=k[f],m=new re(a,d[c+f]);if(null!=m){var n=aa.getPropertyPathInfos(g,
b),g=n.w,n=n.p;aa.setWgtDynamicLinkedProperty(g,n);if(m.isJSONObject())switch(m.getType()){case oc.DATALINK:m=aa.generateDataLink(a,g,n,m,e),aa.registerLink(e,m),m.dataSrc&&"TagMgrWgt"==m.dataSrc.getJMType()&&this.tagsToSubscribe.push(m.tag)}else aa.setWgtValue(g,n,m)}}};c.prototype.activateRowWidgets=function(a,b){for(var e=b.getWidgets(),c=0;c<e.length;c++){var d=e[c];d&&this.activateWidget(a,d,b,c)}};c.prototype.activateRow=function(a,b,e){b.isFree=!1;b.setIndex(e);aa.destroyDynamicData(this,b);
this.activateRowWidgets(a,b)};c.prototype.subscribeDynamicModelTags=function(){var a=this,b;if(0<this.tagsToSubscribe.length){var e=g.import("_debounce");null===(b=this.debounce)||void 0===b?void 0:b.cancel();this.debounce=e(function(){g.activeProject.getTagMgr().subscribeForTagsNotification(a.tagsToSubscribe);a.tagsToSubscribe=[]},this.debounceTime);this.debounce()}};c.prototype.unsubscribeDynamicModelTags=function(){var a=this,b;if(0<this.tagsToUnsubscribe.length){var e=g.import("_debounce");null===
(b=this.debounce)||void 0===b?void 0:b.cancel();this.debounce=e(function(){g.activeProject.getTagMgr().unsubscribeForTagsNotification(a.tagsToUnsubscribe);a.tagsToUnsubscribe=[]},this.debounceTime);this.debounce()}};c.prototype.installTableHeader=function(a){if(this.hasHeader()){var b=new ac,e=a.getWidgetsOfRow(1);b.isFree=!1;b.setIndex(null);b.setWidgets(e);b.setType(0);b.setStrokes(a);b.setStrokesColors(a);b.setBgColor(a);b.setSelBgColor(a);b.setSelFgColor(a);b.setSelStrokeColor(a);b.setGraphicGridRow(this.getDynamicGridRow(a,
b));b=this.cloneHeaderRow(a,b);this.activateRowWidgets(a,b);this.rectifyRowBounds(a,b);this.setRowBgColor(a,b,!0);this._header=b;a.addTableHeaderRow(b)}};c.prototype.updateRowPrototypes=function(a,b){var e=this.getRowType(b+1),c=this.getRowPrototypesByRowType(e);if(c){var d=c.getRowsLen(),e=this._rowPrototypes[e],f=c.getIteratorIndex();if(f===c.getRowsLen())c.insertRow(this.cloneRow(a,e,d));else{var k=c.getCurrentRow();k.isFree||k.getIndex()===b||(k=c.getRows()[d-1],k.isFree?c.swapRow(k):c.spliceRow(f,
0,this.cloneRow(a,e,d)))}}};c.prototype.setPreviousRow=function(a){if((a=this._model[a-1])&&void 0!==a._t&&(a=this.getRowPrototypesByRowType(a._t).getPreviousRow(),void 0!==a&&-1!==a.getIndex())){this._previousRowInView=a;return}this._previousRowInView=null};c.prototype.setNextRow=function(a){if((a=this._model[a+1])&&void 0!==a._t&&(a=this.getRowPrototypesByRowType(a._t).getNextRow(),void 0!==a&&-1!==a.getIndex())){this._nextRowInView=a;return}this._nextRowInView=null};c.prototype.addNewRow=function(a,
b,e){this.activateRow(a,b,e);a.addTableRow(b);this.rectifyRowBounds(a,b);this.setRowBgColor(a,b,!1)};c.prototype.updateViewMap=function(a){this._viewMap[a.getIndex()]=a};c.prototype.hasValidStartIndex=function(a){return a<this.getMinRowsIndex()||a>this.getMaxRowsIndex()?!1:!0};c.prototype.hasValidEndIndex=function(a){return a<this.getMinRowsIndex()||a>this.getMaxRowsIndex()?!1:!0};c.prototype.hasNewIndexes=function(a){return a.startIndex!==this._startIndex||a.endIndex!==this._endIndex};c.prototype.enableCloning=
function(a,b){return(this.hasNewIndexes(a)||b)&&this.hasValidStartIndex(a.startIndex)&&this.hasValidEndIndex(a.endIndex)};c.prototype.startCloning=function(a,b,e){return this.enableCloning(b,e)?(this._startIndex=b.startIndex,this._endIndex=b.endIndex,aa.clonePrototypes(this,a,b),!0):!1};c.prototype.scrollTo=function(a,b,e){return this.startCloning(a,this.getComputedIndexes(a,b),e)};c.prototype.destroyBodyDelegates=function(){for(var a=0;a<this._m_rowPrototypes.length;a++)for(var b=this._m_rowPrototypes[a].getRows(),
e=0;e<b.length;e++){var c=b[e],d=c.getWidgets();aa.destroyDynamicData(this,c);for(c=0;c<d.length;c++)d[c].isClone&&!d[c].destroyed&&aa.destroyWgt(d[c])}this._m_rowPrototypes=[]};c.prototype.destroyHeaderDelegates=function(){if(this._header){var a=this._header.getWidgets();aa.destroyDynamicData(this,this._header);for(var b=0;b<a.length;b++)a[b].isClone&&!a[b].destroyed&&aa.destroyWgt(a[b])}this._header=null};c.prototype.removeDelegatesFromRenderingQueue=function(a){var b=g.getRenderingQueue(),e;for(e in b){var c=
b[e].w;c.isClone&&c.tableGroupWgt.wgtId==a.wgtId&&g.removeFromRender(c)}};c.prototype.update=function(a){this.destroyHeaderDelegates();this.destroyBodyDelegates();this.removeDelegatesFromRenderingQueue(a);this._texts={};this._header=null;this.defineNewGeometry(a);this.initNewPrototypes(a);this.installTableHeader(a)};c.ERROR_MSGS={MODEL_NOT_FOUND:"Table widget: js model not found !",MODEL_ROW_IDX_ERROR:"Table widget: row does not exist at specified index !",MODEL_ROW_KEY_ERROR:"Table widget: row property not found !"};
return c}();g.export("TableGroupController",se);var cd=function(){function c(){this.style=document.getElementById("jm-dyn-style");null===this.style&&(this.style=document.createElement("style"),this.style.setAttribute("id","jm-dyn-style"),document.head.appendChild(this.style));this.sheet=this.style.sheet}c.prototype.selector=function(a,b){this.sheet.insertRule(a+" { "+b+" }",this.sheet.cssRules.length);return a};c.prototype.removeStyleRule=function(a){for(var b=this.sheet.cssRules,e=0,c=b.length;e<
c;e++){var d=b[e];if(1==d.type&&d.selectorText==a)return this.sheet.deleteRule(e),!0}return!1};c.prototype.removeKeyframesRule=function(a){for(var b=this.sheet.cssRules,e=0,c=b.length;e<c;e++){var d=b[e];if(7==d.type&&d.name==a)return this.sheet.deleteRule(e),!0}return!1};return c}(),va;(function(c){c[c.OPERATOR=0]="OPERATOR";c[c.LBRACKET=1]="LBRACKET";c[c.RBRACKET=2]="RBRACKET";c[c.GROUP_NAME=3]="GROUP_NAME"})(va||(va={}));var te=function(){function c(){this.buffer=null}c.prototype.tokenize=function(a){this.buffer=
a;for(var b=[],e=null,c=a.length,d=0;d<c;d++){var f=a.charAt(d);if(this.isOperator(f)||this.isBracket(f)){null!==e&&(b.push({type:va.GROUP_NAME,pos:{start:e,end:d-1}}),e=null);var k=void 0,k=this.isOperator(f)?va.OPERATOR:"("==f?va.LBRACKET:va.RBRACKET;b.push({type:k,pos:{start:d,end:d}})}else null==e&&(e=d)}null!==e&&b.push({type:va.GROUP_NAME,pos:{start:e,end:c-1}});return b};c.prototype.isOperator=function(a){return"|"==a||"&"==a};c.prototype.isBracket=function(a){return"("==a||")"==a};return c}();
g.addJSModule("GroupExpressionLexer",te);var ue=g.getJSModule("GroupExpressionLexer"),A;(function(c){c[c.EXPRESSION=0]="EXPRESSION";c[c.OPERATOR=1]="OPERATOR";c[c.LBRACKET=2]="LBRACKET";c[c.RBRACKET=3]="RBRACKET";c[c.ELEMENT=4]="ELEMENT";c[c.GROUPNAME=5]="GROUPNAME";c[c.END=6]="END";c[c.ACCEPT=7]="ACCEPT"})(A||(A={}));var F;(function(c){c[c.SHIFT=0]="SHIFT";c[c.REDUCE=1]="REDUCE";c[c.GOTO=2]="GOTO";c[c.ACCEPT=3]="ACCEPT"})(F||(F={}));var ve=function(){function c(){this.actions={};this.goto={};this.actions[0]=
{};this.actions[0][A.LBRACKET]=[F.SHIFT,4];this.actions[0][A.GROUPNAME]=[F.SHIFT,3];this.actions[1]={};this.actions[1][A.END]=[F.ACCEPT,0];this.actions[1][A.OPERATOR]=[F.SHIFT,5];this.actions[2]={};this.actions[2][A.END]=[F.REDUCE,2];this.actions[2][A.LBRACKET]=[F.REDUCE,2];this.actions[2][A.RBRACKET]=[F.REDUCE,2];this.actions[2][A.GROUPNAME]=[F.REDUCE,2];this.actions[2][A.OPERATOR]=[F.REDUCE,2];this.actions[3]={};this.actions[3][A.END]=[F.REDUCE,3];this.actions[3][A.LBRACKET]=[F.REDUCE,3];this.actions[3][A.RBRACKET]=
[F.REDUCE,3];this.actions[3][A.GROUPNAME]=[F.REDUCE,3];this.actions[3][A.OPERATOR]=[F.REDUCE,3];this.actions[4]={};this.actions[4][A.LBRACKET]=[F.SHIFT,4];this.actions[4][A.GROUPNAME]=[F.SHIFT,3];this.actions[5]={};this.actions[5][A.LBRACKET]=[F.SHIFT,4];this.actions[5][A.GROUPNAME]=[F.SHIFT,3];this.actions[6]={};this.actions[6][A.RBRACKET]=[F.SHIFT,8];this.actions[6][A.OPERATOR]=[F.SHIFT,5];this.actions[7]={};this.actions[7][A.END]=[F.REDUCE,1];this.actions[7][A.LBRACKET]=[F.REDUCE,1];this.actions[7][A.RBRACKET]=
[F.REDUCE,1];this.actions[7][A.GROUPNAME]=[F.REDUCE,1];this.actions[7][A.OPERATOR]=[F.REDUCE,1];this.actions[8]={};this.actions[8][A.END]=[F.REDUCE,4];this.actions[8][A.LBRACKET]=[F.REDUCE,4];this.actions[8][A.RBRACKET]=[F.REDUCE,4];this.actions[8][A.GROUPNAME]=[F.REDUCE,4];this.actions[8][A.OPERATOR]=[F.REDUCE,4];this.goto[0]={};this.goto[0][A.ELEMENT]=[F.GOTO,2];this.goto[0][A.EXPRESSION]=[F.GOTO,1];this.goto[4]={};this.goto[4][A.ELEMENT]=[F.GOTO,2];this.goto[4][A.EXPRESSION]=[F.GOTO,6];this.goto[5]=
{};this.goto[5][A.ELEMENT]=[F.GOTO,7]}c.prototype.parse=function(a){this.buffer=a;this.pos=0;this.parsedElements=[];this.groups=[];this.tokens=(new ue).tokenize(a);a=[0];for(var b=this.consumeToken();;){var e=a[a.length-1],e=this.actions[e][b.type],c=e[0],e=e[1];if(c==F.SHIFT)this.parsedElements.push(b),a.push(e),b=this.consumeToken();else if(c==F.REDUCE){for(var e=this.resoveRule(e),c=e[0],e=e[1],d=0;d<e;d++)a.pop();e=a[a.length-1];a.push(this.goto[e][c][1])}else{if(c==F.ACCEPT)return this.parsedElements[0].value;
this.throwSyntaxError();return null}}};c.prototype.resoveRule=function(a){var b;switch(a){case 0:return[A.ACCEPT,1];case 1:a=this.parsedElements.pop().value;b=this.parsedElements.pop().value;var e=this.parsedElements.pop().value;b=this.buffer.substring(b.pos.start,b.pos.end+1);b={type:A.OPERATOR,value:b,parent:null,children:[e,a]};e.parent=b;a.parent=b;this.parsedElements.push({type:A.EXPRESSION,value:b});return[A.EXPRESSION,3];case 2:return b=this.parsedElements.pop().value,this.parsedElements.push({type:A.EXPRESSION,
value:b}),[A.EXPRESSION,1];case 3:return a=this.parsedElements.pop().value,a=this.buffer.substring(a.pos.start,a.pos.end+1),this.groups.push(a),this.parsedElements.push({type:A.ELEMENT,value:{type:A.GROUPNAME,value:a,parent:null,children:null}}),[A.ELEMENT,1];case 4:return this.parsedElements.pop(),a=this.parsedElements.pop().value,this.parsedElements.pop(),this.parsedElements.push({type:A.ELEMENT,value:a}),[A.ELEMENT,3]}return null};c.prototype.mapToGPARSER_SYMBOLType=function(a){switch(a){case va.GROUP_NAME:return A.GROUPNAME;
case va.OPERATOR:return A.OPERATOR;case va.LBRACKET:return A.LBRACKET;case va.RBRACKET:return A.RBRACKET}};c.prototype.getGoupsList=function(){return this.groups};c.prototype.consumeToken=function(){if(this.pos>=this.tokens.length)return{type:A.END,value:null};var a=this.tokens[this.pos++];return{type:this.mapToGPARSER_SYMBOLType(a.type),value:a}};c.prototype.throwSyntaxError=function(){throw"Syntax Error: group expression is not well formed";};return c}();g.addJSModule("GroupExpressionParser",ve);
var we=g.getJSModule("GroupExpressionParser"),Ob=g.getJSModule("Group"),xe=function(){function c(a){this.parser=new we;this.srv=a}c.prototype.run=function(a,b,e){var c=this;this.input=a;this.groups=new Map;this.ast=this.parser.parse(a);a=this.parser.getGoupsList();if(e)return this.requestGroupsInformationAsync(a).then(function(a){a=c.resolveGroupExpression(a);b.setState(a.info.name,a.info.code,a.getTagArray());e(b.info.name,b)}),null;a=this.resolveGroupExpression(this.requestGroupsInformation(a));
return b.setState(a.info.name,a.info.code,a.getTagArray())};c.prototype.resolveGroupExpression=function(a){if(1==a.length)return a[0];for(var b=0;b<a.length;b++){var e=a[b];this.groups.set(e.info.name,e.getTagsMap())}a=this.excuteOperation(this.ast);return(new Ob).setState(this.input,"S_OK",a)};c.prototype.requestGroupsInformationAsync=function(a){for(var b=this,e=Array(a.length),c=0,d=a.length;c<d;c++)e[c]=new Ob;return this.srv.activateGroups(a,e,!1).then(function(){return b.srv.readGroups(a,e,
!1)})};c.prototype.requestGroupsInformation=function(a){for(var b=this,e=Array(a.length),c=0,d=a.length;c<d;c++)e[c]=new Ob;this.srv.activateGroups(a,e,!0).then(function(){return b.srv.readGroups(a,e,!0)});return e};c.prototype.excuteOperation=function(a){var b=a.children[0],e=a.children[1],b=b.type===A.GROUPNAME?this.getTags(b.value):this.excuteOperation(b),e=e.type===A.GROUPNAME?this.getTags(e.value):this.excuteOperation(e);switch(a.value){case "&":return this.and(b,e);case "|":return this.or(b,
e)}return{}};c.prototype.getTags=function(a){return this.groups.get(a)};c.prototype.and=function(a,b){var e={},c;for(c in a)b[c]&&(e[c]=a[c]);return e};c.prototype.or=function(a,b){var e={},c;for(c in a)e[c]=a[c];for(var d in b)e[d]=b[d];return e};return c}();g.addJSModule("GroupExpressionRunner",xe);var ye=function(){function c(){this.mapVarInText=this.mapVarToDataLink=this.mapDatalinkToVar=null;this.variableIndex=0}c.prototype.setMap=function(a){this.mapVarInText=a};c.prototype.canBePresentLiveTags=
function(a){return-1!=a.indexOf("[")&&-1!=a.indexOf("]")};c.prototype.getVariablesMap=function(){return this.mapVarInText};c.prototype.getVariables=function(){return this.mapVarToDataLink};c.prototype.parseTextVariables=function(a,b){if(-1==a.indexOf("["))return[a];this.mapVarInText={};for(var e="",c="",d=!1,f=!1,k=0,g=[],m=0,n=a.length;m<n;m++){var l=a.charAt(m);switch(l){case "[":f?(d?c+="\\"+l:e+=l,f=!1):(d?c+=l:(d=!0,g.push(e),e=""),k++);break;case "]":f?(d?c+="\\"+l:e+=l,f=!1):(k--,d&&0===k?
(c=this.addVariables(this.convertArrayDotNotationToBrackets(c)),g.push(c),this.addToMap(c,b),c="",d=!1):c+=l);break;case "\\":f?(d?c+=l:e+=l,f=!1):f=!0;break;default:f&&(d?c+="\\":e+="\\"+l,f=!1),d?c+=l:e+=l}}""!==e&&g.push(e);return g};c.prototype.addVariables=function(a){this.mapDatalinkToVar||(this.mapDatalinkToVar={},this.mapVarToDataLink={});var b=this.mapDatalinkToVar[a];b||(b="${"+this.variableIndex+"}",this.mapDatalinkToVar[a]=b,this.mapVarToDataLink[b]=a,this.variableIndex++);return b};c.prototype.addToMap=
function(a,b){null===b&&(b="NL");var e=this.mapVarInText[b];e||(e=[],this.mapVarInText[b]=e);e.push(a)};c.prototype.convertArrayDotNotationToBrackets=function(a){var b=a.indexOf(":");if(-1!=b)return a;var e=a.indexOf(".");if(-1==e)return a;var c=a.indexOf("|"),b=b>c?b:c;return 0<=b&&e>b?a:0<e?(b=-1==b?a.length-1:b,c=a.substring(0,e),e=a.substring(e+1,b+1),b<a.length-1?c+"["+e+"]"+a.substring(b,a.length):c+"["+e+"]"):a};return c}();g.export("TextLiveTagParser.ts",ye);var ze=function(){function c(a){this._value=
a}c.of=function(a){return new c(a)};c.prototype.map=function(a){return pc.of(a(this._value))};c.prototype.value=function(){return this._value};c.prototype.chain=function(a){return this.map(a).value()};c.prototype.isNone=function(){return!1};return c}(),Ae=function(){function c(a){}c.of=function(a){return new c};c.prototype.map=function(a){return this};c.prototype.value=function(){return null};c.prototype.chain=function(a){return null};c.prototype.isNone=function(){return!0};return c}(),pc={of:function(c){return null===
c||void 0===c?Ae.of(null):ze.of(c)}},Be=pc;g.export("/DesignPatterns/Maybe.ts",pc);(function(c){var a=c.import("/DesignPatterns/Maybe.ts"),b=function(){function b(a){this.tags={};this.server=a?a:null;this.nSubscription=this.size=0}b.prototype.setServerInterface=function(b){this.server=b};b.prototype.addTag=function(b){a.of(this.tags[b]).isNone()?(this.tags[b]={counter:1,subscribed:!1},this.size++):this.tags[b].counter++};b.prototype.removeTag=function(b){var e=a.of(this.server);if(!e.isNone()){var c=
a.of(this.tags[b]);if(c.isNone())return!1;c=c.value();0==--c.counter&&(c.subscribed&&(e.value().unsubscribeTags([b]),this.nSubscription--),delete this.tags[b],this.size--);return!0}return!1};b.prototype.subscribeTags=function(){if(this.server&&0<this.size&&this.nSubscription<this.size){var b=[],a;for(a in this.tags){var e=this.tags[a];e.subscribed||(b.push(a),e.subscribed=!0,this.nSubscription++)}this.server.subscribeTags(b)}};b.prototype.unsubscribeTags=function(b){if(this.server&&0<this.size){var a=
[],e;for(e in this.tags){var c=this.tags[e];c.subscribed&&(a.push(e),c.subscribed=!1,this.nSubscription--)}b&&(a=a.filter(b));0<a.length&&this.server.unsubscribeTags(a);return a}return null};b.prototype.isTagSubscribed=function(b){return(b=this.tags[b])?b.subscribed:!1};return b}();c.export("DynamicTagSubscriber.ts",b)})(t);var da;(function(c){c[c.BAR=0]="BAR";c[c.FULLSCREEN=1]="FULLSCREEN"})(da||(da={}));var Ce=function(){function c(a){this.iconSize={width:64,height:50};this.style=void 0!==a?a:da.BAR;
a==da.BAR?this.initBar():a==da.FULLSCREEN&&this.initFullScreen();this.visible=!1}c.prototype.initBar=function(){this.statusBar=document.querySelector(".jm-status-bar");this.y=0;this.size=c.minHeight};c.prototype.initFullScreen=function(){this.statusBar=document.createElement("div");this.statusBar.classList.add("jm-status-full-screen");this.statusBar.style.display="none";var a=document.createElement("div");a.classList.add("jm-no-connection-icon");this.statusBar.appendChild(a)};c.prototype.recalculateSize=
function(a,b){switch(this.style){case da.BAR:this.recalculateBarSize(a,b);break;case da.FULLSCREEN:this.recalculateFullScreenSize(a,b)}};c.prototype.recalculateBarSize=function(a,b){var e=b/20;e>c.minHeight?this.size=Math.floor(e):32!=this.size&&(this.size=32);this.visible&&this.drawBar()};c.prototype.recalculateFullScreenSize=function(a,b){var e=b/5;e>c.minHeight?this.size=Math.floor(e):32!=this.size&&(this.size=32);this.visible&&this.drawFullScreen()};c.prototype.setY=function(a){this.style==da.BAR&&
this.y!=a&&(this.y=a,this.visible&&this.drawBar())};c.prototype.drawBar=function(){this.statusBar.style.height=this.size+"px";this.statusBar.style.top=this.y+"px";var a=this.statusBar.querySelector(".jm-connstatus");a.style.height=this.size+"px";a.style.width=this.iconSize.width/this.iconSize.height*this.size+"px"};c.prototype.show=function(){this.style==da.BAR?this.showBar():this.style==da.FULLSCREEN&&this.showFullScreen();this.visible=!0};c.prototype.hide=function(){this.style==da.BAR?this.hideBar():
this.style==da.FULLSCREEN&&this.hideFullScreen()};c.prototype.showBar=function(){this.drawBar();var a=this.statusBar.querySelector(".jm-connstatus");a.classList.remove("jm-active");a.classList.add("jm-broken");this.statusBar.style.display="block";this.statusBar.style["z-index"]=1};c.prototype.hideBar=function(){var a=this.statusBar.querySelector(".jm-connstatus");a.classList.remove("jm-broken");a.classList.add("jm-active");this.statusBar.style.display="none";this.statusBar.style["z-index"]=0;this.visible=
!1};c.prototype.drawFullScreen=function(){null==document.querySelector(".jm-status-full-screen")&&document.querySelector("#jm-layer-messages").appendChild(this.statusBar);var a=this.statusBar.querySelector(".jm-no-connection-icon");a.style.height=this.size+"px";a.style.width=this.iconSize.width/this.iconSize.height*this.size+"px"};c.prototype.showFullScreen=function(){this.drawFullScreen();this.statusBar.style.display="block"};c.prototype.hideFullScreen=function(){this.statusBar.style.display="none"};
c.prototype.isVisible=function(){return this.visible};c.prototype.setStyle=function(a){if(a!=this.style)switch(a){case da.BAR:this.style=da.BAR;this.statusBar.parentNode&&this.statusBar.parentNode.removeChild(this.statusBar);this.initBar();break;case da.FULLSCREEN:this.style=da.FULLSCREEN,this.initFullScreen()}};c.minHeight=32;return c}();t.addModule("StatusBar",Ce);var De=function(){function c(){}c.prototype.generateRandomID=function(){return(Math.floor(1E6*Math.random())+Date.now()).toString()};
return c}();g.export("IDGenerator",new De);var rc=function(c){for(var a=c.length,b=Array(a),e=0;e<a;e++){var h=c[e],d=typeof h;b[e]="number"==d||"boolean"==d?h:qc(h)}return b},qc=function(c){if(null===c)return null;switch(typeof c){case "string":return c.slice(0);case "object":if(Array.isArray(c))return rc(c);var a={},b;for(b in c){var e=c[b];if(Array.isArray(e))a[b]=rc(e);else{var h=typeof e;a[b]="number"==h||"boolean"==h?e:qc(e)}}return a;default:return c}};g.export("deepCloneArray",rc);g.export("deepClonePlainObject",
qc);(function(c){c[c.EMPTY=-1]="EMPTY";c[c.BOOLEAN=0]="BOOLEAN";c[c.BYTE=1]="BYTE";c[c.SHORT=2]="SHORT";c[c.INT=3]="INT";c[c.UNSIGNEDBYTE=4]="UNSIGNEDBYTE";c[c.UNSIGNEDSHORT=5]="UNSIGNEDSHORT";c[c.UNSIGNEDINT=6]="UNSIGNEDINT";c[c.FLOAT=7]="FLOAT";c[c.DOUBLE=8]="DOUBLE";c[c.STRING=9]="STRING";c[c.BINARY=10]="BINARY";c[c.TIME=11]="TIME";c[c.INT64=12]="INT64";c[c.UINT64=13]="UINT64";c[c.INT64A=14]="INT64A";c[c.UINT64A=15]="UINT64A"})(v||(v={}));(function(c){c[c.EMPTY=0]="EMPTY";c[c.BIT=1]="BIT";c[c.BYTE=
2]="BYTE";c[c.SHORT=3]="SHORT";c[c.INT=4]="INT";c[c.UNSIGNED_BYTE=5]="UNSIGNED_BYTE";c[c.UNSIGNED_SHORT=6]="UNSIGNED_SHORT";c[c.UNSIGNED_INT=7]="UNSIGNED_INT";c[c.FLOAT=8]="FLOAT";c[c.DOUBLE=9]="DOUBLE";c[c.STRING=10]="STRING";c[c.BINARY=11]="BINARY";c[c.TIME=12]="TIME";c[c.ARRAY_BIT=13]="ARRAY_BIT";c[c.ARRAY_BYTE=14]="ARRAY_BYTE";c[c.ARRAY_SHORT=15]="ARRAY_SHORT";c[c.ARRAY_INT=16]="ARRAY_INT";c[c.ARRAY_UNSIGNED_BYTE=17]="ARRAY_UNSIGNED_BYTE";c[c.ARRAY_UNSIGNED_SHORT=18]="ARRAY_UNSIGNED_SHORT";c[c.ARRAY_UNSIGNED_INT=
19]="ARRAY_UNSIGNED_INT";c[c.ARRAY_FLOAT=20]="ARRAY_FLOAT";c[c.ARRAY_DOUBLE=21]="ARRAY_DOUBLE";c[c.ARRAY_TIME=22]="ARRAY_TIME";c[c.UINT64=23]="UINT64";c[c.INT64=24]="INT64";c[c.ARRAY_UINT64=25]="ARRAY_UINT64";c[c.ARRAY_INT64=26]="ARRAY_INT64";c[c.OBJECT=27]="OBJECT"})(Na||(Na={}));g.export("hexToDecimal",function(c,a){var b=a==v.UNSIGNEDBYTE||a==v.UNSIGNEDSHORT||a==v.UNSIGNEDINT||a==v.UINT64A||a==v.UINT64;0!=c.length%2&&"-"!=c.charAt(0)&&(c="0"+c);var e=parseInt(c,16);if(b||-1==a)return e;b=Math.pow(2,
c.length/2*8);e>b/2-1&&(e-=b);return e});g.export("_debounce",function(c,a,b){function e(b){var a=m,e=n;m=n=void 0;u=b;return p=c.apply(e,a)}function h(b,a){return y?(cancelAnimationFrame(r),requestAnimationFrame(b)):setTimeout(b,a)}function d(b){var e=b-t;b-=u;return void 0===t||e>=a||0>e||w&&b>=l}function f(){var b=Date.now();if(d(b))return k(b);var e;e=b-u;b=a-(b-t);e=w?Math.min(b,l-e):b;r=h(f,e)}function k(b){r=void 0;if(x&&m)return e(b);m=n=void 0;return p}function g(){for(var b=[],c=0;c<arguments.length;c++)b[c]=
arguments[c];var c=Date.now(),k=d(c);m=b;n=this;t=c;if(k){if(void 0===r)return u=b=t,r=h(f,a),v?e(b):p;if(w)return r=h(f,a),e(t)}void 0===r&&(r=h(f,a));return p}var m,n,l,p,r,t,u=0,v=!1,w=!1,x=!0,y=!a&&0!==a&&"function"===typeof requestAnimationFrame;if("function"!==typeof c)throw new TypeError("Expected a function");a=+a||0;(function(b){var a=typeof b;return null!=b&&("object"===a||"function"===a)})(b)&&(v=!!b.leading,l=(w="maxWait"in b)?Math.max(+b.maxWait||0,a):l,x="trailing"in b?!!b.trailing:
x);g.cancel=function(){if(void 0!==r){var b=r;y?cancelAnimationFrame(b):clearTimeout(b)}u=0;m=t=n=r=void 0};g.flush=function(){return void 0===r?p:k(Date.now())};g.pending=function(){return void 0!==r};return g});g.export("_loadFontFace",function(c){if(null==document.head.querySelector("[href*='fonts.css']")){var a="./css/fonts.css";-1==location.href.indexOf("_webmain")&&(a="../css/fonts.css");WebFont.load({custom:{families:c,urls:[a]}})}});r.prototype=Object.create(l.prototype);r.prototype.constructor=
r;r.prototype.isAggregable=!1;r.prototype.addDataLink=function(c){l.prototype.addDataLink.call(this,c);this.initDataLinkSideEffects(c,c.attr)};r.prototype.initDataLinkSideEffects=function(c,a){"tagSrc"==a&&(this.p.tag=c.tag,this.p.src=c.dataSrc.studioId,this.p.aIdx=c.tagIndex,this.p.srcType=c.srcType)};r.prototype.setValue=function(c,a,b){};r.prototype.getValue=function(c){};r.prototype.destroy=function(){l.prototype.destroy.call(this)};g.fn.hmiAction=function(c,a,b,e){var h=r;if(1==a.t)h=dd;else if(a.c){var d=
g.getAction(a.c);d&&(h=d.constructor)}return new h(this,c,a,e,b)};r.prototype.execute=function(c,a,b){this.done()};r.prototype.addActionListener=function(c){this.listener=c};r.prototype.done=function(){this.listener&&this.listener.done&&this.listener.done()};r.prototype.getSelectedAlarms=function(){for(var c=[],a=0,b=g.getWidget("_AlarmsMgr",!0),e=0;e<b.vars.alSelect.length;e++)b.vars.alSelect[e]&&c.push("al"+ ++a+"="+b.vars.alName[e]);0<c.length&&c.push("n="+c.length);return c.join("&")};r.prototype.exist=
function(c){return g.getWidget(c)?!0:!1};r.prototype.getDataLinkByAttr=function(c){for(var a in this.dataLinks){var b=this.dataLinks[a];if(b.getAttribute()==c)return b}return null};r.prototype.setParameters=function(c){this.c=c.c;this.p=c.p};r.prototype.getParameters=function(){return{c:this.c,p:this.p}};r.prototype.getMessage=function(c,a,b,e){return null};r.prototype.getMsgEvtCode=function(){return 0};r.prototype.getAggregationType=function(){return T.NORMAL};r.prototype.getTagTypeByName=function(c){return g.getActiveProject().getTagMgr().getTagInfo(c).t};
g.addWidgetDefinition("hmiAction",r);sb.prototype=Object.create(r.prototype);sb.prototype.constructor=sb;sb.prototype.execute=function(c,a){var b=g.getWidget("_AlarmsMgr",!0),e=a.alID;"selected"===e?b.ackSelectedAlarms():b.ackSpecificAlarm(e);this.done()};g.addAction("hmiActionAckAlarm",sb);tb.prototype=Object.create(r.prototype);tb.prototype.constructor=tb;tb.prototype.execute=function(c,a){var b=g.activeProject.getWidget("_SysPropMgr",!0).getValue("System Time"),e;e=a.wgtName;if(null!=this.parentWidget.module&&
"*"==e.charAt(0)&&"."==e.charAt(1)){e=this.parentWidget.module;for(var h=!1;null!=e&&!(h=this.project.getCWidgetMgr().hasGfxInheritance(e.ctype));)e=e.module;e=h?e.getWidget(a.wgtName,!0):this.parentWidget.module.getWidget(a.wgtName,!0)}else e=g.getFocusPage().getWidget(a.wgtName,!0);e instanceof Rb?e.setValue("MaxInSeconds",Math.ceil(b)):e.setValue("max",Math.ceil(b));this.done()};g.addAction("hmiActionRefreshEvent",tb);$a.prototype=Object.create(r.prototype);$a.prototype.constructor=$a;$a.prototype.checkAll=
!0;$a.prototype.execute=function(c,a){var b=g.getWidget("_AlarmsMgr",!0);if(b){if(a&&void 0!==a.md){var e=a.md,h=a.flt,d=a.wgt,f;if(h){var k,q,m,n;d&&(f=g.getFocusPage().getWidget(d,!0),k=f.getValue("filterAttr"),q=f.getValue("filterString"),m=f.getValue("filterAttr1"),n=f.getValue("filterString1"));f=b.getSelectAlarmsByFilter(k,q,m,n)}k=!0;if(0==e)if(h)for(e=0,h=f.length;e<h&&k;e++)b.isAlarmSelected(f[e])&&(k=!1);else k=b.getSelectedToggleStatus();else 2==e&&(k=!1);b.doSelectAlarms(f,k)}else this.select=
a&&void 0!=a.enable?a.enable:!this.select,b.doSelectAlarms(null,this.select);this.done()}};g.addAction("hmiActionSelectAllAlarms",$a);ub.prototype=Object.create(r.prototype);ub.prototype.constructor=ub;ub.prototype.execute=function(c,a){var b=g.getWidget(c);a&&a.wgt&&(b=b.parentPage.getWidget(a.wgt,!0),0<b.getValue("PageDuration")&&(b instanceof Rb?b.setValue("MaxInSeconds",b.getValue("MaxInSeconds")-b.getTimeFrame()):(b.setValue("min",b.getValue("min")-b.getTimeFrame()),b.setValue("max",b.getValue("max")-
b.getTimeFrame()))));this.done()};g.addAction("hmiActionScrollEventsBackward",ub);vb.prototype=Object.create(r.prototype);vb.prototype.constructor=vb;vb.prototype.execute=function(c,a){var b=g.getWidget(c);a&&a.wgt&&(b=b.parentPage.getWidget(a.wgt,!0),0<b.getValue("PageDuration")&&(b instanceof Rb?b.setValue("MaxInSeconds",b.getValue("MaxInSeconds")+b.getTimeFrame()):(b.setValue("min",b.getValue("min")+b.getTimeFrame()),b.setValue("max",b.getValue("max")+b.getTimeFrame()))));this.done()};g.addAction("hmiActionScrollEventsForward",
vb);wb.prototype=Object.create(r.prototype);wb.prototype.constructor=wb;wb.prototype.execute=function(c,a){a&&"string"==typeof a.id&&g.getWidget("_MultiLangMgr",!0).changeLanguage(a.id);this.done()};g.addAction("hmiActionSetLanguage",wb);xb.prototype=Object.create(r.prototype);xb.prototype.constructor=xb;xb.prototype.execute=function(c,a,b){a.pg&&""!==$.trim(a.pg)&&(c=$.trim(a.pg),c=-1===c.indexOf("://")?"http://"+c:c,c=0===c.indexOf("://")?"http"+c:c,c=window.open(c,"_blank"),void 0!==c&&null!=c&&
c.focus?c.focus():g.notifyWarning("Launch Browser","We can not open a new tab or window, please check browser pop-up blocker settings."));g.mouseMgr.loseFocus();this.done()};g.addAction("hmiActionLaunchBrowser",xb);yb.prototype=Object.create(r.prototype);yb.prototype.constructor=yb;yb.prototype.execute=function(c,a){var b=g.getActiveProject().getCommunticationObj();a&&"undefined"!=typeof a.id&&b.deleteEventArchive(a.id);this.done()};g.addAction("hmiActionDeleteEventArchive",yb);zb.prototype=Object.create(r.prototype);
zb.prototype.constructor=zb;zb.prototype.execute=function(c,a){var b=this,e=g.getActiveProject().getCommunticationObj();a&&e.deleteTrend(a.n,!1).then(function(a){b.done()}).catch(function(a,e,c){g.debugMode&&g.notifyWarning("DeleteTrend","REST status: request failed.");b.done()});this.done()};g.addAction("hmiActionDeleteTrend",zb);Ab.prototype=Object.create(r.prototype);Ab.prototype.constructor=Ab;Ab.prototype.execute=function(c,a){var b=this,e=g.getActiveProject().getCommunticationObj(),h=a.rc,d=
a.cp,f=a.newSetNameTag,k=a.ns;""!=f&&null!=f&&(f=g.cache.getTag(f))&&((k=f.getValue())&&""!=k||(k="Set"));e.addRecipeDataSet(h,d,k,!1).then(function(a){"S_OK"!=a.code&&g.debugMode&&g.notifyWarning("AddRecipeDataSet","REST status:"+a.code);b.done()}).catch(function(a,e,c){g.debugMode&&g.notifyWarning("AddRecipeDataSet","REST status: request failed.");b.done()})};g.addAction("hmiActionAddRecipeDataSet",Ab);Bb.prototype=Object.create(r.prototype);Bb.prototype.constructor=Bb;Bb.prototype.execute=function(c,
a){var b=this,e=g.getActiveProject().getCommunticationObj();a?e.delRecipeDataSet(a.rc,a.s,!1).then(function(a){"S_OK"!=a.code&&g.debugMode&&g.notifyWarning("DelRecipeDataSet","REST status:"+a.code);b.done()}).catch(function(a,e,c){g.debugMode&&g.notifyWarning("DelRecipeDataSet","REST status: request failed.");b.done()}):this.done()};g.addAction("hmiActionDelRecipeDataSet",Bb);Cb.prototype=Object.create(r.prototype);Cb.prototype.constructor=Cb;Cb.prototype.execute=function(c,a){var b=g.activeProject,
e=b.getCommunticationObj(),h=b.getWidget("_RecipeMgr",!0),b=h.getValue("curRecipe"),h=h.getValue("curRecipeSet"),d=this;e.downloadRecipe(b,h,!1).then(function(b){"S_OK"!=b.code&&g.debugMode&&g.notifyWarning("DownLoadCurRecipe","REST status:"+b.code);d.done()}).catch(function(b,a,e){g.debugMode&&g.notifyWarning("DownLoadCurRecipe","REST status: request failed.");d.done()})};g.addAction("hmiActionDownLoadCurRecipe",Cb);Db.prototype=Object.create(r.prototype);Db.prototype.constructor=Db;Db.prototype.execute=
function(c,a){var b=g.activeProject.getCommunticationObj();if(a){var e=this;b.downloadRecipe(a.r,a.s,!1).then(function(b){"S_OK"!=b.code&&g.debugMode&&g.notifyWarning("DownLoadRecipe","REST status:"+b.code);e.done()}).catch(function(b,a,c){g.debugMode&&g.notifyWarning("DownLoadRecipe","REST status: request failed.");e.done()})}else this.done()};g.addAction("hmiActionDownLoadRecipe",Db);Eb.prototype=Object.create(r.prototype);Eb.prototype.constructor=Eb;Eb.prototype.execute=function(c,a){var b=this,
e=g.getActiveProject().getCommunticationObj();a&&e.resetRecipe(a.r,!1).then(function(a){"S_OK"!=a.code&&g.debugMode&&g.notifyWarning("UpLoadCurRecipe","REST status:"+a.code);b.done()}).catch(function(a,e,c){g.debugMode&&g.notifyWarning("UpLoadCurRecipe","REST status: request failed.");b.done()})};g.addAction("hmiActionResetRecipe",Eb);Fb.prototype=Object.create(r.prototype);Fb.prototype.constructor=Fb;Fb.prototype.execute=function(c,a){var b=g.activeProject,e=b.getCommunticationObj(),h=b.getWidget("_RecipeMgr",
!0),b=h.getValue("curRecipe"),h=h.getValue("curRecipeSet"),d=this;e.uploadRecipe(b,h,!1).then(function(b){"S_OK"!=b.code&&g.debugMode&&g.notifyWarning("UpLoadCurRecipe","REST status:"+b.code);d.done()}).catch(function(b,a,e){g.debugMode&&g.notifyWarning("UpLoadCurRecipe","REST status: request failed.");d.done()})};g.addAction("hmiActionUpLoadCurRecipe",Fb);Gb.prototype=Object.create(r.prototype);Gb.prototype.constructor=Gb;Gb.prototype.execute=function(c,a){var b=g.activeProject.getCommunticationObj();
if(a){var e=this;b.uploadRecipe(a.r,a.s,!1).then(function(b){"S_OK"!=b.code&&g.debugMode&&g.notifyWarning("UpLoadRecipe","REST status:"+b.code);e.done()}).catch(function(b,a,c){g.debugMode&&g.notifyWarning("UpLoadRecipe","REST status: request failed.");e.done()})}else this.done()};g.addAction("hmiActionUpLoadRecipe",Gb);Hb.prototype=Object.create(r.prototype);Hb.prototype.constructor=Hb;Hb.prototype.execute=function(c,a){var b=this,e=g.getActiveProject().getCommunticationObj();if(a){var h=a.r,d=a.s,
b=this;e.setCurrentRecipe(h,d,!1).then(function(a){"S_OK"!=a.code&&g.debugMode&&g.notifyWarning("WriteCurrentRecipeSet","REST status:"+a.code);b.done()}).catch(function(a,e,c){g.debugMode&&g.notifyWarning("WriteCurrentRecipeSet","REST status: request failed.");b.done()})}else this.done()};g.addAction("hmiActionWriteCurrentRecipeSet",Hb);ab.prototype=Object.create(r.prototype);ab.prototype.constructor=ab;ab.prototype.jmType="LogOutAction";ab.prototype.execute=function(c,a){var b=a&&null!=a.allowDefaultUser?
a.allowDefaultUser:!0,e=g.activeProject.getUserGroupMgr();if(0!=b||!e.isDefaultUser()){e.useLastGroupPage()&&!e.isUMTemplate(g.getActivePage().wgtId)&&e.storeLastPageUsed();var h=this;null!=e.isSecurityEnabled()?e.isSecurityEnabled()&&this.project.getCommunticationObj().logOut().then(function(){h.done();h.project.getCommunticationObj().loadLoginUI(e.isDefaultUser(),e.isForceRemoteLoginEnabled())}):this.project.getCommunticationObj().loadLoginUI(!0,!0)}this.done()};g.addAction("hmiActionLogOut",ab);
Ib.prototype=Object.create(r.prototype);Ib.prototype.constructor=Ib;Ib.prototype.execute=function(c,a){this.done()};g.addAction("hmiActionApplyEdit",Ib);Jb.prototype=Object.create(r.prototype);Jb.prototype.constructor=Jb;Jb.prototype.execute=function(c,a,b){this.done()};g.addAction("hmiActionAddUser",Jb);Kb.prototype=Object.create(r.prototype);Kb.prototype.constructor=Kb;Kb.prototype.execute=function(c,a,b){this.done()};g.addAction("hmiActionDeleteUser",Kb);Lb.prototype=Object.create(r.prototype);
Lb.prototype.constructor=Lb;Lb.prototype.execute=function(c,a,b){this.done()};g.addAction("hmiActionEditUsers",Lb);Mb.prototype=Object.create(r.prototype);Mb.prototype.constructor=Mb;Mb.prototype.execute=function(c,a,b){this.done()};g.addAction("hmiActionSwitchUser",Mb);var p=this&&this.__extends||function(){var c=function(a,b){c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return c(a,b)};return function(a,
b){function e(){this.constructor=a}c(a,b);a.prototype=null===b?Object.create(b):(e.prototype=b.prototype,new e)}}(),K=function(){function c(a,b,e){this.id=a;this.flag=b;this.data=e}c.prototype.toJSON=function(){return Object.assign({ID:this.id},{Flag:this.flag},this.data)};c.EMessageEvent={eInvalid:0,eAction_showDialog:1,eAction_showMessage:4,eAction_goToPage:8,eAction_nextPage:9,eAction_previousPage:10,eAction_showWidget:12,eAction_refreshScheduler:16,eAction_dataTransfer:23,eAction_jsAction:46,
eAction_dbInit:49,eAction_dbWriteTags:50,eAction_dbReadTags:51,eAction_dbWriteGroups:52,eAction_dbReadGroups:53,eAction_dbWriteTrends:54,eAction_dbWriteEvents:55,eAction_dbWriteRecipes:56,eAction_dbReadRecipes:57,eAction_setLanguage:58,eAction_DBResetErrors:70,eAction_dbQuery:72};c.EMessageFlag=257;return c}();t.addModule("ActionMessage",K);var T;(function(c){c[c.NORMAL=0]="NORMAL";c[c.PAGE=1]="PAGE";c[c.MESSAGE=2]="MESSAGE"})(T||(T={}));var Ge=function(){function c(){this.queue=[];this.executionStatus=
0}c.prototype.execute=function(){this.queue.shift().doActions()};c.prototype.createAggregation=function(a){var b=null;switch(a.action.getAggregationType()){case T.NORMAL:b=new sc(this);break;case T.PAGE:b=new Ee(this);break;case T.MESSAGE:b=new Fe(this)}b.addActionExec(a);this.queue.push(b)};c.prototype.getAcionExecutionInstance=function(a,b,e,c,d){return new ed(a,b,e,c,d)};c.prototype.addActionToExecute=function(a,b,e,c,d){var f=this.queue[this.queue.length-1];a=this.getAcionExecutionInstance(a,
b,e,c,d);f?f.canAggregateActionExec(a)?f.addActionExec(a):this.createAggregation(a):this.createAggregation(a)};c.prototype.doActions=function(){0<this.queue.length&&0==this.executionStatus&&(this.executionStatus=1,this.execute())};c.prototype.done=function(){0<this.queue.length&&1==this.executionStatus?this.execute():this.executionStatus=0};return c}();t.addModule("Aggregator",Ge);var ed=function(){return function(c,a,b,e,h){this.action=c;this.params=a;this.wgtId=b;this.eventInfo=h;this.strAction=
e}}(),sc=function(){function c(a){this.execInstances=[];this.executionStatus=0;this.aggregator=null;this.pageIdx=-1;this.aggregator=a}c.prototype.executeStandardAction=function(a){a.action.execute(a.wgtId,a.params,a.strAction,a.eventInfo)};c.prototype.execute=function(){this.executeStandardAction(this.execInstances.shift())};c.prototype.addActionExec=function(a){a.action.addActionListener(this);this.execInstances.push(a)};c.prototype.canAggregateActionExec=function(a){a=a.action;var b=this.execInstances[this.execInstances.length-
1].action,e=a.getAggregationType(),c=b.getAggregationType();return a.isAggregable&&b.isAggregable&&e==c?!0:!1};c.prototype.doActions=function(){0<this.execInstances.length&&0==this.executionStatus&&(this.executionStatus=1,this.execute())};c.prototype.done=function(){0<this.execInstances.length&&1==this.executionStatus?this.execute():(this.executionStatus=0,this.aggregator.done())};return c}(),Fe=function(c){function a(){var b=null!==c&&c.apply(this,arguments)||this;b.messages=[];return b}p(a,c);a.prototype.executeWriteMessage=
function(){var b=this,a=function(){return g.getAction("hmiActionShowMessage").execute(null,{msg:"Error: POST writeMessage.json failure !"},3)};g.activeProject.getCommunticationObj().writeMessage({messages:this.messages}).then(function(c){-1==c.indexOf("S_OK")&&a();b.aggregator.done()}).catch(function(c){a();b.aggregator.done()})};a.prototype.execute=function(){var b=this.execInstances.shift();this.messages.push(b.action.getMessage(b.params,b.wgtId,b.strAction,b.eventInfo).toJSON());this.done()};a.prototype.done=
function(){0<this.execInstances.length&&1==this.executionStatus?this.execute():(this.executionStatus=0,this.executeWriteMessage())};return a}(sc),Ee=function(c){function a(){return null!==c&&c.apply(this,arguments)||this}p(a,c);a.prototype.generateLoadPageAction=function(b,a){var c=this,d=g.activeProject.getPageMgr(),f=d.getCurrentPageId(),d=d.getCurrentCategory();if(null!==d){var k=b,q=b.action,m=function(a){var e=g.actionMgr.getActionInstance("hmiActionLoadPage");e.addActionListener(c);return new ed(e,
{pg:a},b.wgtId,"LoadPage",b.eventInfo)};-1==this.pageIdx&&(this.pageIdx=d.pages.indexOf(f));"LoadPageAction"==q.getJMType()?this.pageIdx=d.pages.indexOf(b.params.pg):"NextPageAction"==q.getJMType()?(this.pageIdx=this.pageIdx+1>=d.pages.length?0:this.pageIdx+1,k=m(d.pages[this.pageIdx])):"PrevPageAction"==q.getJMType()&&(this.pageIdx=0>this.pageIdx-1?d.pages.length-1:this.pageIdx-1,k=m(d.pages[this.pageIdx]));a&&("LoadPageAction"!=q.getJMType()&&"PrevPageAction"!=q.getJMType()&&"NextPageAction"!=q.getJMType()||
this.execInstances.pop());this.execInstances.push(k)}};a.prototype.addActionExec=function(b){var a=this.execInstances[this.execInstances.length-1];b.action.addActionListener(this);this.generateLoadPageAction(b,a)};return a}(sc),He=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.getMsgEvtCode=function(){return K.EMessageEvent.eAction_showWidget};a.prototype.execute=function(b,a){null!=a&&0<a.length&&g.getWidget(a[1],!0).setValue("visibility",a[0],null);this.done()};
return a}(r);g.addAction("hmiActionShowWidget",He);var Ie=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a){if(null!=a){var c=a.deltaRow,d=g.getWidget(a.tableId,!0);void 0!==d&&null!==d&&d.scrollTable(c)}this.done()};return a}(r);g.addAction("hmiActionScrollTable",Ie);var Je=function(c){function a(){return null!==c&&c.apply(this,arguments)||this}p(a,c);a.prototype.execute=function(b,a){var c=this.getDataLinkByAttr("dataSrcWgtColumn"),d=
g.getWidget(a.tableWgtId,!0);c&&d&&(d.removeSortingRulesByColumnNames([c.tag]),d.addSortingRules([{_c:c.tag,_m:a.mode,_t:a.type}]),d.updateProxySortingRules());this.done()};return a}(r);g.addAction("hmiActionSetTableSortingColumn",Je);var dd=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.getMsgEvtCode=function(){return K.EMessageEvent.eAction_jsAction};a.prototype.execute=function(b,a,c,d){if(b=g.getWidget(b)){a=void 0;"ProjectWgt"==b.getJMType()?g.activeProject.__eval__(c)():
"PageWgt"==b.getJMType()||"DialogWgt"==b.getJMType()?(a=b.getCallbacks(),a=a[c].fn):a=(a=b.parentPage.getCallbacks())&&a[c]?a[c].fn:g.getActiveProject().getCallbacks()[c].fn;try{if("function"==typeof a){var f=a(b,d);d&&d.cb&&d.cb(f)}}catch(k){b?g.showErrorMessage(b.studioId,"JSAction",k.message):g.showErrorMessage("Unkown","JSAction",k.message)}}this.done()};return a}(r);g.addAction("hmiActionJS",dd);var Ke=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=
function(b,a){var c=g.activeProject.getWidget(a.src,!0),d=a.n;"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d));if(d=c.getSubscribedWgtId(d)){var f=a.xMax instanceof Date?a.xMax.getTime()/1E3:a.xMax,k=a.xMin instanceof Date?a.xMin.getTime()/1E3:a.xMin;c.setTrendView(d,k,f,a.yMin,a.yMax)}this.done()};a.prototype.setValue=function(b,a,c){c&&!c.isQualityGood()||this.p[b]==a||(this.p[b]=a)};return a}(r);g.addAction("hmiActionSetTrendView",Ke);var Le=function(c){function a(b,a,h,d,f){return c.call(this,
b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a){var c=a[0],d=a[1],f=a[2],k=g.getActiveProject();if(c="_TrendMgr"==c?k.getTrendMgr():g.getWidget(c,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=c.getSubscribedWgtId(d))&&c.showTrendCursor(d,"true"==f);this.done()};return a}(r);g.addAction("hmiActionShowTrendCursor",Le);var Me=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a){var c=a[0],d=a[1],f=g.getActiveProject();
if(c="_TrendMgr"==c?f.getTrendMgr():g.getWidget(c,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=c.getSubscribedWgtId(d))&&c.moveTrendWindow(d,"down","page");this.done()};return a}(r);g.addAction("hmiActionPageDownTrend",Me);var Ne=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a){var c=a[0],d=a[1],f=a[2],k=g.getActiveProject();if(c="_TrendMgr"==c?k.getTrendMgr():g.getWidget(c,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),
(d=c.getSubscribedWgtId(d))&&c.changePageDuration(d,parseInt(f));this.done()};return a}(r);g.addAction("hmiActionPageDurationTrend",Ne);var Oe=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a){var c=a[0],d=a[1],f=g.getActiveProject();if(c="_TrendMgr"==c?f.getTrendMgr():g.getWidget(c,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=c.getSubscribedWgtId(d))&&c.moveTrendWindow(d,"left","page");this.done()};return a}(r);g.addAction("hmiActionPageLeftTrend",
Oe);var Pe=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a){var c=a[0],d=a[1],f=g.getActiveProject();if(c="_TrendMgr"==c?f.getTrendMgr():g.getWidget(c,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=c.getSubscribedWgtId(d))&&c.moveTrendWindow(d,"right","page");this.done()};return a}(r);g.addAction("hmiActionPageRightTrend",Pe);var Qe=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=
function(b,a){var c=a[0],d=a[1],f=g.getActiveProject();if(c="_TrendMgr"==c?f.getTrendMgr():g.getWidget(c,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=c.getSubscribedWgtId(d))&&c.moveTrendWindow(d,"up","page");this.done()};return a}(r);g.addAction("hmiActionPageUpTrend",Qe);var Re=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a){var c=a[0],d=a[1],f=g.getActiveProject();if(c="_TrendMgr"==c?f.getTrendMgr():g.getWidget(c,!0))"*"==
d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=c.getSubscribedWgtId(d))&&c.pauseTrend(d);this.done()};return a}(r);g.addAction("hmiActionPauseTrend",Re);var Se=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a){var c=a[0],d=a[1],f=g.getActiveProject();if(c="_TrendMgr"==c?f.getTrendMgr():g.getWidget(c,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=c.getSubscribedWgtId(d))&&c.refreshTrend(d);this.done()};return a}(r);g.addAction("hmiActionRefreshTrend",
Se);var Te=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a){var c=a.wgt,d=a.n,f=g.getActiveProject();if(c="_TrendMgr"==c?f.getTrendMgr():g.getWidget(c,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=c.getSubscribedWgtId(d))&&c.restoreTrendDefault(d);this.done()};return a}(r);g.addAction("hmiActionRestoreTrendDefault",Te);var Ue=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=
function(b,a){var c=a[0],d=a[1],f=g.getActiveProject();if(c="_TrendMgr"==c?f.getTrendMgr():g.getWidget(c,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=c.getSubscribedWgtId(d))&&c.resumeTrend(d);this.done()};return a}(r);g.addAction("hmiActionResumeTrend",Ue);var Ve=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a){var c=a[0],d=a[1],f=g.getActiveProject();if(c="_TrendMgr"==c?f.getTrendMgr():g.getWidget(c,!0))"*"==d.charAt(0)&&
(d=this.parentWidget.resolveId(d)),(d=c.getSubscribedWgtId(d))&&c.moveTrendWindow(d,"down",null);this.done()};return a}(r);g.addAction("hmiActionScrollDownTrend",Ve);var We=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a){var c=a[0],d=a[1],f=g.getActiveProject();if(c="_TrendMgr"==c?f.getTrendMgr():g.getWidget(c,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=c.getSubscribedWgtId(d))&&c.moveTrendWindow(d,"left",null);this.done()};
return a}(r);g.addAction("hmiActionScrollLeftTrend",We);var Xe=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a){var c=a[0],d=a[1],f=g.getActiveProject();if(c="_TrendMgr"==c?f.getTrendMgr():g.getWidget(c,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=c.getSubscribedWgtId(d))&&c.moveTrendWindow(d,"right",null);this.done()};return a}(r);g.addAction("hmiActionScrollRightTrend",Xe);var Ye=function(c){function a(b,a,h,d,f){return c.call(this,
b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a){var c=a[0],d=a[1],f,k,q;a[2]&&(q=parseInt(a[2]));a[3]&&(f=parseInt(a[3]));a[4]&&(k=parseFloat(a[4]));var m=g.getActiveProject();if(c="_TrendMgr"==c?m.getTrendMgr():g.getWidget(c,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=c.getSubscribedWgtId(d))&&c.scrollTrendCursor(d,q,f,k);this.done()};return a}(r);g.addAction("hmiActionScrollTrendCursor",Ye);var Ze=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,
c);a.prototype.execute=function(b,a){var c=a[0],d=a[1],f=a[2],k=a[3],q=a[4],m,n="_TrendMgr"==c?g.activeProject.getTrendMgr():g.getWidget(c,!0);if(n){"*"==k.charAt(0)&&(k=this.parentWidget.resolveId(k));var l=n.getSubscribedWgtId(k);if(l){c=g.cache.getTag(d);switch(f){case "Start":m=0;break;case "Center":m=1;break;case "End":m=2}c?(d=c.value,n.scrollTrendToTime(l,m,d)):(f=null,-1!=q.indexOf("Project:")?(q=q.substring(8),f=g.activeProject.getWidget(q,!0)):f=g.getWidget(q,!0),d=f.getValue(d),d instanceof
Promise?d.then(function(b){n.scrollTrendToTime(l,m,parseFloat(b))}):(moment.isMoment(d)&&(d=(new Date(d)).getTime()/1E3),n.scrollTrendToTime(l,m,d)))}}this.done()};return a}(r);g.addAction("hmiActionScrollTrendToTime",Ze);var $e=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a){var c=a[0],d=a[1],f=g.getActiveProject();if(c="_TrendMgr"==c?f.getTrendMgr():g.getWidget(c,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=c.getSubscribedWgtId(d))&&
c.moveTrendWindow(d,"up",null);this.done()};return a}(r);g.addAction("hmiActionScrollUpTrend",$e);var af=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a){var c=a[0],d=a[1],f=g.getActiveProject();if(c="_TrendMgr"==c?f.getTrendMgr():g.getWidget(c,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=c.getSubscribedWgtId(d))&&c.zoomTrendWindow(d,!0,!0),this.done()};return a}(r);g.addAction("hmiActionZoomInTrend",af);var bf=function(c){function a(b,
a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a){var c=a[0],d=a[1],f=g.getActiveProject();if(c="_TrendMgr"==c?f.getTrendMgr():g.getWidget(c,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=c.getSubscribedWgtId(d))&&c.zoomTrendWindow(d,!0,!1);this.done()};return a}(r);g.addAction("hmiActionZoomInYAxisTrend",bf);var cf=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a){var c=a[0],d=a[1],f=g.getActiveProject();
if(c="_TrendMgr"==c?f.getTrendMgr():g.getWidget(c,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=c.getSubscribedWgtId(d))&&c.zoomTrendWindow(d,!1,!0);this.done()};return a}(r);g.addAction("hmiActionZoomOutTrend",cf);var df=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a){var c=a[0],d=a[1],f=g.getActiveProject();if(c="_TrendMgr"==c?f.getTrendMgr():g.getWidget(c,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=c.getSubscribedWgtId(d))&&
c.zoomTrendWindow(d,!1,!1);this.done()};return a}(r);g.addAction("hmiActionZoomOutYAxisTrend",df);var ef=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a){var c=a[0],d=a[1],f=g.getActiveProject();if(c="_TrendMgr"==c?f.getTrendMgr():g.getWidget(c,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=c.getSubscribedWgtId(d))&&c.resetZoom(d,!0);this.done()};return a}(r);g.addAction("hmiActionZoomResetTrend",ef);var ff=function(c){function a(b,
a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a){var c=a[0],d=a[1],f=g.getActiveProject();if(c="_TrendMgr"==c?f.getTrendMgr():g.getWidget(c,!0))"*"==d.charAt(0)&&(d=this.parentWidget.resolveId(d)),(d=c.getSubscribedWgtId(d))&&c.resetZoom(d,!1);this.done()};return a}(r);g.addAction("hmiActionZoomResetYAxisTrend",ff);var gf=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a){g.getWidget("_AlarmsMgr",!0).saveConfiguration();
this.done()};return a}(r);g.addAction("hmiActionSaveConfiguration",gf);var hf=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a){g.getWidget("_AlarmsMgr",!0).enableAlarms();this.done()};return a}(r);g.addAction("hmiActionEnableAlarm",hf);var jf=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a){g.activeProject.getAlarmsMgr().setSelectAlarm(a.alID,a.select);this.done()};return a}(r);
g.addAction("hmiActionSelectAlarm",jf);var kf=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a){g.getWidget(a.srcId,!0).selectAllAlarmsOnSrc();this.done()};return a}(r);g.addAction("hmiActionSelectAllAlarmsOnSrc",kf);var lf=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a){this.project.getAlarmsMgr().resetSelectedAlarms();this.done()};return a}(r);g.addAction("hmiActionResetAlarm",
lf);var mf=function(c){function a(b,a,h,d,f){b=c.call(this,b,a,h,d,f)||this;b.setAsDefaultAlert();return b}p(a,c);a.prototype.setAsDefaultAlert=function(){var b=this;window.alert=function(a){b.execute(null,{msg:a},2)}};a.prototype.getMsgEvtCode=function(){return K.EMessageEvent.eAction_showMessage};a.prototype.execute=function(b,a,c){var d,f,k;if(a){null!=a.msg&&(d=a.msg);if("undefined"!=typeof a.id){f=a.id;d=g.getWidget(b);if("AlarmsMgrWgt"===d.getJMType())k=d.getPageMLTextMgr(),d=d.alarmsConf.mlTexts[f][d.currLang];
else if(g.getWidget(b,!1).isActiveAlarm)d=g.getWidget("_AlarmsMgr",!0),k=d.getPageMLTextMgr(),d=d.alarmsConf.mlTexts[f][d.currLang];else if(k=b?this.parentWidget.getPageMLTextMgr():g.getActivePage().getPageMLTextMgr(),d=k.getText(f),null==d){var q=g.getFocusPage().getTemplateMLTextMgr();null!=q&&(d=q.getText(f),k=q)}k=k.getMultiLanguagesMgr().getLanguageFont(k.getCurrentLanguage())}b=null!==b?b.replace(/\./g,"_")+"_"+f:"default";f=document.createDocumentFragment();q=document.createElement("div");
q.setAttribute("id","msg-o-"+b);q.setAttribute("class","jm-hmi-overlay");f.appendChild(q);q=document.createElement("div");q.setAttribute("id","msg-b-"+b);q.setAttribute("class","jm-hmi-msg");var m="jm-round-button-circle";switch(c){case 1:c=document.createElement("div");c.setAttribute("class","jm-hmi-msg-hdr jm-bk-error");c.textContent="Error";m+=" rnd-btn-c-bk-err";break;case 2:c=document.createElement("div");c.setAttribute("class","jm-hmi-msg-hdr");c.textContent="Alert";m+=" rnd-btn-c-bk-alrt";
break;case 3:c=document.createElement("div");c.setAttribute("class","jm-hmi-msg-hdr jm-cm-error");c.textContent="Communication error";m+=" rnd-btn-c-bk-cmerr";break;default:c=document.createElement("div"),c.setAttribute("class","jm-hmi-msg-hdr"),c.textContent="Message"}q.appendChild(c);c=document.createElement("div");c.setAttribute("class","jm-hmi-msg-cnt");var n=document.createElement("p");n.setAttribute("style","margin:5px;"+(void 0!=k?"font-family:'"+k:""));a.format&&"html"==a.format?n.innerHTML=
d:n.textContent=d;a=document.createElement("div");a.setAttribute("class","jm-round-button jm-hmi-msg-close");a.innerHTML="<div class='"+m+"'><a>OK</a></div>";c.appendChild(n);c.appendChild(a);q.appendChild(c);f.appendChild(q);(a=this.project)||(a=this.core.getActiveProject());var l=a.getNode("messages");l.appendChild(f);a=l.querySelectorAll("#msg-b-"+b+" .jm-hmi-msg-close");var p=l.querySelectorAll("#msg-o-"+b),r=l.querySelectorAll("#msg-b-"+b);if(a=a[a.length-1])a.addEventListener("click",function(b){b.stopPropagation();
l.removeChild(p[p.length-1]);l.removeChild(r[r.length-1]);g.getInputManager().enableMouse()}),g.getInputManager().disableMouse();g.mouseMgr.loseFocus();this.done()}};return a}(r);g.addAction("hmiActionShowMessage",mf);g.setDefaultAlert(g.getAction("hmiActionShowMessage"));var nf=function(c){function a(b,a,h,d,f){b=c.call(this,b,a,h,d,f)||this;b.isAggregable=!0;return b}p(a,c);a.prototype.getAggregationType=function(){return T.PAGE};a.prototype.getMsgEvtCode=function(){return K.EMessageEvent.eAction_goToPage};
a.prototype.execute=function(b,a,c){c=this.project.getPageMgr();b=c.getCurrentPageId();c=c.getCurrentCategory();var d=c.alias[a.pg];a=d?d:a.pg;a!=b&&""!==a&&void 0!==a&&(c&&-1!=c.pages.indexOf(a)||-1!=c.umpages.indexOf(a))&&g.activeProject.changePage(b,a);this.done()};a.jmType="LoadPageAction";return a}(r);g.addAction("hmiActionLoadPage",nf);var of=function(c){function a(b,a,h,d,f){b=c.call(this,b,a,h,d,f)||this;b.isAggregable=!0;return b}p(a,c);a.prototype.getAggregationType=function(){return T.PAGE};
a.prototype.getMsgEvtCode=function(){return K.EMessageEvent.eAction_previousPage};a.prototype.execute=function(b,a){var c=this.project.getPageMgr(),d=c.getCurrentCategory();if(d){var f=d.pages.indexOf(c.getCurrentPageId());g.activeProject.changePage(c.getCurrentPageId(),d.pages[0>f-1?d.pages.length-1:f-1])}this.done()};a.jmType="PrevPageAction";return a}(r);g.addAction("hmiActionPrevPage",of);var pf=function(c){function a(b,a,h,d,f){b=c.call(this,b,a,h,d,f)||this;b.isAggregable=!0;return b}p(a,c);
a.prototype.getAggregationType=function(){return T.PAGE};a.prototype.getMsgEvtCode=function(){return K.EMessageEvent.eAction_nextPage};a.prototype.execute=function(b,a){var c=this.project.getPageMgr(),d=c.getCurrentCategory();if(d){var f=d.pages.indexOf(c.getCurrentPageId());g.activeProject.changePage(c.getCurrentPageId(),d.pages[f+1>=d.pages.length?0:f+1])}this.done()};a.jmType="NextPageAction";return a}(r);g.addAction("hmiActionNextPage",pf);var qf=function(c){function a(b,a,h,d,f){return c.call(this,
b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a){var c=this.project.getPageMgr(),d=this.project.getWidget("_UserGroupMgr",!0);if(g.enablePjctWidgetServerReq){var f=c.getCurrentCategory();this.prevPageID=c.getLastVisitedPage();if(null==this.prevPageID)if(d=d.loadLastPageUsed(),null!=d)this.prevPageID=c.getWebPage(d.toLowerCase());else if(g.enablePjctWidgetServerReq)this.prevPageID=c.getHomePageId();else{g.getAction("hmiActionLogOut").execute();this.done();return}c=this.prevPageID;f&&-1==f.pages.indexOf(this.prevPageID)&&
(c=this.project.getPageMgr().getWebPage(this.prevPageID.toLowerCase()));c&&g.activeProject.changePage(g.getActivePage().wgtId,c)}else{var k=this.project.getCommunticationObj();k.logOut().then(function(b){k.loadLoginUI(!0,!0)},function(b){k.loadLoginUI(!0,!0)})}this.done()};a.jmType="LastPageAction";return a}(r);g.addAction("hmiActionLastPage",qf);var rf=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a){var c=this.project.getPageMgr(),d=
c.getCurrentCategory();d&&g.activeProject.changePage(c.getCurrentPageId(),c.getWebPage(d.home.toLowerCase()));this.done()};a.jmType="HomePageAction";return a}(r);g.addAction("hmiActionHomePage",rf);var ib=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.resolveParameters=function(b){var a,c;b=$.extend(!0,{},b);if(b.srcType&&"Alias"==b.srcType){var d=this.project.getWidget(b.src,!0).getTagObjFromAlias(b.tag);a=c=void 0;null!=d&&(c=d.tag,a=d.idx,-1!=a&&(b.aIdx=
a));b.tag=c;b.src="_TagMgr";b.srcType="Tag"}b.src&&1<b.src.split(":").length&&(b.wgtPage=b.src.split(":")[0],b.src=b.src.split(":")[1]);if(b.tag&&"*"==b.tag.charAt(0))return b.propType=3,b.rw="rw",b;if(b.tag)d=b.tag,c=g.getWidget(b.src,!0),!b.wgtPage&&c&&"GroupWgt"==c.getJMType()?(a=g.getWidget(b.src,!0),c=a.ctype,b.wgtId=a.wgtId,a=g.activeProject.props,c&&a&&a[c]&&a[c][d]?(b.aliases=a[c][d],b.propType=0):1<d.split(".").length?(b.aliases=d.split("."),b.propType=1):(b.prop=d,b.propType=2)):(b.prop=
d,b.propType=2);else return null;b.rw="rw";return b};a.prototype.setWidgetProperty=function(b,a){var c,d;c=3==b.propType?[b.tag]:[b.prop];var f=b.propType,k;k=b.wgtId?g.getFocusPage().getWidget(b.wgtId):g.getWidget(b.src,!0);for(var q=0,m=c.length;q<m;q++){d={wgt:null,prop:null};0==f||1==f?k.resolveAliasAttribute(c[q],d):d={wgt:k,prop:c[q]};var n=d.wgt;d=d.prop;if("rw"==b.rw){var l=a(n.getValue(d),b);null!==l&&n.setProperty(d,l)}else"w"==b.rw&&n.setProperty(d,b.v)}return!0};a.prototype.isFloat=function(b){return"number"===
typeof b&&0!==b%1?!0:!1};return a}(r),ia;(function(c){c[c.OVER=1]="OVER";c[c.LIMIT=2]="LIMIT";c[c.STEP=4]="STEP"})(ia||(ia={}));var sf=function(c){function a(b,a,h,d,f){b=c.call(this,b,a,h,d,f)||this;b.maskQualityTags=ia.STEP|ia.LIMIT|ia.OVER;return b}p(a,c);a.prototype.execute=function(b,a){var c=this,d=this.resolveParameters(a),f=this.maskQualityTags==(ia.STEP|ia.LIMIT|ia.OVER);null!=d&&f?(f=this.project.getTagMgr())&&("_TagMgr"==d.src||d.wgtPage)?f.stepTag(d.tag,d.aIdx,d.step,d.limit,d.over).then(function(b){c.done()}).catch(function(){c.done()}):
(this.setWidgetProperty(d,this.step32Bit),this.done()):this.done()};a.prototype.setValue=function(b,a,c){if("overLimitTagSrc"==b||"StepOverLimit"==b){if(c&&!c.isQualityGood())return this.maskQualityTags&=~ia.OVER,!1;c.isQualityGood()&&(this.maskQualityTags|=ia.OVER);this.p.over=a}else if("stepLimitTagSrc"==b||"StepLimit"==b){if(c&&!c.isQualityGood())return this.maskQualityTags&=~ia.LIMIT,!1;c.isQualityGood()&&(this.maskQualityTags|=ia.LIMIT);this.p.limit=a}else if("stepSizeTagSrc"==b||"Step"==b){if(c&&
!c.isQualityGood())return this.maskQualityTags&=~ia.STEP,!1;c.isQualityGood()&&(this.maskQualityTags|=ia.STEP);this.p.step=a}else"tagSrc"==b&&(b=this.getDataLinkByAttr("tagSrc"),null!=b&&this.p.aIdx!=b.tagIndex&&(this.p.aIdx=b.tagIndex));return!0};a.prototype.step32Bit=function(b,a){var c=b+a.step,d=c;a.over&&(d=0>a.step?c<a.limit?a.limit:c:c>a.limit?a.limit:c);return d};return a}(ib);g.addAction("hmiActionStepTag",sf);var tf=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,
c);a.prototype.execute=function(b,a,c){var d=this;b=this.resolveParameters(a);null==b?this.done():"_TagMgr"==b.src||b.wgtPage?this.project.getTagMgr().toggleTag(b.tag,b.aIdx,b.idx).then(function(b){d.done()}).catch(function(){d.done()}):(this.setWidgetProperty(b,this.apply.bind(this)),this.done())};a.prototype.apply=function(b,a){b=parseFloat(b);return isNaN(b)||this.isFloat(b)?null:0!==(b>>a.idx)%2?b&~(1<<a.idx):b|1<<a.idx};a.prototype.setValue=function(b,a,c){"tagSrc"==b&&(b=this.getDataLinkByAttr("tagSrc"),
null!=b&&this.p.aIdx!=b.tagIndex&&(this.p.aIdx=b.tagIndex));return!0};return a}(ib);g.addAction("hmiActionToggleBit",tf);var uf=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a,c){var d=this;b=this.resolveParameters(a);null==b?this.done():"_TagMgr"==b.src||b.wgtPage?this.project.getTagMgr().setBitTag(b.tag,b.aIdx,b.idx).then(function(b){d.done()}).catch(function(){d.done()}):(this.setWidgetProperty(b,this.apply.bind(this)),this.done())};
a.prototype.apply=function(b,a){b=parseFloat(b);if(isNaN(b)||this.isFloat(b))return null;var c=a.tagType,d=1<<a.idx,f=64;"Tag"==a.srcType&&(f=t.getModule("Tag").getNumberOfBits(c)-1);return a.idx>f?b:b|d};a.prototype.setValue=function(b,a,c){"tagSrc"==b&&(b=this.getDataLinkByAttr("tagSrc"),null!=b&&this.p.aIdx!=b.tagIndex&&(this.p.aIdx=b.tagIndex));return!0};return a}(ib);g.addAction("hmiActionSetBit",uf);var vf=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=
function(b,a,c){var d=this;b=this.resolveParameters(a);null==b?this.done():"_TagMgr"==b.src||b.wgtPage?this.project.getTagMgr().resetBitTag(b.tag,b.aIdx,b.idx).then(function(b){d.done()}).catch(function(){d.done()}):(this.setWidgetProperty(b,this.apply.bind(this)),this.done())};a.prototype.apply=function(b,a){b=parseFloat(b);return isNaN(b)||this.isFloat(b)?null:b&~(1<<a.idx)};a.prototype.setValue=function(b,a,c){"tagSrc"==b&&(b=this.getDataLinkByAttr("tagSrc"),null!=b&&this.p.aIdx!=b.tagIndex&&(this.p.aIdx=
b.tagIndex));return!0};return a}(ib);g.addAction("hmiActionResetBit",vf);var wf=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a,c){var d=this;b=this.resolveParameters(a);null==b?this.done():"_TagMgr"==b.src||b.wgtPage?this.project.getTagMgr().setValue(b.tag,b.v,b.aIdx,!0).then(function(b){d.done()}).catch(function(){d.done()}):(this.setWidgetProperty(b,this.apply.bind(this)),this.done())};a.prototype.apply=function(b,a){return a.v};a.prototype.setValue=
function(b,a,c){"tagSrc"==b&&(b=this.getDataLinkByAttr("tagSrc"),null!=b&&this.p.aIdx!=b.tagIndex&&(this.p.aIdx=b.tagIndex))};return a}(ib);g.addAction("hmiActionWriteTag",wf);var xf=function(c){function a(b,a,h,d,f){b=c.call(this,b,a,h,d,f)||this;b.isAggregable=!0;return b}p(a,c);a.prototype.isWriteMessageExecutable=function(){return this.srcDataSrc&&this.dstDataSrc?"Tag"==this.srcType&&"Tag"==this.dstType||"Recipe"==this.srcType&&"Recipe"==this.dstType||"Recipe"==this.srcType&&"Tag"==this.dstType||
"Widget"==this.srcType&&("Tag"==this.dstType||"Recipe"==this.dstType):!1};a.prototype.getAggregationType=function(){return this.isWriteMessageExecutable()?T.MESSAGE:T.NORMAL};a.prototype.getMessage=function(b,a,c,d){if(this.isWriteMessageExecutable()){if("Widget"==this.srcType&&this.srcDataSrc)return b=t.import("ActionMessage"),new b(b.EMessageEvent.eAction_dataTransfer,b.EMessageFlag,{SrcT:"Value",SrcV:this.srcDataSrc.getValue(this.srcTagName,this.srcTagIndex).toString(),DstT:this.dstType,DstV:this.dstTagName+
"."+this.dstTagIndex});if("Widget"!=this.srcType)return b=t.import("ActionMessage"),new b(b.EMessageEvent.eAction_dataTransfer,b.EMessageFlag,{SrcT:this.srcType,SrcV:this.srcTagName+"."+this.srcTagIndex,DstT:this.dstType,DstV:this.dstTagName+"."+this.dstTagIndex})}return null};a.prototype.execute=function(b,a,c,d){this.srcDataSrc&&this.dstDataSrc&&this.srcDataSrc&&(b=new (t.getModule("Quality"))(192),this.dstDataSrc.setValue(this.dstTagName,this.srcDataSrc.getValue(this.srcTagName,this.srcTagIndex),
b,this.dstTagIndex));this.done()};a.prototype.addDataLink=function(b){c.prototype.addDataLink.call(this,b);"SrcTag"==b.attr?(this.srcDataSrc=b.dataSrc,this.srcTagName=b.tag,this.srcTagIndex=b.tagIndex,this.srcType=g.activeProject.getSrcType(b.dataSrc)):"DestTag"==b.attr&&(this.dstDataSrc=b.dataSrc,this.dstTagName=b.tag,this.dstTagIndex=b.tagIndex,this.dstType=g.activeProject.getSrcType(b.dataSrc))};return a}(ib);g.addAction("hmiActionDataTransfer",xf);var yf=function(c){function a(b,a,h,d,f){return c.call(this,
b,a,h,d,f)||this}p(a,c);a.prototype.getMsgEvtCode=function(){return K.EMessageEvent.eAction_showDialog};a.prototype.execute=function(b,a){var c=this,d,f,k=g.activeProject.getPageMgr(),q=k.getCurrentCategory();if(q){var m=(q=q.alias[a.pg])?q:a.pg,q="?"+encodeURIComponent(g.activeProject.studioId),n=g.activeProject.dlgMaxLimit,l=g.activeProject.dlgInstancesActive,p=g.activeProject.getUserGroupMgr(),r=p.getAuthorizationMap(),k=k.getPageStudioId(m);(null===(f=null===(d=null===r||void 0===r?void 0:r.widgets)||
void 0===d?void 0:d[k])||void 0===f?void 0:f[k])===p.getWidgetAuthorizationCodes().HIDE?this.done():(l.length>=n&&void 0!==l[0]&&g.getAction("hmiActionCloseDialog").execute(b,{pg:g.getWidget(l[0]).studioId.toLowerCase()}),null!=m&&void 0!=m?-1==l.indexOf(m)?$.ajax({url:m+".html"+q,dataType:"html",success:function(b){var a,e,d;a=document.createElement("link");a.setAttribute("rel","stylesheet");a.setAttribute("href","../css/pages/_"+m+".css");e=document.createElement("div");e.innerHTML=b;d=e.querySelector("div[data-role='hmi-dialog']");
requestAnimationFrame(function(){Ta(d,"Transform","translateZ(0) scale(0)");document.head.appendChild(a);for(var b=e.getElementsByTagName("script"),f=null,k=null,q=0,n=b.length;q<n;q++){var l=b[q].id;"hmi-page"===l?f=b[q].textContent:"hmi-init"===l&&(k=b[q].textContent)}null!=k&&eval(k);g.getActiveProject().getCWidgetMgr().injectCWTemplates(d,d.getAttribute("id"));c.project.getNode("container").appendChild(d);null!=f&&eval(f);b=g.getPageInitFunction("_"+m)();b.bindCWJSClass();g.activeProject.subscribeDynamicTags();
g.getEventMgr().trigger(g.getFocusPage().getHTMLElement(),"loadWgt");b.show();b.execJS();b.load();c.done()})}}):this.done():this.done())}else this.done()};return a}(r);g.addAction("hmiActionShowDialog",yf);var zf=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a){var c=g.getActiveProject();if("*"==a.pg)c.closeAllDialogs();else{var d=g.getActiveProject().getPageMgr(),f=void 0;if(".*"==a.pg)f=g.getFocusPage().getId();else{var k=d.getCurrentCategory();
k&&(f=(f=k.alias[a.pg])?f:d.getWebPage(a.pg))}c.isActiveDialog(f)&&c.closeDialog(f)}this.done()};return a}(r);g.addAction("hmiActionCloseDialog",zf);var Af=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a){var c=g.getWidget(a[0],!0);c&&c.refresh();this.done()};return a}(r);g.addAction("hmiActionRefreshTrendTable",Af);var Bf=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a){var c=
g.getWidget(a[0],!0);c&&c.moveBackward();this.done()};return a}(r);g.addAction("hmiActionScrollTrendTableBackward",Bf);var Cf=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a){var c=g.getWidget(a[0],!0);c&&c.moveForward();this.done()};return a}(r);g.addAction("hmiActionScrollTrendTableForward",Cf);var Df=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.setValue=function(b,a,c){if(c.isQualityGood())switch(b){case "FolderPath":this.p.f=
a;break;case "CsvFields":this.p.csvfields=a;break;case "CsvLogs":this.p.csvlogs=a;break;case "DateTimeFormat":this.p.dtformat=a;break;case "LangCode":this.p.langcode=a}};a.prototype.execute=function(b,a){var c=this,d=$hmi.getActiveProject().getCommunticationObj();a?d.dumpTrend(a,!1).then(function(){c.done()}).catch(function(){g.debugMode&&g.notifyWarning("DumpTrend","REST status: request failed.");c.done()}):this.done()};return a}(r);g.addAction("hmiActionDumpTrend",Df);var tc;(function(c){c[c.DEFAULT=
0]="DEFAULT";c[c.PROG=1]="PROG";c[c.SUCC=2]="SUCC";c[c.FAILED=3]="FAILED"})(tc||(tc={}));var Ef=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.setValue=function(b,a,c){if(c.isQualityGood())switch(b){case "FilePath":this.p.p=a;break;case "FileName":this.p.fn=a}};a.prototype.execute=function(b,a){var c=this,d=g.getActiveProject().getCommunticationObj();if(a){var f=a.r,k=a.ds,q=a.p,m=a.fn,n=a.dt,l=a.ts,p=a.tagName,m=m.replace(/%r/g,"{{r}}"),m=m.replace(/%d/g,
"{{d}}");d.dumpRecipeData(f,k,q,m,p,n,l,!1).then(function(b){b.status==tc.FAILED&&(b.msg?g.showMessage("Dump Recipe Data",b.msg):g.showMessage("Dump Recipe Data","Error status code:"+b.status));c.done()}).catch(function(){g.debugMode&&g.notifyWarning("DumpRecipeData","REST status: request failed.");c.done()})}else this.done()};return a}(r);g.addAction("hmiActionDumpRecipeData",Ef);var uc;(function(c){c[c.DEFAULT=0]="DEFAULT";c[c.PROG=1]="PROG";c[c.SUCC=2]="SUCC";c[c.FAILED=3]="FAILED"})(uc||(uc={}));
var Ff=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.setValue=function(b,a,c){if(c.isQualityGood())switch(b){case "FilePath":this.p.p=a;break;case "FileName":this.p.fn=a}};a.prototype.execute=function(b,a){var c=this,d=g.getActiveProject().getCommunticationObj();if(a){var f=a.r,k=a.s,q=a.p,m=a.fn,n=a.br,l=a.tagName,p=a.rtype,r=a.matchname,m=m.replace(/%r/g,"{{r}}"),m=m.replace(/%d/g,"{{d}}");d.restoreRecipeData(f,k,q,m,l,n,r,p,!1).then(function(b){b.status==
uc.FAILED&&(b.msg?$hmi.showMessage("Restore Recipe Data",b.msg):$hmi.showMessage("Restore Recipe Data","Error status code:"+b.status));c.done()}).catch(function(){$hmi.debugMode&&$hmi.notifyWarning("RestoreRecipeData","REST status: request failed.");c.done()})}};return a}(r);g.addAction("hmiActionRestoreRecipeData",Ff);var Gf=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a,c){this.exist(b)&&(g.getActiveProject().getWidget("_UserGroupMgr",
!0).loadUMForm(b,c.toLowerCase()),this.done())};return a}(r);g.addAction("hmiActionChangePassword",Gf);var Hf=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a,c){this.exist(b)&&(g.getActiveProject().getWidget("_UserGroupMgr",!0).changePwdAction(),this.done())};return a}(r);g.addAction("hmiActionChangePwd",Hf);var If=function(c){function a(b,a,h,d,f){b=c.call(this,b,a,h,d,f)||this;b.isAggregable=!0;return b}p(a,c);a.prototype.getAggregationType=
function(){return T.MESSAGE};a.prototype.getMsgEvtCode=function(){return K.EMessageEvent.eAction_dbInit};a.prototype.getMessage=function(b,a,c,d){a=t.import("ActionMessage");return new a(a.EMessageEvent.eAction_dbInit,a.EMessageFlag,{DbLink:b.link,SQLquery:b.sql})};a.prototype.execute=function(b,a){this.done()};a.jmType="DBInitAction";return a}(r);g.addAction("hmiActionDBInit",If);var Jf=function(c){function a(b,a,h,d,f){b=c.call(this,b,a,h,d,f)||this;b.isAggregable=!0;return b}p(a,c);a.prototype.getAggregationType=
function(){return T.MESSAGE};a.prototype.getMsgEvtCode=function(){return K.EMessageEvent.eAction_dbQuery};a.prototype.getMessage=function(b,a,c,d){c=g.import("IDGenerator");a=g.getWidget("_DBConnectorMgr",!0);c=c.generateRandomID();a.registerDBQueryCb(c,b.cb);a=t.import("ActionMessage");return new a(a.EMessageEvent.eAction_dbQuery,a.EMessageFlag,{DbLink:b.link,SQLquery:b.sql,resultSetAsJson:b.rsType.toString(),DBsessionId:c})};a.prototype.execute=function(b,a){this.done()};a.jmType="DBQuery";return a}(r);
g.addAction("hmiActionDBQuery",Jf);var Kf=function(c){function a(b,a,h,d,f){b=c.call(this,b,a,h,d,f)||this;b.isAggregable=!0;return b}p(a,c);a.prototype.getAggregationType=function(){return T.MESSAGE};a.prototype.getMsgEvtCode=function(){return K.EMessageEvent.eAction_dbReadGroups};a.prototype.getMessage=function(b,a,c,d){a=t.import("ActionMessage");return new a(a.EMessageEvent.eAction_dbReadGroups,a.EMessageFlag,{DbLink:b.link,SQLquery:b.sql,Groups:b.groups.split(";")})};a.prototype.execute=function(b,
a){this.done()};a.jmType="DBReadGroups";return a}(r);g.addAction("hmiActionDBReadGroups",Kf);var Lf=function(c){function a(b,a,h,d,f){b=c.call(this,b,a,h,d,f)||this;b.isAggregable=!0;return b}p(a,c);a.prototype.getAggregationType=function(){return T.MESSAGE};a.prototype.getMsgEvtCode=function(){return K.EMessageEvent.eAction_dbReadRecipes};a.prototype.getMessage=function(b,a,c,d){a=t.import("ActionMessage");return new a(a.EMessageEvent.eAction_dbReadRecipes,a.EMessageFlag,{DbLink:b.link,SQLquery:b.sql,
Recipes:b.recipes.split(";")})};a.prototype.execute=function(b,a){this.done()};a.jmType="DBReadRecipes";return a}(r);g.addAction("hmiActionDBReadRecipes",Lf);var Mf=function(c){function a(b,a,h,d,f){b=c.call(this,b,a,h,d,f)||this;b.isAggregable=!0;return b}p(a,c);a.prototype.getAggregationType=function(){return T.MESSAGE};a.prototype.getMsgEvtCode=function(){return K.EMessageEvent.eAction_dbReadTags};a.prototype.getMessage=function(b,a,c,d){a=t.import("ActionMessage");return new a(a.EMessageEvent.eAction_dbReadTags,
a.EMessageFlag,{DbLink:b.link,SQLquery:b.sql,Tags:b.tags.split(";")})};a.prototype.execute=function(b,a){this.done()};a.jmType="DBReadTags";return a}(r);g.addAction("hmiActionDBReadTags",Mf);var Nf=function(c){function a(b,a,h,d,f){b=c.call(this,b,a,h,d,f)||this;b.isAggregable=!0;return b}p(a,c);a.prototype.getAggregationType=function(){return T.MESSAGE};a.prototype.getMsgEvtCode=function(){return K.EMessageEvent.eAction_DBResetErrors};a.prototype.getMessage=function(b,a,c,d){a=t.import("ActionMessage");
return new a(a.EMessageEvent.eAction_DBResetErrors,a.EMessageFlag,{DbLink:b.link})};a.prototype.execute=function(b,a){this.done()};a.jmType="DBResetErrors";return a}(r);g.addAction("hmiActionDBResetErrors",Nf);var Of=function(c){function a(b,a,h,d,f){b=c.call(this,b,a,h,d,f)||this;b.isAggregable=!0;return b}p(a,c);a.prototype.getAggregationType=function(){return T.MESSAGE};a.prototype.getMsgEvtCode=function(){return K.EMessageEvent.eAction_dbWriteEvents};a.prototype.getMessage=function(b,a,c,d){a=
t.import("ActionMessage");return new a(a.EMessageEvent.eAction_dbWriteEvents,a.EMessageFlag,{DbLink:b.link,SQLquery:b.sql,DurationIndex:b.durationIdx,EventArchiveName:b.eventArchive})};a.prototype.execute=function(b,a){this.done()};a.jmType="DBWriteEvents";return a}(r);g.addAction("hmiActionDBWriteEvents",Of);var Pf=function(c){function a(b,a,h,d,f){b=c.call(this,b,a,h,d,f)||this;b.isAggregable=!0;return b}p(a,c);a.prototype.getAggregationType=function(){return T.MESSAGE};a.prototype.getMsgEvtCode=
function(){return K.EMessageEvent.eAction_dbWriteGroups};a.prototype.getMessage=function(b,a,c,d){a=t.import("ActionMessage");return new a(a.EMessageEvent.eAction_dbWriteGroups,a.EMessageFlag,{DbLink:b.link,SQLquery:b.sql,Groups:b.groups.split(";")})};a.prototype.execute=function(b,a){this.done()};a.jmType="DBWriteGroups";return a}(r);g.addAction("hmiActionDBWriteGroups",Pf);var Qf=function(c){function a(b,a,h,d,f){b=c.call(this,b,a,h,d,f)||this;b.isAggregable=!0;return b}p(a,c);a.prototype.getAggregationType=
function(){return T.MESSAGE};a.prototype.getMsgEvtCode=function(){return K.EMessageEvent.eAction_dbWriteRecipes};a.prototype.getMessage=function(b,a,c,d){a=t.import("ActionMessage");return new a(a.EMessageEvent.eAction_dbWriteRecipes,a.EMessageFlag,{DbLink:b.link,SQLquery:b.sql,Recipes:b.recipes.split(";")})};a.prototype.execute=function(b,a){this.done()};a.jmType="DBWriteRecipes";return a}(r);g.addAction("hmiActionDBWriteRecipes",Qf);var Rf=function(c){function a(b,a,h,d,f){b=c.call(this,b,a,h,d,
f)||this;b.isAggregable=!0;return b}p(a,c);a.prototype.getAggregationType=function(){return T.MESSAGE};a.prototype.getMsgEvtCode=function(){return K.EMessageEvent.eAction_dbWriteTags};a.prototype.getMessage=function(b,a,c,d){a=t.import("ActionMessage");return new a(a.EMessageEvent.eAction_dbWriteTags,a.EMessageFlag,{DbLink:b.link,SQLquery:b.sql,Tags:b.tags.split(";")})};a.prototype.execute=function(b,a){this.done()};a.jmType="DBWriteTags";return a}(r);g.addAction("hmiActionDBWriteTags",Rf);var Sf=
function(c){function a(b,a,h,d,f){b=c.call(this,b,a,h,d,f)||this;b.isAggregable=!0;return b}p(a,c);a.prototype.getAggregationType=function(){return T.MESSAGE};a.prototype.getMsgEvtCode=function(){return K.EMessageEvent.eAction_dbWriteTrends};a.prototype.getMessage=function(b,a,c,d){a=t.import("ActionMessage");return new a(a.EMessageEvent.eAction_dbWriteTrends,a.EMessageFlag,{DbLink:b.link,SQLquery:b.sql,Trend:b.trend,DurationIndex:b.durationIdx})};a.prototype.execute=function(b,a){this.done()};a.jmType=
"DBWriteTrends";return a}(r);g.addAction("hmiActionDBWriteTrends",Sf);var Tf=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.execute=function(b,a){if(a.dataSrc){var c=g.getWidget(a.dataSrc,!0);c&&c.refresh()}this.done()};a.jmType="RefreshDBTable";return a}(r);g.addAction("hmiActionRefreshDBTable",Tf);var Vf=function(){function c(){this.actionFactory=new Uf;this.srv=g.activeProject.getCommunticationObj()}c.prototype.startEventBasedCommunication=function(){this.srv.subscribeToMessageEvent(this.onDataReady.bind(this))};
c.prototype.stopEventBasedCommunication=function(){this.srv.unsubscribeFromMessageEvent()};c.prototype.onDataReady=function(a){var b=this;a.forEach(function(a){var c=a.v.i;(c==K.EMessageEvent.eAction_dbQuery||c==K.EMessageEvent.eAction_refreshScheduler)&&(c=b.actionFactory.createAction(c,a.v))&&g.activeProject.getActionMgr().notifyActionExecution(c,a.v)})};return c}();t.export("SSENotificationHandler",Vf);var Wf=function(c){function a(b,a,h,d,f){b=c.call(this,b,a,h,d,f)||this;b.isAggregable=!0;return b}
p(a,c);a.prototype.getMsgEvtCode=function(){return K.EMessageEvent.eAction_refreshScheduler};a.prototype.execute=function(b,a){var c=g.activeProject.getWidget("_ScheduleMgr",!0);c&&c.refresh([a.data]);this.done()};a.jmType="RefreshScheduler";return a}(r);g.addAction("hmiActionRefreshScheduler",Wf);var Uf=function(){function c(){}c.prototype.createAction=function(a,b){var c=g.activeProject.getActionMgr(),h=null,d={wgtId:null,event:null,options:{p:{actID:-1},c:"",t:0},parentPage:null,parentWidget:null},
f=function(b){b=b.page.split(".jmx")[0].toLowerCase();b=g.activeProject.getPageMgr().getWebPage(b);var a=g.activeProject.getPageMgr().getCurrentCategory(),a=a?a.alias[b]:void 0;return{pg:a?a:b}},k=function(b){var a=b.msg.match(/\[(.*?)\]/g);if(null!==a){var c=a[0].substring(1,a[0].length-1),a=c.split("@")[0],c=c.split("@")[1];if("Scheduler"==c)return{msg:g.getWidget("_ScheduleMgr",!0).getMLText(a)};if("Alarm"==c)return{msg:g.getWidget("_AlarmsMgr",!0).getMLText(a)}}return{msg:b.msg}};switch(a){case K.EMessageEvent.eAction_dbQuery:d.options.t=
0;d.options.c="DBQuery";h=c.getActionInstance("hmiActionDBQuery",d);break;case K.EMessageEvent.eAction_showMessage:d.options.t=0;d.options.c="ShowMessage";d.options.p=Object.assign(d.options.p,k(b.v));h=c.getActionInstance("hmiActionShowMessage",d);break;case K.EMessageEvent.eAction_showDialog:d.options.t=0;d.options.c="ShowDialog";d.options.p=Object.assign(d.options.p,f(b.v));h=c.getActionInstance("hmiActionShowDialog",d);break;case K.EMessageEvent.eAction_goToPage:d.options.t=0;d.options.c="LoadPage";
d.options.p=Object.assign(d.options.p,f(b.v));h=c.getActionInstance("hmiActionLoadPage",d);break;case K.EMessageEvent.eAction_nextPage:d.options.t=0;d.options.c="NextPage";h=c.getActionInstance("hmiActionNextPage",d);break;case K.EMessageEvent.eAction_previousPage:d.options.t=0;d.options.c="PrevPage";h=c.getActionInstance("hmiActionPrevPage",d);break;case K.EMessageEvent.eAction_jsAction:d.options.t=1;d.options.c=b.v.func;h=c.getActionInstance("hmiActionJS",d);break;case K.EMessageEvent.eAction_refreshScheduler:d.options.t=
0;d.options.p=Object.assign(d.options.p,{data:b.v});h=c.getActionInstance("hmiActionRefreshScheduler",d);break;case K.EMessageEvent.eAction_setLanguage:d.options.t=0,d.options.p=Object.assign(d.options.p,{id:"L"+b.v.lang}),h=c.getActionInstance("hmiActionSetLanguage",d)}return h};return c}();l.prototype.opacity=1;l.prototype.visible=!0;l.prototype.blink=0;l.prototype.x=null;l.prototype.y=null;l.prototype.parentWidget=null;l.prototype.xFromScaling=!1;l.prototype.isTemplateWgt=!1;l.prototype.hT=-1;
l.prototype.aRT=-1;l.prototype.aRM=0;l.prototype.passthru=2;l.prototype.passthruDelay=-1;l.prototype.disabled=!1;l.prototype.nWgts=0;l.prototype.qualityIcon=-1;l.prototype.firstQualityShow=!0;l.prototype._initialized=!1;l.prototype._currentRot=null;l.prototype._center=null;l.prototype._boundingRect=null;l.prototype._subscriptions=null;l.prototype._renderMask=0;l.prototype._baseRenderMask=0;l.prototype._baseRenderFlags={X:2,Y:4,CX:8,CY:16,WIDTH:32,HEIGHT:64,ROTATION:128,BLINK:512,VISIBLE:1024,OPACITY:2048,
SHOWINFOICON:4096,HIDEINFOICON:8192,SHOW_UNC_IC_QUALITY:16384,SHOW_BAD_IC_QUALITY:32768,REMOVE_IC_QUALITY:65536};l.prototype.invokablePropsList=["visible"];l.prototype.invokableFunList=[];l.prototype._userValue=null;l.prototype.module=null;l.prototype._$elem=void 0;l.prototype.masked=!1;l.prototype.maskChar="*";l.jmType=null;l.wgtAuth={HIDE:0,RDONLY:1,FULL:2,DEFAULT:3};Object.defineProperty(l.prototype,"$elem",{get:function(){void 0===this._$elem&&(this._$elem=$(this.elem));return this._$elem},set:function(c){this._$elem=
c}});Object.defineProperty(l.prototype,"currentRot",{get:function(){null==this._currentRot&&(this._currentRot=this._getCurrentRotation());return this._currentRot},set:function(c){this._currentRot=c}});Object.defineProperty(l.prototype,"center",{get:function(){null==this._center&&(this._center=this._map(Mc(this.mtx),{x:this.cx,y:this.cy}));return this._center},set:function(c){this._center=c}});Object.defineProperty(l.prototype,"boundingRect",{get:function(){var c=this.elem,a=[],b=null,e=null,b=c,c=
g.getFocusPage().getWidget(c.id),h=!0;do if((e=c)?a.push(e.getTransformMatrix()):a.push(Nc($(b).css("transform"))),b=b.parentElement,e&&(c=e.parentWidget),e.constructor==R||e.constructor==hb)h=!1;while(h);e=[[1,0,0],[0,1,0],[0,0,1]];for(b=a.length-1;0<=b;b--)e=Xa(e,a[b]);return this._boundingRect=this._mapRect(e,{x:0,y:0,width:this.width,height:this.height})},set:function(c){this._boundingRect=c}});Object.defineProperty(l.prototype,"id",{get:function(){return this.studioId}});l.prototype._registerJSActions=
function(c,a){var b=this;return c.map(function(c){if(c.t===g.actionMgr.enActionType.JS){var h;h=b.constructor===R?b:c.alAction?g.getActiveProject():b.constructor===hb?b:b.parentPage;c.c=h.registerPageCallback(c.c,b,a)}return c})};l.prototype.updateTransform=function(){this.mtx=this._getTransformMtx($(this.elem).css("transform"));this.currentRot=this._getCurrentRotation()};l.prototype.setId=function(c){this.wgtId=c};l.prototype._getCurrentRotation=function(){var c=this.mtx;return Math.atan2(c[1][0],
c[0][0])*(180/Math.PI)};l.prototype._setRotation=function(c){var a=c-this.currentRot,b=this.center.x,e=this.center.y,h=Math.PI/180,d=Math.cos(a*h),a=Math.sin(a*h),d=Xa([[1,0,b],[0,1,e],[0,0,1]],[[d,-a,0],[a,d,0],[0,0,1]]),d=Xa(d,[[1,0,-b],[0,1,-e],[0,0,1]]);this.mtx=d=Xa(d,this.mtx);this.currentRot=c};l.prototype.render=function(){if(!this.elem)return!1;this._baseRenderMask&this._baseRenderFlags.ROTATION&&(g.browserOptimizations.forceLayers?(this.elem.style.msTransform="translateZ(0) "+Ka(this.mtx),
this.elem.style.webkitTransform="translateZ(0) "+Ka(this.mtx),this.elem.style.transform="translateZ(0) "+Ka(this.mtx)):(this.elem.style.msTransform=Ka(this.mtx),this.elem.style.webkitTransform=Ka(this.mtx),this.elem.style.transform=Ka(this.mtx)));this._baseRenderMask&this._baseRenderFlags.VISIBLE&&(this.elem.style.display=this.visible?null:"none");this._baseRenderMask&this._baseRenderFlags.OPACITY&&(this.elem.style.opacity=this.opacity);this._baseRenderMask&this._baseRenderFlags.BLINK&&(this.blink?
this.elem.classList.add("jm-blink"):this.elem.classList.remove("jm-blink"));this._baseRenderMask&this._baseRenderFlags.X&&(this.elem.style.left=this.x+"px",this.left=this.x);this._baseRenderMask&this._baseRenderFlags.Y&&(this.elem.style.top=this.y+"px",this.top=this.y);this._baseRenderMask&this._baseRenderFlags.WIDTH&&(this.elem.style.width=this.width+"px");this._baseRenderMask&this._baseRenderFlags.HEIGHT&&(this.elem.style.height=this.height+"px");this._baseRenderMask&this._baseRenderFlags.SHOWINFOICON&&
this.addAccessDeniedIcon();this._baseRenderMask&this._baseRenderFlags.HIDEINFOICON&&this.removeAccessDeniedIcon();this._baseRenderMask&this._baseRenderFlags.SHOW_UNC_IC_QUALITY&&(this.qualityIcon=0,this.showQualityIcon(this.qualityIcon));this._baseRenderMask&this._baseRenderFlags.SHOW_BAD_IC_QUALITY&&(this.qualityIcon=1,this.showQualityIcon(this.qualityIcon));this._baseRenderMask&this._baseRenderFlags.REMOVE_IC_QUALITY&&(this.qualityIcon=-1,this.hideQualityIcon());this._baseRenderMask=0;return!0};
l.prototype.getTransformMatrix=function(){return this.mtx};l.prototype._getTransformMtx=function(c){return Nc(c)};l.prototype.setElem=function(c){this.elem=c};l.prototype.setOptions=function(c){if(null!=c){this._options=c;for(var a in c)switch(a){case "br":this.boundingRect={x:0,y:0,height:c[a][3],width:c[a][2]};break;case "x":this.left=c.x;break;case "y":this.top=c.y;break;case "w":this.width=c.w;break;case "h":this.height=c.h;break;case "id":break;default:this.setDefaultOption(a,c[a])}}};l.prototype.setDefaultOption=
function(c,a){this[c]=a};l.prototype.setOption=function(c,a){this.setValue(c,a)};l.prototype.getOptions=function(){var c=Object.keys(this._options),a;for(a in c)this._options[c[a]]=this[c[a]]instanceof Array?this[c[a]].slice(0):this[c[a]];return this._options};l.prototype.init=function(){};l.prototype.setValue=function(c,a,b,e,h){e=!1;h=-1;if(this.isBadValue(a,!1,b))return!1;if("visibility"==c||"visible"==c)"boolean"!=typeof a&&(a=parseInt(a)),this.visible!=a&&(this.visible=a,e=this.getAuthorizations(),
this.umgr&&e==this.umgr.getWidgetAuthorizationCodes().HIDE&&(this.visible=!1),this._baseRenderMask|=this._baseRenderFlags.VISIBLE,e=!0,h=0);else if("opacity"===c||"fill-opacity"===c)a="boolean"==typeof a?1==a?1:0:parseFloat(a),this.opacity!=a&&(this.opacity=a,this._baseRenderMask|=this._baseRenderFlags.OPACITY,e=!0,h=0);else if("blink"===c){a="boolean"==typeof a?1==a?1:0:parseFloat(a);if(1<a||0>a)a=1;this.blink!=a&&(this.blink=a,this._baseRenderMask|=this._baseRenderFlags.BLINK,e=!0,h=0)}else if("x"===
c)a=parseFloat(a),this.x!=a&&(this.x=a,this._baseRenderMask|=this._baseRenderFlags.X,e=!0,h=0);else if("y"===c)a=parseFloat(a),this.y!=a&&(this.y=a,this._baseRenderMask|=this._baseRenderFlags.Y,e=!0,h=0);else if("width"==c){if(a!=this.width){2>a&&(a=2);var d=g.getActivePage(),f=this.boundingRect.height;d.isFitToSizeEnable()&&(f=Number(Math.round(f/d.getScaleFactors().y+"e3")+"e-3"));this.setParentBounds(this.left,this.top,a,f,this.parentWidget)}}else"height"==c?a!=this.height&&(2>a&&(a=2),d=g.getActivePage(),
f=this.boundingRect.width,d.isFitToSizeEnable()&&(f=Number(Math.round(f/d.getScaleFactors().x+"e3")+"e-3")),this.setParentBounds(this.left,this.top,f,a,this.parentWidget)):"rot"==c?(a=parseFloat(a),this.rot!=a&&(this._setRotation(a),this._baseRenderMask|=this._baseRenderFlags.ROTATION,e=!0,h=0)):"disabled"==c&&this.disabled!=a&&(this.disabled=1==a,e=!0,h=0);e&&(g.addToRender(this),this.sendUpdate(c,a,b));return h};l.prototype.setProperty=function(c,a,b){this.setValue(c,a,Ma.QUALITY_GOOD)};l.prototype.getValue=
function(c){var a={x:"left",y:"top",height:"height",width:"width"};return"id"==c||"objectName"==c?this.studioId:"visibility"==c?null==this.elem.style.display||"none"==this.elem.style.display?0:1:"opacity"==c||"fill-opacity"==c?this.opacity:"undefined"!==typeof a[c]?this.elem?this.elem.style[a[c]].split("px")[0]:null:this[c]};l.prototype.getProperty=l.prototype.getParameter=function(c,a){return this.getValue(c,a)};l.prototype.getHTMLElement=function(){return this.elem};l.prototype.hasPropInDatalinks=
function(c){this["has"+c+"PropInDatalinks"]=null!=c?!0:!1};l.prototype.allowUpdateLanguageOnProps=function(c){if(this.isClone)return!0;for(var a=0;a<c.length;a++)if(this["has"+c[a]+"PropInDatalinks"])return!1;return this.isMl};l.prototype.addDataLink=function(c){this.parentPage?this.parentPage.registerLink(c):this.registerLink&&this.registerLink(c);this.subscribeDataLink(c)};l.prototype.initDataLinkSideEffects=function(c,a){};l.prototype.subscribeDataLink=function(c){void 0==this.dataLinks&&(this.dataLinks=
{});this.dataLinks[c.getId()]=c};l.prototype.removeDataLink=l.prototype.unsubscribeDataLink=function(c){this.dataLinks&&c&&delete this.dataLinks[c.getId()]};l.prototype.sendUpdate=function(c,a,b){if(null!=this.dataLinks){var e,h;for(h in this.dataLinks)e=this.dataLinks[h],e.dataSrcId===this.wgtId&&e.tag===c&&e.setWgtValue(a,void 0,b)}null!=this.module&&(this.hasSubscriptionFor(this.module)?this.sendNotification("mdup",{attr:c,v:a,q:b}):(e=this.studioId.indexOf(this.module.studioId),-1!==e&&(e="*."+
this.studioId.substr(e+this.module.studioId.length+1)+".",e="*"==c.charAt(0)&&"."==c.charAt(1)?e+c.substr(2):e+c,this.module.sendUpdate(e,a,b))))};l.prototype.areAliases=function(c,a){return!1};l.prototype.doWriteValue=function(c,a){var b=this;return new Promise(function(e){var h=[],d;for(d in b.dataLinks){var f=b.dataLinks[d];(f.attr===c||f.tgtWgt.areAliases&&f.tgtWgt.areAliases(f.attr,c))&&f.dataSrc!==b&&"r"!==f.getValue("rw")&&h.push(f.setTagValue(a))}if(0===h.length&&b.module){if(h=b.studioId.indexOf(b.module.studioId),
-1!==h)return h="*."+b.studioId.substr(h+b.module.studioId.length+1)+".",h="*"===c.charAt(0)&&"."===c.charAt(1)?h+c.substr(2):h+c,b.module.doWriteValue(h,a)}else Promise.all(h).then(function(){e()})})};l.prototype.isBadValue=function(c,a,b){if(null!=this.umgr&&0==this.getAuthorizations()||this.elem&&"none"==this.elem.style.display||null===b)return!1;var e=this,h=function(b){-1!=e.project.iconStatusDelay&&setTimeout(function(){if(!e.destroyed){switch(b){case -1:e._baseRenderMask|=e._baseRenderFlags.REMOVE_IC_QUALITY;
break;case 0:e._baseRenderMask|=e._baseRenderFlags.SHOW_UNC_IC_QUALITY;break;case 1:e._baseRenderMask|=e._baseRenderFlags.SHOW_BAD_IC_QUALITY}g.addToRender(e)}},e.project.iconStatusDelay)};if(b){if(b.isQualityGood())return h(-1),!1;b.isQualityUncertain()?h(0):h(1);return!0}if(null===c||void 0===c||void 0===a&&isNaN(c))return h(0),!0;h(-1);return!1};l.prototype.showQualityIcon=function(c){this.elem&&(!0===this.firstQualityShow&&(this.firstQualityShow=!1),this.elem&&-1!=this.qualityIcon&&(this.hideQualityIcon(),
this.addQualityIcon()))};l.prototype.hideQualityIcon=function(){this.elem&&(-1<this.elem.className.indexOf("jm-bad-a")&&(this.removeValueIcon(1),this.elem.classList.remove("jm-bad-a")),-1<this.elem.className.indexOf("jm-unc-a")&&(this.removeValueIcon(0),this.elem.classList.remove("jm-unc-a")))};l.prototype.addQualityIcon=function(){if(this.elem){var c;0==this.qualityIcon?(this.elem.classList.add("jm-unc-a"),c="jm-unc"):(this.elem.classList.add("jm-bad-a"),c="jm-bad");var a=this.wgtId+"_"+c;c='<div id="'+
a+'" class="'+c+'"></div>';this.parentWidget?"TableGroupWgt"===this.parentWidget.getJMType()?$("#"+CSS.escape(this.parentWidget.wgtId+".body")).append(c):$(this.parentWidget.elem).append(c):$(this.elem).append(c);c=parseFloat(this.elem.style.left.split("px")[0]);parseFloat(this.elem.style.width.split("px")[0]);var b=parseFloat(this.elem.style.top.split("px")[0]);(a=$("#"+CSS.escape(a)))&&a.css({position:"absolute",left:c,top:b,width:16,height:16})}};l.prototype.removeValueIcon=function(c){var a;1==
c?a=this.wgtId+"_jm-bad":0==c&&(a=this.wgtId+"_jm-unc");void 0!==a&&(c=document.getElementById(a),null!=c&&c.parentNode.removeChild(c))};l.prototype.showHideAccessDeniedIcon=function(){if(!this.adIconVisible){this.showAccessDeniedIcon();this.adIconVisible=!0;var c=this;window.setTimeout(function(){c.hideAccessDeniedIcon();c.adIconVisible=!1},2500)}};l.prototype.showAccessDeniedIcon=function(){this._baseRenderMask|=this._baseRenderFlags.SHOWINFOICON;g.addToRender(this)};l.prototype.hideAccessDeniedIcon=
function(){this._baseRenderMask|=this._baseRenderFlags.HIDEINFOICON;g.addToRender(this)};l.prototype.addAccessDeniedIcon=function(){if(this.elem){var c=this.wgtId+"_ad",a=document.createElement("div");a.setAttribute("id",c);a.setAttribute("class","hmi-access-denied");a.style.position="absolute";a.style.left=this.left+this.width-24+"px";a.style.top=this.top+"px";a.style.width="24px";a.style.height="24px";this.parentWidget?this.parentWidget.elem.appendChild(a):this.elem.appendChild(a)}};l.prototype.removeAccessDeniedIcon=
function(){var c=document.getElementById(this.wgtId+"_ad");null!=c&&c.parentNode.removeChild(c)};l.prototype.addWidget=function(c,a){this.wgts||(this.wgts={});null===this.wgtsOrder&&(this.wgtsOrder=[]);this.wgts[c]=a;this.wgtsOrder.push(c);this.nWgts++;a.studioId?this.mapId[a.studioId.toLowerCase()]=c:this.mapId[a.studioId]=c};l.prototype.removeWidget=function(c){if(this.wgts&&void 0!==this.wgts[c]){var a=this.wgtsOrder.indexOf(c);-1!=a&&this.wgtsOrder.splice(a,1);delete this.wgts[c];this.nWgts--}};
l.prototype.getChild=function(c){return 0!=this.nWgts&&0<=c&&c<this.nWgts?this.wgts[this.wgtsOrder[c]]:null};l.prototype.getChildrendNumber=function(){return this.nWgts};l.prototype.getWidget=function(c,a,b){var e=this.wgts;if(a&&c==this.studioId)return this;if(null===e)return null;a&&void 0!==this.mapId[c]&&(c=this.mapId[c]);var h=e[c];if(void 0!==h)return b?h.isTemplateWgt?h:null:h;for(var d in e)if(h=e[d].getWidget(c,a,b),null!==h)if(b){if(h.isTemplateWgt)return h}else return h;return null};l.prototype.getWidgetByClass=
function(c){return this.getWidgetByCondition(function(a){return a.constructor==c})};l.prototype.getWidgetByCondition=function(c){for(var a=[this];0<a.length;){var b=a.pop(),e;for(e in b.wgts){b=this.wgts[e];if(c(b))return b;0<b.nWgts&&a.push(b)}}return null};l.prototype.getWidgetByJMType=function(c){var a=null,b=1,e=c.match(/\d+$/),h=-1;null!=e&&(c=c.replace(e[0],""),h=parseInt(e[0]));for(var d in this.wgts){e=this.wgts[d];if(e.getJMType()==c&&-1==h||e.getJMType()==c&&h==b)return e;e.getJMType()==
c&&-1!=h&&h!=b&&b++;e.wgts&&(a=e.getWidgetByJMType(c))}return a};l.prototype.resolveAliasAttribute=function(c,a){var b=c.split("."),e=b[0],b=b[1],h=e.replace(/[0-9]/g,""),e=parseInt(e.substring(h.length));isNaN(e)&&(e=1);h=$("div[data-widget='"+h+"']",this.elem);0<h.length&&h.length>=e?(e=h[e-1].getAttribute("id"),a.wgt=this.getWidget(e),a.prop=b):a.wgt=null};l.prototype.getWebIdFromAlias=function(c){for(var a=[],b,e=0;e<c.length;e++)b=c[e].split(".")[0],a.push(b);return a};l.prototype.getPropFromAlias=
function(c){for(var a=[],b,e=0;e<c.length;e++)b=c[e].split(".")[1],a.push(b);return a};l.prototype.getJsObject=function(){return this.constructor==Va&&this.js?this.js:this.parentWidget?this.parentWidget.getJsObject():null};l.prototype.getAbsolutePosition=function(){for(var c=this.parentWidget,a=this.left,b=this.top;!(!c||c==this||c instanceof R||c instanceof hb);){var e=c.left||0,h=c.top||0,d=0,f=0;c instanceof Va&&c.hasGridLayout()&&(d=c.getXScrollPosition(),this.isInHeader||(f=c.getYScrollPosition(),
c instanceof Pa&&(b+=c.getHeaderHeight())),b+=c.getGlobalStrokeWidth(),a+=c.getGlobalStrokeWidth());b-=f;a-=d;b+=h;a+=e;c=c.parentWidget}return{x:a,y:b}};l.prototype.getParentTransform=function(c){for(var a=this.parentWidget,b=[];a!=c;)e=a.mtx,b.push([[e[0][0],e[0][1],e[0][2]+a.left],[e[1][0],e[1][1],e[1][2]+a.top],[e[2][0],e[2][1],e[2][2]]]),a=a.parentWidget;var e=this.mtx;c=[[1,0,0],[0,1,0],[0,0,1]];for(a=b.length-1;0<=a;a--)c=ma(c,b[a]);return c=ma(c,[[e[0][0],e[0][1],e[0][2]+this.left],[e[1][0],
e[1][1],e[1][2]+this.top],[e[2][0],e[2][1],e[2][2]]])};l.prototype.updateOnResize=function(c){c&&(this.top=c.y,this.left=c.x,this.width=c.width,this.height=c.height,this.cx=c.center.x,this.cy=c.center.y,this.mtx=c.mtx)};l.prototype.setParentBounds=function(c,a,b,e,h){if(h!=this.parentWidget){h=this.getParentTransform(h);var d=Mc(h),f=this._mapRect(ma(h,this.mtx),{x:0,y:0,width:this.width,height:this.height}),k=1,g=1,k=0==f.width?0==b?1:b/1E-6:b/f.width,g=0==f.height?0==e?1:e/1E-6:e/f.height,g=[[k,
0,0],[0,g,0],[0,0,1]];b=ma(h,this.mtx);b=ma(g,b);b=ma(d,b);g=ma(g,h);g=ma(d,g);e=Math.sqrt(b[0][0]*b[0][0]+b[1][0]*b[1][0]);f=Math.sqrt(b[0][1]*b[0][1]+b[1][1]*b[1][1]);k=[[1/e,0,0],[0,1/f,0],[0,0,1]];this.xformScaling?this.mtx=ma(g,this.mtx):(this.mtx=ma(b,k),this.center.x*=e,this.center.y*=f,this.width*=e,this.height*=f,this.elem.style.width=this.width+"px",this.elem.style.height=this.height+"px");ga(this.elem,Ka(this.mtx));this.updateBoundingRect();this._normalizePosition(h,d,{x:c,y:a})}else f=
ic(this.mtx)?{x:0,y:0,width:this.width,height:this.height}:this._mapRect(this.mtx,{x:0,y:0,width:this.width,height:this.height}),k=0==f.width?0==b?1:b/1E-6:b/f.width,g=0==f.height?0==e?1:e/1E-6:e/f.height,g=[[k,0,0],[0,g,0],[0,0,1]],b=ma(g,this.mtx),e=Math.sqrt(b[0][0]*b[0][0]+b[1][0]*b[1][0]),f=Math.sqrt(b[0][1]*b[0][1]+b[1][1]*b[1][1]),k=[[1/e,0,0],[0,1/f,0],[0,0,1]],this.xformScaling?this.mtx=ma(g,this.mtx):(this.mtx=ma(b,k),this.center.x*=e,this.center.y*=f,this.width*=e,this.height*=f,this.elem.style.width=
this.width+"px",this.elem.style.height=this.height+"px"),this.updateBoundingRect(),this._normalizePosition(null,null,{x:c,y:a});c=this._map(this.mtx,this.center);this.cx=c.x;this.cy=c.y};l.prototype._normalizePosition=function(c,a,b){var e=g.matrixPool,h=e.getMatrix3(this.mtx[0][0],this.mtx[0][1],0,this.mtx[1][0],this.mtx[1][1],0,this.mtx[2][0],this.mtx[2][1],1),d=e.getMatrix3(0,0,0,0,0,0,0,0,0),f=h.m,k={x:0,y:0,width:this.width,height:this.height},q=this._mapRect(f,k),q=ic(f)?k:this._mapRect(f,k);
if(null===c)c=f;else{var m=d.m;m[0][0]=c[0][0]*f[0][0]+c[0][1]*f[1][0]+c[0][2]*f[2][0];m[0][1]=c[0][0]*f[0][1]+c[0][1]*f[1][1]+c[0][2]*f[2][1];m[0][2]=c[0][0]*f[0][2]+c[0][1]*f[1][2]+c[0][2]*f[2][2];m[1][0]=c[1][0]*f[0][0]+c[1][1]*f[1][0]+c[1][2]*f[2][0];m[1][1]=c[1][0]*f[0][1]+c[1][1]*f[1][1]+c[1][2]*f[2][1];m[1][2]=c[1][0]*f[0][2]+c[1][1]*f[1][2]+c[1][2]*f[2][2];m[2][0]=c[2][0]*f[0][0]+c[2][1]*f[1][0]+c[2][2]*f[2][0];m[2][1]=c[2][0]*f[0][1]+c[2][1]*f[1][1]+c[2][2]*f[2][1];m[2][2]=c[2][0]*f[0][2]+
c[2][1]*f[1][2]+c[2][2]*f[2][2];c=m}k=ic(c)?k:this._mapRect(c,k);k=null===a?{x:k.x,y:k.y}:this._map(a,{x:k.x,y:k.y});a=null===a?b:this._map(a,b);this.mtx[0][2]=-q.x;this.mtx[1][2]=-q.y;this.mtx[2][2]=1;this.top=a.y-(k.y-q.y);this.left=a.x-(k.x-q.x);this.elem.style.top=this.top+"px";this.elem.style.left=this.left+"px";ga(this.elem,Ka(this.mtx));this.updateBoundingRect();e.free3(h);e.free3(d)};l.prototype.getParentBounds=function(c){c=this.getParentTransform(c);return this._mapRect(c,{x:0,y:0,width:this.width,
height:this.height})};l.prototype._mapRect=function(c,a){a.right=a.x+a.width;a.bottom=a.y+a.height;a.top=a.y;a.left=a.x;var b=this._map(c,{x:a.left,y:a.top}),e=b.x,h=b.y,d=b.x,f=b.y,b=this._map(c,{x:a.right,y:a.top}),e=Math.min(e,b.x),h=Math.min(h,b.y),d=Math.max(d,b.x),f=Math.max(f,b.y),b=this._map(c,{x:a.right,y:a.bottom}),e=Math.min(e,b.x),h=Math.min(h,b.y),d=Math.max(d,b.x),f=Math.max(f,b.y),b=this._map(c,{x:a.left,y:a.bottom}),e=Math.min(e,b.x),h=Math.min(h,b.y),d=Math.max(d,b.x),f=Math.max(f,
b.y);return{x:e,y:h,width:d-e,height:f-h}};l.prototype.updateBoundingRect=function(){this.boundingRect=null};l.prototype._map=function(c,a){var b=g.matrixPool,e=b.getMatrix3x1(a.x,a.y,1),h=b.getMatrix3x1(0,0,0),d=h.m,f=e.m;d[0][0]=c[0][0]*f[0][0]+c[0][1]*f[1][0]+c[0][2]*f[2][0];d[1][0]=c[1][0]*f[0][0]+c[1][1]*f[1][0]+c[1][2]*f[2][0];d[2][0]=c[2][0]*f[0][0]+c[2][1]*f[1][0]+c[2][2]*f[2][0];d={x:d[0][0],y:d[1][0]};b.free3x1(e);b.free3x1(h);return d};l.prototype.getParentWgt=function(){return this.parentWidget};
l.prototype.getInvokablePropsList=function(){for(var c=l.prototype.invokablePropsList,a=this.invokablePropsList,b=0,e=c.length;b<e;b++){var h=c[b];-1==this.invokablePropsList.indexOf(h)&&(a=a.concat(h))}return a};l.prototype.getInvokableFunList=function(){for(var c=l.prototype.invokableFunList,a=this.invokableFunList,b=0,e=c.length;b<e;b++){var h=c[b];-1==this.invokableFunList.indexOf(h)&&(a=a.concat(h))}return a};l.prototype.getPageMLTextMgr=function(){for(var c=!1,a=this.module;null!=a&&!c;){var b=
this.project.getCWidgetMgr();if(b){if(c=b.hasGfxInheritance(a.ctype))break;a=a.module}else break}return c?a.getCWMLTextMgr():this.isTemplateWgt?this.parentPage.getTemplateMLTextMgr():this.parentPage.getPageMLTextMgr()};Nb.prototype.getWidget=function(){return this.w};Nb.prototype.addCallback=function(c){return this.cb.push(c)};Nb.prototype.getCallbacks=function(){return this.cb};l.prototype.subscribeWgt=function(c,a){c&&(void 0===this._subscriptions[c.wgtId]?this._subscriptions[c.wgtId]=new Nb(c,
a):this._subscriptions[c.wgtId].addCallback(a))};l.prototype.unsubscribeWgt=function(c){c&&delete this._subscriptions[c.wgtId]};l.prototype.sendNotification=function(c,a){for(var b in this._subscriptions)for(var e=this._subscriptions[b].cb,h=0,d=e.length;h<d;h++)e[h](c,a)};l.prototype.removeSubscriptions=function(){this._subscriptions={}};l.prototype.getAllSubscriptions=function(){return this._subscriptions};l.prototype.getWidgetSubscribed=function(c){return this._subscriptions[c].getWidget()||null};
l.prototype.hasSubscriptionFor=function(c){return null!=this._subscriptions[c.wgtId]};l.prototype.trigger=function(c,a){};l.prototype.updateLanguage=function(){for(var c in this.wgts)this.isMl&&this.wgts[c].updateLanguage()};l.prototype.unmountLinks=function(){for(var c in this.dataLinks)this.dataLinks[c].unmount()};l.prototype.mountLinks=function(){for(var c in this.dataLinks)this.dataLinks[c].mount()};l.prototype.removeQualityIcon=function(){this.parentWidget&&null!=this.parentWidget.elem&&this.parentWidget.elem.querySelectorAll("#"+
CSS.escape(this.wgtId+"_jm-unc")+",#"+CSS.escape(this.wgtId+"_jm-bad")).forEach(function(c){c.remove()})};l.prototype.destroy=function(){if(this.destroyed)return!1;var c=this.wgts;if(c)for(var a in c)c[a].destroyed||c[a].destroy();delete g.renderingQueue[this.wgtId];this.elem&&(this.elem=null);this.wgtPos=this.wgtOffset=this.invMtxChain=this.js=null;this.removeQualityIcon();this.unmountLinks();this.dataLinks={};this.removeAllActions();this.wgtsOrder=this.wgts=this._userValue=this.parentPage=this.parentWidget=
null;return this.destroyed=!0};l.prototype.countDataLinks=function(){if(this.dataLinks){if("object"==typeof this.dataLinks)return Object.keys(this.dataLinks).length;if(this.dataLinks.constructor==Array)return this.dataLinks.length}return 0};l.prototype._isNativeSelectCompatible=function(){var c=navigator.userAgent;return/Android/i.test(c)&&(/Chrome\/[.0-9]* (?!Mobile)/i.test(c)||/Chrome\/[.0-9]* Mobile/i.test(c))||/iPhone/i.test(c)||/iPad/i.test(c)?!1:null!=c.match(/webkit/i)||null!=c.match(/firefox/i)?
!0:!1};l.prototype.isWgtEventsPreventDefault=function(){return!0};l.supportedEvents="onMousePress onMouseRelease onMouseClick onMouseHold onMouseHoldRepeat onMousePressRepeat onDataUpdate onActivate onDeactivate tonActivate tonDeactivate onDraw onMouseDrag onGesturePan onGesturePinch onGestureRotate onGestureSwipeRight onGestureSwipeLeft onGestureSwipeUp onGestureSwipeDown onGesturePinchOpen onGesturePinchClosed onGestureRotateClockwise onGestureRotateAntiClockwise".split(" ");l.prototype.addAction=
function(c,a){if(l.supportedEvents.includes(c))if(this[c]||(this[c]=[]),"tonActivate"===c)this[c].push(a),this.tonActivate=this._registerJSActions(this.tonActivate,!0);else if("tonDeactivate"===c)this[c].push(a),this.tonDeactivate=this._registerJSActions(this.tonDeactivate,!0);else for(var b=this._registerJSActions([a]),e=0,h=b.length;e<h;e++)this[c].push(b[e])};l.prototype.getActions=function(){for(var c={},a=0;a<l.supportedEvents.length;a++){var b=l.supportedEvents[a];null!=this[b]&&(c[b]=this[b])}return c};
l.prototype.invalidateMtxChain=function(){this.initInvMtxChain=!1;for(var c in this.wgts)this.wgts[c].initInvMtxChain=!1,this.wgts[c].wgts&&this.wgts[c].invalidateMtxChain()};l.prototype.saveInvMtxChain=function(c){this.invMtxChain=c.chain;this.wgtOffset=c.offset;this.wgtPos=c.pos;this.initInvMtxChain=!0};l.prototype.removeAllActions=function(){delete this.onMousePress;delete this.onMouseRelease;delete this.onMouseClick;delete this.onDataUpdate};l.prototype.saveValue=function(c){var a=g.getActiveProject().projectName;
if(Modernizr.localstorage){var b=window.localStorage.getItem("hmi");if(b)try{b=JSON.parse(b)}catch(e){b={}}else b={};b[a]||(b[a]={});if(null!=this[c]&&void 0!=typeof this[c])return b[a][this.wgtId]=this[c],window.localStorage.hmi=JSON.stringify(b),!0}return!1};l.prototype.loadValue=function(c){c=g.getActiveProject().projectName;if(Modernizr.localstorage)try{return JSON.parse(window.localStorage.getItem("hmi"))[c][this.wgtId]}catch(a){return null}else return null};l.prototype.getDatalink=function(c){for(var a in this.dataLinks){var b=
this.dataLinks[a];if(b.attr==c)return b}return null};l.prototype.getDataLinks=function(){return this.dataLinks};l.prototype.getDataLinksByDataSrc=function(c,a){for(var b in this.dataLinks){var e=this.dataLinks[b];e.dataSrcId===c.wgtId&&a.push(e)}if(null!=this.wgts)for(b in this.wgts)this.wgts[b].getDataLinksByDataSrc(c,a)};l.prototype.getAuthorizations=function(){return this.umgr?this.umgr.isSecurityEnabled()?this.umgr.getWidgetTreeAuthorizations(this):this.umgr.getWidgetAuthorizationCodes().FULL:
Zb.wgtAuth.FULL};l.prototype.getWidgetAuthorizationCodes=function(){return l.wgtAuth};l.prototype.ERROR_MSG={INIT_PRM:"Promise Widget Ready is not initialized"};l.prototype.resolveWgtReady=function(){throw this.ERROR_MSG.INIT_PRM;};l.prototype.rejectWgtReady=function(){throw this.ERROR_MSG.INIT_PRM;};l.prototype.initPromiseReady=function(){var c=this;this._prmWgtReady=new Promise(function(a,b){c.resolveWgtReady=a;c.rejectWgtReady=b})};l.prototype.waitWgtReady=function(){if(this._prmWgtReady)return this._prmWgtReady;
throw this.ERROR_MSG.INIT_PRM;};l.prototype.getHoldTime=function(){return this.project!==this&&-1==this.hT?this.project.getHoldTime():this.hT};l.prototype.getAutoRepeatPeriod=function(){return this.project!==this&&-1==this.aRT?this.project.getAutoRepeatPeriod():this.aRT};l.prototype.getAutoRepeatMode=function(){return this.aRM};l.prototype.getPassthruTime=function(){return this.project!==this&&-1==this.passthruDelay?this.project.getAutoRepeatPeriod():this.passthruDelay};l.prototype.isPassthruEnable=
function(){return this.project!==this&&2==this.passthru?this.project.isPassthruEnable():1==this.passthru};l.prototype.load=function(){};l.prototype.unload=function(){};l.prototype.findJSFunction=function(c){var a=this[c];return void 0!==a?a:null!=this.parentWidget?this.parentWidget.findJSFunction(c):null};l.prototype.setId=function(c){this.wgtId=c};l.prototype.getId=function(){return this.wgtId};l.prototype.getUserId=function(){return this.studioId};l.prototype.setAsVisible=function(c){this.elem&&
(this.elem.style.display=this.visible?null:"none")};l.prototype.getLayout=function(){return!this.parentWidget||null==this.l||"GroupWgt"!=this.parentWidget.getJMType()&&"TableGroupWgt"!=this.parentWidget.getJMType()||null==this.parentWidget.getLayoutSize()?null:this.l[this.parentWidget.getLayoutSize()]};l.prototype.getOffsetTop=function(){return 0};l.prototype.getOffsetLeft=function(){return 0};l.prototype.hasLayout=function(){return void 0!=this.l};l.prototype.getModule=function(){return void 0===
this.module?null:this.module};l.prototype.getGraphicModule=function(){var c=this.project.getCWidgetMgr();if(c&&this.module){if(c.hasGfxInheritance(this.module.ctype))return this.module;if(this.parentWidget)return this.parentWidget.getGraphicModule()}return null};l.prototype.isModuleInstance=function(){return!1};l.prototype.resolveId=function(c){if(null!=this.module){var a=this.getGraphicModule();if(a)return c.replace("*",a.studioId)}return c};l.prototype.getJMType=function(){return this.constructor.jmType};
l.prototype.updateDataLink=function(c){};l.prototype.isCW=function(){var c=g.activeProject.getCWidgetMgr();return null!=this.ctype?c.isRegisteredModule(this.ctype)?!0:!1:!1};l.prototype.instantiateWgt=function(c,a,b){return new c({wgtId:null===b.ext?this.wgtId:this.wgtId+"."+b.ext},this.studioId,Object.assign({isClone:!0,protoWgtId:this.wgtId},this.getOptions(),b),this.parentPage,a)};l.prototype.cloneDataLinks=function(c){if(null!=this.dataLinks)for(var a in this.dataLinks){var b=this.dataLinks[a];
b.dataSrc&&b.dataSrc.isTableDataSource||$hmi.hmiAttach(c,b.dataSrcId,b.getOptions())}};l.prototype.cloneActions=function(c,a){var b=this.getActions(),e;for(e in b){var h=e,d=b[e],f;for(f in d){var k=d[f],g=k.getOptions();new k.constructor({wgtId:null==a.ext?k.wgtId:k.wgtId+"."+a.ext},h,g,c.parentPage,c)}}};l.prototype.cloneWgt=function(c,a,b){c=this.instantiateWgt(this.constructor,c,b);this.cloneDataLinks(c);this.cloneActions(c,b);if(this.wgts&&!a)for(var e in this.wgts)null==c.wgts&&(c.wgts={}),
this.wgts[e].cloneWgt(c,!1,b);return c};l.prototype.clone=function(c){var a=this.isCW();this.elem&&(Vb.setFragment(this.elem.cloneNode(!0)),Vb.changeFragmentIds(c.ext,a));c=this.cloneWgt(this.parentWidget,a,c);Vb.resetFragment();return c};l.prototype.executeActivationCallback=function(){return this.isWgtActive?!1:!0};l.prototype.executeDeactivationCallback=function(){return this.isWgtActive?!0:!1};l.prototype.bindEvents=function(c,a){var b=null;null!=a?b=a:(b=this.parentPage.elem,this.isClone&&null!=
this.tableGroupWgt&&(b=this.tableGroupWgt.elem));var e=g.getEventMgr(),h;for(h in c)e.on(b,h,c[h])};l.prototype.unbindEvents=function(c,a){var b=null;null!=a?b=a:(b=this.parentPage.elem,this.isClone&&null!=this.tableGroupWgt&&(b=this.tableGroupWgt.elem));var e=g.getEventMgr(),h;for(h in c)e.off(b,h,c[h])};l.prototype.deactivateWidgetPrototypes=function(){this.unmountLinks();if(null!=this.wgts)for(var c in this.wgts)this.wgts[c].deactivateWidgetPrototypes()};l.prototype.getGridPosition=function(c){return null!=
this.l?{rOcc:this.l[c].rOcc,cOcc:this.l[c].cOcc}:null};l.prototype.getRowSpan=function(c){return null!=this.l?this.l[c].rSpan:null};l.prototype.getColSpan=function(c){return null!=this.l?this.l[c].cSpan:null};l.prototype.setTextIds=function(c){this.mlIds=c};l.prototype.setCloneTextIds=function(c){this.clMLIds=c};l.prototype.getTextIds=function(){return this.mlIds};l.prototype.getCloneTextIds=function(){return this.clMLIds};l.prototype.updateCloneMLIds=function(){this.clMLIds=[];if(this.mlIds)for(var c=
0;c<this.mlIds.length;c++)this.clMLIds.push(this.ext+"-"+this.mlIds[c])};l.prototype.hasExportedDataLinks=function(){return null!=this.datalinks?!0:!1};l.prototype.setDynamicLinkedProperty=function(c){this.dynamicFieldProperties.push(c)};l.prototype.isDynamicLinkedProperty=function(c){return this.isClone&&-1!=this.dynamicFieldProperties.indexOf(c)?!0:!1};l.prototype.getSrcType=function(){var c;switch(this.studioId){case "_TagMgr":c="Tag";break;case "_IndexedTagSetMgr":c="Alias";break;case "_RecipeMgr":c=
"Recipe";break;case "_SysPropMgr":c="Recipe";break;case "_MultiLangMgr":case "_VariablesWgt":case "_AlarmsMgr":case "_EventMgr":c="Widget"}return c};l.prototype.getWidgetType=function(){var c;switch(this.studioId){case "_TagMgr":case "_IndexedTagSetMgr":case "_RecipeMgr":case "_SysPropMgr":case "_MultiLangMgr":case "_VariablesWgt":case "_AlarmsMgr":case "_EventMgr":c="Project";break;default:c="Widget"}return c};l.prototype.hasGridLayout=function(){return this.grid?!0:!1};l.prototype.getProject=function(){return g.getActiveProject()};
l.prototype.isRoot=function(){return!1};l.prototype.updateStyle=function(c){};l.prototype.getDataLinks=function(){return this.dataLinks};l.prototype.getTagInfo=function(c){return null};l.prototype.constructor=l;g.addWidgetDefinition("hmiWidget",l);J.prototype=Object.create(l.prototype);J.prototype.constructor=J;J.prototype.showGrid=!0;J.prototype.cursorWidth=4;J.prototype.type=0;J.prototype.xanchor=0;J.prototype.yanchor=0;J.prototype.xspacing=0;J.prototype.yspacing=0;J.prototype.cursorColor="rgb( 255, 0, 0 )";
J.prototype._renderMask=0;J.prototype._renderFlags={GRID:2,CURSOR:4,UPDATEGRIDCANVAS:8,UPDATECRSCANVAS:16};J.jmType="GridWgt";J.prototype._initObjects=function(){this.gridGraph=new oa(this.elem.querySelector(".jm-trend_grid"),{width:this.width,height:this.height,minX:this.min||0,maxX:this.max||1E3,minY:this.y0||0,maxY:this.y1||100,xanchor:this.xanchor,yanchor:this.yanchor,xspacing:this.xspacing,yspacing:this.yspacing,gridX:this.gridX,gridY:this.gridY,colorX:this.colorX,colorY:this.colorY});var c=
{width:this.width,height:this.height,xCursorShow:this.xCursorShow,yCursorShow:this.yCursorShow,yCursorPos:this.yCursorPos,cursorWidth:this.cursorWidth,cursorColor:this.cursorColor};this.trnWnd.isScatter()?this.cursorGraph=new Y(this.elem.querySelector(".jm-trend_cursor"),c):this.cursorGraph=new S(this.elem.querySelector(".jm-trend_cursor"),c)};J.prototype.render=function(){l.prototype.render.call(this);this._renderMask&this._renderFlags.GRID&&(this.gridGraph.setGridX(this.gridX),this.gridGraph.setGridY(this.gridY),
this.gridGraph.setColorX(this.colorX),this.gridGraph.setColorY(this.colorY),this.showGrid&&this.gridGraph.drawBGGrid());if(this._renderMask&this._renderFlags.CURSOR){if(!this._initXCursor){var c=this.max-this.getTrendDuration()/2,a=null==this.yCursorPos?0:this.yCursorPos;this.cursorGraph.setXCursorPos(c);this.cursorGraph.setYCursorPos(a);this._initXCursor=!0}this.cursorGraph.drawCursor(!1)}this._renderMask&this._renderFlags.UPDATEGRIDCANVAS&&(this.gridGraph.updateSize(this.width,this.height),this.gridGraph.clearCanvasContext(),
this.gridGraph.drawBGGrid());this._renderMask&this._renderFlags.UPDATECRSCANVAS&&(this.cursorGraph.updateSize(this.width,this.height),this.cursorGraph.clearCanvasContext(),this.cursorGraph.drawCursor(!1));this._renderMask=0};J.prototype.setValue=function(c,a,b,e){e=!1;if(this.isBadValue(a,!1,b))return!1;switch(c){case "showGrid":this.showGrid!=a&&(this.showGrid=a,this._renderMask|=this._renderFlags.GRID,e=!0,this.sendUpdate(c,this.showGrid,b));break;case "cursor_pos":this.xCursorPos!=a&&(this.xCursorPos=
a,this.cursorGraph.setXCursorPos(this.xCursorPos),this._renderMask|=this._renderFlags.CURSOR,e=!0,this.sendUpdate(c,this.xCursorPos,b));break;case "ycursor_pos":this.yCursorPos!=a&&(this.yCursorPos=a,this.cursorGraph.setYCursorPos(this.yCursorPos),this._renderMask|=this._renderFlags.CURSOR,e=!0,this.sendUpdate(c,this.yCursorPos,b));break;case "min":this.min!=a&&(this.min=a,this.cursorGraph.setXMin(this.min),this._renderMask|=this._renderFlags.CURSOR,e=!0,this.sendUpdate(c,this.min,b));break;case "max":this.max!=
a&&(this.max=a,this.cursorGraph.setXMax(this.max),this._renderMask|=this._renderFlags.CURSOR,e=!0,this.sendUpdate(c,this.max,b));break;case "y0":this.y0!=a&&(this.y0=a,this.cursorGraph.setYMin(this.y0),this._renderMask|=this._renderFlags.CURSOR,e=!0,this.sendUpdate(c,this.y0,b));break;case "y1":this.y1!=a&&(this.y1=a,this.cursorGraph.setYMax(this.y1),this._renderMask|=this._renderFlags.CURSOR,e=!0,this.sendUpdate(c,this.y1,b));break;case "xanchor":this.xanchor!=a&&(this.xanchor=a,this._renderMask|=
this._renderFlags.CURSOR,e=!0,this.sendUpdate(c,this.xanchor,b));break;case "yanchor":this.yanchor!=a&&(this.yanchor=a,this._renderMask|=this._renderFlags.CURSOR,e=!0,this.sendUpdate(c,this.yanchor,b));break;case "xspacing":this.xspacing!=a&&(this.xspacing=a,this._renderMask|=this._renderFlags.CURSOR,e=!0,this.sendUpdate(c,this.xspacing,b));break;case "yspacing":this.yspacing!=a&&(this.yspacing=a,this._renderMask|=this._renderFlags.CURSOR,e=!0,this.sendUpdate(c,this.yspacing,b));break;case "gridX":this.gridX!=
a&&(this.gridX=a,this._renderMask|=this._renderFlags.GRID,e=!0,this.sendUpdate(c,this.gridX,b));break;case "gridY":this.gridY!=a&&(this.gridY=a,this._renderMask|=this._renderFlags.GRID,e=!0,this.sendUpdate(c,this.gridY,b));break;case "colorX":this.colorX!=a&&(this.colorX=a,this._renderMask|=this._renderFlags.GRID,e=!0,this.sendUpdate(c,this.colorX,b));break;case "colorY":this.colorY!=a&&(this.colorY=a,this._renderMask|=this._renderFlags.GRID,e=!0,this.sendUpdate(c,this.colorY,b));break;default:l.prototype.setValue.call(this,
c,a,b)}e&&g.addToRender(this)};J.prototype.getValue=function(c){switch(c){case "cursor_pos":return this.cursorGraph.getXPosition();case "ycursor_pos":return this.cursorGraph.getYPosition();case "cursor-show":return this.cursorGraph.isCursorVisible()}return l.prototype.getValue.call(this,c)};J.prototype.scrollTrendCursor=function(c,a,b){if(this.trnWnd.isScatter())this.cursorGraph.isVisible&&(c=this.cursorGraph.stepXY(c,b),this.xCursorPos=c.xvalue,this._renderMask|=this._renderFlags.CURSOR,g.addToRender(this),
this.updateXYCursorValue(c.xvalue,c.yoccurence));else{var e=this.getTrendDuration();a=0==a?e*b/100:1E3*b;c=this.getXCursor()+(1==c?-a:a);c<this.min&&(c=this.min);c>this.max&&(c=this.max);this.setValue("cursor_pos",c,null)}};J.prototype.setCursorVisibility=function(c){this.cursorGraph.setCursorVisibility(c);this.trnWnd.isInitialized()&&(c?this.setValue("cursor_pos",this.max-this.getTrendDuration()/2,null,null):this.setValue("cursor_pos",-1,null,null));this.trnWnd.isScatter()&&c&&(this.cursorGraph.resetXYCursor(),
this.updateXYCursorValue(this.cursorGraph.getValueXY(),this.cursorGraph.getOccurenceXY()))};J.prototype.getXCursor=function(){return this.cursorGraph.getXPosition()};J.prototype.getYCursor=function(){return this.cursorGraph.getYPosition()};J.prototype.getTrendDuration=function(){return this.trnWnd.xPageSize};J.prototype.updateCursorGrid=function(){var c=this.parentWidget,a=[],b;for(b in c.wgts){var e=c.wgts[b];e.constructor==U&&e.visible&&a.push(e)}this.cursorGraph.updateXYGrid(a);this.cursorGraph.isCursorVisible()&&
(c=this.cursorGraph.getValueXY(),a=this.cursorGraph.getOccurenceXY(),void 0!==c&&void 0!==a&&this.updateXYCursorValue(c,a))};J.prototype.isCursorVisible=function(){return null!=this.cursorGraph?this.cursorGraph.isCursorVisible():!1};J.prototype.updateXYCursorValue=function(c,a){var b=this.parentWidget,e;for(e in b.wgts){var h=b.wgts[e];h.constructor==U&&h.visible&&h.setXYCursorValue(c,a)}};J.prototype.setParentBounds=function(c,a,b,e,h){l.prototype.setParentBounds.call(this,c,a,b,e,h);this.updateOnResize()};
J.prototype.updateOnResize=function(c){l.prototype.updateOnResize.call(c);this._renderMask=this._renderFlags.UPDATECRSCANVAS|this._renderFlags.UPDATEGRIDCANVAS;g.addToRender(this)};J.prototype.destroy=function(){if(this.destroyed)return!1;g.cache.setWgtProp(this.elem.id,"crsVisible",this.cursorGraph.isCursorVisible());g.cache.setWgtProp(this.elem.id,"yCursorPos",this.xCursorPos);this.cursorGraph.clearCanvasContext();this.gridGraph.clearCanvasContext();this.cursorGraph=this.cursorGraph=null;return l.prototype.destroy.call(this)};
g.fn.hmiGridWgt=function(c,a,b,e){return new J(this,c,a,b,e)};g.addWidgetDefinition("hmiGridWgt",J);B.prototype=Object.create(l.prototype);B.prototype.constructor=B;B.prototype.backgroundClass="bgColor00";B.prototype.form="round";B.prototype.type=0;B.prototype.reverse=!1;B.prototype.min=0;B.prototype.max=100;B.prototype.startAngle=0;B.prototype.stopAngle=90;B.prototype.initAngle=0;B.prototype.value=0;B.prototype._clickOffset=null;B.prototype.dragging=0;B.prototype.discrete=0;B.prototype.opacity=1;
B.prototype.fill=null;B.prototype.stroke=null;B.prototype.disabled=!0;B.prototype.permission="rw";B.prototype.TOOLTIPSIZE=15;B.prototype.xformScaling=!0;B.prototype._renderMask=0;B.prototype._renderFlags={VALUE:1,FILL:2,STROKE:4,OPACITY:8,TOOLTIP:16,CREATETOOLTIP:32};B.prototype._mouseActionType={MOUSEDOWN:0,MOUSEMOVE:1,MOUSEUP:2};B.jmType="NeedleWgt";B.prototype.render=function(){l.prototype.render.call(this);this._renderMask&this._renderFlags.VALUE&&this.updateNeedle();this._renderMask&this._renderFlags.CREATETOOLTIP&&
this.renderToolTip();this._renderMask&this._renderFlags.TOOLTIP&&this.updateToolTip();this._renderMask&this._renderFlags.FILL&&$("."+this.backgroundClass,this.elem).css("fill",this.fill);this._renderMask&this._renderFlags.STROKE&&$("path",this.elem).attr("stroke",this.stroke);this._renderMask&this._renderFlags.OPACITY&&$("svg",this.elem).css("opacity",this.opacity);this._renderMask=0};B.prototype.renderToolTip=function(){if(this.parentPage){this.ndlToolTip=document.getElementById(this.parentPage.wgtId+
"_ndltooltip");if(!this.ndlToolTip){var c=document.createElement("div"),a=document.createElement("span");c.id=this.parentPage.wgtId+"_ndltooltip";c.style.position="absolute";c.style.fontFamily="arial";c.style.fontSize=this.TOOLTIPSIZE+"px";c.style.width=this.TOOLTIPSIZE+"px";c.style.height=this.TOOLTIPSIZE+"px";c.style.top="0px";c.style.left="0px";c.style.display="none";a.setAttribute("style","background-color:white;");c.appendChild(a);this.parentPage.elem&&(this.parentPage.elem.appendChild(c),this.ndlToolTip=
c)}c=this.getAbsolutePosition();this.mtxChain=this.getParentTransform();this.tooltipx=c.x;this.tooltipy=c.y}};B.prototype.handleEvent=function(){this.events={mousedown:!0,touchstart:!0}};B.prototype.addDataLink=function(c){l.prototype.addDataLink.call(this,c);c.tgtWgt==this&&this.initDataLinkSideEffects(c,c.attr)};B.prototype.initDataLinkSideEffects=function(c,a){"value"==a&&(this.permission="rw"==c.rw||"w"==c.rw?"rw":"r")};B.prototype.updateNeedle=function(){this.value=this.value>this.max?this.max:
this.value;this.value=this.value<this.min?this.min:this.value;var c=this.max-this.min;if(0==this.type){var a=this.initAngle-this.startAngle,c=0!=c?(this.stopAngle-this.startAngle)*(this.value-this.min)/c:0,c=-a+c;ga(this.image,"rotate("+c+"deg)");this.elem&&(this.elem.setAttribute("data-v",this.value),this.elem.setAttribute("data-a",c))}else if(2==this.type){var a=parseFloat(this.image.getAttribute("data-cx")),a=this.cx-a,b=0;0!=c&&(b=(this.width-2*this.cx)*(this.value-this.min)/c);b=this.reverse?
this.width-2*this.cx-b+a:b+a;this.image.style.left=b+"px";this.elem&&(this.elem.setAttribute("data-v",this.value),this.elem.setAttribute("data-p",b))}else if(1==this.type){var b=parseFloat(this.image.getAttribute("data-cy")),a=this.cy>this.height/2?this.height-this.cy:this.cy,b=a-b,e=0;0!=c&&(e=(this.height-2*a)*(this.value-this.min)/c);e=this.reverse?this.height-2*a-e+b:e+b;this.image.style.top=e+"px";this.elem&&(this.elem.setAttribute("data-v",this.value),this.elem.setAttribute("data-p",e))}};B.prototype.updateToolTip=
function(){if(1==this.wrMode){if(this._currMouseAction==this._mouseActionType.MOUSEDOWN||this._currMouseAction==this._mouseActionType.MOUSEMOVE){var c=this.tooltipx,a=this.tooltipy,b=this.mtxChain[0][0],e=this.mtxChain[1][1];switch(this.type){case 0:a+=this.height/2*e;break;case 1:c+=this.imageW*b;a+=parseFloat(this.image.style.top)*e;break;case 2:c+=parseFloat(this.image.style.left)*b,a-=this.TOOLTIPSIZE*e}this.ndlToolTip.style.left=c+"px";this.ndlToolTip.style.top=a+"px";this.ndlToolTip.childNodes[0].textContent=
this.value;this.ndlToolTip.style.display="block"}this._currMouseAction==this._mouseActionType.MOUSEUP&&(this.ndlToolTip.style.display="none")}};B.prototype.setValue=function(c,a,b){var e=!1,h="#000";if("value"==c){if(this.isBadValue(a,!1,b))return!1;a=parseFloat(a,!1,b);if(isNaN(a))return!1;a>this.max?a=this.max:a<this.min&&(a=this.min);this.value!=a?(this.value=a,this._renderMask|=this._renderFlags.VALUE,e=!0,this.sendUpdate(c,this.value,b)):1==this.wrMode&&this._currMouseAction==this._mouseActionType.MOUSEUP&&
(this._renderMask|=this._renderFlags.TOOLTIP,e=!0,this.sendUpdate(c,this.value,b))}else if("fill"==c)isNaN(a)?this.isBadValue(a,!0,b)?(this.fill=h,e=!0):this.fill!=a&&(0==a.indexOf("#")&&1<a.length&&8>=a.length&&(h=a),this.fill=h,e=!0,this.sendUpdate(c,this.fill,b)):(e=!0,this.fill=h),e&&(this._renderMask|=this._renderFlags.FILL);else if("stroke"==c)isNaN(a)&&(this.isBadValue(a,!0,b)?(this.stroke=h,e=!0):this.stroke!=a&&(0==a.indexOf("#")&&1<a.length&&8>=a.length&&(h=a),this.stroke=h,e=!0,this.sendUpdate(c,
this.stroke,b)),e&&(this._renderMask|=this._renderFlags.STROKE));else if("fill-opacity"==c){if(this.isBadValue(a,!1,b))return!1;a=parseFloat(a);0>a?a=0:1<a&&(a=1);this.opacity!=a&&(this.opacity=a,e=!0,this._renderMask|=this._renderFlags.OPACITY,this.sendUpdate(c,this.opacity,b))}else if("min"==c)a=parseFloat(a),this.min!=a&&(this.min=a,this.range=this.max-this.min,e=!0,this._renderMask|=this._renderFlags.VALUE,this.sendUpdate(c,this.min,b));else if("max"==c)a=parseFloat(a),this.max!=a&&(this.max=
a,this.range=this.max-this.min,e=!0,this._renderMask|=this._renderFlags.VALUE,this.sendUpdate(c,this.max,b));else if("numStates"==c){if(this.isBadValue(a,!1,b))return!1;h=parseInt(a);this.max!=this.min+h-1&&(this.max=a,this.range=this.max-this.min,e=!0,this._renderMask|=this._renderFlags.VALUE,this.sendUpdate(c,h,b))}else if("reverseScale"==c){if(this.isBadValue(a,!1,b))return!1;a=parseInt(a);this.reverse!=a&&(this.reverse=a,e=!0,this._renderMask|=this._renderFlags.VALUE,this.sendUpdate(c,this.reverse,
b))}else"startAngle"==c?this.startAngle!=a&&(0>a&&(a=0),this.startAngle=parseFloat(a),this.startAngle<=this.stopAngle&&(this._renderMask|=this._renderFlags.VALUE,e=!0)):"endAngle"==c||"stopAngle"==c?this.stopAngle!=a&&(360<a&&(a=360),this.stopAngle=parseFloat(a),this._renderMask|=this._renderFlags.VALUE,e=!0):l.prototype.setValue.call(this,c,a,b);e&&g.addToRender(this)};B.prototype.getValue=function(c){return"value"==c?this.value:this[c]?this[c]:l.prototype.getValue.call(this,c)};B.prototype.updateThumbPosition=
function(c,a){if(this.isBadValue(c,!1,a))return!1;c=parseFloat(c,!1,a);if(isNaN(c))return!1;c>this.max?c=this.max:c<this.min&&(c=this.min);this.value!=c?(this.value=c,this._renderMask=this._renderFlags.VALUE|this._renderFlags.TOOLTIP):this._renderMask|=this._renderFlags.TOOLTIP;g.addToRender(this)};B.prototype.doMouseDown=function(c,a){if(this.disabled||"r"==this.permission)return!1;if(this.umgr&&this.authCode==this.umgr.getWidgetAuthorizationCodes().RDONLY)return this.project.getValue("onAccessDenied")&&
this.showHideAccessDeniedIcon(),!1;this._currMouseAction=this._mouseActionType.MOUSEDOWN;this._currTargetId=c.wgt.wgtId;this.dragging=1;var b;1==this.type||2==this.type?(this._clickOffset={x:0,y:0},b=this._normValueFromMouseHV({x:c.x,y:c.y})):b=this._normValueFromMouseRound({x:c.x,y:c.y});1==this.wrMode?this.updateThumbPosition(b,null):(this.setValue("value",b,null),this.doWriteValue("value",b))};B.prototype.doMouseUp=function(c,a){if(this.disabled||"r"==this.permission||this.umgr&&this.authCode==
this.umgr.getWidgetAuthorizationCodes().RDONLY)return!1;this._currMouseAction=this._mouseActionType.MOUSEUP;this._currTargetId=null;this.dragging=0;1==this.wrMode&&(this.setValue("value",this.value,null),this.doWriteValue("value",this.value));this._clickOffset=null};B.prototype.doMouseMove=function(c,a){if(this.disabled||"r"==this.permission||this.umgr&&this.authCode==this.umgr.getWidgetAuthorizationCodes().RDONLY)return!1;this._currMouseAction=this._mouseActionType.MOUSEMOVE;this.dragging=1;var b;
1==this.type||2==this.type?(b={x:c.x-this._clickOffset.x,y:c.y-this._clickOffset.y},b=this._normValueFromMouseHV(b)):b=this._normValueFromMouseRound({x:c.x,y:c.y});1==this.wrMode?this.updateThumbPosition(b,null):(this.setValue("value",b,null),this._writeDraggingValues())};B.prototype._writeDraggingValues=function(){var c=this;null==this.draggingTimeOut&&(this.doWriteValue("value",c.value),this.draggingTimeOut=setTimeout(function(){c.doWriteValue("value",c.value);c.draggingTimeOut=null},c.writeTagDelay))};
B.prototype._normValueFromMouseHV=function(c){c=1==this.type?c.y:c.x;var a=this.value,a=this.max-this.min;if(0==a)return 0;c-=this.offset;a=this.reverse?this.max-c*a/this.length:c*a/this.length+this.min;return a<this.min?this.min:a>this.max?this.max:1==this.discrete?a.toFixed():a};B.prototype._normValueFromMouseRound=function(c){c=180*Math.atan2(this.cy-c.y,c.x-this.cx)/Math.PI;var a=0>this.startAngle?-180-this.startAngle:null;c=((a?-180<c&&c<a?-180-c:180-c:180-c)-this.startAngle)*this.range/(this.stopAngle-
this.startAngle)+this.min;this.reverse&&(c=this.stopAngle-c);if(c<this.min-.5||c>this.max+.5)c=this.value;this.discrete&&(c=Math.round(c));return c};B.prototype.destroy=function(){this.ndlToolTip=null;return l.prototype.destroy.call(this)};g.fn.hmiNeedle=function(c,a,b,e){return new B(this,c,a,b,e)};g.addWidgetDefinition("hmiNeedle",B);C.prototype=Object.create(l.prototype);C.prototype.constructor=C;C.prototype.visible=!0;C.prototype.pBuffer=null;C.prototype.min=0;C.prototype.max=1E3;C.prototype.y0=
0;C.prototype.y1=100;C.prototype.y1=100;C.prototype.trendCurveType=100;C.prototype._renderMask=0;C.prototype._renderFlags={UPDATECURVECANVAS:2};C.jmType="TrendCurveWgt";C.prototype.unload=function(){this.value=null;this.graph.clearData();this.clearCanvas()};C.prototype.getLineChartObj=function(c){this.graph=new D(c,{width:this.width,height:this.height,minX:this.min||0,maxX:this.max||1E3,minY:this.y0||0,maxY:this.y1||100,line:this.drawType,stroke:this.stroke,strokeWidth:this.strokeWidth},this)};C.prototype.createCurveCanvas=
function(c){var a=document.createElement("canvas");a.setAttribute("id",c);a.setAttribute("width",this.width);a.setAttribute("height",this.height);this.elem.appendChild(a)};C.prototype.updateCurveCanvasSize=function(){this.graph.updateSize(this.width,this.height)};C.prototype.updateCurveCanvasContainerSize=function(){this.graph.updateCanvasContainerSize(this.getParentBounds(this.parentWidget))};C.prototype.clearCanvas=function(){this.graph.clearCanvasContext()};C.prototype.renderCurve=function(){this.graph.drawCurve()};
C.prototype.renderDrawOnCanvasResize=function(){this.clearCanvas();this.updateCurveCanvasContainerSize();this.updateCurveCanvasSize()};C.prototype.render=function(){l.prototype.render.call(this);this._renderMask&this._renderFlags.UPDATECURVECANVAS&&this.renderDrawOnCanvasResize();this._renderMask=0};C.prototype.updateHistoricGraph=function(){var c=this.trnWnd.startTime,a=this.trnWnd.endTime,b=this.trnWnd.width,e;if(null==this.pBuffer.getDeltaTime()||this.currPageDuration!=this.trnWnd.xPageSize)this.currPageDuration=
this.trnWnd.xPageSize,0<b&&(e=parseInt(this.trnWnd.xPageSize/b),this.pBuffer.setDeltaTime(e));this.pBuffer.setHistoricParams(c,a,b,this.currPageDuration)};C.prototype.setValue=function(c,a,b,e){if(this.isBadValue(a,!1,b))return 0;switch(c){case "web-value":this.value==a||this.trnWnd.isOnPause()||(this.value=a,this.updateValues(),this.trnWnd.drawCurves(),void 0!=this.value&&null!=this.value[this.value.length-1]&&this.elem.setAttribute("data-cv",this.value[this.value.length-1].y));break;case "Value":this.val!=
a&&(this.val=a,this.sendUpdate(c,this.val,b));break;case "min":if(this.min!=a||this.trnWnd.forceUpdate())this.min=a,this.updateValues(),this.pBuffer&&this.updateHistoricGraph(),this.sendUpdate(c,this.min,b);break;case "max":if(this.max!=a||this.trnWnd.forceUpdate())this.max=a,this.updateValues(),this.pBuffer&&this.updateHistoricGraph(),this.sendUpdate(c,this.max,b);break;case "y0":if(this.y0!=a||this.trnWnd.forceUpdate())this.y0=a,this.updateValues(),this.sendUpdate(c,this.y0,b);break;case "y1":if(this.y1!=
a||this.trnWnd.forceUpdate())this.y1=a,this.updateValues(),this.sendUpdate(c,this.y1,b);break;case "drawType":this.drawType!=a&&(this.drawType=a,this.visible=0>this.drawType||1<this.drawType?0:1,this.updateValues(),this.sendUpdate(c,this.drawType,b));break;case "visibility2":this.visible!=a&&(this.getAuthorizations()==this.umgr.getWidgetAuthorizationCodes().HIDE?this.visible=0:this.visible=0>a||1<a?1:a,this.updateValues(),this.sendUpdate(c,this.visible,b));break;case "cursor-value":this.cursorValue!=
a&&(this.cursorValue=a,this.sendUpdate(c,this.cursorValue,b));break;case "stroke":this.stroke!=a&&(this.stroke=a,this.graph.setStrokeColor(a),this.sendUpdate(c,this.stroke,b));break;case "stroke-width":this.strokeWidth!=a&&(this.strokeWidth=a,this.graph.setStrokeWidth(a),this.sendUpdate(c,this.strokeWidth,b));break;default:l.prototype.setValue.call(this,c,a,b)}};C.prototype.updateMinMax=function(c,a){var b=!1;this.min!=c&&(this.min=c,this.updateValues(),b=!0,this.sendUpdate("min",this.min,null));
this.max!=a&&(this.max=a,b=!0,this.updateValues(),this.sendUpdate("max",this.max,null));b&&0==this.curveType&&this.updateHistoricGraph()};C.prototype.updateValues=function(){void 0!==this.value&&null!==this.value&&(this.graph.setXRange(this.min,this.max),this.graph.setYRange(this.y0,this.y1),this.graph.updateCurve(this.value,this.drawType,this.visible),this.cursorTs=this.trnWnd.getValue("cursor-timestamp"))};C.prototype.getValue=function(c){switch(c){case "web-value":c=this.pBuffer?this.getArrayPointsFromSamples():
this.value;break;case "Value":c=this.val;break;case "min":c=this.min;break;case "max":c=this.max;break;case "y0":c=this.y0;break;case "y1":c=this.y1;break;case "visibility2":c=this.visible;break;case "cursor-value":c=this.cursorValue;break;case "cursor-ts":c=this.cursorTs;break;default:c=l.prototype.getValue.call(this,c)}return c};C.prototype.getArrayPointsFromSamples=function(){var c=[];if(this.value)for(var a=0;a<this.value.length;a++)c.push([this.value[a].x,this.value[a].y]);return c};C.prototype.addDataLink=
function(c){l.prototype.addDataLink.call(this,c);this.initDataLinkSideEffects(c,c.attr)};C.prototype.initDataLinkSideEffects=function(c,a){c.dataSrc.constructor==bc&&c.dataSrc.isHistoric()&&(this.pBuffer=c.dataSrc)};C.prototype.getSamplingTime=function(){if(this.pBuffer)return this.pBuffer.getTrendST()};C.prototype.getWindowMinMax=function(){return{wndStart:this.trnWnd.startTime,wndEnd:this.trnWnd.endTIme}};C.prototype.refreshTrend=function(){this.trnWnd.update();this.trnWnd.drawCurves()};C.prototype.setParentBounds=
function(c,a,b,e,h){l.prototype.setParentBounds.call(this,c,a,b,e,h);this.updateOnResize()};C.prototype.updateOnResize=function(c){l.prototype.updateOnResize.call(c);this._renderMask=this._renderFlags.UPDATECURVECANVAS;g.addToRender(this)};C.prototype.destroy=function(){if(this.destroyed)return!1;this.trnWnd.unsubscribeWgt(this);this.graph.destroy();this.value=null;this.unbindEvents({unloadWgt:this.deactivateHandler});return l.prototype.destroy.call(this)};g.fn.hmiTrendCurveWgt=function(c,a,b,e){return new C(this,
c,a,b,e)};g.addWidgetDefinition("hmiTrendCurveWgt",C);U.prototype=Object.create(C.prototype);U.prototype.constructor=U;U.jmType="XYCurveWgt";U.prototype.load=function(){null==this.value&&(this.value=Array(this.maxLimit))};U.prototype.unload=function(){this.isInitCurveRenderDone=!1;this.xvalue=this.yvalue=this.value=null;this.graph.clearData()};U.prototype.renderDrawOnCanvasResize=function(){C.prototype.renderDrawOnCanvasResize.call(this);var c=this;window.requestAnimationFrame(function(){c.trnWnd.drawCurves()})};
U.prototype.setValue=function(c,a,b,e){if(this.isBadValue(a,!1,b))return 0;switch(c){case "xvalue":this.xvalue!=a&&(this.xvalue=a,this.updateXYValue(),this.updateValues(),this.sendUpdate(c,this.xvalue,b));break;case "yvalue":this.yvalue!=a&&(this.yvalue=a,this.updateXYValue(),this.updateValues(),this.sendUpdate(c,this.yvalue,b));break;case "min":if(this.min!=a||this.trnWnd.forceUpdate())this.min=a,this.updateValues(),this.sendUpdate(c,this.min,b);break;case "max":if(this.max!=a||this.trnWnd.forceUpdate())this.max=
a,this.updateValues(),this.sendUpdate(c,this.max,b);break;case "y0":if(this.y0!=a||this.trnWnd.forceUpdate())this.y0=a,this.updateValues(),this.sendUpdate(c,this.y0,b);break;case "y1":if(this.y1!=a||this.trnWnd.forceUpdate())this.y1=a,this.updateValues(),this.sendUpdate(c,this.y1,b);break;default:l.prototype.setValue.call(this,c,a,b)}};U.prototype.getValue=function(c){switch(c){case "xvalue":c=this.xvalue;break;case "yvalue":c=this.yvalue;break;case "min":c=this.min;break;case "max":c=this.max;break;
case "y0":c=this.y0;break;case "y1":c=this.y1;break;case "cursor-value":c=this.cursorValue;break;case "cursor-ts":c=this.trnWnd.getGridWgt().getXCursor();break;default:c=l.prototype.getValue.call(this,c)}return c};U.prototype.updateXYValue=function(){var c=this.trnWnd.getGridWgt();if(this.xvalue&&this.yvalue){for(var a=Math.min(this.xvalue.length,this.maxLimit),b=0;b<a;b++)void 0!==this.yvalue[b]&&(void 0!==this.value[b]?(this.value[b].x=this.xvalue[b],this.value[b].y=this.yvalue[b]):this.value[b]=
new fa(this.xvalue[b],this.yvalue[b],new za(192)));c.updateCursorGrid()}};U.prototype.setXYCursorValue=function(c,a){void 0!==this.value[this.idxSelectedSample]&&this.value[this.idxSelectedSample].select(!1);var b=this.xvalue.indexOf(c);if(-1!==b){var b=this._findIndex(c,b,a),e=this.yvalue[b];void 0==e&&(b=this.xvalue.lastIndexOf(c),e=this.yvalue[b]);this.idxSelectedSample=b;this.cursorValue=e;void 0!==this.value[this.idxSelectedSample]&&this.value[this.idxSelectedSample].select(!0)}else this.cursorValue=
"";this.trnWnd.setValue("cursor-timestamp",c,Ma.prototype.QUALITY_GOOD);this.sendUpdate("cursor-value",this.cursorValue,Ma.prototype.QUALITY_GOOD)};U.prototype._findIndex=function(c,a,b){var e=this.xvalue,h=a;a+=1;for(var d=e.length;a<d&&0<b;a++)e[a]==c&&(b--,h=a);return h};U.prototype.addDataLink=function(c){l.prototype.addDataLink.call(this,c)};U.prototype.updateValues=function(){C.prototype.updateValues.call(this);this.isInitCurveRenderDone||(this.refreshTrend(),this.isInitCurveRenderDone=!0)};
U.prototype.destroy=function(){l.prototype.unbindEvents.call(this,{loadWgt:this.activateHandler});return C.prototype.destroy.call(this)};g.fn.hmiXYCurveWgt=function(c,a,b,e){return new U(this,c,a,b,e)};g.addWidgetDefinition("hmiXYCurveWgt",U);La.prototype=Object.create(l.prototype);La.prototype.constructor=La;La.jmType="RecipeWgt";g.fn.hmiRecipeWgt=function(c,a,b,e){return new La(this,c,a,b,e)};g.addWidgetDefinition("hmiRecipeWgt",La);var p=this&&this.__extends||function(){var c=function(a,b){c=Object.setPrototypeOf||
{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return c(a,b)};return function(a,b){function e(){this.constructor=a}c(a,b);a.prototype=null===b?Object.create(b):(e.prototype=b.prototype,new e)}}(),Ia=this&&this.__assign||function(){Ia=Object.assign||function(c){for(var a,b=1,e=arguments.length;b<e;b++){a=arguments[b];for(var h in a)Object.prototype.hasOwnProperty.call(a,h)&&(c[h]=a[h])}return c};return Ia.apply(this,arguments)},
nc=this&&this.__spreadArrays||function(){for(var c=0,a=0,b=arguments.length;a<b;a++)c+=arguments[a].length;for(var c=Array(c),e=0,a=0;a<b;a++)for(var h=arguments[a],d=0,f=h.length;d<f;d++,e++)c[e]=h[d];return c},fd=this&&this.__awaiter||function(c,a,b,e){function h(a){return a instanceof b?a:new b(function(b){b(a)})}return new (b||(b=Promise))(function(b,f){function k(b){try{m(e.next(b))}catch(a){f(a)}}function g(b){try{m(e["throw"](b))}catch(a){f(a)}}function m(a){a.done?b(a.value):h(a.value).then(k,
g)}m((e=e.apply(c,a||[])).next())})},gd=this&&this.__generator||function(c,a){function b(b){return function(a){return e([b,a])}}function e(b){if(d)throw new TypeError("Generator is already executing.");for(;h;)try{if(d=1,f&&(k=b[0]&2?f["return"]:b[0]?f["throw"]||((k=f["return"])&&k.call(f),0):f.next)&&!(k=k.call(f,b[1])).done)return k;if(f=0,k)b=[b[0]&2,k.value];switch(b[0]){case 0:case 1:k=b;break;case 4:return h.label++,{value:b[1],done:!1};case 5:h.label++;f=b[1];b=[0];continue;case 7:b=h.ops.pop();
h.trys.pop();continue;default:if(!(k=h.trys,k=0<k.length&&k[k.length-1])&&(6===b[0]||2===b[0])){h=0;continue}if(3===b[0]&&(!k||b[1]>k[0]&&b[1]<k[3])){h.label=b[1];break}if(6===b[0]&&h.label<k[1]){h.label=k[1];k=b;break}if(k&&h.label<k[2]){h.label=k[2];h.ops.push(b);break}k[2]&&h.ops.pop();h.trys.pop();continue}b=a.call(c,h)}catch(e){b=[6,e],f=0}finally{d=k=0}if(b[0]&5)throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}var h={label:0,sent:function(){if(k[0]&1)throw k[1];return k[1]},trys:[],ops:[]},
d,f,k,g;return g={next:b(0),"throw":b(1),"return":b(2)},"function"===typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g},ja;(function(c){c[c.RECIPE=2]="RECIPE";c[c.SET=3]="SET";c[c.ELEM=4]="ELEM"})(ja||(ja={}));var vc=function(c){function a(b,a,h,d,f){var k=c.call(this,b.wgtId,a,h,d,f)||this;k.setDefaultState();if(!g.enablePjctWidgetServerReq)return k;g.isTestModeActive()||k.parentWidget.waitWgtReady().then(function(){k.srv=k.project.getCommunticationObj();k.srv.getConf().then(function(b){k.recipesConfig=
b["recipes.json"]}).catch(function(){k.core.getAction("hmiActionShowMessage").execute(null,{msg:"Error loading recipes configuration. Reloading..."},null,null,3);setTimeout(function(){k.project.getCommunticationObj().loadIndex()},2E3)});k.srv.getRecipeList(!1).then(function(b){null!=b&&0!=b.length&&(k.recipeList=b,k.srv.getRecipeParams("curRecipe","all",!1).then(function(b){k.curRecipe=b;k.srv.subscribeRecipe("curRecipe",function(b,a){k.onCurrRecipeUpdate(b,a)});k._usedInCurrPage?k.srv.setRecipeNotificationRate(k._ACTIVE_POLL):
k.srv.setRecipeNotificationRate(k._IDLE_POLL);k._firstUpdate()}))}).catch(function(){k.core.getAction("hmiActionShowMessage").execute(null,{msg:"Error loading recipes list. Reloading..."},3);setTimeout(function(){k.project.getCommunticationObj().loadIndex()},2E3)})});return k}p(a,c);a.prototype.setDefaultState=function(){this.recipeList=void 0!==this.recipeList?this.recipeList:[];this.curRecipeSetList=void 0!==this.curRecipeSetList?this.curRecipeSetList:[];this.curRecipeSet=void 0!==this.curRecipeSet?
this.curRecipeSet:null;this.curRecipe=void 0!==this.curRecipe?this.curRecipe:null;this.curSelRecipeSet=void 0!==this.curSelRecipeSet?this.curSelRecipeSet:null;this.enSub=void 0!==this.enSub?this.enSub:{};this._IDLE_POLL=void 0!==this._IDLE_POLL?this._IDLE_POLL:8E3;this._ACTIVE_POLL=void 0!==this._ACTIVE_POLL?this._ACTIVE_POLL:1500;this._usedInCurrPage=void 0!==this._usedInCurrPage?this._usedInCurrPage:!1;this._isRemoteSrc=void 0!==this._isRemoteSrc?this._isRemoteSrc:!1;this._baseProps=void 0!==this._baseProps?
this._baseProps:["recipeList","curRecipeSetList","curRecipeSet","curRecipe"]};a.prototype.getValue=function(b){if("curRecipe"==b)return this.curRecipe?this.curRecipe.id:void 0;if("recipeList"==b)return this.recipeList;if("curRecipeSetList"==b)return this.curRecipe?this.curRecipe.RecipeSetList:void 0;if("curRecipeSet"==b)return this.curRecipe?this.curRecipe.selSet:void 0;var a=b.split("."),c=a[a.length-1];if(this.enSub[b]&&this.enSub[b].obj)return this.enSub[b].obj[c];if(this.core.initPageLogic||void 0===
this.srv)return null;b=a.length;var d,f;b==ja.RECIPE&&(d=this.srv.getRecipeParam(a[0],c,!0),f=d.err,d=d.v);b==ja.SET&&(d=this.srv.getRecipeSetParam(a[0],a[1],c,!0),f=d.err,d=d.v);b==ja.ELEM&&(d=this.srv.getRecipeElemParam(a[0],a[1],a[2],c,!0),f=d.err,d=d.v);f&&this.core.notifyWarning("Recipe Manager","REST status:"+f);return d};a.prototype.setValue=function(b,a,c,d){d=c=!1;if(b){var f=t.getModule("Tag"),k=function(b,a){if(Array.isArray(b)&&Array.isArray(a)){if(b.length!=a.length)return!1;for(var c=
0;c<b.length;c++)if("string"==typeof b[c]&&"string"==typeof a[c]&&b[c]!=a[c])return!1;return!0}return!1};if("curRecipe"==b)this.curRecipe.id!=a&&(this.curRecipe.id=a,this._isRemoteSrc||this.srv.setCurrentRecipe(this.curRecipe.id,null,!1),c=!0);else if("curRecipeSetList"==b)k(this.curRecipe.RecipeSetList,a)||(this.curRecipe.RecipeSetList=a,c=!0);else if("curRecipeSet"==b)this.curRecipe.selSet!=a&&(this.curRecipe.selSet=a,this._isRemoteSrc||this.srv.setCurrentRecipe(this.curRecipe.id,this.curRecipe.selSet,
!1),c=!0);else if("recipeList"==b)k(this.recipeList,a)||(this.recipeList=a,c=!0);else{var g=b.split("."),m=g.length,n=g[m-1],l=void 0;this.enSub[b]&&this.enSub[b].en?(m=this.enSub[b],l=m.type,a instanceof Tb&&("%%empty%%"==a[n]&&(d=!0),a=a[n]),k(m.obj[n],a)||(m.obj[n]=a,c=!0)):(c=!0,l=m);if(!this._isRemoteSrc&&c)switch(l){case ja.RECIPE:this.srv.setRecipeParam(g[0],a,!1);break;case ja.SET:this.srv.setRecipeSetParam(g[0],g[1],n,a,!1);g[0]==this.curRecipe.id&&this.sendUpdate("curRecipeSet",a,f.QUALITY_GOOD,
-1);break;case ja.ELEM:this.srv.setRecipeElemParam(g[0],g[1],g[2],n,a,!1)}}c&&this.sendUpdate(b,a,d?f.QUALITY_UNCERTAIN:f.QUALITY_GOOD,-1)}};a.prototype.subscribeDataLink=function(b){var a=this;c.prototype.subscribeDataLink.call(this,b);g.activeProject.waitWgtReady().then(function(){var c=b.tag.split("."),d=c.length,f=b.tag;a._usedInCurrPage||(a._usedInCurrPage=!0,a.srv.setRecipeNotificationRate(a._ACTIVE_POLL));-1!=a._baseProps.indexOf(f)||a.enSub[f]&&a.enSub[f].en||(a.enSub[f]={en:!0,type:d},d==
ja.RECIPE?("RecipeSetList"==c[1]?a.srv.subscribeRecipeSetList(c[0],function(b,c){a.onDataUpdate(b,c)}):a.srv.subscribeRecipe(c[0],function(b,c){a.onDataUpdate(b,c)}),a.enSub[f].obj=new la):d==ja.SET?(a.srv.subscribeRecipeSet(c[0],c[1],function(b,c){a.onDataUpdate(b,c)}),a.enSub[f].obj=new sa):d==ja.ELEM&&(a.srv.subscribeRecipeSetElem(c[0],c[1],c[2],function(b,c){a.onDataUpdate(b,c)}),a.enSub[f].obj=new ya))})};a.prototype.onCurrRecipeUpdate=function(b,a){var c=t.getModule("Tag");this._isRemoteSrc=
!0;this.setValue("curRecipe",a.id,c.QUALITY_GOOD);void 0!=a.RecipeSetList&&this.setValue("curRecipeSetList",a.RecipeSetList,c.QUALITY_GOOD);void 0!=a.selSet&&this.setValue("curRecipeSet",a.selSet,c.QUALITY_GOOD);void 0!=a.rcList&&this.setValue("recipeList",a.rcList,c.QUALITY_GOOD);this.recipeList[a.id]!=a.Name&&this.setValue("recipeList",this.recipeList.map(function(b,c){return c==a.id?a.Name:b}),c.QUALITY_GOOD);this._isRemoteSrc=!1};a.prototype.onDataUpdate=function(b,a){var c=t.getModule("Tag");
this._isRemoteSrc=!0;this.setValue(b,a,c.QUALITY_GOOD);this._isRemoteSrc=!1};a.prototype._firstUpdate=function(){for(var b=t.getModule("Tag"),a=this._baseProps,c=0,d=a.length;c<d;c++)this.sendUpdate(a[c],this.getValue(a[c]),b.QUALITY_GOOD)};a.prototype.onPageChange=function(){if(this.srv){this.srv.setRecipeNotificationRate(this._IDLE_POLL);this._usedInCurrPage=!1;for(var b in this.enSub){var a=b.split("."),c=a.length;this.enSub[b]&&this.enSub[b].en&&(c==ja.RECIPE?"RecipeSetList"==a[1]?this.srv.unsubscribeRecipeSetList(a[0]):
this.srv.unsubscribeRecipe(a[0]):c==ja.SET?this.srv.unsubscribeRecipeSet(a[0],a[1]):c==ja.ELEM&&this.srv.unsubscribeRecipeSetElem(a[0],a[1],a[2]),this.enSub[b].en=!1)}}};a.prototype.getTagInfo=function(b){return{t:-1,s:-1,rt:500,ct:-1}};a.jmType="RecipeMgrWgt";return a}(l);g.fn.hmiRecipeMgr=function(c,a,b,e){return new vc(this,c,a,b,e)};g.addWidgetDefinition("hmiRecipeMgr",vc);var jb;(function(c){c[c.DOWN=0]="DOWN";c[c.UP=1]="UP"})(jb||(jb={}));var Sb=function(c){function a(){var b=c.call(this)||
this;b.dropDir=jb.DOWN;return b}p(a,c);a.prototype.clone=function(){return new a};a.prototype.initialize=function(b,a,c,d,f,k,q){null!=this.keyboard&&this.hide();this.widget=b;this.inputType=a;this.format=c;this.browserInputSupport=q;this.valueFormat=f;this.layer=g.getFocusPage();if(k.getElementById("jm-kpd"))this.keyboard=null;else{b=void 0;switch(a){case "datetime":a=-1!=c.indexOf("M")||-1!=c.indexOf("d")||-1!=c.indexOf("y");c=-1!=c.indexOf("s")||-1!=c.indexOf("h")||-1!=c.indexOf("m");b=this.createKeyboardDateTimeContainer({input:this.createDateTimeInput(d,
a,c),save:this.createSaveButton(),cancel:this.createCancelButton()},q);break;default:b=this.createKeyboardContainer({input:this.createStandardInput("jm-nField",a,this.format,d),save:this.createSaveButton(),cancel:this.createCancelButton()})}this.keyboard=b;this.appendChildren()}};a.prototype.createStandardInput=function(b,a,c,d){var f=document.createElement("div"),k=document.createElement("input");k.setAttribute("name","nField");k.setAttribute("id",b);k.setAttribute("autocapitalize","off");k.setAttribute("autofocus",
"");""==c&&k.setAttribute("type",a);k.style.width=this.widget.elem.style.width;k.style.color="#383838";k.style.backgroundColor="#dfdfde";k.style.font=this.widget.elem.style.font;k.style.fontSize=this.widget.elem.style.fontSize;k.style.textAlign=this.widget.elem.style.textAlign;k.setAttribute("value",d?d.trim():"");"time"==this.inputType&&-1!=this.format.toLowerCase().indexOf("ss")&&k.setAttribute("step","1");f.appendChild(k);return f};a.prototype.createDTInput=function(b,a,c){var d=document.createElement("input");
d.setAttribute("name",b);d.setAttribute("id",b);d.setAttribute("class",b);d.setAttribute("autocapitalize","off");d.setAttribute("autofocus","");d.setAttribute("type",a);d.style.width=this.widget.elem.style.width;d.style.color="#383838";d.style.backgroundColor="#efefe7";d.style.font=this.widget.elem.style.font;d.style.fontSize=this.widget.elem.style.fontSize;d.style.textAlign=this.widget.elem.style.textAlign;d.style.top="0px";d.style.boxSizing="border-box";d.style.border="0px";d.setAttribute("value",
c?c.trim():"");"time"==this.inputType&&-1!=this.format.toLowerCase().indexOf("ss")&&d.setAttribute("step","1");return d};a.prototype.createCustomDTInput=function(b,a,c,d){var f=document.createElement("div");f.setAttribute("id",b);f.setAttribute("class",b);f.setAttribute("style","display:inline-block;width:"+d.width+"px;height:"+d.width+"px;");var k;"date"==a?(k=c.split("-"),k=[{value:k[0],min:1970,max:NaN},{value:k[1],min:1,max:12},{value:k[2],min:1,max:31}]):"time"==a&&(k=c.split(":"),k=[{value:k[0],
min:0,max:24},{value:k[1],min:0,max:59},{value:k[2],min:0,max:59}]);if(void 0!=k)for(d="width:"+d.width/k.length+"px;height:"+d.height+"px;font-size:"+this.widget.getValue("fontSize")+"px;box-sizing:border-box",b=0;b<k.length;b++)a=k[b],c=document.createElement("input"),c.setAttribute("type","number"),c.setAttribute("value",a.value),c.setAttribute("style",d),NaN!=a.min&&c.setAttribute("min",a.min.toString()),NaN!=a.max&&c.setAttribute("max",a.max.toString()),f.appendChild(c);return f};a.prototype.creatDateInput=
function(b,a,c,d){var f=document.createElement("div");f.style.backgroundColor="#efefe7";f.style.display="flex";f.style.width=a.width+c+"px";f.style.height=a.height+"px";var k=document.createElement("div");k.style.height=c+"px";k.style.width=c+"px";k.style.display="inline-block";var g=document.createElement("div");g.setAttribute("class","jm-calendar");g.style.height=c-d+"px";g.style.width=c-d+"px";g.style.margin=d/2+"px";f.style.borderRadius="2px";k.appendChild(g);f.appendChild(k);this.browserInputSupport.date?
f.appendChild(this.createDTInput("jm-nFiledDate","date",b)):f.appendChild(this.createCustomDTInput("jm-nFiledDate","date",b,a));return f};a.prototype.createTimeInput=function(b,a,c,d){var f=document.createElement("div");f.style.backgroundColor="#efefe7";f.style.display="flex";f.style.width=a.width+c+"px";f.style.height=a.height+"px";var k=document.createElement("div");k.style.height=c+"px";k.style.width=c+"px";k.style.display="inline-block";var g=document.createElement("div");g.setAttribute("class",
"jm-clock");g.style.height=c-d+"px";g.style.width=c-d+"px";g.style.margin=d/2+"px";f.style.borderRadius="2px";k.appendChild(g);f.appendChild(k);this.browserInputSupport.time?f.appendChild(this.createDTInput("jm-nFiledTime","time",b)):f.appendChild(this.createCustomDTInput("jm-nFiledTime","time",b,a));return f};a.prototype.createDateTimeInput=function(b,a,c){b=b.split(" ");var d=b[0],f=b[1],k=parseFloat(this.widget.elem.style.width),g=parseFloat(this.widget.elem.style.height),m=this.dateTimeIconSize=
10<g?g:20,n=b=0,l=document.createElement("div");a&&(a=this.creatDateInput(d,{width:k,height:g},m,10),l.appendChild(a),b=parseInt(a.style.width),n=parseInt(a.style.height));c&&(c=this.createTimeInput(f,{width:k,height:g},m,10),l.appendChild(c),b=b<parseInt(c.style.width)?parseInt(c.style.width):b,n=0!=n?n+parseInt(c.style.height):parseInt(c.style.height));l.style.width=b+"px";l.style.height=n+"px";return l};a.prototype.createSaveButton=function(){var b=document.createElement("button");b.setAttribute("type",
"button");b.setAttribute("class","positive");b.setAttribute("name","save");b.setAttribute("id","jm-save");var a=document.createElement("div");a.setAttribute("class","jm-img jm-saveimg");b.appendChild(a);b.appendChild(document.createTextNode("Save"));b.style.width="80px";b.style.height="30px";return b};a.prototype.createCancelButton=function(){var b=document.createElement("button");b.setAttribute("type","button");b.setAttribute("class","negative");b.setAttribute("name","discard");b.setAttribute("id",
"jm-discard");var a=document.createElement("div");a.setAttribute("class","jm-img jm-cancelimg");b.appendChild(a);b.appendChild(document.createTextNode("Cancel"));b.style.width="80px";b.style.height="30px";return b};a.prototype.appendChildren=function(){this.dropDir===jb.UP?(this.keyboard.appendChild(this.save),this.keyboard.appendChild(this.cancel),this.keyboard.appendChild(this.input)):(this.keyboard.appendChild(this.input),this.keyboard.appendChild(this.save),this.keyboard.appendChild(this.cancel))};
a.prototype.setVerticalAlignment=function(){var b=0,a=this.widget.getVerticalAlignment(),c=parseFloat(this.widget.elem.style.fontSize),d=parseFloat(this.widget.elem.style.height);"middle"===a?b=d/2-c/2:"bottom"===a&&(b=d-c);this.keyboard.style.marginTop=b+"px"};a.prototype.moveKeyboardInsidePage=function(b){var a=this.keyboard,c=parseFloat(a.style.left),d=parseFloat(a.style.top),f=parseFloat(a.style.width),k=a.getBoundingClientRect().height+10,f=b.width-(c+f);0>f&&(f=c+f,a.style.left=(0>f?0:f)+"px");
b=b.height-(d+k);0>b&&(d+=b,a.style.top=(0>d?0:d)+"px",this.dropDir=jb.UP);0>c&&(a.style.left="0px")};a.prototype.setKeyboardLayer=function(b){this.layer=b};a.prototype.getKeyboardLayer=function(){return this.layer};a.prototype.setPosition=function(){var b=this.widget.getAbsolutePosition();this.keyboard.style.left=b.x+"px";this.keyboard.style.top=b.y+"px";this.moveKeyboardInsidePage(this.getKeyboardLayer())};a.prototype.createKeyboardContainer=function(b){var a=document.createElement("div");a.setAttribute("id",
"jm-kpd");a.setAttribute("data-wgtid",this.widget.wgtId);g.browserOptimizations.forceLayers&&a.setAttribute("class","jm-hacklayer");this.input=b.input;this.save=b.save;this.cancel=b.cancel;a.style.width=Math.max(this.widget.width,2*parseFloat(this.save.style.width)+10)+"px";return a};a.prototype.createKeyboardDateTimeContainer=function(b,a){var c=this.createKeyboardContainer(b),d=parseFloat(b.input.style.width);c.style.width=Math.max(d,2*parseFloat(this.save.style.width)+10)+"px";c.style.height=parseInt(b.input.style.height)+
parseInt(b.save.style.height)+10+"px";return c};a.prototype.show=function(){null!==this.keyboard&&(this.setVerticalAlignment(),this.setPosition(),this.getKeyboardLayer().getHTMLElement().appendChild(this.keyboard),g.getInputManager().disableMouse())};a.prototype.onSave=function(b){if("datetime"==this.inputType)this.onSaveDateTime(b);else this.onSaveStandard(b)};a.prototype.onSaveStandard=function(b){if(this.keyboard){var a=$("#jm-nField"),c=a.attr("type");this.keyboard.querySelector("#jm-save").addEventListener("click",
function(){b(c,a.val())})}};a.prototype.getDateTimeFormCustomField=function(b,a){for(var c=b.getElementsByTagName("input"),d=Array(3),f=0,k=c.length;f<k;f++)d[f]=c.item(f).value;return d.join(a)};a.prototype.onSaveDateTime=function(b){var a=this;if(this.keyboard){var c=this.keyboard.querySelector("#jm-nFiledDate"),d=this.keyboard.querySelector("#jm-nFiledTime");this.keyboard.querySelector("#jm-save").addEventListener("click",function(){var f,k;a.browserInputSupport.date?c&&(f=c.value):f=a.getDateTimeFormCustomField(c,
"-");a.browserInputSupport.time?d&&(k=d.value):k=a.getDateTimeFormCustomField(d,":");b(a.inputType,{date:f,time:k})})}};a.prototype.onCancel=function(b){this.keyboard&&this.keyboard.querySelector("#jm-discard").addEventListener("click",b)};a.prototype.onKeyUp=function(b){if(this.keyboard)if("datetime"==this.inputType){var a=this.keyboard.querySelector("#jm-nFiledDate");a&&a.addEventListener("keyup",b);(a=this.keyboard.querySelector("#jm-nFiledTime"))&&a.addEventListener("keyup",b)}else this.keyboard.querySelector("#jm-nField").addEventListener("keyup",
b)};a.prototype.hide=function(){if(this.keyboard){var b=this.keyboard.parentNode;b&&(b.removeChild(this.keyboard),this.reset());g.getInputManager().enableMouse()}};a.remove=function(){var b=document.getElementById("kpd");if(b){var a=b.parentNode;a&&a.removeChild(b)}};a.prototype.reset=function(){this.layer=this.valueFormat=this.browserInputSupport=this.format=this.inputType=this.widget=this.keyboard=null;this.dropDir=jb.DOWN};a.type="normal";return a}(function(){function c(){}c.prototype.initialize=
function(a,b,c,h,d,f,k){};c.prototype.setKeyboardLayer=function(a){};c.prototype.getKeyboardLayer=function(){return null};c.prototype.getHTML=function(){return this.keyboard};c.prototype.show=function(){};c.prototype.hide=function(){};c.prototype.onSave=function(a){};c.prototype.onCancel=function(a){};c.prototype.onKeyUp=function(a){};c.prototype.createSaveButton=function(){return null};c.prototype.createCancelButton=function(){return null};c.prototype.clone=function(){return new c};return c}()),
Xf=function(){function c(a,b){this.document=a;this.browserInputSupport=b;this.keyboards=new Map}c.prototype.register=function(a,b){this.keyboards.set(a,b)};c.prototype.createKeyboard=function(a,b,c,h,d,f){(f=this.keyboards.get(f))||(f=new Sb);f.initialize(a,b,c,h,d,this.document,this.browserInputSupport);return f};c.destroyAllKeyboards=function(){Sb.remove()};c.prototype.createKeyboardFromTemplate=function(a,b,c,h){(a=this.keyboards.get(a))||(a=new Sb);a=a.clone();a.createSaveButton=c;a.createCancelButton=
h;g.keyboardFactory.register(b,a)};return c}();g.keyboardFactory=new Xf(document,Modernizr.inputtypes);g.keyboardFactory.register(Sb.type,new Sb);(function(c){c[c.NONE=0]="NONE";c[c.FITSIZE=1]="FITSIZE";c[c.FITPAGETOSCREENSIZE=2]="FITPAGETOSCREENSIZE"})(I||(I={}));(function(c){c[c.NORMAL=0]="NORMAL";c[c.PRECACHE=1]="PRECACHE"})(na||(na={}));R=function(c){function a(b,e,h,d){e=c.call(this,b.wgtId,e,h,null,null)||this;e.visible=!1;e.setDefaultState();e.isCached=!1;e.invokablePropsList=["id","Id"];e.dialog=
0;e.sFactor=0;e.callbacks={};e.loadMode=1===d?na.PRECACHE:na.NORMAL;e.currentPageColor=e.pageColor;e.constructor==a&&(g.setProjectReady(),g.setCurrentPage(e),(d=g.getActiveProject().getPageMgr())&&e.loadMode==na.NORMAL&&(g.setActivePage(e),d&&!d.isCurrentPageDefined()&&d.setCurrentPageFromName(e.wgtId)));e.project=g.getActiveProject();g.addWidget(b.wgtId,e);e.elem&&null!=e.project&&2==e.project.getValue("bgColorOption")&&e.getId()==g.getActivePage().getId()&&(b=t.getModule("Quality"),e.project.setValue("color",
e.currentPageColor,new b(192)));e.templateWebId&&(e.currentPageColor=e.templatePageColor,e.templatePagePrefix=e.templateWebId.split("_")[0]);e.cntMtx=[[1,0,0],[0,1,0],[0,0,1]];e.left=0;e.top=0;e.mtx||(e.mtx=[[1,0,0],[0,1,0],[0,0,1]]);0==g.mode&&e.constructor==a&&e.executeOnDemandFitToScreenSizeModality();e.elem&&e.loadFontsFace();g.activeProject&&(e.sysVars=g.activeProject.getWidget("_SysPropMgr",!0));e.linksList={};e.initFocus();e._renderMask|=a._renderFlags.BGCOLOR;g.addToRender(e);return e}p(a,
c);a.prototype.initFocus=function(){this.loadMode==na.NORMAL&&(g.setFocusPage(this),g.mouseMgr.loseFocus())};a.prototype.setDefaultState=function(){this.visible=void 0!==this.visible?this.visible:!1;this.fitCssTransform=void 0!==this.fitCssTransform?this.fitCssTransform:"";this.xPageOffset=void 0!==this.xPageOffset?this.xPageOffset:0;this.yPageOffset=void 0!==this.yPageOffset?this.yPageOffset:0;this.resizeTimer=void 0!==this.resizeTimer?this.resizeTimer:null;this.templateWebId=void 0!==this.templateWebId?
this.templateWebId:null;this.mlPage=void 0!==this.mlPage?this.mlPage:null;var b=this.project.getMultiLanguageMgr();this.exportedLang=void 0!==this.exportedLang?this.exportedLang:b&&b.getCurrentLanguage()};a.prototype.pageactivate=function(){var b=g.activeProject.getWidget("_IndexedTagSetMgr",!0);if(this.constructor==a&&(this.isCached&&(g.activeProject.getWidget("_TagMgr",!0).subscribePageGroups(g.getActivePage().wgtId),this.executeOnDemandFitToScreenSizeModality()),"changepassword"==this.studioId.toLowerCase())){var c=
g.activeProject.getWidget("_UserGroupMgr",!0);c.clearAll();c.checkMessages()}if(this.isCached){for(var h in this.linksList)this.linksList[h].update(),this.linksList[h].mount();this.project.subscribeDynamicTags()}this.execTemplateJS();this.execJS();this.tOnActivateActions();this.onActivateActions();b.loadIndexes()};a.prototype.load=function(){this.pageactivate()};a.prototype.pagedeactivate=function(){var b=g.activeProject.getWidget("_IndexedTagSetMgr",!0);g.activeProject.getWidget("_TagMgr",!0).unsubscribePageGroups(this.wgtId);
b&&b.unsubscribePageTags();g.activeProject.off("resize.page");this.tOnDeActivateActions();this.onDeActivateActions();this.executeActions();this.unmountDataLinks()};a.prototype.unload=function(){this.pagedeactivate()};a.prototype.registerLink=function(b){this.linksList&&!this.isCached&&(this.linksList[b.getId()]=b)};a.prototype.unregisterLink=function(b){this.linksList&&delete this.linksList[b.getId()]};a.prototype.unmountDataLink=function(b){this.linksList[b.getId()].unmount()};a.prototype.unmountDataLinks=
function(){for(var b in this.linksList)this.linksList[b].unmount()};a.prototype.destroy=function(){c.prototype.destroy.call(this);clearTimeout(this.resizeTimer);this.mlPage=this.mlTemplate=null;g.getWidgets()[this.wgtId]=null;this.project.removeGroupedButton(this.wgtId);this.linksList=null;return!0};a.prototype.render=function(){if(!c.prototype.render.call(this))return this._renderMask=0,!1;if(this._renderMask&a._renderFlags.VISIBLE){var b=document.getElementById("_"+this.wgtId);this.visible?(Ta(b,
"Transform",this.fitCssTransform),Ta(b,"TransformOrigin","0px 0px")):Ta(b,"Transform","translateZ(0)scale(0)")}if(this._renderMask&a._renderFlags.REDRAW){switch(this.fitsize){case I.FITPAGETOSCREENSIZE:this.executeFitPageToScreenSize();break;case I.FITSIZE:case I.NONE:this.executeFitToSize(),this.project.updateStatusBarPosition(this.yPageOffset)}this.forceRedraw=!1}this._renderMask&a._renderFlags.BGCOLOR&&this.elem&&(b=g.activeProject.getUserGroupMgr(),this.templateStudioId&&(this.currentPageColor=
b.isPageHidden(this.templateStudioId.toLowerCase())?this.pageColor:this.templatePageColor),this.elem.style.backgroundColor=this.currentPageColor);this._renderMask&a._renderFlags.APPLYFOCUS&&this.applyFocus();this._renderMask=0;return!0};a.prototype.onFocus=function(){this._renderMask|=a._renderFlags.APPLYFOCUS;g.addToRender(this)};a.prototype.applyFocus=function(){};a.prototype.executeOnDemandFitToScreenSizeModality=function(){if(this.fitsize==I.FITSIZE||this.fitsize==I.FITPAGETOSCREENSIZE){var b=
g.getBrowserWindowSize();this.adaptToBrowserViewport(b.width,b.height)}else this.sFactor=1,this._renderMask|=a._renderFlags.REDRAW,g.addToRender(this);this.bindResizeEvent();this.project.getValue("enableFitToScreenTransition")&&Ya(this.elem,"none")};a.prototype.executeFitToSize=function(){var b=document.getElementById("_"+this.wgtId),a=g.getBrowserWindowSize(),c=(a.width-this.width*this.sFactor)/2,a=(a.height-this.height*this.sFactor)/2;.1>c&&(c=0);.1>a&&(a=0);this.xPageOffset=c;this.yPageOffset=
a;this.fitCssTransform="translateY( "+a+"px ) translateX( "+c+"px ) scale( "+this.sFactor+" )";this.cntMtx[0][0]=this.cntMtx[1][1]=this.sFactor;this.cntMtx[0][2]=c;this.cntMtx[1][2]=a;null!=b&&(this.visible&&(ha(b,"left top"),ga(b,this.fitCssTransform)),b.style.position="absolute",b.style.left="0px",b.style.top="0px",this.executeGroupGridLayout())};a.prototype.executeFitPageToScreenSize=function(){var b=document.getElementById("_"+this.wgtId);b.style.width=this.elem.style.width=this.width+"px";b.style.height=
this.elem.style.height=this.height+"px";for(var a in this.wgts)if(b=this.wgts[a],b.elem&&b.parentWidget==this){var c=b.getParentBounds(this);b.setParentBounds(c.x*this.xScale,c.y*this.yScale,c.width*this.xScale,c.height*this.yScale,this)}};a.prototype.executeGroupGridLayout=function(){for(var b in this.wgts){var a=this.wgts[b];a.elem&&a.parentWidget==this&&a.hasGridLayout()&&a.executeGridLayout()}};a.prototype.bindResizeEvent=function(){var b=this;this.forceRedraw=!1;this.invalidateMtxChain();g.activeProject.on("resize.page",
function(a){clearTimeout(b.resizeTimer);b.resizeTimer=window.setTimeout(function(a,c){b.project.getValue("enableFitToScreenTransition")?Ya(b.elem,"0.3s"):Ya(b.elem,"none");b.adaptToBrowserViewport(a,c);b.invalidateMtxChain()},300,a.width,a.height)})};a.prototype.adaptToBrowserViewport=function(b,c){var h=this.getRatio(b,c);this.fitsize==I.FITSIZE?this.sFactor=Math.min(h.x,h.y):this.fitsize==I.FITPAGETOSCREENSIZE&&(this.width=b,this.height=c,this.xScale=h.x,this.yScale=h.y);this.forceRedraw=!0;this._renderMask|=
a._renderFlags.REDRAW;g.addToRender(this)};a.prototype.getRatio=function(b,a){return{x:0==this.width?0==b?1:b/1E-6:b/this.width,y:0==this.height?0==a?1:a/1E-6:a/this.height}};a.prototype.getScaleFactors=function(){var b={x:1,y:1};this.sFactor&&(b.x=b.y=this.sFactor);this.xScale&&this.yScale&&(b.x=this.xScale,b.y=this.yScale);return b};a.prototype.isFitToSizeEnable=function(){return this.fitsize==I.FITSIZE?!0:!1};a.prototype.isFitPageToScreenSizeEnable=function(){return this.fitsize==I.FITPAGETOSCREENSIZE?
!0:!1};a.prototype.loadFontsFace=function(){void 0!=this.fonts&&0<this.fonts.length&&g.import("_loadFontFace")(this.fonts)};a.prototype.onActivateActions=function(){if(this.onActivate)for(var b=this.onActivate,a=0;a<b.length;a++)g.doAction(this.wgtId,b[a])};a.prototype.tOnActivateActions=function(){if(this.tonActivate)for(var b=this.tonActivate,a=0;a<b.length;a++)g.doAction(this.wgtId,b[a])};a.prototype.executeActions=function(){g.actionMgr.doActions()};a.prototype.onDeActivateActions=function(){if(this.onDeactivate)for(var b=
this.onDeactivate,a=0;a<b.length;a++)g.doAction(this.wgtId,b[a])};a.prototype.tOnDeActivateActions=function(){if(this.tonDeactivate)for(var b=this.tonDeactivate,a=0;a<b.length;a++)g.doAction(this.wgtId,b[a])};a.prototype.setDialogElem=function(){this.dialog=(this.elem=document.getElementById(this.wgtId+"Dialog"))?1:0};a.prototype.getEventWidgets=function(){var b=[],a;for(a in this.wgts)"EventBufferWgt"==this.wgts[a].getJMType()&&b.push(this.wgts[a]);return b};a.prototype.initialUpdate=function(){for(var b in this.wgts){var a=
this.wgts[b].getDataLinks();if(a)for(var c in a){var d=a[c],f=d.dataSrc.getValue(d.tag);"object"!=typeof f&&0<=d.rw.indexOf("r")&&d.tgtWgt.setValue(d.attr,f,void 0)}}};a.prototype.bindCWCallbacks=function(){for(var b in this.callbacks){var a=this.callbacks[b],c=a.callbackString.indexOf(".");-1!=c&&"this"==a.callbackString.substring(0,c)&&(a.fn=a.wgt.findJSFunction(a.callbackString.substring(c+1)))}};a.prototype.bindJSCallback=function(b){for(var c in this.callbacks){var h=this.callbacks[c];if(h.wgt.constructor==
a||b==h.wgt.isTemplateWgt){var d=h.callbackString.indexOf(".");if(-1!=d)if("this"==h.callbackString.substring(0,d))h.fn=h.wgt.findJSFunction(h.callbackString.substring(d+1));else try{h.fn=this.__eval__(h.callbackString)}catch(f){}else try{h.fn=this.__eval__(h.callbackString)}catch(k){}}}};a.prototype.__eval__=function(b){};a.prototype.registerPageCallback=function(b,a,c){void 0===c&&(c=!1);c=a&&0==b.indexOf("this.")?a.isClone?":"+a.protoWgtId+":"+b:":"+a.wgtId+":"+b:c||a.isTemplateWgt?this.templatePagePrefix+
b:b;this.callbacks[c]||(this.callbacks[c]={callbackString:b,fn:null,wgt:a});return c};a.prototype.bindCWJSClass=function(){var b=g.getActiveProject().getCWidgetMgr();b&&b.bindCWLogicClass(this)};a.prototype.setValue=function(b,e,h,d){d=!1;if(null!=this.elem)switch(b){case "color":b="rgb(0,0,0)";isNaN(e)&&!this.isBadValue(e,!0,h)&&this.pageColor!=e&&(/^rgb\(\s*\d+,\s*\d+\s*,\s*\d+\s*\)$/.test(e)?b=e:e&&0==e.indexOf("#")&&1<e.length&&8>=e.length&&(b=e));this.pageColor!=b&&(this.pageColor=b,this.currentPageColor=
this.templateWebId?this.templatePageColor:b,2==this.project.getValue("bgColorOption")&&this.project.setValue("color",this.pageColor,h));break;case "visibility":case "visible":this.visible!=e&&(this.visible=e,this.getAuthorizations()===this.umgr.getWidgetAuthorizationCodes().HIDE&&(this.visible=!1),this._renderMask|=a._renderFlags.VISIBLE,this.forceRedraw&&(this._renderMask|=a._renderFlags.REDRAW),d=!0);break;default:c.prototype.setValue.call(this,b,e,h)}d&&g.addToRender(this);return!0};a.prototype.getValue=
function(b){return"backgroundColor"==b||"color"==b?this.pageColor:"id"==b||"Id"==b?this.studioId:l.prototype.getValue.call(this,b)};a.prototype.addWidget=function(b,a){c.prototype.addWidget.call(this,b,a);"PageMLTextMgrWgt"==a.getJMType()&&(a.isTemplateWgt?this.mlTemplate=a:this.mlPage=a)};a.prototype.getPageMLTextMgr=function(){return this.mlPage};a.prototype.getTemplateMLTextMgr=function(){return this.mlTemplate};a.prototype.execTemplateJS=function(){if("undefined"!=typeof g.getPagesScript()&&this.templateWebId){var b=
g.getPagesScript()[this.templateWebId];if(b)try{b()}catch(a){g.showErrorMessage(this.studioId,"Initialization",a.message)}}};a.prototype.execJS=function(){if(this.project.isProjectReady()){if("undefined"!=typeof g.getPagesScript()){var b=g.getPagesScript()[this.wgtId];if(b)try{b()}catch(a){g.showErrorMessage(this.studioId,"Initialization",a.message)}}}else{var c=this;setTimeout(function(){c.execJS()},100)}};a.prototype.show=function(){this.setValue("visible",!0,null)};a.prototype.hide=function(){this.setValue("visible",
!1,null)};a.prototype.setCached=function(b){this.isCached=b};a.prototype.getProject=function(){return this.project};a.prototype.getTransformMatrix=function(){return this.cntMtx};a.prototype.isPageCached=function(){return this.isCached};a.prototype.getPrefix=function(){return this.prefix};a.prototype.getTemplatePrefix=function(){return this.templatePagePrefix};a.prototype.getLoadingMode=function(){return this.loadMode};a.prototype.isRoot=function(){return!0};a.prototype.getExportedLanguage=function(){return this.exportedLang};
a.prototype.getWidgets=function(){return this.wgts};a.prototype.getCallbacks=function(){return this.callbacks};a.jmType="PageWgt";a._renderMask=0;a._renderFlags={VISIBLE:1,REDRAW:2,BGCOLOR:4,REDRAWDLG:8,UPDATEPOS:16,APPLYDLGPARAMS:32,APPLYDLGHDR:64,APPLYFITTOSCREENSIZE:128,APPLYFOCUS:256};return a}(l);Object.defineProperty(R.prototype,"backgroundColor",{get:function(){return this.elem?this.getValue("color"):""},set:function(c){this.setValue("color",c,null,null)}});g.fn.hmiPage=function(c,a,b,e){return new R(this,
c,a,e)};g.addWidgetDefinition("hmiPage",R);var wc;(function(c){c[c.MODAL=0]="MODAL";c[c.NON_MODAL=1]="NON_MODAL"})(wc||(wc={}));var Yf=function(){function c(a){var b=a.wgtId,c=a.studioId,h=a.width,d=a.hdrHeight,f=a.title;if(null==f||""==f)f=c;var k=this._elem=document.createElement("div"),q=document.createElement("div");k.setAttribute("data-role","dialog-header");k.setAttribute("data-ref",a.wgtId);k.setAttribute("id",b+"_header");q.setAttribute("id",b+"_title");q.className+=" jm-hdr-title";q.appendChild(document.createTextNode(f));
k.appendChild(q);a=document.createElement("div");f=document.createElement("div");a.id=b+"_close";f.className+=" jm-button-close";a.appendChild(f);k.style.position="absolute";k.style.width=h+"px";k.style.height=d+"px";k.style.backgroundColor="rgb( 223, 223, 223)";k.style.boxSizing="border-box";k.style.borderBottom="1px solid #000a";a.style.position="absolute";a.style.width="30px";a.style.height="30px";a.style.left="7px";a.style.top="7px";k.appendChild(a);a.addEventListener("mouseup",function(){g.getInputManager().isMouseEnabled()&&
g.getAction("hmiActionCloseDialog").execute(b,{pg:c.toLowerCase()})})}Object.defineProperty(c.prototype,"elem",{get:function(){return this._elem},enumerable:!1,configurable:!0});return c}(),hb=function(c){function a(b,a,h){b=c.call(this,b,a,h)||this;b.debounceTime=300;b.cntMtx=[[1,0,0],[0,1,0],[0,0,1]];b.visible=void 0===b.visible?!0:b.visible;b.hdrHeight=47;b.fitsize=g.getActivePage().fitsize;b.dlgCont=document.getElementById(b.wgtId+"_content");b.dlgMain=document.getElementById("_"+b.wgtId);null==
b.parentPage&&(b.parentPage=g.getActivePage());b.fitsize==I.FITSIZE&&(b.bindResizeDialogEvent(),b.adaptDialogToBrowserViewport());b.applyStyles();b.drawHeader();b.updatePosition();b.checkGridLayoutGroups();return b}p(a,c);a.prototype.initFocus=function(){this.loadMode==na.NORMAL&&(g.activeProject.addAsActiveDialog(this),g.setFocusPage(this),g.mouseMgr.loseFocus())};a.prototype.applyFocus=function(){this.dlgMain&&g.activeProject.getNode("container").appendChild(this.dlgMain)};a.prototype.render=function(){this._renderMask&
R._renderFlags.UPDATEPOS&&this.runtimePosition();this._renderMask&R._renderFlags.APPLYDLGPARAMS&&this.setStyle();this._renderMask&R._renderFlags.APPLYDLGHDR&&this.addHeader();this._renderMask&R._renderFlags.REDRAWDLG&&this.applyTransform();this._renderMask&R._renderFlags.APPLYFITTOSCREENIZE&&c.prototype.executeGroupGridLayout.call(this);return c.prototype.render.call(this)};a.prototype.applyTransform=function(){var b=g.getActivePage().sFactor;if(this.fitsize==I.NONE||this.fitsize==I.FITPAGETOSCREENSIZE)b=
1;this.fitCssTransform="scale( "+b+" )translateZ(0)";this.cntMtx[0][0]=this.cntMtx[1][1]=b;ha(this.dlgMain,"left top");ga(this.dlgMain,this.fitCssTransform)};a.prototype.debounce=function(b,a){this.resizeDialogTimer&&clearTimeout(this.resizeDialogTimer);this.resizeDialogTimer=setTimeout(function(){b()},a)};a.prototype.bindResizeDialogEvent=function(){var b=this;g.activeProject.on("resize."+this.wgtId,function(){b.debounce(function(){b.adaptDialogToBrowserViewport();b.invalidateMtxChain()},b.debounceTime)})};
a.prototype.applyStyles=function(){this._renderMask=R._renderFlags.APPLYDLGPARAMS;g.addToRender(this)};a.prototype.drawHeader=function(){this.titlebar&&void 0==this.header&&(this._renderMask|=R._renderFlags.APPLYDLGHDR,g.addToRender(this))};a.prototype.updatePosition=function(){this._renderMask|=R._renderFlags.UPDATEPOS;g.addToRender(this)};a.prototype.checkGridLayoutGroups=function(){this._renderMask|=R._renderFlags.APPLYFITTOSCREENSIZE;g.addToRender(this)};a.prototype.adaptDialogToBrowserViewport=
function(){this.dlgMain&&(this.drawHeader(),this.updatePosition(),this.checkGridLayoutGroups(),this.fitsize==I.FITSIZE&&(this._renderMask|=R._renderFlags.REDRAWDLG,g.addToRender(this)))};a.prototype.runtimePosition=function(){if(this.dynPos)this.xPosition=parseFloat(this.elem.getAttribute("px")),this.yPosition=parseFloat(this.elem.getAttribute("py"));else{var b=this.width,a=this.height;this.fitsize==I.FITSIZE&&(b*=g.getActivePage().sFactor,a*=g.getActivePage().sFactor);this.xPosition=g.browserWindow.width/
2-b/2;this.yPosition=this.titlebar?g.browserWindow.height/2-(a+this.hdrHeight)/2:g.browserWindow.height/2-a/2}var a=b=0,c=1,d=1;if(this.dynPos){switch(this.fitsize){case I.NONE:b=(g.browserWindow.width-this.parentPage.width)/2;a=(g.browserWindow.height-this.parentPage.height)/2;break;case I.FITSIZE:b=this.parentPage.xPageOffset;a=this.parentPage.yPageOffset;c=d=this.parentPage&&this.parentPage.sFactor||1;break;case I.FITPAGETOSCREENSIZE:b=this.parentPage.xPageOffset,a=this.parentPage.yPageOffset,
c=this.parentPage&&this.parentPage.xScale||1,d=this.parentPage&&this.parentPage.yScale||1}0>b&&(b=0);0>a&&(a=0)}this.left=b+this.xPosition*c;this.top=a+this.yPosition*d;this.dlgMain.style.left=this.left+"px";this.dlgMain.style.top=this.top+"px";this.applyTransform()};a.prototype.setStyle=function(){this.dlgMain.style.position="absolute";this.dlgMain.style.width=this.width+"px";this.dlgMain.style.height="auto";this.dlgMain.style.boxShadow="1px 1px 20px #000000";this.dlgMain.style.zIndex="1";(this.titlebar||
"transparent"!=this.pageColor)&&this.titlebar&&(this.dlgCont.style.marginTop="47px",this.elem.style.position="relative")};a.prototype.enableDrag=function(){if(this.titlebar&&this.header){var b=this;$(this.dlgMain).draggable({handle:$("#"+this.header.elem.id),cursor:"move",drag:function(){var a=$(this)[0];b.left=parseFloat(a.style.left.split("px")[0]);b.top=parseFloat(a.style.top.split("px")[0]);b.xPosition=(b.left-b.xPageOffset)/b.sFactor;b.yPosition=(b.top-b.yPageOffset)/b.sFactor;b.invalidateMtxChain()}})}};
a.prototype.disableDrag=function(){$(this.dlgMain).draggable({disabled:!0})};a.prototype.addHeader=function(){this.header=new Yf(this);this.header.elem.appendBefore(this.dlgCont);this.enableDrag()};a.prototype.pagedeactivate=function(){var b=g.getActivePage(),a=g.activeProject.getLastActiveDialogId();a&&(b=g.activeProject.getActiveDialogs().get(a).wgt);g.setFocusPage(b);var b=g.activeProject.getWidget("_TagMgr",!0),a=g.getEventMgr(),c=g.activeProject.getWidget("_IndexedTagSetMgr",!0);a&&a.trigger(this.elem,
"unloadWgt");b&&b.unsubscribePageGroups(this.wgtId);c&&c.unsubscribePageTags();this.unmountDataLinks();this.destroy()};a.prototype.pageactivate=function(){var b=g.activeProject.getWidget("_TagMgr",!0),a=g.activeProject.getWidget("_IndexedTagSetMgr",!0);b&&b.subscribePageGroups(this.wgtId);a&&a.loadIndexes();this.fitsize==I.FITSIZE&&this.bindResizeDialogEvent();this.onActivateActions()};a.prototype.closeDialog=function(){this.pagedeactivate()};a.prototype.getOffsetTop=function(){return this.titlebar?
this.fitsize==I.FITSIZE?this.hdrHeight*g.getActivePage().sFactor:this.hdrHeight:0};a.prototype.getOffsetLeft=function(){return 0};a.prototype.getTransformMatrix=function(){return this.cntMtx};a.prototype.stopLogic=function(){g.activeProject.getWidget("_TagMgr",!0).unsubscribePageGroups(this.wgtId);g.activeProject.off("resize."+this.wgtId)};a.prototype.getDialogContainerElem=function(){return this.dlgMain?this.dlgMain:null};a.prototype.isModal=function(){return this.dialogType==wc.MODAL};a.prototype.destroy=
function(){clearTimeout(this.resizeDialogTimer);g.activeProject.off("resize."+this.wgtId);this.dlgMain.remove();$("link[href='../css/pages/_"+this.wgtId+".css']").remove();return c.prototype.destroy.call(this)};a.jmType="DialogWgt";return a}(R);g.fn.hmiDialog=function(c,a,b){return new hb(this,c,a)};g.addWidgetDefinition("hmiDialog",hb);var hd=function(c){function a(b,a,h,d,f){var k=c.call(this,b.wgtId,a,h,d,f)||this;k.PROPS={TIME:"System Time",XSCREEN:"X Screen resolution",YSCREEN:"Y Screen resolution",
GROUP:"This Client Group-Name",USRNAME:"This Client User-Name",CONN_ST:"Connection status",CLIENTID:"This Client ID",MEMORY:"Available System Memory",CURR_LANG_ID:"Current Language Id",CURR_LANG_NAME:"Current Language Name",CURR_LANG_CODE:"Current Language Code"};k.sysProp={};b=g;k.sysProp[k.PROPS.XSCREEN]=b.browserWindow.width;k.sysProp[k.PROPS.YSCREEN]=b.browserWindow.height;k._pollingTime=1E3;k.DLSSetting={status:"",stdoff:null,stdw:"",stdd:"",stdm:"",stdhh:"",stdmm:"",dlsoff:null,dlsw:"",dlsd:"",
dlsm:"",dlshh:"",dlsmm:"",mode:null};k.sysProp[k.PROPS.TIME]=new Date;k._pollTimer=null;k._systemTimeDelayTimer=null;k._timeoutSytemTime=3E5;k.enabledVars={"System Time":!1,"X Screen resolution":!1,"Y Screen resolution":!1};k.propsImpl={};b.isTestModeActive()||(k.parentWidget.waitWgtReady().then(function(){k.srv=k.project.getCommunticationObj();k._requestTimeSettings().then(function(){k.startQuerying(k.PROPS.TIME)})}),k.sysProp[k.PROPS.CONN_ST]=k.project.getConnectionStatus());if(b=k.project.getWidget("_UserGroupMgr",
!0))b.waitWgtReady().then(function(){k.trigger("um_login")}),b.subscribeWgt(k,function(b,a){k.trigger(b,a)});(b=k.project.getMultiLanguageMgr())&&b.subscribeWgt(k,function(b,a){k.trigger(b,a)});k.project.subscribeWgt(k,function(b,a){k.trigger(b,a)});return k}p(a,c);a.prototype.subscribeDataLink=function(b){c.prototype.subscribeDataLink.call(this,b);var a=b.tag;this.enabledVars[a]?b.tgtWgt.setValue(b.attr,this.sysProp[a],null):this.startQuerying(a)};a.prototype._requestTimeSettings=function(){var b=
this;return this.srv.getDLSSettings().then(function(a){b.DLSSetting=a})};a.prototype.getServerOffset=function(){return 0===this.DLSSetting.mode?this.DLSSetting.stdoff:1===this.DLSSetting.mode?this.DLSSetting.dlsoff:0};a.prototype.startXScreenWatch=function(){var b=this;this.project.on("resize.sysvar",function(){b.updateScreenSize("X")})};a.prototype.startYScreenWatch=function(){var b=this;this.project.on("resize.sysvar",function(){b.updateScreenSize("Y")})};a.prototype.updateScreenSize=function(b){var a=
0,c=t.getModule("Tag"),a=g;"X"==b?(a=a.browserWindow.width=this.sysProp[this.PROPS.XSCREEN]=window.innerWidth,this.sendUpdate(this.PROPS.XSCREEN,a,c.QUALITY_GOOD)):"Y"==b&&(a=a.browserWindow.height=this.sysProp[this.PROPS.YSCREEN]=window.innerHeight,this.sendUpdate(this.PROPS.YSCREEN,a,c.QUALITY_GOOD))};a.prototype.setValue=function(b,a,c,d){"System Time"==b?("date"==$.type(a)?this.srv.setTime(Math.round(a.getTime()/1E3),!1):this.srv.setTime(a,!1),clearTimeout(this._systemTimeDelayTimer),this._systemTimeDelayTimer=
null):b==this.PROPS.CONN_ST?this.sendUpdate(b,this.sysProp[this.PROPS.CONN_ST],c):this.propsImpl[b]&&a!=this.sysProp[b]&&(this.sysProp[b]=a,this.sendUpdate(b,a,c))};a.prototype.getTime=function(){return this.sysProp[this.PROPS.TIME]instanceof Date?this.sysProp[this.PROPS.TIME].getTime():this.sysProp[this.PROPS.TIME].toDate().getTime()};a.prototype.getValue=function(b){var a=g;if(b!=this.PROPS.TIME||this.enabledVars[b]){if(b==this.PROPS.TIME)return this.sysProp[b].toDate().getTime()/1E3;if(b==this.PROPS.CONN_ST)return this.sysProp[this.PROPS.CONN_ST];
if(this.propsImpl[b])return this.sysProp[b];var c=null;switch(b){case this.PROPS.XSCREEN:return this.enabledVars[this.PROPS.XSCREEN]?this.sysProp[b]:a.browserWindow.width;case this.PROPS.YSCREEN:return this.enabledVars[this.PROPS.YSCREEN]?this.sysProp[b]:a.browserWindow.height;case this.PROPS.CLIENTID:if(b=this.project.getWidget("_UserGroupMgr",!0))return b.getValue("ClientID");break;case this.PROPS.CURR_LANG_ID:return(c=this.project.getMultiLanguageMgr())?c.getValue("curLangId"):"";case this.PROPS.CURR_LANG_NAME:return(c=
this.project.getMultiLanguageMgr())?c.getValue("curLangName"):"";case this.PROPS.CURR_LANG_CODE:if(c=this.project.getMultiLanguageMgr())return c.getValue("curLangCode");default:return this.sysProp[b]}}else return moment().toDate().getTime()/1E3};a.prototype.trigger=function(b,a){var c=t.getModule("Tag");switch(b){case "c_status":var d=this.project.getConnectionStatus();this.sysProp[this.PROPS.CONN_ST]!=d&&(this.sysProp[this.PROPS.CONN_ST]=d,this.sendUpdate(this.PROPS.CONN_ST,d,c.QUALITY_GOOD));break;
case "um_login":var d=this.project.getWidget("_UserGroupMgr",!0).getValue("username"),f=this.project.getWidget("_UserGroupMgr",!0).getValue("group");this.sysProp[this.PROPS.USRNAME]!=d&&(this.sysProp[this.PROPS.USRNAME]=d,this.sendUpdate(this.PROPS.USRNAME,d,c.QUALITY_GOOD));this.sysProp[this.PROPS.GROUP]!=f&&(this.sysProp[this.PROPS.GROUP]=f,this.sendUpdate(this.PROPS.GROUP,f,c.QUALITY_GOOD));break;case "up-lang":if(d=this.project.getMultiLanguageMgr())this.sendUpdate(this.PROPS.CURR_LANG_ID,d.getValue("curLangId"),
c.QUALITY_GOOD),this.sendUpdate(this.PROPS.CURR_LANG_NAME,d.getValue("curLangName"),c.QUALITY_GOOD),this.sendUpdate(this.PROPS.CURR_LANG_CODE,d.getValue("curLangCode"),c.QUALITY_GOOD)}};a.prototype.isSystemVarsEnable=function(b){return this.enabledVars[b]};a.prototype.startDateTimePolling=function(){var b=this,a=t.getModule("Tag");null==this._systemTimeDelayTimer?this.srv.getTime(!1).then(function(c){"#S_OK"==c.status&&(c=new Date(c.time),b.sysProp["System Time"]=moment(c),b.sendUpdate("System Time",
c,a.QUALITY_GOOD));b._pollTimer=window.setTimeout(function(){b.startDateTimePolling()},b._pollingTime);b._systemTimeDelayTimer=window.setTimeout(function(){clearTimeout(b._systemTimeDelayTimer);b._systemTimeDelayTimer=null},b._timeoutSytemTime)}):(b.sysProp["System Time"]=b.sysProp["System Time"].add(1,"seconds"),b.sendUpdate("System Time",b.sysProp["System Time"].clone().toDate().getTime()/1E3,a.QUALITY_GOOD),b._pollTimer=window.setTimeout(function(){b.startDateTimePolling()},b._pollingTime))};a.prototype.startQuerying=
function(b){var a=this;switch(b){case this.PROPS.TIME:this.startDateTimePolling();this.enabledVars[this.PROPS.TIME]=!0;break;case this.PROPS.XSCREEN:this.updateScreenSize("X");this.startXScreenWatch();this.enabledVars[this.PROPS.XSCREEN]=!0;var c=g.getEventMgr();if(c){a=this;this.deactivateXHandler=function(){g.activeProject.off("resize.sysvar");a.enabledVars[a.PROPS.XSCREEN]=!1;c.off(d,"unloadWgt",a.deactivateXHandler)};var d=g.getActivePage().elem;c.on(d,"unloadWgt",this.deactivateXHandler)}break;
case this.PROPS.YSCREEN:this.updateScreenSize("Y");this.startYScreenWatch();this.enabledVars[this.PROPS.YSCREEN]=!0;c&&(a=this,this.deactivateYHandler=function(){g.activeProject.off("resize.sysvar");a.enabledVars[a.PROPS.YSCREEN]=!1;c.off(d,"unloadWgt",a.deactivateYHandler)},d=g.getActivePage().elem,c.on(d,"unloadWgt",this.deactivateYHandler));break;default:this.propsImpl[b]&&(this.enabledVars[b]=!0)}};a.prototype.__implementsProperty=function(b,a){var c=t.getModule("Tag");this.propsImpl[b]&&clearTimeout(this.propsImpl[b].timer);
void 0===a.interval&&(a.interval=5E3);1E3>a.interval&&(a.interval=1E3);void 0===a.timer&&(a.timer=null);var d=this.propsImpl[b]=a,f=d.query();this.setValue(b,f,c.QUALITY_GOOD);this._pollCustomProperty(b,d)};a.prototype._pollCustomProperty=function(b,a){var c=this,d=t.getModule("Tag");a.timer=window.setTimeout(function(){var f=a.query();c.setValue(b,f,d.QUALITY_GOOD);c._pollCustomProperty(b,a)},a.interval)};a.jmType="SysPropMgrWgt";return a}(l);g.fn.hmiSystemVars=function(c,a,b,e){return new hd(this,
c,a,b,e)};g.addWidgetDefinition("hmiSystemVars",hd);var id;(function(c){c[c.AUTO=0]="AUTO";c[c.SSE=1]="SSE";c[c.LONGPOLLING=2]="LONGPOLLING"})(id||(id={}));var jd;(function(c){c[c.NONE=0]="NONE";c[c.RUNTIME=1]="RUNTIME";c[c.BROWSER=2]="BROWSER"})(jd||(jd={}));var kd;(function(c){c[c.JMOBILE=0]="JMOBILE";c[c.STANDALONE=1]="STANDALONE"})(kd||(kd={}));var eb=function(c){function a(b,e,h,d){var f=c.call(this,b,e,h,d)||this;f.dlgMaxLimit=5;f.dlgMap=new Map;f.initPromiseReady();f.defs=g.defs;f.actMgr=g.actionMgr;
f.invokablePropsList=["changePageAnimation","changePageAnimationOnCache"];if(1===g.mode)f.setDefaultState(),g.init(),f.project=f,g.activeProject=f,g.projectInterface=new E(f),f.initPromiseReady(),f.props={},void 0!==Ua&&(f.cWidgetMgr=new Ua(f)),f.resolveWgtReady(!0);else{f.template={body:{node:null,children:{container:{node:null},init:{node:null},broken:{node:null},overlays:{node:null,children:{dtpop:{node:null},spinnerbox:{node:null},loading:{node:null},messages:{node:null}}}}}};"undefined"!=typeof h.modernBrowser&&
(h.modernBrowser?(g.browserOptimizations.nativeRenderLoop=h.optimizations.nativeRenderCycle,g.browserOptimizations.forceLayers=h.optimizations.forceLayers):(g.browserOptimizations.nativeRenderLoop=!1,g.browserOptimizations.forceLayers=!1));f.setDefaultState();f.projectName=h.projectName;f.maxBandwidth=h.maxBandwidth;f.connectionMode=h.connectionMode;f.iconStatusDelay=h.webSysIconDelay;f._renderMask=0;f.status=0;f._browserListener=["resize"];f.groupedButtons={};f.initGFX();g.init();f.bindToWindowEvent();
b=t.getModule("StatusBar");f.enbleStatusBar=!0;f.statusBarStyle="FULLSCREEN";f.statusBar=new b(1);g.cache.clear();f.tagMgr=null;f.trendMgr=null;f.pageMgr=null;f._prmTagMgr=new Promise(function(b,a){f._fnResolveTagMgr=b});g.activeProject=f.project=f;g.projectInterface=new E(f);1==f.bgColorOption&&(f._renderMask|=a._renderFlags.BGCOLOR,g.addToRender(f));b=f.getScrollbarSize();g.browserScrollbarWidth=b.width;g.browserScrollbarHeight=b.height;50>f.pollRate?f.pollRate=50:1E4<f.pollRate&&(f.pollRate=1E4);
if(0>f.timeout||864E5<f.timeout)f.timeout=0;g.startInActivityTimer(f.timeout,function(){g.getAction("hmiActionLogOut").execute()});f.dlgInstancesActive=[];f.projectReady=!1;f.pagesCacheSize=6;f.fitToScreenTransition=!0;f.enableListenerOnHashChange();g.isTestModeActive()?(void 0!==Ua&&(f.cWidgetMgr=new Ua(f)),f.resolveWgtReady(!0)):(f.curURL=window.location.href.substring(0,window.location.href.lastIndexOf("/")+1),g.getServerConf().then(function(b){b.projectName=f.projectName;b.maxBandwidth=f.maxBandwidth;
b.connectionMode=f.connectionMode;f.ttl=b.ttl;g.initServerInterface(b);f.srv=g.getServerInterface();b=g.getJSModule("GroupExpressionRunner");f.groupExpressionRunner=new b(f.srv);f.srv.getProjectInformation().then(function(){setInterval(function(){var b=f.srv.isSessionAlive();2==b.status&&g.loadLoginPage();1==b.status&&0==f.connstatus&&(f.hideStatusBar(),f.connstatus=1,f.sendNotification("c_status"));0==b.status&&1==f.connstatus&&(f.showStatusBar(),f.connstatus=0,f.sendNotification("c_status"));1==
b.status&&f.projectName.toLowerCase()!=b.projectName.toLowerCase()&&-1==b.projectName.indexOf("_SIMULATOR_")&&g.loadLoginPage()},f.ttl);f.srv.requestConf();f.srv.getConf("propsMap.json").then(function(b){f.props=b["propsMap.json"]});void 0!==Ua&&(f.cWidgetMgr=new Ua(f));f.resolveWgtReady(!0)})}))}return f}p(a,c);a.prototype.initSSENotificationHandler=function(){var b=this;0==g.isTestModeActive()&&g.isCoreWidgetsReady().then(function(){var a=t.import("SSENotificationHandler");void 0!==a&&(b.notificationHandler=
new a,b.notificationHandler.startEventBasedCommunication())})};a.prototype.showStatusBar=function(){this.enbleStatusBar&&(this.updateStatusBar(this.core.browserWindow.width,this.core.browserWindow.height),this.statusBar.show())};a.prototype.hideStatusBar=function(){this.statusBar.hide()};a.prototype.enableListenerOnHashChange=function(){var b=this;window.addEventListener("hashchange",function(){var a=location.hash,c=a.indexOf("loadPage=");-1!=c&&(a=b.getWidget("_PageMgr",!0).getWebPage(a.substring(c+
9).toLowerCase()),b.changePage(g.getActivePage().getId(),a))},!1)};a.prototype.initGFX=function(){var b=this.template;b.body.node=document.getElementsByClassName("jm-body")[0];b.body.children.container.node=document.getElementById("jm-container");b.body.children.init.node=document.getElementById("hmi-init");b.body.children.broken.node=document.getElementsByClassName("jm-broken");b.body.children.overlays.children.dtpop.node=document.getElementById("jm-hmi-dtpop");b.body.children.overlays.children.spinnerbox.node=
document.getElementById("jm-spinnerbox");b.body.children.overlays.children.loading.node=document.getElementById("jm_loading_");b.body.children.overlays.children.messages.node=document.getElementById("jm-layer-messages")};a.prototype.updateStatusBar=function(b,a){this.statusBar.recalculateSize(b,a)};a.prototype.updateStatusBarPosition=function(b){this.statusBar.setY(b)};a.prototype.getNode=function(b){var a=this.template;if(!a)return null;switch(b){case "body":return a.body.node;case "container":return a.body.children.container.node;
case "initcode":return a.body.children.initcode.node;case "broken":return a.body.children.broken.node;case "dtpopup":return a.body.children.overlays.childern.dtpopup.node;case "spinnerbox":return b=a.body.children.overlays.children.spinnerbox.node,null==b&&(b=document.getElementById("jm-spinnerbox"),a.body.children.overlays.children.spinnerbox.node=b),b;case "loading":return a.body.children.overlays.children.loading.node;case "messages":return b=a.body.children.overlays.children.messages.node,null==
b&&(b=document.getElementById("jm-layer-messages"),a.body.children.overlays.children.messages.node=b),b}return null};a.prototype.removeNode=function(b){var a=this.template;switch(b){case "loading":b=a.body.children.overlays.children.loading.node,null!=b&&(b.parentNode.removeChild(b),a.body.children.overlays.children.loading.node=null)}return null};a.prototype.setDefaultState=function(){this.props=void 0!==this.props?this.props:null;this.pollRate=void 0!==this.pollRate?this.pollRate:3E3;this.timeout=
void 0!==this.timeout?this.timeout:6E5;this.connstatus=void 0!==this.connstatus?this.connstatus:1;this.color=void 0!==this.color?this.color:"none";this.connectionMode=void 0!==this.connectionMode?this.connectionMode:0;this._callbacks={};this._webPageSync=null;this.curURL=window.location.href.substring(0,window.location.href.lastIndexOf("/")+1);this.webMemoryThreshold=void 0!==this.webMemoryThreshold?this.webMemoryThreshold:0;this.shortDateFormat=void 0!==this.shortDateFormat?this.shortDateFormat:
"DD/MMM/YYYY";this.longDateFormat=void 0!==this.longDateFormat?this.longDateFormat:"MM/DD/YY - hh:mm:ss";this.fieldsStyle||(this.fieldsStyle={},this.fieldsStyle.decimalSymbol=void 0!==this.fieldsStyle.decimalSymbol?this.fieldsStyle.decimalSymbol:".",this.fieldsStyle.thousandSymbol=void 0!==this.fieldsStyle.thousandSymbol?this.fieldsStyle.thousandSymbol:",");this.fieldsStyle.digitsGrouping=3};a.prototype.getConnectionStatus=function(){return this.connstatus};a.prototype.hideLoadingPage=function(){this.removeNode("loading")};
a.prototype.getScrollbarSize=function(){var b=document.body,a=document.createElement("div"),c=document.createElement("div");a.setAttribute("style","width:50px;height:50px;position:absolute;overflow:scroll;");a.appendChild(c);c.setAttribute("style","width:100px;height:100px;");b.appendChild(a);var c=a.offsetWidth-a.clientWidth,d=a.offsetHeight-a.clientHeight;b.removeChild(a);return{width:c,height:d}};a.prototype.getActiveDialogs=function(){return this.dlgMap};a.prototype.isActiveDialog=function(b){return-1!=
this.dlgInstancesActive.indexOf(b)};a.prototype.getActiveDialogsIds=function(){return this.dlgInstancesActive};a.prototype.getLastActiveDialogId=function(){return this.dlgInstancesActive[this.dlgInstancesActive.length-1]};a.prototype.activateDialogs=function(){for(var b=0;b<this.dlgInstancesActive.length;b++){var a=this.dlgInstancesActive[b],c=g.getWidget(a),d=c.getDialogContainerElem();this.getNode("container").appendChild(d);(a=this.dlgMap.get(a))&&0==a.enable&&(g.setFocusPage(c),a.enable=!0,g.getEventMgr().trigger(g.getFocusPage().getHTMLElement(),
"loadWgt"),c.show(),c.execJS(),c.load())}};a.prototype.addAsActiveDialog=function(b){this.dlgInstancesActive.push(b.wgtId);this.dlgMap.set(b.wgtId,{wgt:b,enable:!0})};a.prototype.removeActiveDialogs=function(b){var a=this.dlgInstancesActive.indexOf(b);0<=a&&(this.dlgInstancesActive.splice(a,1),this.dlgMap.delete(b))};a.prototype.closeAllDialogs=function(){for(var b=this.dlgInstancesActive.length-1;0<=b;b--)this.closeDialog(this.dlgInstancesActive[b]);this.dlgInstancesActive=[];this.dlgMap.clear();
$(window).off("load.dialog orientationchange.dialog resize.dialog")};a.prototype.closeDialog=function(b){0>this.dlgInstancesActive.indexOf(b)||(this.removeActiveDialogs(b),this.cWidgetMgr.freeCWInstances("_"+b),g.getWidget(b).closeDialog())};a.prototype.stopDialogsLogic=function(){for(var b=0,a=this.dlgInstancesActive.length;b<a;b++){var c=this.dlgMap.get(this.dlgInstancesActive[b]);c&&c.wgt.isModal()&&(c.wgt.stopLogic(),c.enable=!1)}};a.prototype.addWidget=function(b,a){c.prototype.addWidget.call(this,
b,a);switch(a.getJMType()){case "TagMgrWgt":this.tagMgr=a;this._fnResolveTagMgr(this.tagMgr);break;case "MultiLangMgrWgt":this.multiLangMgr=a;break;case "SysPropMgrWgt":this.systemVars=a;break;case "TrendMgrWgt":this.trendMgr=a;break;case "AlarmsMgrWgt":this.alarmsMgr=a;break;case "IndexedTagSetMgrWgt":this.indexedTagSetMgr=a;break;case "UserGroupMgrWgt":this.userGroupMgr=a}};a.prototype.getTagMgrInstance=function(){return this._prmTagMgr};a.prototype.getUserGroupMgr=function(){null==this.userGroupMgr&&
(this.userGroupMgr=this.getWidget("_UserGroupMgr",!0));return this.userGroupMgr};a.prototype.getIndexedTagSetMgr=function(){null==this.indexedTagSetMgr&&(this.indexedTagSetMgr=this.getWidget("_IndexedTagSetMgr",!0));return this.indexedTagSetMgr};a.prototype.getAlarmsMgr=function(){null==this.alarmsMgr&&(this.alarmsMgr=this.getWidget("_AlarmsMgr",!0));return this.getWidget("_AlarmsMgr",!0)};a.prototype.getTagMgr=function(){null==this.tagMgr&&(this.tagMgr=this.getWidget("_TagMgr",!0));return this.tagMgr};
a.prototype.getMultiLanguageMgr=function(){null==this.multiLangMgr&&(this.multiLangMgr=this.getWidget("_MultiLangMgr",!0));return this.multiLangMgr};a.prototype.getSystemPropertiesMgr=function(){null==this.systemVars&&(this.systemVars=this.getWidget("_SysPropMgr",!0));return this.systemVars};a.prototype.getTrendMgr=function(){null==this.trendMgr&&(this.trendMgr=this.getWidget("_TrendMgr",!0));return this.trendMgr};a.prototype.getPageMgr=function(){null==this.pageMgr&&(this.pageMgr=this.getWidget("_PageMgr",
!0));return this.pageMgr};a.prototype.getProject=function(){return this};a.prototype.getRecipeMgr=function(){null==this.recipeMgr&&(this.recipeMgr=this.getWidget("_RecipeMgr",!0));return this.recipeMgr};a.prototype.getTag=function(b,a,c,d,f){return"function"!=typeof d?this._getTagSync(b,a,c,d):this._getTagAsync(b,a,c,d,f)};a.prototype._getTagSync=function(b,a,c,d){var f=null;d||"undefined"==typeof g.getTagFromCache(b)?(d=t.getModule("Tag"),c=this.srv.readTagSync(new d(b,c)),c.getMessageStatus().getValue()!=
y.status.E_TIMEOUT&&(f=c.getValue(),a instanceof H&&(a.setState(c.quality,f,c.type,"S_OK",c.timestamp),a.setMessageCode(c.getMessageStatus().getValue())))):(b=g.getTagFromCache(b),f=b.getValue(c),a&&a.setState(b.quality,f,b.type,"S_OK",b.ts));return f};a.prototype._getTagAsync=function(b,a,c,d,f){var k=t.getModule("Tag");if(f||"undefined"==typeof g.getTagFromCache(b))return this.srv.readTag(new k(b,c)).then(function(c){if((c instanceof H||c instanceof k)&&c.getMessageStatus().getValue()!=y.status.E_TIMEOUT){var h;
h=a instanceof H?a:new H;h.setState(c.quality,c.value,c.type,"S_OK",c.timestamp);return d(b,h)}});f=g.getTagFromCache(b);a.setState(f.quality,f.getValue(c),f.type,"S_OK",f.ts);return d(b,a)};a.prototype.setTag=function(b,a,c,d){var f=new H,k=this.getWidget("_TagMgr",!0);"undefined"==typeof c&&(c=0);if(d)return(b=k.setTagValue(b,a,c,f,!0).getMessageStatus())?b.getValue()==y.status.S_OK:!1;k.setTagValue(b,a,c,f,!1)};a.prototype.getCommunticationObj=function(){return this.srv};a.prototype.getGroup=function(b,
a,c){return this.groupExpressionRunner.run(b,a,c)};a.prototype.getPollRate=function(){return this.pollRate};a.prototype.changePageByIndex=function(b,a){var c=b.getPages();0<=a&&a<=c.length&&this.changePage(g.getActivePage().getId(),c[a])};a.prototype.setValue=function(b,c,h,d){var f=this;switch(b){case "WebPageSynch":var k=this.getWidget("_PageMgr",!0);if(isNaN(c)||!k)return!1;if(1>c||c>k.length()){this._webPageSync=c;break}var q=parseInt(c)-1;parseInt(c)!=this._webPageSync&&(this._webPageSync=c,
g.isCoreWidgetsReady().then(function(){requestAnimationFrame(function(){k.isPrecaching()?k.waitPrecacheEnd().then(function(){return f.changePageByIndex(k,q)}).catch(function(){return f.changePageByIndex(k,q)}):f.changePageByIndex(k,q)})}));break;case "changePageAnimation":this.setChangePageAnimation(c);break;case "changePageAnimationOnCache":this.changePageAnimationOnCache=1==c;break;case "enableFitToScreenTransition":this.fitToScreenTransition=c;break;case "pagesCacheSize":this.pagesCacheSize!=c&&
(1>c&&(c=1),this.pagesCacheSize=c);break;case "color":this.color!=c&&(this.color=this.validateColor(c)?c:"#000",this._renderMask|=a._renderFlags.BGCOLOR,g.addToRender(this));break;case "webMemoryThreshold":c!=this.webMemoryThreshold&&h.isQualityGood()&&(this.webMemoryThreshold=c,this.sendUpdate(b,c,h));break;case "webMemoryAvailable":c!=this.webMemoryAvailable&&h.isQualityGood()&&(this.webMemoryAvailable=c,this.sendUpdate(b,c,h));break;case "shortDateFormat":void 0!=c&&""!==c&&c!=this.shortDateFormat&&
(this.shortDateFormat=c,this.updateGlobalStyle({shortDateFormat:this.shortDateFormat}),this.sendUpdate(b,c,h));break;case "longDateFormat":void 0!=c&&""!==c&&c!=this.longDateFormat&&(this.longDateFormat=c,this.updateGlobalStyle({longDateFormat:this.longDateFormat}),this.sendUpdate(b,c,h));break;case "decimalSymbol":void 0!=c&&""!==c&&c!=this.fieldsStyle.decimalSymbol&&"string"==typeof c&&1==c.length&&(this.fieldsStyle.decimalSymbol=c,this.updateGlobalStyle({decimalSymbol:this.fieldsStyle.decimalSymbol}),
this.sendUpdate(b,c,h));break;case "thousandSymbol":void 0!=c&&""!==c&&c!=this.fieldsStyle.thousandSymbol&&"string"==typeof c&&1==c.length&&(this.fieldsStyle.thousandSymbol=c,this.updateGlobalStyle({thousandSymbol:this.fieldsStyle.thousandSymbol}),this.sendUpdate(b,c,h));break;case "webDebugLogs":b=t.import("JMVirtualConsole");null==this.jmConsole&&(this.jmConsole=new b);this.jmConsole.getMode()!=c.mode&&(this.jmConsole.setMode(c.mode),1==c.mode&&(this.jmConsole.setConnectionParameters(c.address,
c.port),this.jmConsole.openConnection()));break;case "webEnableStatusBar":this.enbleStatusBar!=c&&(this.enbleStatusBar=1==c);break;case "webStatusBarStyle":this.statusBarStyle!=c&&(this.statusBarStyle=c,"BAR"==this.statusBarStyle?this.statusBar.setStyle(0):"FULLSCREEN"==this.statusBarStyle&&this.statusBar.setStyle(1))}return!0};a.prototype.jmLog=function(b){this.jmConsole&&this.jmConsole.log(b)};a.prototype.updateGlobalStyle=function(b){var a=g.getFocusPage().getWidgets(),c;for(c in a)a[c].updateStyle(b);
if(g.getFocusPage().getId()!=g.getActivePage().getId())for(c in a=g.getActivePage().getWidgets(),a)a[c].updateStyle(b)};a.prototype.render=function(){this._renderMask&a._renderFlags.BGCOLOR&&(1==this.bgColorOption||2==this.bgColorOption)&&(document.body.style.background=this.color);this._renderMask&a._renderFlags.UPDATESTATUSBAR&&this.updateStatusBar(this.core.browserWindow.width,this.core.browserWindow.height);this._renderMask=0;return!0};a.prototype.validateColor=function(b){return void 0===b||
null===b?!1:0==b.indexOf("#")&&1<b.length&&8>=b.length||"r"===b.charAt(0)&&"g"===b.charAt(1)&&"b"===b.charAt(2)?!0:!1};a.prototype.getValue=function(b){switch(b){case "WebPageSynch":return this._webPageSync;case "changePageAnimation":return this.changePageAnimation;case "changePageAnimationOnCache":return this.changePageAnimationOnCache;case "pagesCacheSize":return this.pagesCacheSize;case "enableFitToScreenTransition":return this.fitToScreenTransition;case "decimalSymbol":return this.fieldsStyle.decimalSymbol;
case "thousandSymbol":return this.fieldsStyle.thousandSymbol;case "webDebugLogs":return this.jmConsole?{mode:this.jmConsole.getMode(),address:this.jmConsole.getAddress(),port:this.jmConsole.getPort()}:null;default:return this[b]}};a.prototype.checkAvailableMemory=function(){return 0===this.webMemoryThreshold||0===this.webMemoryAvailable?!0:this.webMemoryAvailable>this.webMemoryThreshold};a.prototype.isProjectReady=function(){return this.projectReady};a.prototype.hideLoading=function(){var b=this;
g.isCoreWidgetsReady().then(function(){if(b.srv.getConnectionStatus())b.hideLoadingPage();else b.srv.onConnectionReady(function(){b.hideLoadingPage()})}).catch(function(b){})};a.prototype.execJS=function(){var b=this;g.isCoreWidgetsReady().then(function(){if("undefined"!=typeof g.getPagesScript()){var a=g.getPagesScript()[b.wgtId];if(a)try{a()}catch(c){g.showErrorMessage(b.studioId,"Project Page",c.message)}}b.projectReady=!0;b.status=1}).catch(function(b){})};a.prototype.onPageChange=function(b){if(b.recipes){var a=
this.getRecipeMgr();if(a)a.onPageChange()}b.dialogs&&this.stopDialogsLogic()};a.prototype.getURLForNextNormalPage=function(b){if(1<b.length){var a=b.length;if("umtemplates"==b[a-2])return b[a-2]="pages",this.curURL=b.join("/");if("pages"==b[a-2])return this.curURL}return this.curURL+"pages/"};a.prototype.getURLForNextUMPage=function(b){if(1<b.length){var a=b.length;if("pages"==b[a-2])return b[a-2]="umtemplates",this.curURL=b.join("/")}-1==this.curURL.indexOf("umtemplates")&&(this.curURL+="umtemplates/");
return this.curURL};a.prototype.getPageUrl=function(b){return this.getWidget("_UserGroupMgr",!0).isUMTemplate(b)?this.getURLForNextUMPage(this.curURL.split("/")):this.getURLForNextNormalPage(this.curURL.split("/"))};a.prototype.changePage=function(b,a){var c=this,d,f,k=this.getPageMgr(),q=g.activeProject.getUserGroupMgr().getAuthorizationMap(),m=k.getPageStudioId(a);if(0!==(null===(f=null===(d=null===q||void 0===q?void 0:q.widgets)||void 0===d?void 0:d[m])||void 0===f?void 0:f[m])&&!k.isPrecaching()){this.status=
2;g.pageNavigationOptions.pageToLeave=b;g.pageNavigationOptions.pageToLoad=a;d=g.getBrowserWindowSize();this.triggerEvent("shouldChangePage",{src:k.getPageStudioId(b),dst:k.getPageStudioId(a),height:d.height,width:d.width});this.onPageChange({recipes:!0,dialogs:!0});d=!1;g.pageNavigationOptions.pageToLeave==g.pageNavigationOptions.pageToLoad||!this.changePageAnimationOnCache&&this.getPageMgr().isCached(g.pageNavigationOptions.pageToLoad)||(d=this.showSpinner(!0));var n=function(){k.setLastVisitedPage(b);
var a=c.getPageUrl($hmi.pageNavigationOptions.pageToLoad);$hmi.changePage(a+($hmi.pageNavigationOptions.pageToLoad+".html"),{src:$hmi.pageNavigationOptions.pageToLeave,dst:$hmi.pageNavigationOptions.pageToLoad,beautify:function(b){c.injectCWTemplatesToDOM(b)}})};d?setTimeout(function(){n();c.status=1},0):(n(),this.status=1)}};a.prototype.injectCWTemplatesToDOM=function(b,a){void 0===a&&(a=!1);this.cWidgetMgr.injectCWTemplates(b,b.getAttribute("id"),a)};a.prototype.getClientType=function(){return"web"};
a.prototype.bindToWindowEvent=function(){var b=this;window.addEventListener("resize",function(){var c=window.innerWidth,h=window.innerHeight;g.setBrowserWindowSize(c,h);b.triggerEvent("resize",{width:c,height:h});b._renderMask|=a._renderFlags.UPDATESTATUSBAR;b.core.addToRender(b)})};a.prototype.on=function(b,a){var c=null;-1!=b.indexOf(".")&&(c=b.split("."),b=c[0],c=c[1]);null==this._callbacks[b]?this._callbacks[b]=[{n:c,cb:a}]:this._callbacks[b].push({n:c,cb:a})};a.prototype.off=function(b){var a=
null;-1!=b.indexOf(".")&&(a=b.split("."),b=a[0],a=a[1]);if(null!=this._callbacks[b])if(null==a)delete this._callbacks[b];else{for(var c=this._callbacks[b],d=[],f=0,k=c.length;f<k;f++)c[f].n!=a&&d.push(c[f]);this._callbacks[b]=d}};a.prototype.triggerEvent=function(b,a){var c=g.activeProject,d=c._callbacks[b];if(null==d)return!0;for(var f=0,k=d.length;f<k;f++){var q=d[f].cb(a);if("shouldChangePage"==b&&null!=q){var m=c.getWidget("_PageMgr",!0).getWebPage(q.toLowerCase());null!=m&&(g.pageNavigationOptions.pageToLoad=
m)}if(!1===q)return!1}return!0};a.prototype._resolveStartPage=function(b,a){var c=null,d=this.getWidget("_UserGroupMgr",!0),f=this.getPageMgr();if(b&&d.isUMTemplate(b))return b;var k=f.getCurrentCategory();if(null===k)return g.isTestModeActive()||g.showMessage("Page category","Page size or current userAgent is outside the parameters of any page category.</br>Please review the JMobile project."),c;if(d.useLastGroupPage()&&!a){var q=d.loadLastPageUsed();if(q&&!f.isUserManagmentPage(q)&&k&&(c=f.getWebPage(q.toLowerCase()))&&
-1!=k.pages.indexOf(c))return c}d=d.getHomePage(k.name);b||c||!d||(c=d);b||c||(c=k.home);if(c&&(c=f.getWebPage(c.toLowerCase()),void 0!==c))return c;if(null==b||-1==k.pages.indexOf(b))b="";return b.toLowerCase()};a.prototype.loadHomePage=function(b,a){var c=this,d=this._resolveStartPage(b,a);d&&($hmi.enablePjctWidgetServerReq?$hmi.isTestModeActive()||$hmi.isCoreWidgetsReady().then(function(){c.changePage(null,d)}):this.changePage(null,d))};a.prototype.getCWidgetMgr=function(){return this.cWidgetMgr};
a.prototype.subscribeDynamicTags=function(){this.getTagMgr().subscribeDynamicTags()};a.prototype.unsubscribeDynamicTags=function(){this.getWidget("_TagMgr",!0).unsubscribeDynamicTags()};a.prototype.setChangePageAnimation=function(b){this.changePageAnimation=1==b};a.prototype.showSpinner=function(b){if(!this.changePageAnimation)return!1;var a=this.getNode("spinnerbox");b?Pc(a,"translate(0px,0px)"):Pc(a,"translate(-10000px,-10000px)");return!0};a.prototype.getWidgetDefinitions=function(){return this.defs};
a.prototype.getWidgetDefinition=function(b){return this.defs[b]};a.prototype.getHmiModuleLoader=function(){return t};a.prototype.getActionMgr=function(){return this.actMgr};a.prototype.getFocusPage=function(){return g.getFocusPage()};a.prototype.groupButtonIn=function(b,a){var c=b.parentPage.getId();void 0===this.groupedButtons[c]&&(this.groupedButtons[c]={});void 0===this.groupedButtons[c][a]&&(this.groupedButtons[c][a]={});this.groupedButtons[c][a][b.getId()]=b};a.prototype.updateButtonGroupedByID=
function(b,a){var c=b.parentPage.getId();if(this.groupedButtons[c]&&this.groupedButtons[c][a]){var c=this.groupedButtons[c][a],d=b.getId(),f;for(f in c)f!=d&&1==c[f].getValue("value")&&c[f].doMouseDown()}};a.prototype.removeGroupedButton=function(b){this.groupedButtons[b]&&delete this.groupedButtons[b]};a.prototype.addModule=function(b){var a=this;return this.waitWgtReady().then(function(){a.cWidgetMgr.addModule(b)})};a.prototype.pagedeactivate=function(){};a.prototype.getSrcType=function(b){switch(b.studioId){case "_TagMgr":b=
"Tag";break;case "_IndexedTagSetMgr":b="Alias";break;case "_RecipeMgr":b="Recipe";break;case "_SysPropMgr":b="System";break;case "_MultiLangMgr":case "_VariablesWgt":case "_AlarmsMgr":case "_EventMgr":b="Widget";break;default:b="Widget"}return b};a.prototype.hasTagInCache=function(b){return void 0!=g.cache.getTag(b)};a.prototype.isDebugMode=function(){return 1==this.webShowRuntimeErrors};a._renderFlags={BGCOLOR:1,UPDATESTATUSBAR:2};a.jmType="ProjectWgt";return a}(R);g.fn.hmiProject=function(c,a,b,
e){return new eb(this,c,a,b)};g.addWidgetDefinition("hmiProject",eb);var X;(function(c){c[c.SEGMENTS=0]="SEGMENTS";c[c.HRZ_STRETCH=1]="HRZ_STRETCH";c[c.VRT_STRETCH=2]="VRT_STRETCH";c[c.VRT=3]="VRT";c[c.HRZ=4]="HRZ"})(X||(X={}));var ld=function(c){function a(b,a,h,d,f){b=c.call(this,b.wgtId,a,h,d,f)||this;b.setDefaultState();b.type==X.VRT_STRETCH||b.type==X.HRZ_STRETCH?b.bar=b.elem.getElementsByTagName("svg")[0]:(b.background=b.elem.getElementsByClassName("jm-bargraph-bk")[0],b.bar=b.elem.getElementsByClassName("jm-bargraph-bar")[0]);
return b}p(a,c);a.prototype.setDefaultState=function(){this.min=void 0===this.min?0:this.min;this.max=void 0===this.max?100:this.max;this.color=this.color?this.color:"rgb(170,170,170)";this.backgroundColor=void 0==this.backgroundColor?"none":this.backgroundColor;this.nodes=void 0===this.nodes?0:this.nodes;this.reverse=void 0===this.reverse?!1:this.reverse;this.gpuEnabled=void 0===this.gpuEnabled?!0:this.gpuEnabled;this.type=void 0===this.type?X.SEGMENTS:this.type;this._renderMask=0;this.invokablePropsList=
["fill"]};a.prototype.setValue=function(b,e,h,d){var f="#000";if("value"===b){if(this.isBadValue(e,!1,h))return!1;e=parseFloat(e);if(isNaN(e))return!1;e!=this.value&&(e>this.max?e=this.max:e<this.min&&(e=this.min),this.value=e,this.elem&&this.elem.setAttribute("data-v",this.value.toString()),this._renderMask|=a._renderFlags.VALUE,g.addToRender(this),this.sendUpdate(b,this.value,h))}else if("fill"===b){if(this.isBadValue(e,!1,h))return!1;this.color!=e&&(this.color=e,this._renderMask|=a._renderFlags.FILL,
g.addToRender(this),this.sendUpdate(b,e,h))}else if("color"==b||"Color"==b)if(isNaN(e)){if(this.isBadValue(e,!0,h))return this.backgroundColor=f,this._renderMask|=a._renderFlags.COLOR,g.addToRender(this),!1;this.backgroundColor!=e&&(0==e.indexOf("#")&&1<e.length&&8>=e.length&&(f=e),this.backgroundColor=f,this._renderMask|=a._renderFlags.COLOR,g.addToRender(this),this.sendUpdate(b,f,h))}else this._renderMask|=a._renderFlags.COLOR,g.addToRender(this),this.backgroundColor=f;else if("min"==b){if(this.isBadValue(e,
!1,h))return!1;e!=this.min&&(e>this.max&&(e=this.max),this.min=e,this._renderMask|=a._renderFlags.VALUE,g.addToRender(this),this.sendUpdate(b,this.min,h))}else if("max"==b){if(this.isBadValue(e,!1,h))return!1;e!=this.max&&(e<this.min&&(e=this.min),this.max=e,this._renderMask|=a._renderFlags.VALUE,g.addToRender(this),this.sendUpdate(b,this.max,h))}else if("reverseScale"==b||"!reverseScale"==b){if(this.isBadValue(e,!1,h))return!1;e!=this.reverse&&(this.reverse=e,this._renderMask|=a._renderFlags.VALUE,
g.addToRender(this),this.sendUpdate(b,e,h))}else c.prototype.setValue.call(this,b,e,h,d);return!0};a.prototype.render=function(){c.prototype.render.call(this);var b=g.browserOptimizations.forceLayers;if(this._renderMask&a._renderFlags.VALUE){var e=0;if(this.type==X.SEGMENTS)this.colorSegments();else if(this.type==X.HRZ_STRETCH)e=(this.value-this.min)/(this.max-this.min),this.reverse?ha(this.bar,this.width+"px "+this.height+"px"):ha(this.bar,"0 100%"),b?ga(this.bar,"translateZ(0) scaleX("+e+")"):ga(this.bar,
"scaleX("+e+")");else if(this.type==X.VRT_STRETCH)e=(this.value-this.min)/(this.max-this.min),this.reverse?ha(this.bar,"0px 0px"):ha(this.bar,this.width+"px "+this.height+"px"),b?ga(this.bar,"translateZ(0) scaleY("+e+")"):ga(this.bar,"scaleY("+e+")");else if(b){var e=(this.value-this.min)/(this.max-this.min),h;if(this.type==X.HRZ_STRETCH||this.type==X.HRZ)this.reverse?ha(this.bar,this.width+"px "+this.height+"px"):ha(this.bar,"0 100%"),h="translateZ(0) scaleX("+e+")";else if(this.type==X.VRT_STRETCH||
this.type==X.VRT)this.reverse?ha(this.bar,"0px 0px"):ha(this.bar,this.width+"px "+this.height+"px"),h="translateZ(0) scaleY("+e+")";ga(this.bar,h)}else b=this.bar.style,this.type==X.VRT?(e=this.height*(this.value-this.min)/(this.max-this.min),this.reverse||(b.top=this.height-e+"px"),b.height=e+"px"):this.type==X.HRZ&&(e=this.width*(this.value-this.min)/(this.max-this.min),this.reverse&&(b.left=this.width-e+"px"),b.width=e+"px")}if(this._renderMask&a._renderFlags.FILL)switch(this.type){case X.SEGMENTS:this.colorSegments();
break;case X.HRZ_STRETCH:case X.VRT_STRETCH:b=this.bar.getElementsByClassName("bgColor00");0<b.length?b[0].setAttribute("fill",this.color):this.bar.firstElementChild.setAttribute("fill",this.color);break;default:this.bar.style.backgroundColor=this.color}if(this._renderMask&a._renderFlags.COLOR)switch(this.type){case X.SEGMENTS:this.colorSegments();break;default:this.background.style.backgroundColor=this.backgroundColor}this._renderMask&a._renderFlags.UPDATESVG&&this.elem.getElementsByTagName("svg")[0]&&
(b=this.elem.getElementsByTagName("svg")[0],e=this.width/parseFloat(b.getAttribute("width")),h=this.height/parseFloat(b.getAttribute("height")),ha(b,"top left"),ga(b,"scale("+e+","+h+")"));this._renderMask=0};a.prototype.colorSegments=function(){var b=Math.floor((this.value-this.min)/(this.max-this.min)*this.nodes);this.reverse&&(b=this.nodes-b);for(var a="",c=1;c<=this.nodes;c++){var d=this.elem.querySelector(".jm-hmi-bar-seg-"+c);d&&(a=c<=b?this.color:this.backgroundColor,d.style&&d.style.fill&&
(d.style.fill=a),d.setAttribute("fill",a))}};a.prototype.getValue=function(b){switch(b){case "value":return this.value;case "fill":return this.color;case "color":case "Color":return this.backgroundColor;default:return c.prototype.getValue.call(this,b)}};a.prototype.setParentBounds=function(b,a,h,d,f){c.prototype.setParentBounds.call(this,b,a,h,d,f);this.updateOnResize()};a.prototype.updateOnResize=function(b){c.prototype.updateOnResize.call(this,b);this._renderMask|=a._renderFlags.UPDATESVG;g.addToRender(this)};
a.prototype.destroy=function(){this.bar=this.background=null;return c.prototype.destroy.call(this)};a._renderFlags={VALUE:2,FILL:4,COLOR:8,UPDATESVG:16};a.jmType="BargraphWgt";return a}(l);g.fn.hmiBarGraph=function(c,a,b,e){return new ld(this,c,a,b,e)};g.addWidgetDefinition("hmiBarGraph",ld);if(void 0!==window.CanvasRenderingContext2D){var xc=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(){var c=arguments;if(c[0]instanceof N){var a=c[0].wgt,b=a.encodedUrl,
e=this,h=new Image;h.onload=function(){c[0]=h;xc.apply(e,c);e.restore()};this.save();if(void 0===b)if(b=a.elem.querySelector("svg")){a=document.createElement("svg");a.setAttribute("xmlns","http://www.w3.org/2000/svg");a.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");var d=b.querySelector("use");if(d){if(b=d.cloneNode(!0),d=d.getAttribute("xlink:href").substring(1),d=document.getElementById(d))d=d.cloneNode(!0),a.appendChild(d),a.appendChild(b)}else a=b.cloneNode(!0);h.src="data:image/svg+xml;base64,"+
btoa(a.outerHTML)}else{if(a=a.elem.querySelector("img"))c[0]=a.cloneNode(!0),xc.apply(this,c),this.restore()}else h.src=b}else xc.apply(this,c)}}var cc=function(c){function a(b,a,h,d,f){var k=c.call(this,b.wgtId,a,h,d,f)||this;k.authCode=k.getAuthorizations();k.cnvId=k.wgtId+"_gcnv";k.cnvEl=k.elem.querySelector("#"+CSS.escape(k.cnvId));k._context2d=k.cnvEl.getContext("2d");k.applyContextTransformations();k.events={mousedown:!0,touchstart:!0};g.getEventMgr()&&(k.activateHandler=function(){c.prototype.executeActivationCallback.call(k)&&
(k.update(),k.isWgtActive=!0)},k.deactivateHandler=function(){c.prototype.executeDeactivationCallback.call(k)&&(k.isWgtActive=!1)},c.prototype.bindEvents.call(k,{loadWgt:k.activateHandler,unloadWgt:k.deactivateHandler}));return k}p(a,c);Object.defineProperty(a.prototype,"context2d",{get:function(){return this._context2d},set:function(b){this._context2d=b},enumerable:!1,configurable:!0});a.prototype.render=function(){c.prototype.render.call(this);if(this._renderMask&a._renderFlags.DRAW&&this.onDraw){this.autoClear&&
this.clearCanvasContext();for(var b=this.onDraw,e=0;e<b.length;e++)g.doAction(this.wgtId,b[e])}this._renderMask&a._renderFlags.RESIZE&&(this.cnvEl.width=this.width,this.cnvEl.height=this.height,this.context2d=this.cnvEl.getContext("2d"));this._renderMask=0};a.prototype.applyContextTransformations=function(){var b=this.width/this.cnvW,a=this.height/this.cnvH;switch(this.rdrHint){case 1:this._context2d.scale(Math.min(b,a),Math.min(b,a));break;case 2:this._context2d.scale(b,a)}};a.prototype.setValue=
function(b,a,h,d,f){c.prototype.setValue.call(this,b,a,h,d,f);this.update()};a.prototype.update=function(){this._renderMask|=a._renderFlags.DRAW;g.addToRender(this)};a.prototype.clearCanvasContext=function(){this._context2d.clearRect(0,0,this.cnvW,this.cnvH)};a.prototype.doMouseDown=function(){return this.authCode==this.umgr.getWidgetAuthorizationCodes().RDONLY?(this.project.getValue("onAccessDenied")&&this.showHideAccessDeniedIcon(),!1):!0};a.prototype.doMouseUp=function(){return this.authCode==
this.umgr.getWidgetAuthorizationCodes().RDONLY?(this.project.getValue("onAccessDenied")&&this.showHideAccessDeniedIcon(),!1):!0};a.prototype.doMouseMove=function(){if(this.authCode==this.umgr.getWidgetAuthorizationCodes().RDONLY)return!1};a.prototype.destroy=function(){if(this.destroyed)return!1;c.prototype.unbindEvents.call(this,{loadWgt:this.activateHandler,unloadWgt:this.deactivateHandler});this.clearCanvasContext();return c.prototype.destroy.call(this)};a.prototype.setParentBounds=function(b,
e,h,d,f){c.prototype.setParentBounds.call(this,b,e,h,d,f);this._renderMask|=a._renderFlags.RESIZE;g.addToRender(this)};a.jmType="GenericCanvasWgt";a._renderFlags={DRAW:2,RESIZE:4};return a}(l);g.fn.hmiGenericCanvasWgt=function(c,a,b,e){return new cc(this,c,a,b,e)};g.addWidgetDefinition("hmiGenericCanvasWgt",cc);var yc=function(c){function a(b,a,h,d,f){b=c.call(this,b.wgtId,a,h,d,f)||this;b.values={value1:null,value2:null,value3:null,value4:null,value5:null,value6:null,value7:null,value8:null,value9:null,
value10:null,value11:null,value12:null,value13:null,value14:null,value15:null,value16:null};return b}p(a,c);a.prototype.setValue=function(b,a,c){this.values[b]!=a&&void 0!=a&&(this.values[b]=a,this.sendUpdate(b,a,c))};a.prototype.getValue=function(b){return this.values[b]};a.prototype.setParentBounds=function(b,a,c,d,f){};a.prototype.getParentBounds=function(b){return{x:0,y:0,width:0,height:0}};a.prototype.destroy=function(){this.values=null;return this.destroyed?!1:c.prototype.destroy.call(this)};
a.prototype.setProperty=function(b,a){this.doWriteValue(b,a);this.setValue(b,a,t.getModule("Tag").QUALITY_GOOD)};a.jmType="JSFunctBlockWgt";a.invokablePropsList="value1 value2 value3 value4 value5 value6 value7 value8 value9 value10 value11 value12 value13 value14 value15 value16".split(" ");return a}(l);Object.defineProperties(yc.prototype,{value1:{get:function(){return this.getValue("value1")},set:function(c){this.setProperty("value1",c)}},value2:{get:function(){return this.getValue("value2")},
set:function(c){this.setProperty("value2",c)}},value3:{get:function(){return this.getValue("value3")},set:function(c){this.setProperty("value3",c)}},value4:{get:function(){return this.getValue("value4")},set:function(c){this.setProperty("value4",c)}},value5:{get:function(){return this.getValue("value5")},set:function(c){this.setProperty("value5",c)}},value6:{get:function(){return this.getValue("value6")},set:function(c){this.setProperty("value6",c)}},value7:{get:function(){return this.getValue("value7")},
set:function(c){this.setProperty("value7",c)}},value8:{get:function(){return this.getValue("value8")},set:function(c){this.setProperty("value8",c)}},value9:{get:function(){return this.getValue("value9")},set:function(c){this.setProperty("value9",c)}},value10:{get:function(){return this.getValue("value10")},set:function(c){this.setProperty("value11",c)}},value11:{get:function(){return this.getValue("value11")},set:function(c){this.setProperty("value11",c)}},value12:{get:function(){return this.getValue("value12")},
set:function(c){this.setProperty("value12",c)}},value13:{get:function(){return this.getValue("value13")},set:function(c){this.setProperty("value13",c)}},value14:{get:function(){return this.getValue("value14")},set:function(c){this.setProperty("value14",c)}},value15:{get:function(){return this.getValue("value15")},set:function(c){this.setProperty("value15",c)}},value16:{get:function(){return this.getValue("value16")},set:function(c){this.setProperty("value16",c)}}});g.fn.hmiJSFunctBlock=function(c,
a,b,e){return new yc(this,c,a,b,e)};g.addWidgetDefinition("hmiJSFunctBlock",yc);var Pb=function(c){function a(b,a,h,d,f){var k=c.call(this,b.wgtId,a,h,d,f)||this;k.tagSetsData={};k.activeTagGroups=[];k.mapIdxToName={};k.activeTagsAlias=[];k.activeIndexes=new Map;k.initPromiseReady();g.activeProject.getTagMgr().subscribeWgt(k,function(b,a){k.trigger(b,a)});if(!g.enablePjctWidgetServerReq)return k;k.parentWidget.waitWgtReady().then(function(){k.srv=k.parentWidget.getCommunticationObj();k.srv.getConf().then(function(b){k.tagSetsData=
b["indexedtagset.json"];k.generateMapIdxToName();k.updateDatalinks();k.resolveWgtReady()}).catch(function(){g.getAction("hmiActionShowMessage").execute(null,{msg:"Error loading indexed tag configuration file. Reloading..."},3);setTimeout(function(){k.project.getCommunticationObj().loadIndex()},2E3)})});return k}p(a,c);a.prototype.updateDatalinks=function(){for(var b in this.dataLinks)this.dataLinks[b].update()};a.prototype.generateMapIdxToName=function(){for(var b in this.tagSetsData)null==this.mapIdxToName[this.tagSetsData[b].tsIdx.name]&&
(this.mapIdxToName[this.tagSetsData[b].tsIdx.name]=[]),this.mapIdxToName[this.tagSetsData[b].tsIdx.name].push(b)};a.prototype.getLastValidGroup=function(b){for(var a=0;a<this.activeTagGroups.length;a++){var c=this.activeTagGroups[a];if(c.ts===b)return c}return null};a.prototype.addTagsToGroup=function(b){var a=this.tagSetsData[b.ts];if(a&&a.inst[b.tsidx])for(var c=a.aliases,a=a.inst[b.tsidx].tgs,d=0;d<c.length;d++)-1!=this.activeTagsAlias.indexOf(b.ts+"."+c[d])&&(b.tags.push(a[d]),b.aliases.push(c[d]))};
a.prototype.loadIndexes=function(){this.trigger("indexedtagsetready",[],Array.from(this.activeIndexes,function(b){return b[1]}))};a.prototype.trigger=function(b,a,c){var d=this;this.waitWgtReady().then(function(){if("indexedtagsetready"==b){if(c&&0<c.length){for(var a=[],e=[],q=0;q<c.length;q++){var m=c[q],n=d.mapIdxToName[m.name];if(0<n.length)for(var l=0;l<n.length;l++){var p=n[l];if(d.tagSetsData[p].tsIdx.name==m.name&&d.tagSetsData[p].tsIdx.idx==m.index){var r=null!==m.value&&void 0!==m.value?
m.value.toString().toLowerCase():"-1",t=d.getLastValidGroup(p),u=[];null!==t&&(a.push(t),u=t.pages);t=g.getFocusPage().wgtId;0>u.indexOf(t)&&u.push(t);u={ts:p,tsidx:r,tags:[],aliases:[],pages:u};d.tagSetsData[u.ts]&&d.tagSetsData[u.ts].inst[u.tsidx]?e.push(u):e.push({ts:p,tsidx:r,tags:[],aliases:d.tagSetsData[p].aliases,pages:[]})}}}0<a.length&&d.unsubscribeGroups(a);0<e.length&&d.subscribeGroups(e)}d.update()}})};a.prototype.addToActiveTagGroup=function(b){for(var a=0;a<b.length;a++)this.activeTagGroups.push(b[a])};
a.prototype.removeFromActiveTagGroup=function(b){this.activeTagGroups=this.activeTagGroups.filter(function(a){for(var c=0;c<b.length;c++)if(a.ts==b[c].ts)return!1;return!0})};a.prototype.subscribeTags=function(b){0<b.length&&g.activeProject.getTagMgr().subscribeForTagsNotification(b)};a.prototype.unsubscribeTags=function(b){0<b.length&&g.activeProject.getTagMgr().unsubscribeForTagsNotification(b)};a.prototype.unsubscribeGroups=function(b){for(var a=[],c=0;c<b.length;c++){var d=b[c];if(null!==d)for(var f=
0;f<d.tags.length;f++){var k=d.tags[f].split(".")[0];-1===a.indexOf(k)&&a.push(k)}}this.removeFromActiveTagGroup(b);this.unsubscribeTags(a)};a.prototype.unsubscribePageGroups=function(){for(var b=this.activeTagGroups,a=g.getFocusPage().wgtId,c=[],d=[],f=0;f<b.length;f++){var k=b[f];if(null!==k){var q=k.pages.indexOf(a);-1!=q&&k.pages.splice(q,1);if(0==k.pages.length)for(d.push(k),q=0;q<k.tags.length;q++){var m=k.tags[q].split(".")[0];-1===c.indexOf(m)&&c.push(m)}}}this.removeFromActiveTagGroup(d);
this.unsubscribeTags(c);0==this.activeTagGroups.length&&(this.activeTagsAlias=[])};a.prototype.unsubscribePageTags=function(){this.unsubscribePageGroups()};a.prototype.subscribeGroups=function(b){for(var a=[],c=0;c<b.length;c++){this.addTagsToGroup(b[c]);for(var d=b[c].tags,f=0;f<d.length;f++){var k=d[f].split(".")[0];-1===a.indexOf(k)&&a.push(k)}}this.addToActiveTagGroup(b);this.subscribeTags(a)};a.prototype.update=function(){for(var b=t.import("Quality"),a=0;a<this.activeTagGroups.length;a++)for(var c=
this.activeTagGroups[a],d=c.ts,f=c.aliases,c=c.tags,k=0;k<f.length;k++){var q="",m=new b(192);if(void 0!==c[k]){var n=c[k].split(".")[0],l=c[k].split(".")[1],l=l?Number(l.substring(1,l.length-1)):-1;if(n=g.cache.getTag(n))q=n.getValue(l),m=n.getQuality()}n=d+"."+f[k];-1!=this.activeTagsAlias.indexOf(n)&&this.sendUpdate(n,q,m,-1)}};a.prototype.getTagObjFromAlias=function(b,a){var c=b.split(".")[0];if(void 0!==this.tagSetsData[c]){var d=b.split(".")[1],f=this.tagSetsData[c].tsIdx.name,k=this.tagSetsData[c].tsIdx.idx,
q=g.getWidget(this.tagSetsData[c].tsIdx.dataSrc,!0),m=void 0;if(q){var n=-1;q instanceof fb?(f=g.cache.getTag(f))&&(n=f.getValue(k)):(k=q.getValue(f,k),null!==k&&void 0!==k&&(n=k));n=n.toString().toLowerCase();void 0!=this.tagSetsData[c]&&void 0!==this.tagSetsData[c].inst[n]&&(m=this.tagSetsData[c].inst[n].tgs,c=this.tagSetsData[c].aliases.indexOf(d),m=m[c])}if(m)return c=m.split("."),d=-1,1<c.length&&(m=c[0],d=parseInt(c[1].substr(1,c[1].length-1))),{tag:m,idx:d}}return null};a.prototype.getValue=
function(b,a){if("."==b.charAt(0)){var c=b.split(".")[1];if(void 0!==this.tagSetsData[c]){var d=this.tagSetsData[c].tsIdx.name;return g.getWidget(this.tagSetsData[c].tsIdx.dataSrc,!0).getValue(d,a)}return null}if(d=this.getTagObjFromAlias(b,a))if(c=d.idx,d=g.cache.getTag(d.tag))return void 0===a&&(a=c),d.getValue(a);return null};a.prototype.setValue=function(b,a,c,d){if("."==b.charAt(0))b=b.split(".")[1],this.tagSetsData[b]&&c.isQualityGood()&&(c=this.tagSetsData[b].tsIdx.name,b=this.tagSetsData[b].tsIdx.idx,
d=null==b?d:b,a={name:c,value:a,index:d},this.activeIndexes.set(c+"["+d+"]",a),this.trigger("indexedtagsetready",[],[a]));else{c=this.getTagObjFromAlias(b,d);b=g.cache.getTag(c.tag);var f=a;b&&b.isArrayTag()&&-1==c.idx&&(f=b.getValue(c.idx),-1==b.getStringTagType().indexOf("string")&&-1!==d?f[d]=a:f=a);c&&g.activeProject.getTagMgr().setValue(c.tag,f,c.idx,!0)}};a.prototype.subscribeDataLink=function(b){c.prototype.subscribeDataLink.call(this,b);if("."==b.attr.charAt(0))b=b.attr.split(".")[1],void 0!==
this.tagSetsData[b]&&this.subscribeTags([this.tagSetsData[b].tsIdx.name]);else{b=b.tag;var a=b.split(".")[0],h=b.split(".")[1];void 0!==this.tagSetsData[a]&&-1!=this.tagSetsData[a].aliases.indexOf(h)&&-1==this.activeTagsAlias.indexOf(b)&&this.activeTagsAlias.push(b)}};a.jmType="IndexedTagSetMgrWgt";return a}(l);g.fn.hmiIndexedTagSetMgr=function(c,a,b,e){return new Pb(this,c,a,b,e)};g.addWidgetDefinition("hmiIndexedTagSetMgr",Pb);(function(c){c[c.INIT_PRM=0]="INIT_PRM"})(Ba||(Ba={}));mc=function(){function c(){this._prmWgtReady=
null}c.prototype.resolveWgtReady=function(a){throw Ba.INIT_PRM;};c.prototype.rejectWgtReady=function(a){throw Ba.INIT_PRM;};c.prototype.initPromiseReady=function(){var a=this;this._prmWgtReady=new Promise(function(b,c){a.resolveWgtReady=b;a.rejectWgtReady=c})};c.prototype.waitWgtReady=function(){if(this._prmWgtReady)return this._prmWgtReady;throw Ba.INIT_PRM;};return c}();(function(c){c[c.NORMAL=0]="NORMAL";c[c.TEMPLATE=1]="TEMPLATE"})(Ca||(Ca={}));var Ua=function(c){function a(b){var a=c.call(this)||
this;a.project=b;a.cwgts={};a.instancesMap={};a.HTMLTemplatePolyfillEnabled=HTMLTemplateElement.bootstrap instanceof Function;b=document.getElementById("hmi-templates");var h=!1;a.initPromiseReady();b&&(h=0!=b.childNodes.length);g.isTestModeActive()?a.resolveWgtReady(!0):h?a.resolveWgtReady(!0):a.project.getCommunticationObj().getResource("templates.xml").then(function(b){document.getElementById("hmi-templates").innerHTML=b;a.HTMLTemplatePolyfillEnabled&&HTMLTemplateElement.bootstrap(document);a.resolveWgtReady(!0)}).catch(function(){a.resolveWgtReady(!1)});
return a}p(a,c);a.prototype.setCWMap=function(b,a){null==this.instancesMap[b]&&(this.instancesMap[b]=a)};a.prototype.getCWMap=function(b){b=this.instancesMap[b];return void 0!=b?b:null};a.prototype.freeCWInstances=function(b){delete this.instancesMap[b]};a.prototype.removeInstance=function(b,a){var c=this.instancesMap[b];if(!c)return!1;for(var c=c.p,d=null,f=0;f<c.length;f++)if(c[f].studioId==a){d=f;break}return null!==d?(c.splice(d,1),!0):!1};a.prototype.clearInstanceMap=function(){this.instancesMap=
{}};a.prototype.getAttributeLink=function(b,a){b=b.toLowerCase();return void 0!==this.cwgts[b]&&null!==this.cwgts[b].props?this.cwgts[b].props.attr[a]:[]};a.prototype.hasAttribute=function(b,a){b=b.toLowerCase();return void 0!==this.cwgts[b]&&null!==this.cwgts[b].props};a.prototype.getParameters=function(b){b=b.toLowerCase();return void 0!==this.cwgts[b]&&null!==this.cwgts[b].props?this.cwgts[b].props.par:[]};a.prototype.isRegisteredModule=function(b){b=b.toLowerCase();return void 0!==this.cwgts[b]};
a.prototype.hasGfxInheritance=function(b){b=b.toLowerCase();b=this.cwgts[b];return null!=b&&null!=b.conf&&null!=b.conf.w};a.prototype.findCustomWidget=function(b,a){var c=null,d=null;void 0!=a&&(d=this.getCWMap(a));for(var f=b.querySelectorAll("[data-ctype]"),k=0,g=f.length;k<g;k++){var m=f[k],n=m.getAttribute("data-ctype"),l="1"==m.getAttribute("data-tmpl");this.isRegisteredModule(n)&&(null===c&&(c={p:[],t:[]}),m={webId:m.getAttribute("id"),studioId:m.getAttribute("data-sid"),moduleName:n},l?(c.t.push(m),
null!=d&&d.t.push(m)):(c.p.push(m),null!=d&&d.p.push(m)))}return c};a.prototype.addModule=function(b){this.cwgts[b.name]=b};a.prototype.injectCWTemplates=function(b,a,c){void 0===c&&(c=!1);var d=this.getCWMap(a),f=b.getAttribute("id")!=a;if(null==d||f||c){d=this.findCustomWidget(b,a);if(null==d)return;f||this.setCWMap(a,d)}this.injectCW(b,d.t,a,Ca.TEMPLATE);this.injectCW(b,d.p,a,Ca.NORMAL)};a.prototype.injectCW=function(b,a,c,d){if(void 0!==a)for(var f=0,k=a.length;f<k;f++){var g=a[f].webId,m=a[f].studioId,
n=a[f].moduleName.toLowerCase(),l=this.cwgts[n];if(void 0!==l){null===l.template&&(l.template=document.getElementById(n));l=l.template;n=b.querySelector("#"+CSS.escape(g));null!=l&&null!=n&&(l instanceof HTMLTemplateElement?n.appendChild(l.content.cloneNode(!0)):l instanceof DocumentFragment&&n.appendChild(l.cloneNode(!0)));for(var l=n.querySelectorAll(".jm-wgt, .jm-wgt>div, .jm-hmi-col, canvas"),p=0,r=l.length;p<r;p++){var t=l[p];if("*"===t.id.charAt(0)&&"."===t.id.charAt(1)){t.id=t.id.replace("*",
g);var u=t.getAttribute("data-sid");null!=u&&t.setAttribute("data-sid",u.replace("*",m))}d==Ca.TEMPLATE&&t.setAttribute("data-tmpl","1")}this.injectCWTemplates(n,c)}}};a.prototype.instantiateCW=function(b,a){var c;a=a.toLowerCase();var d=this.cwgts[a],f=this.project.getWidgetDefinitions(),k=this.project.getActionMgr(),q=(c={},c[a]=b,c);if(null!=d&&null!=d.conf&&null!=d.conf.w){b.setModule();d.conf.grid&&b.setGridLayout(d.conf.grid);c=d.conf.w;for(var m=g.import("deepClonePlainObject"),n=0,l=c.length;n<
l;n++){var p=c[n],r=p.w.replace("*",b.wgtId),t=m(p.p),u=void 0,u=void 0!==p.s&&null!==p.s?p.s.replace("*",b.studioId):r,v=q[p.f.toLowerCase()];-1!=p.t.indexOf("hmiAction")?(t.module=b,u=k.getActionDefinition(p.t),q[p.w]=new u({wgtId:r},p.e,t,this.project.getFocusPage(),v)):"hmiAttach"===p.t?(r=p.s,null!==r&&void 0!==r&&("*"==r&&(r=q[p.w].parentWidget.getId()),g.hmiAttach(q[p.w],r,t))):(t.isTemplateWgt=b.isTemplateWgt,t.module=b,b.isClone&&(t.isClone=b.isClone,t.protoWgtId=b.protoWgtId+"."+p.w.substring(2),
t.tableGroupWgt=b.tableGroupWgt,t.ext=b.ext),"hmiCWMLTextMgr"==p.t&&d.tr&&this.applyMLPatch(t.texts,d.tr),void 0===v&&(v=b),q[p.w]=new f[p.t]({wgtId:r},u,t,this.project.getFocusPage(),v))}this.subscribeAttributeLinks(d,b);k=f=void 0;Oc(b.mtx)?(f=b.width,k=b.height):(k=b._map(b.mtx,{x:b.width,y:b.height}),f=k.x,k=k.y);q=b.left;c=b.top;b.width=d.conf.br.width;b.height=d.conf.br.height;b.left=0;b.top=0;q==b.left&&b.top==c&&b.width==f&&b.height==k||b.setParentBounds(q,c,f,k,b.parentWidget)}};a.prototype.subscribeAttributeLinks=
function(b,a){if(null!==b.props&&null!==b.props.attr)for(var c in b.props.attr){var d=b.props.attr[c];if(0<d.length)for(var f=0,k=d.length;f<k;f++){var g=d[f].lastIndexOf("."),m=d[f].substring(0,g),g=a.getWidget(m,!0,a.isTemplateWgt);if(null==g){var n=m.replace(/[0-9]/g,""),m=parseInt(m.substring(n.length));isNaN(m)&&(m=1);var l=[];a.getWidgetsByJMClass(n,m,l);l.length==m&&(g=l[m-1])}null!=g&&g.subscribeWgt(a,function(b,a){return function(c,e){"mdup"==c&&b.sendUpdate(a,e.v,e.q)}}(a,c))}}};a.prototype.applyMLPatch=
function(b,a){for(var c in a){var d=b[c],f=a[c],k;for(k in f)d[k]=f[k]}};a.prototype.bindJSClass=function(b){var a=this.cwgts[b.ctype.toLowerCase()];void 0!==a&&null!=a.js&&a.js.call(b,b)};a.prototype.bindCWLogicClass=function(b,a){var c=this.getCWMap(a?a:"_"+b.wgtId);if(null!==c){for(var d=c.t,f=0,k=d.length;f<k;f++){var g=d[f];if(!this.hasGfxInheritance(g.moduleName)){var m=b.getWidget(g.webId);this.subscribeAttributeLinks(this.cwgts[m.ctype.toLowerCase()],m);this.bindJSClass(m)}}d=c.p;f=0;for(k=
d.length;f<k;f++)g=d[f],m=b.getWidget(g.webId),this.hasGfxInheritance(g.moduleName)||this.subscribeAttributeLinks(this.cwgts[m.ctype.toLowerCase()],m),this.bindJSClass(m);(0<c.t.length||0<c.p.length)&&b.bindCWCallbacks()}};return a}(mc),zc=function(c){function a(b,a,h,d,f){b=c.call(this,b.wgtId,a,h,d,f)||this;if(!g.enablePjctWidgetServerReq)return b;b.setDefaultState();var k=b;b.firstLangLoad=!0;b.mlMgr=g.activeProject.getWidget("_MultiLangMgr",!0);if(b.mlMgr){b.mlMgr.subscribe(b.wgtId,function(b){k.isActive()&&
k.changePageLanguage(b)});if(b.parentPage.elem){if(a=b.parentPage.elem.getAttribute("data-hmilang"))b.curLangId=a;if(a=g.getEventMgr())k=b,b.activateHander=function(){k.load()},b.deactivateHander=function(){k.unload()},a.on(b.parentPage.elem,"loadWgt",b.activateHander),a.on(b.parentPage.elem,"unloadWgt",b.deactivateHander)}b.module&&b.module.setCWMLTextMgr(b);b.checkForLanguageUpdate();b.status=!0}return b}p(a,c);a.prototype.setDefaultState=function(){this.curLangId=null!=this.curLangId?this.curLangId:
null;this.mlMgr=null!=this.mlMgr?this.mlMgr:null};a.prototype.checkForLanguageUpdate=function(){var b=this.mlMgr.curLangId;(this.curLangId!=b||this.firstLangLoad)&&this.changePageLanguage(b)};a.prototype.load=function(){this.status=!0;this.checkForLanguageUpdate()};a.prototype.unload=function(){this.status=!1};a.prototype.changePageLanguage=function(b){if(this.curLangId!=b||this.firstLangLoad){this.firstLangLoad=!1;this.curLangId=b;var a=this.parentPage.wgts,c;for(c in a){var d=a[c],f=!this.isTemplateWgt&&
!d.isTemplateWgt,k=this.isTemplateWgt&&d.isTemplateWgt,g=void 0,g=d instanceof Va?d.hasModule&&d.hasMLManager():null!=d.module&&d.module.hasMLManager();!f&&!k||g||d.updateLanguage()}this.parentPage.elem&&!this.isTemplateWgt&&this.parentPage.elem.setAttribute("data-hmilang",b)}};a.prototype.getMLTexts=function(b){return this.texts[b]};a.prototype.getText=function(b,a){return this.texts[b]?this.texts[b][this.curLangId]:null};a.prototype.getCurrentFont=function(){return this.mlMgr.getLanguageFont(this.curLangId)};
a.prototype.getCurrentLanguage=function(){return this.mlMgr.curLangId};a.prototype.getMultiLanguagesMgr=function(){return this.mlMgr};a.prototype.isActive=function(){return this.status};a.prototype.setValue=function(b,a){};a.prototype.getValue=function(b){};a.prototype.destroy=function(){this.mlMgr&&this.mlMgr.unsubscribe(this.wgtId);var b=g.getEventMgr();b.off(this.parentPage.elem,"loadWgt",this.activateHander);b.off(this.parentPage.elem,"unloadWgt",this.deactivateHander);return c.prototype.destroy.call(this)};
a.jmType="PageMLTextMgrWgt";return a}(l);g.fn.hmiPageMLTextMgr=function(c,a,b,e){return new zc(this,c,a,b,e)};g.addWidgetDefinition("hmiPageMLTextMgr",zc);var Zf=function(c){function a(b,a,h,d,f){return c.call(this,b,a,h,d,f)||this}p(a,c);a.prototype.changePageLanguage=function(b){if(this.curLangId!=b||this.firstLangLoad){this.firstLangLoad=!1;this.curLangId=b;b=this.parentWidget.wgts;for(var a in b){var c=b[a];(!this.isTemplateWgt&&!c.isTemplateWgt||this.isTemplateWgt&&c.isTemplateWgt)&&c.updateLanguage()}a=
t.getModule("Tag");b=this.parentWidget.getAttributeLinks();for(var d in b)c=b[d],c.t==kb.MLPATCH&&(c=c.v[parseInt(this.curLangId.substr(1))],this.parentWidget.setValue(d,c,a.QUALITY_GOOD))}};a.prototype.getMLTexts=function(b){return this.texts[b]};a.prototype.getText=function(b,a,c){if(a&&c){var d=a.getUserId().split(".");c="*."+d[d.length-1]+"."+c;if((d=this.parentWidget.getAttributeLinks())&&(c=d[c])&&c.t==kb.MLPATCH)return c.v[this.curLangId.substr(1)]}return a&&a.isClone?a.tableGroupWgt.getText(b,
a):this.texts[b]?this.texts[b][this.curLangId]:null};a.jmType="CustomWgtMLTextMgrWgt";return a}(zc);g.addWidgetDefinition("hmiCWMLTextMgr",Zf);lc=function(){function c(){this.dataLinks=null}c.prototype.addDataLink=function(a){this.parentPage?this.parentPage.registerLink(a):this.registerLink&&this.registerLink(a);this.subscribeDataLink(a)};c.prototype.subscribeDataLink=function(a){void 0==this.dataLinks&&(this.dataLinks={});this.dataLinks[a.getId()]=a};c.prototype.removeDataLink=function(a){delete this.dataLinks[a.getId()]};
c.prototype.registerLink=function(a){};c.prototype.getWidget=function(a,b,c){return null};c.prototype.setProperty=function(a,b){var c=t.getModule("Tag");this.setValue(a,b,c.QUALITY_GOOD)};c.prototype.setValue=function(a,b,c,h,d){};c.prototype.getValue=function(a){return null};c.prototype.getId=function(){return""};c.prototype.destroy=function(){for(var a in this.dataLinks){var b=this.dataLinks[a];b.dataSrc.getId()!=this.getId()?b.dataSrc.removeDataLink(b):b.tgtWgt.getId()!=this.getId()&&b.tgtWgt.removeDataLink(b)}};
c.prototype.unmountLinks=function(){for(var a in this.dataLinks)this.dataLinks[a].unmount()};c.prototype.mountLinks=function(){for(var a in this.dataLinks)this.dataLinks[a].mount(),this.dataLinks[a].update()};return c}();(function(c){c[c.EMPTY=-1]="EMPTY";c[c.BOOLEAN=0]="BOOLEAN";c[c.BYTE=1]="BYTE";c[c.SHORT=2]="SHORT";c[c.INT=3]="INT";c[c.UNSIGNEDBYTE=4]="UNSIGNEDBYTE";c[c.UNSIGNEDSHORT=5]="UNSIGNEDSHORT";c[c.UNSIGNEDINT=6]="UNSIGNEDINT";c[c.FLOAT=7]="FLOAT";c[c.DOUBLE=8]="DOUBLE";c[c.STRING=9]=
"STRING";c[c.BINARY=10]="BINARY";c[c.TIME=11]="TIME";c[c.INT64=12]="INT64";c[c.UINT64=13]="UINT64";c[c.INT64A=14]="INT64A";c[c.UINT64A=15]="UINT64A"})(v||(v={}));(function(c){c[c.EMPTY=0]="EMPTY";c[c.BIT=1]="BIT";c[c.BYTE=2]="BYTE";c[c.SHORT=3]="SHORT";c[c.INT=4]="INT";c[c.UNSIGNED_BYTE=5]="UNSIGNED_BYTE";c[c.UNSIGNED_SHORT=6]="UNSIGNED_SHORT";c[c.UNSIGNED_INT=7]="UNSIGNED_INT";c[c.FLOAT=8]="FLOAT";c[c.DOUBLE=9]="DOUBLE";c[c.STRING=10]="STRING";c[c.BINARY=11]="BINARY";c[c.TIME=12]="TIME";c[c.ARRAY_BIT=
13]="ARRAY_BIT";c[c.ARRAY_BYTE=14]="ARRAY_BYTE";c[c.ARRAY_SHORT=15]="ARRAY_SHORT";c[c.ARRAY_INT=16]="ARRAY_INT";c[c.ARRAY_UNSIGNED_BYTE=17]="ARRAY_UNSIGNED_BYTE";c[c.ARRAY_UNSIGNED_SHORT=18]="ARRAY_UNSIGNED_SHORT";c[c.ARRAY_UNSIGNED_INT=19]="ARRAY_UNSIGNED_INT";c[c.ARRAY_FLOAT=20]="ARRAY_FLOAT";c[c.ARRAY_DOUBLE=21]="ARRAY_DOUBLE";c[c.ARRAY_TIME=22]="ARRAY_TIME";c[c.UINT64=23]="UINT64";c[c.INT64=24]="INT64";c[c.ARRAY_UINT64=25]="ARRAY_UINT64";c[c.ARRAY_INT64=26]="ARRAY_INT64";c[c.OBJECT=27]="OBJECT"})(Na||
(Na={}));var $b=function(c){function a(b,a,h,d){var f=c.call(this)||this;f.dataSrc=null;f.tgtWgt=null;f.attr="";f.dataSrcId="";f.dataSource="";f.numXforms=0;f.rw="r";f.tag="";f.tagIndex=-1;f.tagType=-1;f.tagRange=null;f.initialized=!0;f.id=b;f._options=d;f.tgtWgt=a;f.page=g.getFocusPage();f.setDataSrcWgt(h);f.initOptions(d);b=t.getModule("Tag");f.quality_good=b.QUALITY_GOOD;f.quality_uncertain=b.QUALITY_UNCERTAIN;return f}p(a,c);a.prototype.setOptions=function(b){this._options=b};a.prototype.getOptions=
function(){return this._options};a.prototype.resolveTagName=function(){if(!(this.dataSrc instanceof Pb||this.dataSrc instanceof Ac||this.dataSrc instanceof vc)&&"*"!==this.tag.charAt(0)&&-1!==this.tag.indexOf(".")){var b=this.tag.split(".");if(1<b.length){var a=b[b.length-1],b=this.dataSrc.getWidgetByJMType(b[b.length-2]);this.tag=a;this.dataSrc=b;this.dataSrcId=b.wgtId}}};a.prototype.initOptions=function(b){if(null!=b){for(var a in b)"xforms"!=a&&(this[a]=b[a]);null!=this.tagType&&(this.tagRange=
t.getModule("Tag").getTypeRange(this.tagType));this.resolveTagName();this.loadXForms(b.xforms);this.loadStructuredTag()}};a.prototype.loadXForms=function(b){if(b&&0<b.length){this.numXforms=b.length;this.xforms=Array(this.numXforms);for(var a=g.getActiveProject(),c=0,d=this.numXforms;c<d;c++){var f=void 0;if(b[c]instanceof Da)f=b[c];else{var k=b[c],f=new (a.getWidgetDefinition(k.hmiConstructor))({wgtId:k.id},k.id,Ia({className:k.className},k.parameters),g.getFocusPage(),this.tgtWgt);if(k.datalinks)for(var q=
0,m=k.datalinks.length;q<m;q++){var n=k.datalinks[q].p,l=void 0,p=0,l=0==n.wT?("ProjectWgt"==this.tgtWgt.getJMType()?this.tgtWgt:this.tgtWgt.parentPage.getProject()).getWidget(n.dataSource,!0):-1==n.wT?g.getWidget(n.dataSource,!0):this.tgtWgt.parentPage.getWidget(n.dataSource,!0);this.parentPage&&(p=this.tgtWgt.parentPage.getLoadingMode());g.createAndMountDataLink(f,l,n,p)}}f&&f.setDLink(this);this.xforms[c]=f}}};a.prototype.resolveParameterReference=function(b){var a=b.match(/\${\w*}/g);if(null!==
a)for(var c=0;c<a.length;c++){var d=a[c];if(null!==d&&3<d.length){var f=d.substring(2,d.length-1),k=this.tgtWgt instanceof dc?this.tgtWgt.parentWidget.getModule():this.tgtWgt.getModule();if(null!==k)if(k.hasParameter(f))b=b.replace(d,k.getValue(f)),k.addParameterDataLink(f,this);else if(k=k.getParentModuleWithParameter(f))b=b.replace(d,k.getValue(f)),k.addParameterDataLink(f,this)}}return b};a.prototype.loadStructuredTag=function(){if(null!=this._tag&&""!=this._tag){var b=this.resolveParameterReference(this._tag),
a=this.tagIndex;null!=this._tagIndex&&""!=this._tagIndex&&(a=parseFloat(this.resolveParameterReference(this._tagIndex)));(this.tag!=b&&this._tag!=b||this.tagIndex!=a)&&this.updateDataSourceAttribute(b,a);this.dataSrc.updateDataLink(this)}};a.prototype.getModule=function(){return this.tgtWgt.getModule()};a.prototype.addInternalLink=function(b){void 0===this.links&&(this.links=[]);this.links.push(b)};a.prototype.mountInternalLinks=function(){if(this.links&&0<this.links.length)for(var b=0,a=this.links.length;b<
a;b++){var c=this.links[b].s,d=this.links[b].p,c=0==d.wT?this.page.getProject().getWidget(c,!0):this.page.getWidget(c,!0),d=g.createDataLink(this,c,d);d.update();d.mount()}};a.prototype.unmountInternalLinks=function(){if(this.links&&0<this.links.length)for(var b in this.dataLinks)this.dataLinks[b].unmount()};a.prototype.unmountXForms=function(){for(var b=this.page.getProject().getFocusPage(),a=0,c=this.xforms;a<c.length;a++)b.removeXForm(c[a].getId())};a.prototype.mount=function(){this.tgtWgt.addDataLink(this);
this.dataSrc&&this.dataSrc.subscribeDataLink(this);this.mountInternalLinks();if(this.xforms)for(var b=0,a=this.xforms;b<a.length;b++)a[b].mountLinks();return this};a.prototype.unmount=function(){this.tgtWgt.removeDataLink(this);this.dataSrc&&this.dataSrc.unsubscribeDataLink(this);this.unmountInternalLinks();if(this.xforms)for(var b=0,a=this.xforms;b<a.length;b++)a[b].unmountLinks();return this};a.prototype.update=function(){if("rw"===this.rw||"r"===this.rw){var b=g.cache.getTag(this.tag),a=this.srcType;
"Widget"==a||"Data"==a||"Recipe"==a||"Alias"==a?(b=this.dataSrc.getValue(this.tag,this.tagIndex),this.setWgtValue(b,-1,this.quality_good,!1,null)):"System"==a?(b=this.dataSrc.getValue(this.tag),this.tgtWgt.setValue(this.attr,b,this.quality_good,this.tagIndex)):b?this.setWgtValue(b.getValue(this.tagIndex),-1,b.getQuality(),!1,b.ts):this.tgtWgt.setValue(this.attr,void 0,this.quality_uncertain)}return this};a.prototype.updateDSParameter=function(){if(null!=this._tag){var b=this.resolveParameterReference(this._tag),
a=this.tagIndex;null!=this._tagIndex&&""!=this._tagIndex&&(a=parseFloat(this.resolveParameterReference(this._tagIndex)));if(this.tag!=b&&this._tag!=b||this.tagIndex!=a)this.updateDataSourceAttribute(b,a),this.dataSrc.updateDataLink(this),"TagMgrWgt"==this.dataSrc.getJMType()&&this.dataSrc.subscribeDynamicTags()}};a.prototype.updateDataSourceAttribute=function(b,a){this.dataSrc.unsubscribeDataLink(this);this.tag=b;this.tagIndex=a;this.dataSrc.subscribeDataLink(this)};a.prototype.setWgtValue=function(b,
a,c,d,f){this.enableUpdate=null!=d?d:!0;if("w"!=this.rw){var k=this.tgtWgt.getValue(this.attr);0<this.numXforms&&(b=this.doXform(b,"r"));if("undefined"!=typeof this.tgtWgt.onDataUpdate&&this.enableUpdate&&k!=b)if(g.activeProject.isProjectReady())this.doOnDataUpdate(b,k,this.attr,0,"R");else{var q=this;g.isCoreWidgetsReady().then(function(){q.doOnDataUpdate(b,k,q.attr,0,"R")})}void 0===a&&(a=this.tagIndex);this.tgtWgt.setValue(this.attr,b,c,a,f)}};a.prototype.doOnDataUpdate=function(b,a,c,d,f){if(void 0!=
this.tgtWgt&&void 0!=this.tgtWgt.onDataUpdate){b={attribute:this.attr,oldValue:a,newValue:b,attrName:c,mode:f,index:d};a=this.tgtWgt.onDataUpdate;for(c=0;c<a.length;c++)g.doAction(this.tgtWgt.wgtId,a[c],b);g.actionMgr.doActions()}};a.prototype.setTagValue=function(b){var a;if(null!=this.dataSrc){var c=b,d=0,f=null===(a=this.dataSrc.getTagInfo(this.tag))||void 0===a?void 0:a.ct;0<this.numXforms?(b=this.doXform(c,"w"),b=this.scaleTagValues(b,f),a=this.doXform(b,"r"),c!=a&&this.tgtWgt.setValue(this.attr,
a,this.quality_good)):b=this.scaleTagValues(b,f);var k=this.dataSrc.getValue(this.tag,this.tagIndex);if("undefined"!=typeof this.tgtWgt.onDataUpdate&&k!=b){var q=this.tagIndex;if(g.activeProject.isProjectReady())this.doOnDataUpdate(b,k,this.attr,q,"W");else{var m=this;g.isCoreWidgetsReady().then(function(){m.doOnDataUpdate(b,k,m.attr,q,"W")})}}-1!=this.tagIndex?d=this.tagIndex:this.tgtWgt.index&&(d=this.tgtWgt.index);return this.dataSrc.constructor==fb?this.dataSrc.setValue(this.tag,b,d,!0):this.dataSrc.constructor==
Pb?Promise.resolve(this.dataSrc.setValue(this.tag,b,this.quality_good,d)):Promise.resolve(this.dataSrc.setValue(this.tag,b,this.quality_good,d,!0))}return Promise.resolve(!0)};a.prototype.isOutOfTagRange=function(b){return b<this.tagRange.min||b>this.tagRange.max};a.prototype.castWithSign=function(b){var a,c;switch(this.tagType){case v.BYTE:a=255;c=128;break;case v.SHORT:a=65535,c=32768}return this.isOutOfTagRange(b)&&(b&=a,0!=(b&c))?-((~b&a)+1):b};a.prototype.scaleTagValues=function(b,a){var c=!isNaN(b),
d=0!=b%1;a=void 0!==a?a:this.tagType;switch(a){case v.BOOLEAN:return c?1==b?1:0:0;case v.BYTE:case v.SHORT:return c?d?Math.round(this.castWithSign(b)):this.castWithSign(b):0;case v.INT:return c?Math.round(b):0;case v.FLOAT:case v.DOUBLE:return c?b:0;case v.UNSIGNEDBYTE:return c?d?(Math.round(b)&255)>>>0:(b&255)>>>0:0;case v.UNSIGNEDSHORT:return c?d?(Math.round(b)&65535)>>>0:(b&65535)>>>0:0;case v.UNSIGNEDINT:return c?d?(Math.round(b)&4294967295)>>>0:(b&4294967295)>>>0:0;default:return b}};a.prototype.doXform=
function(b,a){for(var c=0;c<this.numXforms;c++){var d=this.xforms[c];if(void 0!=d){var f=d.getValue();b=d.execute(this,b,a,f)}}return b};a.prototype.getId=function(){return this.id};a.prototype.getDataSrc=function(){return this.dataSrc};a.prototype.getAttribute=function(){return this.attr};a.prototype.getTag=function(){return this.tag};a.prototype.getTagType=function(){return this.tagType};a.prototype.getTagValue=function(){var b=this.dataSrc.getValue(this.tag);"object"==typeof b&&b.constructor==
Array&&(b=-1==this.tagIndex?b[0]:b[this.tagIndex]);return b};a.prototype.setAttribute=function(b){this.attr=b};a.prototype.setDataSrcWgt=function(b){b&&(this.dataSrc=b,this.dataSrcId=b.wgtId)};a.prototype.setTgtWgt=function(b){this.tgtWgt=b};a.prototype.setValue=function(b,a,c,d,f){if(!c.isQualityGood())return!1;switch(b){case "Index":a!=this.tagIndex&&(this.tagIndex=a,this.update())}return!0};a.prototype.getValue=function(b){return"rw"==b?this.rw:null};a.prototype.getTargetWidget=function(){return this.tgtWgt};
a.parseString=function(b,a){for(var c="",d="_TagMgr",f="",k="",g="",m="-1",n=[],l=!1,p=!1,r=!1,t=void 0===a?!1:a,u=!1,v=!1,w=b.length,x=0;x<w;x++)switch(b[x]){case "\\":if(p||l||v)g+="\\";p=!p;break;case "|":p||l?l&&r?(m=g,g="",r=!1):(g+="|",p&&(p=!1)):(v=!0,0==f.length?f=g:t?(k=g,u=t=!1):u?(d=g,u=!1):n.push(g),g="");break;case "[":if(p||l||v)g+="[";l||p||(l=!0,0==f.length&&(f=g,g="",r=!0));p&&(p=!1);break;case "]":if(p||v)g+="]";l&&!p&&(v||(r?(m=g,""!=g&&(isNaN(Number(g))?(m="0",c=g):m=g),r=!1):
c=g,g=""),l=!1);p&&(p=!1);break;case ":":p||l?(g+=":",p=!1):(u=!0,0==f.length&&(f=g),g="");break;case ">":p||l?(g+=">",p=!1):(t=!0,0==f.length?f=g:u&&(d=g),g="");break;default:p&&(p=!1),g+=b[x]}0<g.length&&(0==f.length?f=g:t?k=g:u?d=g:n.push(g));return{strSrcWgt:d,strTagName:f,strIndex:m,elemList:n,strAttr:k,strIndexTag:c}};a.prototype.generateXFormFeature=function(b){var c=b.indexOf("("),h=b.indexOf(")");if(-1!=c&&-1!=h){var d=g.activeProject,f=g.getFocusPage(),k=b.substring(0,c);b=b.substring(c+
1,h);c=f.wgtId.split("_")[0]+"_tmpXForm"+a.tmpXFormSeed++;d=new (d.getWidgetDefinition("hmi"+k))({wgtId:c},c,{},f,null);d.readFromString(b,this);return d}return null};a.prototype.getTagOptionsFromString=function(b,c,h){var d,f=d||(d={});f[f.R=0]="R";f[f.W=1]="W";f[f.RW=2]="RW";var k=["R","W","R/W"],q,m="",n="r",l,p,f={};if("="===b[0])h=g.getFocusPage(),n=b.substring(1),d=h.wgtId.split("_")[0]+"_tmpXForm"+a.tmpXFormSeed++,h=new dc({wgtId:d},d,null,h,null),h.readFromString(n,this),q=null,f.rw="rw",
f.tag="",f.srcType="Formula",f.dataSource="",f.xforms=[h],f.tagIndex=-1,f.wT=1;else{var r=a.parseString(b,c);b=r.strTagName;c=r.strIndex;var m=r.strSrcWgt,t=r.elemList,u=r.strAttr;q=r.strIndexTag;r=[];""!==q&&(l=g.createDataLink(null,null,{}),l.readFromString(q+":Index",!0),this.addInternalLink({id:"tmp",p:l.getOptions(),s:l.dataSrc.studioId,w:"tmp_l0"}));q=null;switch(m){case "_TagMgr":q=g.activeProject.getTagMgr();break;case "_AlarmsMgr":q=g.activeProject.getAlarmsMgr();break;case "_UserGroupMgr":q=
g.activeProject.getUserGroupMgr();break;case "_IndexedTagSetMgr":q=g.activeProject.getIndexedTagSetMgr()}q=null==q?g.getWidget(m,!0):q;p=g.activeProject.getSrcType(q);m=q.studioId;l="Project"==q.getWidgetType()?0:1;var v=0,w;for(w in t){var x=t[w],y=this.generateXFormFeature(x);if(null!=y)r.push(y),v++;else switch(x){case k[d.R]:n="r";break;case k[d.W]:n="w";break;case k[d.RW]:n="rw"}}if(void 0!=h&&0==v&&"TagMgrWgt"==q.getJMType())for(d=0;d<h.length;d++)w=h[d],(k=q.getTagInfo(b))&&k.t==w.tagType&&
(y=this.generateXFormFeature(w.feature),null!=y&&(r.push(y),v++));f.rw=n;f.tag=b;f.attr=null==u||""==u?this.attr:u;f.srcType=p;f.dataSource=m;f.tagIndex=Number(c);f.xforms=r;f.wT=l}this.setDataSrcWgt(q);return f};a.prototype.readFromString=function(b,a){if(0<b.length){var c=this.getTagOptionsFromString(b,a);this.setOptions(c);this.initOptions(c)}return null};a.prototype.readFromStringAndSetTarget=function(b,a,c,d){if(0==b.length)return this;b=this.getTagOptionsFromString(b,!1,d);b.attr=c;b.dataSource=
a.studioId;this.setOptions(b);this.initOptions(b);return this};a.prototype.writeToString=function(b,a){void 0===b&&(b=!0);void 0===a&&(a=!1);var c=["R","W","RW"],d="",f,k=f||(f={});k[k.R=0]="R";k[k.W=1]="W";k[k.RW=2]="RW";if("Formula"===this.srcType)1==this.xforms.length&&(c=this.xforms[0],c=c.writeToString(b,a),d+=c);else{k=this.tag;k=k.replace(/\\/g,"\\\\");k=k.replace(/\[/g,"\\[");k=k.replace(/\]/g,"\\]");k=k.replace(/\;/g,"\\;");k=k.replace(/\:/g,"\\:");k=k.replace(/\>/g,"\\>");d=k=k.replace(/\|/g,
"\\|");if(0<k.length){var q="Tag"==this.srcType||"Recipe"==this.srcType||"Alias"==this.srcType||this.tagType==v.EMPTY,m=void 0,n=null,l;for(l in this.dataLinks){var m=this.dataLinks[l],p=m.tgtWgt;if(m&&p.getId()==this.getId()&&"Index"==m.attr){n=m;break}}q&&(n||-1!=this.tagIndex)&&(m=this.tagIndex.toString(),a&&null!=n.tag&&(m=n.tag),k=k.replace(/\\/g,"\\\\"),k=k.replace(/\[/g,"\\["),k=k.replace(/\]/g,"\\]"),k=k.replace(/\;/g,"\\;"),k=k.replace(/\:/g,"\\:"),k=k.replace(/\>/g,"\\>"),k=k.replace(/\|/g,
"\\|"),n?(l=n.writeToString(b,a),m="["+m+"|"+l+"]"):m="["+m+"]",d+=m)}l=this.dataSrc.studioId;0<l.length&&"_TagMgr"!=l&&(k=k.replace(/\\/g,"\\\\"),k=k.replace(/\[/g,"\\["),k=k.replace(/\]/g,"\\]"),k=k.replace(/\;/g,"\\;"),k=k.replace(/\:/g,"\\:"),k=k.replace(/\>/g,"\\>"),k.replace(/\|/g,"\\|"),d+=":"+l);b&&(k=(k=g.cache.getTag(this.tag))?k.getStringTagType():"",d+=">"+k+":"+this.attr);this.rw.toUpperCase()!=c[f.R]&&(k=this.rw.toUpperCase(),k==c[f.RW]&&(k="R/W"),d+="|"+k);if(null!=this.xforms)for(f=
this.xforms,k=0;k<f.length;k++)c=this.xforms[k],l=c.writeToString(b,a),d+="|"+c.className+"("+l+")"}return d};a.prototype.destroy=function(){var b=this.xforms;if(b)for(var a in b)b[a].destroy();return!0};a.prototype.hasStructuredTag=function(){return null!=this._tag&&""!=this._tag};a.prototype.subscribeForDatasourceNotification=function(){this.dataSrc instanceof fb&&this.dataSrc.subscribeDynamicTags()};a.tmpXFormSeed=0;return a}(lc);g.addWidgetDefinition("hmiDataLink",$b);g.export("hmiDataLink",$b);
var wa=function(){function c(){this.colProperties=[];this.rowProperties=[];this.colXPos=[];this.rowYPos=[]}c.prototype.init=function(a,b,e){this.gridProperties=b.gr;this.colProperties=[];this.rowProperties=[];for(var h in b.colsProps)this.colProperties.push(JSON.parse(JSON.stringify(b.colsProps[h])));for(var d in b.rowsProps)this.rowProperties.push(JSON.parse(JSON.stringify(b.rowsProps[d])));a.getGridGlobalStrokeCollapsed()==c.enumStrokeCollaption.TRUE&&(e||this.computeRowStrokeCollapsed(a),this.computeColStrokeCollapsed(a))};
c.prototype.getGridColSuperiorLimit=function(){for(var a=0,b=0;b<this.gridProperties.grCols;b++)a+=this.colProperties[b].maxWidth;return a};c.prototype.getGridRowSuperiorLimit=function(){for(var a=0,b=0;b<this.gridProperties.grRows;b++)a+=this.rowProperties[b].minHeight;return a};c.prototype.getRowProperties=function(){return this.rowProperties?this.rowProperties:null};c.prototype.getColProperties=function(){return this.colProperties?this.colProperties:null};c.prototype.computeRowStrokeCollapsed=
function(a){var b=this.gridProperties.grGStkMode,e=this.gridProperties.grGStkWidth,h=this.gridProperties.grGStkColor;a=a.getGridRowsNumber();for(var d=0;d<a;d++){var f=this.rowProperties[d].tStroke,k=this.rowProperties[d].bStroke;0==d&&(b==c.enumStrokeMode.AUTO&&(this.rowProperties[d].tStroke=Math.max(f,e)/2),e>=f&&(this.rowProperties[d].tStkColor=h));if(0<d){var g=this.rowProperties[d-1].bStroke,m=Math.max(f,g)/2;this.rowProperties[d].tStroke=Math.ceil(m);this.rowProperties[d-1].bStroke=Math.floor(m);
g>f?this.rowProperties[d].tStkColor=this.rowProperties[d-1].bStkColor:this.rowProperties[d-1].bStkColor=this.rowProperties[d].tStkColor;d==a-1&&(b==c.enumStrokeMode.AUTO&&(this.rowProperties[d].bStroke=Math.max(k,e)/2),e>=k&&(this.rowProperties[d].bStkColor=h))}}};c.prototype.computeColStrokeCollapsed=function(a){var b=this.gridProperties.grGStkMode,e=this.gridProperties.grGStkWidth,h=this.gridProperties.grGStkColor;a=a.getGridColsNumber();for(var d=0;d<a;d++){var f=this.colProperties[d].lStroke,
k=this.colProperties[d].rStroke;0==d&&(b==c.enumStrokeMode.AUTO&&(this.colProperties[d].lStroke=Math.max(f,e)/2),e>=f&&(this.colProperties[d].lStkColor=h));if(0<d){var g=this.colProperties[d-1].rStroke,m=Math.max(f,g)/2;this.colProperties[d].lStroke=Math.ceil(m);this.colProperties[d-1].rStroke=Math.floor(m);g>f?this.colProperties[d].lStkColor=this.colProperties[d-1].rStkColor:this.colProperties[d-1].rStkColor=this.colProperties[d].lStkColor;d==a-1&&(b==c.enumStrokeMode.AUTO&&(this.colProperties[d].rStroke=
Math.max(k,e)/2),e>=k&&(this.colProperties[d].rStkColor=h))}}};c.prototype.getWAspectRatio=function(a){return parseFloat(a.split(":")[0])};c.prototype.getHAspectRatio=function(a){return parseFloat(a.split(":")[1])};c.prototype.getTotalColMinWidth=function(){var a=0;if(0<this.colProperties.length)for(var b=0;b<this.gridProperties.grCols;b++)a+=this.colProperties[b].minWidth;return a};c.prototype.getTotalRowMinHeight=function(){var a=0;if(0<this.rowProperties.length)for(var b=0;b<this.gridProperties.grRows;b++)a+=
this.rowProperties[b].minHeight;return a};c.prototype.preserveAspectRatio=function(a){a.getParentBounds(a.parentWidget);var b=a.getChildren(),e;for(e in b)if(b[e].hasLayout()){var h=b[e].getLayout(),d=b[e].getParentBounds(b[e].parentWidget);if(1==h.preserveAR){var f=d.width*(this.getHAspectRatio(h.aR)/this.getWAspectRatio(h.aR));if(f<=d.height){var k=d.height-f,g=d.y,m=a.getGridUnderflow().v;switch(h.vItemUF){case c._wgtVerUnderflowMode.INHERITED:switch(m){case c._groupVerUnderflowMode.MIDDLE:g+=
k/2;break;case c._groupVerUnderflowMode.BOTTOM:g+=k}break;case c._wgtVerUnderflowMode.MIDDLE:g+=k/2;break;case c._wgtVerUnderflowMode.BOTTOM:g+=k}b[e].setParentBounds(d.x,g,d.width,f,b[e].parentWidget)}else{f=d.height*this.getWAspectRatio(h.aR)/this.getHAspectRatio(h.aR);k=d.width-f;g=d.x;m=a.getGridUnderflow().h;switch(h.hItemUF){case c._wgtHorUnderflowMode.INHERITED:switch(m){case c._groupHorUnderflowMode.CENTER:g+=k/2;break;case c._groupHorUnderflowMode.RIGHT:g+=k}break;case c._wgtHorUnderflowMode.CENTER:g+=
k/2;break;case c._wgtHorUnderflowMode.RIGHT:g+=k}b[e].setParentBounds(g,d.y,f,d.height,b[e].parentWidget)}}}};c.prototype.applyAlgorithm=function(a,b){this.widthCalc(a);this.heightCalc(a);this.preserveAspectRatio(a);b&&b()};c.prototype.widthCalc=function(a,b){var e=a.getGridOverflow().h,h=a.getGridUnderflow().h,d=a.getParentBounds(a.parentWidget),f=a.getChildren(),k=d.width,g=0,m=a.getScrollbarAutohide(),n=a.getScrollbarSize();m==c._scrollbarAutohide.ALWAYSVISIBLE&&this.getTotalColMinWidth()>d.width&&
(g+=Math.max(0,n+this.gridProperties.grSclOffset));k-=g;0>=k&&(k=.1);d=this.baseWidthCalc(a,k);if(d==c._grState.OK)this.wgtRepositioningX(a,f,0);else if(d==c._grState.OVERFLOW)switch(e){case c._groupHorOverflow.HIDDEN:this.wgtRepositioningX(a,f,0);break;case c._groupHorOverflow.SCROLL:b||this.heightCalc(a,!0),this.wgtRepositioningX(a,f,0)}else if(d==c._grState.UNDERFLOW)switch(h){case c._groupHorUnderflowMode.LEFT:this.wgtRepositioningX(a,f,0);break;case c._groupHorUnderflowMode.CENTER:case c._groupHorUnderflowMode.RIGHT:e=
k-this.getGridColSuperiorLimit();h==c._groupHorUnderflowMode.CENTER&&(e=Math.floor(e/2));for(h=0;h<=a.getGridColsNumber();h++)this.colProperties[h].colPos+=e;this.wgtRepositioningX(a,f,0);break;default:this.wgtRepositioningX(a,f,0)}};c.prototype.heightCalc=function(a,b){var e=a.getGridOverflow().v,h=a.getGridUnderflow().v,d=a.getParentBounds(a.parentWidget),f=a.getChildren(),k=d.height,g=0,m=a.getScrollbarAutohide(),n=a.getScrollbarSize();m==c._scrollbarAutohide.ALWAYSVISIBLE&&this.getTotalRowMinHeight()>
d.height&&(g+=Math.max(0,n+this.gridProperties.grSclOffset));k-=g;0>=k&&(k=.1);d=this.baseHeightCalc(a,k);if(d==c._grState.OK)this.wgtRepositioningY(a,f,0);else if(d==c._grState.OVERFLOW)switch(e){case c._groupHorOverflow.HIDDEN:this.wgtRepositioningY(a,f,0);break;case c._groupHorOverflow.SCROLL:b||this.widthCalc(a,!0),this.wgtRepositioningY(a,f,0)}else if(d==c._grState.UNDERFLOW)switch(h){case c._groupVerUnderflowMode.TOP:this.wgtRepositioningY(a,f,0);break;case c._groupVerUnderflowMode.MIDDLE:case c._groupVerUnderflowMode.BOTTOM:e=
k-this.getGridRowSuperiorLimit();h==c._groupVerUnderflowMode.MIDDLE&&(e=Math.floor(e/2));for(h=0;h<=a.getGridRowsNumber();h++)this.rowProperties[h].rowPos+=e;this.wgtRepositioningY(a,f,0);break;default:this.wgtRepositioningY(a,f,0)}};c.prototype.fuzzyCompare=function(a,b){return 1E-5>=Math.abs(a-b)?!0:!1};c.prototype.wgtRepositioningX=function(a,b,e){e=[];for(var h=a.getGridColsNumber(),d=0;d<h;d++)e[d]=this.colProperties[d+1].colPos-this.colProperties[d].colPos;for(var f in b)if(b[f].hasLayout()){for(var h=
b[f].getParentBounds(b[f].parentWidget),d=b[f].getLayout(),k=d.cOcc,g=d.cSpan,m=k-1,n=m+g-1,l=0,p=m;p<=n;p++)l+=e[p];l-=d.maxWidth;n=p=0;0>=l&&(l=0);var r=a.getGridUnderflow().h;if(0!=l)switch(d.hItemUF){case c._wgtHorUnderflowMode.INHERITED:switch(r){case c._groupHorUnderflowMode.LEFT:n=l;break;case c._groupHorUnderflowMode.CENTER:p=l/2;n=l/2;break;case c._groupHorUnderflowMode.RIGHT:p=l}break;case c._wgtHorUnderflowMode.LEFT:n=l;break;case c._wgtHorUnderflowMode.CENTER:p=l/2;n=l/2;break;case c._wgtHorUnderflowMode.RIGHT:p=
l}l=m;p=Math.round(this.colProperties[l].colPos+this.colProperties[l].lMargin+this.colProperties[l].lStroke+p);l=m+g;g=Math.round(this.colProperties[l].colPos-p-this.colProperties[k+g-2].rMargin-this.colProperties[l-1].rStroke-n);0>=g&&(g=.1);p+=d.lMargin;g=g-d.lMargin-d.rMargin;0>=g&&(g=.1);0<k?b[f].setAsVisible(!0):b[f].setAsVisible(!1);b[f].setParentBounds(p,h.y,g,h.height,b[f].parentWidget)}};c.prototype.wgtRepositioningY=function(a,b,e){e=[];for(var h=a.getGridRowsNumber(),d=0;d<h;d++)e[d]=this.rowProperties[d+
1].rowPos-this.rowProperties[d].rowPos;for(var f in b)if(b[f].hasLayout()){for(var h=b[f].getParentBounds(b[f].parentWidget),d=b[f].getLayout(),k=d.rOcc,g=d.rSpan,m=k-1,n=m+g-1,l=0,p=m;p<=n;p++)l+=e[p];l-=d.maxHeight;n=p=0;0>=l&&(l=0);var r=a.getGridUnderflow().v;if(0!=l)switch(d.vItemUF){case c._wgtVerUnderflowMode.INHERITED:switch(r){case c._groupVerUnderflowMode.TOP:n=l;break;case c._groupVerUnderflowMode.MIDDLE:p=l/2;n=l/2;break;case c._groupVerUnderflowMode.BOTTOM:p=l}break;case c._wgtVerUnderflowMode.TOP:n=
l;break;case c._wgtVerUnderflowMode.MIDDLE:p=l/2;n=l/2;break;case c._wgtVerUnderflowMode.BOTTOM:p=l}l=m;p=Math.round(this.rowProperties[l].rowPos+this.rowProperties[l].tMargin+this.rowProperties[l].tStroke+p);l=m+g;g=Math.round(this.rowProperties[l].rowPos-p-this.rowProperties[k+g-2].bMargin-this.rowProperties[l-1].bStroke-n);0>=g&&(g=.1);p+=d.tMargin;g=g-d.tMargin-d.bMargin;0>=g&&(g=.1);0<k?b[f].setAsVisible(!0):b[f].setAsVisible(!1);b[f].setParentBounds(h.x,p,h.width,g,b[f].parentWidget)}};c.prototype.baseWidthCalc=
function(a,b){var e,h=0,d=[],f=[],k=[],g=a.getGridColsNumber();this.colProperties.length<=g&&(this.colProperties.push({}),this.colProperties[g].colPos=0,this.colProperties[g].maxWidth=0);b=Math.round(b);if(0>=b)return c._grState.ERROR;for(var m=0;m<g;m++)k.push(!0);for(var n=c._grState.ERROR,l=0;l<=g;l++){for(m=e=0;m<g;m++)d[m]=0,k[m]&&(e+=this.colProperties[m].stretch);for(var p=0,m=0;m<g;m++){if(k[m]){d[m]=this.colProperties[m].stretch/e;null==f[m]&&(f[m]=0);f[m]+=d[m]*(b-h);var r=this.colProperties[m].minWidth,
t=this.colProperties[m].maxWidth;f[m]>t-1E-5&&(f[m]=t);f[m]<r+1E-5&&(f[m]=r)}p+=f[m]}h=p;if(this.fuzzyCompare(b,h)){n=c._grState.OK;break}e=!0;if(h>b){for(m=0;m<g;m++)k[m]&&(r=this.colProperties[m].minWidth,f[m]<r+1E-5?k[m]=!1:e=!1);if(e){n=c._grState.OVERFLOW;break}}else{for(m=0;m<g;m++)k[m]&&(t=this.colProperties[m].maxWidth,f[m]>t-1E-5?k[m]=!1:e=!1);if(e){n=c._grState.UNDERFLOW;break}}}this.colProperties[0].colPos=0;for(m=1;m<=g;m++)this.colProperties[m].colPos=this.colProperties[m-1].colPos+f[m-
1];return n};c.prototype.baseHeightCalc=function(a,b){var e,h=0,d=[],f=[],k=[],g=a.getGridRowsNumber();this.rowProperties.length<=g&&(this.rowProperties.push({}),this.rowProperties[g].rowPos=0,this.rowProperties[g].maxHeight=0);b=Math.round(b);if(0>=b)return c._grState.ERROR;for(var m=0;m<g;m++)k.push(!0);for(var n=c._grState.ERROR,l=0;l<=g;l++){for(m=e=0;m<g;m++)d[m]=0,k[m]&&(e+=this.rowProperties[m].stretch);for(var p=0,m=0;m<g;m++){if(k[m]){d[m]=this.rowProperties[m].stretch/e;null==f[m]&&(f[m]=
0);f[m]+=d[m]*(b-h);var r=this.rowProperties[m].minHeight,t=this.rowProperties[m].maxHeight;f[m]>t-1E-5&&(f[m]=t);f[m]<r+1E-5&&(f[m]=r)}p+=f[m]}h=p;if(this.fuzzyCompare(b,h)){n=c._grState.OK;break}e=!0;if(h>b){for(m=0;m<g;m++)k[m]&&(r=this.rowProperties[m].minHeight,f[m]<r+1E-5?k[m]=!1:e=!1);if(e){n=c._grState.OVERFLOW;break}}else{for(m=0;m<g;m++)k[m]&&(t=this.rowProperties[m].maxHeight,f[m]>t-1E-5?k[m]=!1:e=!1);if(e){n=c._grState.UNDERFLOW;break}}}this.rowProperties[0].rowPos=0;for(m=1;m<=g;m++)this.rowProperties[m].rowPos=
this.rowProperties[m-1].rowPos+f[m-1];return n};c._grState={OK:0,OVERFLOW:1,UNDERFLOW:2,ERROR:3};c._wgtHorUnderflowMode={INHERITED:0,LEFT:1,CENTER:2,RIGHT:3};c._groupHorUnderflowMode={BLOCKED:0,LEFT:1,CENTER:2,RIGHT:3};c._wgtVerUnderflowMode={INHERITED:0,TOP:1,MIDDLE:2,BOTTOM:3};c._groupVerUnderflowMode={BLOCKED:0,TOP:1,MIDDLE:2,BOTTOM:3};c._groupHorOverflow={HIDDEN:0,SCROLL:2};c._groupVerOverflow={HIDDEN:0,SCROLL_TMP:1,SCROLL:2};c._scrollbarAutohide={AUTO:0,ALWAYSVISIBLE:1};c.enumStrokeMode={AUTO:0,
FIXED:1};c.enumStrokeCollaption={FALSE:0,TRUE:1};return c}(),$f=function(){function c(a){this._group=a}c.prototype.drawGrid=function(){for(var a=this._group.getGridProperties(),b=a.grRows,a=a.grCols,c=this.createTableElement(),h,d,f=0;f<b;f++){h=this.createRowElement();for(var k=0;k<a;k++)d=this.createCellElement(),this.applyStyles(h,d,f,k),h.appendChild(d);c.appendChild(h)}this.removeBackgroundStrokes(c);this.appendTableElement(c)};c.prototype.appendTableElement=function(a){(this._group.getScrollbarContentElem()||
this._group.elem).prepend(a)};c.prototype.createTableElement=function(){var a=document.createElement("div"),b=this._group.getParentBounds(this._group.parentWidget);a.id=this._group.wgtId+".table-grid";a.style.position="absolute";a.style.width=b.width+"px";a.style.height=b.height+"px";return a};c.prototype.createRowElement=function(){var a=document.createElement("div");a.id=this._group.wgtId+".table-row";a.className+=" jm-gr-row";return a};c.prototype.createCellElement=function(){var a=document.createElement("div");
a.id=this._group.wgtId+".table-cell";a.className+=" jm-gr-cell";return a};c.prototype.canApplyStyles=function(a,b,c,h){return 0>a||0>b||0>c||0>h?!1:!0};c.prototype.removeBackgroundStrokes=function(a){var b=this._group.getGLRowProps(),c=this._group.getChildren(),h;for(h in c)if(c[h].hasLayout()){var d=c[h].getLayout(),f=d.rOcc-1,k=f+d.rSpan,g=d.cOcc-1,m=g+d.cSpan;if(this.canApplyStyles(f,k,g,m)){var l=d.lBgColor?d.lBgColor:b[f].bgColor;if(1==d.rSpan&&1==d.cSpan)a.childNodes[f].childNodes[g].style.backgroundColor=
l;else for(d=f;d<k;d++)for(var p=a.childNodes[d],r=g;r<m;r++){var t=p.childNodes[r];d+1<k&&(t.style.borderBottom="none");d-1>=f&&(t.style.borderTop="none");r+1<m&&(t.style.borderRight="none");r-1>=g&&(t.style.borderLeft="none");t.style.backgroundColor=l}}}};c.prototype.applyStyles=function(a,b,c,h){var d=this._group.getGLRowProps(),f=this._group.getGLColProps();a.style.top=d[c].rowPos+"px";b.style.left=f[h].colPos+"px";b.style.height=d[c+1].rowPos-d[c].rowPos+"px";b.style.width=f[h+1].colPos-f[h].colPos+
"px";b.style.borderLeft=f[h].lStroke+"px solid "+f[h].lStkColor;b.style.borderRight=f[h].rStroke+"px solid "+f[h].rStkColor;b.style.borderTop=d[c].tStroke+"px solid "+d[c].tStkColor;b.style.borderBottom=d[c].bStroke+"px solid "+d[c].bStkColor;b.style.backgroundColor=d[c].bgColor};c.prototype.delete=function(){var a=this._group.getScrollbarContentElem(),b;a?b=a.firstElementChild:(b=this._group.elem.firstElementChild,a=this._group.elem);var c=this._group.wgtId+".table-grid";b&&b.id===c&&a.removeChild(b)};
return c}(),ad=function(){function c(a,b){this._scrollbar=window.Scrollbar.use(Za);this._scrollbar=window.Scrollbar.init(a,b.lib);b.ext.disableX&&this.disableXScroll();b.ext.disableY&&this.disableYScroll();b.ext.bgColor&&this.setBgColor(b.ext.bgColor);b.ext.color&&this.setColor(b.ext.color);b.ext.contentSize&&this.setContentSize(b.ext.contentSize)}c.prototype.addListener=function(a){this._callback=a;this._scrollbar.addListener(a)};c.prototype.removeListener=function(){this._scrollbar.removeListener(this._callback)};
c.prototype.enableXScroll=function(){this._scrollbar.containerEl.appendChild(this._scrollbar.track.xAxis.element);this._scrollbar.options.plugins.disableScroll.direction=null};c.prototype.enableYScroll=function(){this._scrollbar.containerEl.appendChild(this._scrollbar.track.yAxis.element);this._scrollbar.options.plugins.disableScroll.direction=null};c.prototype.disableXScroll=function(){this._scrollbar.track.xAxis.element.remove();this._scrollbar.options.plugins.disableScroll.direction="x"};c.prototype.disableYScroll=
function(){this._scrollbar.track.yAxis.element.remove();this._scrollbar.options.plugins.disableScroll.direction="y"};c.prototype.setPosition=function(a,b){this._scrollbar.setPosition(a,b)};c.prototype.setContentSize=function(a){this._scrollbar.setContentSize(a)};c.prototype.setBgColor=function(a){this._scrollbar.setXAxisColor(a);this._scrollbar.setYAxisColor(a)};c.prototype.setColor=function(a){this._scrollbar.setXThumbColor(a);this._scrollbar.setYThumbColor(a)};c.prototype.setSize=function(a){this._axisSize=
a;this._scrollbar.setXAxisSize(a);this._scrollbar.setYAxisSize(a)};c.prototype.setAlwaysShowTracks=function(a){this._scrollbar.options.alwaysShowTracks=a};c.prototype.getContainerSize=function(){return this._scrollbar.getSize().container};c.prototype.getContentSize=function(){return this._scrollbar.getSize().content};c.prototype.getLimit=function(){return this._scrollbar.limit};c.prototype.scrollTo=function(a,b){this._scrollbar.scrollTo(a,b)};c.prototype.update=function(){this._scrollbar.update()};
c.prototype.getAxisSize=function(){return this._axisSize};c.prototype.getOffset=function(){return this._scrollbar.offset};c.prototype.getContentEl=function(){return this._scrollbar.contentEl};c.prototype.getContainerEl=function(){return this._scrollbar.containerEl};c.prototype.getScrollTop=function(){return this._scrollbar.scrollTop};c.prototype.getScrollLeft=function(){return this._scrollbar.scrollLeft};c.prototype.destroy=function(){this._scrollbar.destroy()};return c}(),kb;(function(c){c[c.VALUE=
0]="VALUE";c[c.MLPATCH=1]="MLPATCH"})(kb||(kb={}));var lb;(function(c){c[c.X=0]="X";c[c.Y=1]="Y"})(lb||(lb={}));var Va=function(c){function a(b,a,h,d,f){b=c.call(this,b.wgtId,a,h,d,f)||this;b.xScroll=0;b.yScroll=0;b.relHorScrollPos=0;b.relVerScrollPos=0;b.clickWgtId=null;b.activeElements=[];b.invokablePropsList=b.initializeIvokablePropList();b.hasModule=!1;b.cwMLMgr=null;a=g.activeProject.getCWidgetMgr();if(null!=a){a.instantiateCW(b,b.ctype);a=t.getModule("Tag");for(var k in b.links)(h=b.links[k],
h.t==kb.VALUE&&null!=h.v)?b.setValue(k,h.v,a.QUALITY_GOOD):h.t==kb.MLPATCH&&(d=g.activeProject.getWidget("_MultiLangMgr",!0))&&(h=h.v[d.getCurrentLangIndex()],b.setValue(k,h,a.QUALITY_GOOD))}b.hasGridLayout()&&(b.initGridLayout(),b.initScrollbar());b.parentWidget instanceof Bc&&b.parentWidget.setGroup(b);return b}p(a,c);a.prototype.setGridLayout=function(b){this.grid=b;this.initGridLayout()};a.prototype.initScrollbar=function(){if("GroupWgt"==this.getJMType()||"TableGroupWgt"==this.getJMType()){var b=
this.getOverflow();if(b.h==wa._groupHorOverflow.SCROLL||b.v==wa._groupVerOverflow.SCROLL||b.v==wa._groupVerOverflow.SCROLL_TMP)this._renderMask|=a._renderFlags.DRWSCROLLBAR,this.render()}};a.prototype.initializeIvokablePropList=function(){var b=[];if(g.activeProject.props&&g.activeProject.props[this.ctype]){var a=g.activeProject.props[this.ctype],c;for(c in a)b.push(c)}return b=b.concat("gridNRows gridNCols gridHorOverFlow gridVerOverFlow gridHorUnderFlow gridVerUnderFlow gridScrollColor gridScrollBgColor gridScrollSize gridScrollAutohide gridGlobalStrokeCollapsed".split(" "))};
a.prototype.findWgt=function(b,a){var c=a.replace("*",b.studioId),d=b.mapId[c.toLowerCase()];if(d)return b.wgts[d];c=c.substring(b.studioId.length+1).split(".");if(0<c.length)for(var f=0;f<c.length;f++)(d=b.mapId[(b.studioId+"."+c[f]).toLowerCase()])&&(b=b.wgts[d]);return b};a.prototype.getWidget=function(b,a,h){if(!0===a&&"*"===b.charAt(0)&&"."===b.charAt(1)){var d=this.findWgt(this,b);if(void 0!==d)return h?d.isTemplateWgt?d:null:d;var d=this.wgts,f;for(f in d){var k=d[f].getWidget(b,a,h);if(null!==
k)if(h){if(k.isTemplateWgt)return k}else return k}return null}return c.prototype.getWidget.call(this,b,a,h)};a.prototype.getWidgetsByJMClass=function(b,c,h){for(var d in this.wgts){var f=this.wgts[d];if(f.getJMType()==b){if(h.push(f),h.length>=c)return!0}else if(f instanceof a&&f.getWidgetsByJMClass(b,c,h))return!0}return!1};a.prototype.addDataLink=function(b){c.prototype.addDataLink.call(this,b);var a=b.attr;if("*"===a[0]&&"."===a[1]){var h=a.lastIndexOf("."),h=this.getWidget(a.substring(0,h),!0,
this.isTemplateWgt);null!==h&&(a=a.split("."),h.initDataLinkSideEffects(b,a[a.length-1]))}};a.prototype.addParameterDataLink=function(b,a){var c=b.toLowerCase();void 0===this.params[c].links&&(this.params[c].links=[]);this.params[c].links.push(a)};a.prototype.hasParameter=function(b){b=b.toLowerCase();return this.params&&this.params[b]?!0:!1};a.prototype.setParamsValue=function(b,a){var c=b.toLowerCase();this.params&&this.params[c]&&(this.params[c].v=a)};a.prototype.getParamsValue=function(b){b=b.toLowerCase();
return this.params&&this.params[b]?this.params[b].v:""};a.prototype.getParentModuleWithParameter=function(b){for(var a=this.module;a;){if(a.hasParameter(b))return a;a=this.parentWidget.module}return null};a.prototype.updateDataLinkParm=function(b){b=b.toLowerCase();if(b=this.params[b].links)for(var a=0,c=b.length;a<c;a++)b[a].updateDSParameter()};a.prototype.getDatalink=function(b){for(var a in this.dataLinks){var c=this.dataLinks[a];if(c.attr==b)return c}return null};a.prototype.setModule=function(){this.hasModule=
!0};a.prototype.areAliases=function(b,a){var c=this.project.getCWidgetMgr().getAttributeLink(this.ctype,b);if(0===c.length){var d=this.invokablePropsList;d&&-1!==d.indexOf(b)&&void 0!==g.activeProject.props[this.ctype]&&(c=g.activeProject.props[this.ctype][b])}return-1!==c.indexOf(a)};a.prototype.addWidget=function(b,a){c.prototype.addWidget.call(this,b,a);this.disabled&&a.setValue("disabled",1,null,null)};a.prototype.resolveAliasAttribute=function(b,a){if("*"===b[0]&&"."===b[1]){var h=b.lastIndexOf("."),
h=this.getWidget(b.substring(0,h),!0,this.isTemplateWgt);if(null!==h){var d=b.split(".");a.wgt=h;a.prop=d[d.length-1]}else a.wgt=null,a.prop=null}else c.prototype.resolveAliasAttribute.call(this,b,a)};a.prototype.setWidgetValueFromAttributeLink=function(b,a,c,d){var f=!1;if(b&&0<b.length)for(var k=0,g=b.length;k<g;k++){var m={wgt:null,prop:null};this.resolveAliasAttribute(b[k],m);null!==m&&null!==m.wgt&&(m.wgt.setValue(m.prop,a,c,d),f=!0)}return f};a.prototype.getWidgetValueFromAttributeLink=function(b,
a){if(b&&0<b.length)for(var c=0,d=b.length;c<d;c++){var f={wgt:null,prop:null};this.resolveAliasAttribute(b[c],f);if(null!==f&&null!==f.wgt)return f.wgt.getValue(f.prop,a)}return""};a.prototype.setWidgetValueFromCWAttributeLinks=function(b,a,c,d){var f=g.activeProject.getCWidgetMgr();return f?this.setWidgetValueFromAttributeLink(f.getAttributeLink(this.ctype,b),a,c,d):!1};a.prototype.setWidgetValueFromProjectAttributeLinks=function(b,a,c,d){return this.setWidgetValueFromAttributeLink(g.activeProject.props[this.ctype][b],
a,c,d)};a.prototype.getWidgetValueFromCWAttributeLinks=function(b,a){var c=g.activeProject.getCWidgetMgr();return c?this.getWidgetValueFromAttributeLink(c.getAttributeLink(this.ctype,b),a):""};a.prototype.getWidgetValueFromProjectAttributeLinks=function(b,a){return this.getWidgetValueFromAttributeLink(g.activeProject.props[this.ctype][b],a)};a.prototype.guessPrimaryWidgetStr=function(){for(var b in this.wgts){var a=this.wgts[b].getJMType();if("ButtonWgt"==a||"IndicatorWgt"==a||"NeedleWgt"==a)return a}return null};
a.prototype.setValue=function(b,e,h,d){if(!this.isBadValue(e,!1,h))if("disabled"==b){if(this.disabled!=e){this.disabled=e="boolean"==typeof e?1==e?1:0:parseFloat(e);this.sendUpdate(b,this.disabled,h);for(var f in this.wgts)this.wgts[f].setValue(b,this.disabled,h,d)}}else if("relHorScrollPos"==b)this.scrollbarInstance&&this.relHorScrollPos!=e&&(this.relHorScrollPos=e,this._renderMask|=a._renderFlags.UPDATESCROLLBARX,this.sendUpdate(b,this.relHorScrollPos,null),g.addToRender(this));else if("relVerScrollPos"==
b)this.scrollbarInstance&&this.relVerScrollPos!=e&&(this.relVerScrollPos=e,this._renderMask|=a._renderFlags.UPDATESCROLLBARY,this.sendUpdate(b,this.relVerScrollPos,null),g.addToRender(this));else if("visibility"==b)this.visibility=e,this.sendUpdate(b,this.visibility,null),c.prototype.setValue.call(this,b,e,h,d);else if("gridHorOverFlow"==b)e!==this.gridHorOverFlow&&this.scrollbarInstance&&(this.gridHorOverFlow=e,this.sendUpdate(b,this.gridHorOverFlow,null),this.gridHorOverFlow===wa._groupHorOverflow.HIDDEN?
this.scrollbarInstance.disableXScroll():this.scrollbarInstance.enableXScroll());else if("gridVerOverFlow"==b)e!==this.gridVerOverFlow&&(this.gridVerOverFlow=e,this.sendUpdate(b,this.gridVerOverFlow,null),this.gridVerOverFlow===wa._groupVerOverflow.HIDDEN?this.scrollbarInstance.disableYScroll():this.scrollbarInstance.enableYScroll());else if("gridHorUnderFlow"==b)e!==this.gridHorUnderFlow&&(this.gridHorUnderFlow=e,this.sendUpdate(b,this.gridHorUnderFlow,null),this.gridLayoutInstance.applyAlgorithm(this),
this instanceof Pa&&this.update());else if("gridVerUnderFlow"==b)e!==this.gridVerUnderFlow&&(this.gridVerUnderFlow=e,this.sendUpdate(b,this.gridVerUnderFlow,null),this.gridLayoutInstance.applyAlgorithm(this),this instanceof Pa&&this.update());else if("gridScrollColor"==b)e!==this.gridScrollColor&&this.scrollbarInstance&&(this.gridScrollColor=e,this.scrollbarInstance.setColor(this.gridScrollColor),this.sendUpdate(b,this.gridScrollColor,null),this.scrollbarInstance.update());else if("gridScrollBgColor"==
b)e!==this.gridScrollBgColor&&this.scrollbarInstance&&(this.gridScrollBgColor=e,this.sendUpdate(b,this.gridScrollBgColor,null),this.scrollbarInstance.setBgColor(this.gridScrollBgColor),this.scrollbarInstance.update());else if("gridScrollSize"==b)e!==this.gridScrollSize&&this.scrollbarInstance&&(this.gridScrollSize=e,this.sendUpdate(b,this.gridScrollSize,null),this.scrollbarInstance.setSize(this.gridScrollSize),this.scrollbarInstance.update());else if("gridScrollAutohide"==b)e!==this.gridScrollAutohide&&
(this.gridScrollAutohide=e,this.sendUpdate(b,this.gridScrollAutohide,null),this.scrollbarInstance.setAlwaysShowTracks(0===this.gridScrollAutohide?!1:!0),this.scrollbarInstance.update());else if("gridGlobalStrokeCollapsed"==b)e!==this.gridGlobalStrokeCollapsed&&(this.gridGlobalStrokeCollapsed=e,this.sendUpdate(b,this.gridGlobalStrokeCollapsed,null),this.gridLayoutInstance.applyAlgorithm(this),this instanceof Pa&&this.update());else{if("width"==b||"height"==b)return c.prototype.setValue.call(this,b,
e,h);f=b.lastIndexOf(".");if(-1!=f){var k=null,q=b.substring(f+1),m=b.substring(0,f);1<=f&&"*"==b[0]&&"."==b[1]&&((k=this.getWidget(m,!0,this.isTemplateWgt))||(k=this.getWidget(m.replace("*",this.studioId),!0,this.isTemplateWgt)));null===k&&(k=this.getWidgetByJMType(m));k?k.setValue(q,e,h,d):c.prototype.setValue.call(this,b,e,h,d);this.sendUpdate(b,e,h)}else if(-1!==g.activeProject.getCWidgetMgr().getParameters(this.ctype).indexOf(b)||this.hasParameter(b)){if(void 0===h||h.isQualityGood())this.setParamsValue(b,
e),this.updateDataLinkParm(b)}else if(f=this.invokablePropsList,this[b]!=e)if(this.setWidgetValueFromCWAttributeLinks(b,e,h,d))this.sendUpdate(b,e,h);else{if(f&&-1!=f.indexOf(b)&&void 0!==g.activeProject.props[this.ctype]&&(this[b]=e,this.setWidgetValueFromProjectAttributeLinks(b,e,h,d))){this.sendUpdate(b,e,h);return}0>c.prototype.setValue.call(this,b,e,h,d)&&(f=this.guessPrimaryWidgetStr(),null!==f&&this.setValue(f+"."+b,e,h,d))}}};a.prototype.getValue=function(b,a){if("gridLayout"==b)return this.hasGridLayout();
if("gridNRows"==b)return this.hasGridLayout()?this.getGridRowsNumber():"";if("gridNCols"==b)return this.hasGridLayout()?this.getGridColsNumber():"";if("gridHorOverFlow"==b)return this.hasGridLayout()?this.getGridOverflow().h:"";if("gridVerOverFlow"==b)return this.hasGridLayout()?this.getGridOverflow().v:"";if("gridHorUnderFlow"==b)return this.hasGridLayout()?this.getGridUnderflow().h:"";if("gridVerUnderFlow"==b)return this.hasGridLayout()?this.getGridUnderflow().v:"";if("gridGlobalStrokeCollapsed"==
b)return this.hasGridLayout()?this.getGridGlobalStrokeCollapsed():"";if("gridGlobalStrokeWidth"==b)return this.hasGridLayout()?this.getGlobalStrokeWidth():"";if("gridGlobalStrokeColor"==b)return this.hasGridLayout()?this.getGlobalStrokeColor():"";if("gridGlobalStrokeMode"==b)return this.hasGridLayout()?this.getGlobalStrokeMode():"";if("gridScrollAutohide"==b)return this.hasGridLayout()?this.getScrollbarAutohide():"";if("gridScrollSize"==b)return this.hasGridLayout()?this.gridScrollSize:"";if("gridScrollColor"==
b)return this.hasGridLayout()?this.gridScrollColor:"";if("gridScrollBgColor"==b)return this.hasGridLayout()?this.gridScrollBgColor:"";if("gridScrollOffset"==b)return this.hasGridLayout()?this.gridScrollOffset:"";var h=b.lastIndexOf(".");if(-1!=h){var d=null,f=b.substring(h+1),k=b.substring(0,h);1<=h&&"*"==b[0]&&"."==b[1]&&(d=this.getWidget(k,!0,this.isTemplateWgt),d===this&&(d=this.getWidget(k.replace("*",this.studioId),!0,this.isTemplateWgt)));null===d&&(d=this.getWidgetByJMType(k));return d?d.getValue(f,
a):c.prototype.getValue.call(this,b,a)}h="";if(this.hasParameter(b))return this.getParamsValue(b);h=this.getWidgetValueFromCWAttributeLinks(b,a);if(""!==h||(h=this.invokablePropsList)&&-1!=h.indexOf(b)&&void 0!==g.activeProject.props[this.ctype]&&(h=this.getWidgetValueFromProjectAttributeLinks(b,a),""!==h))return h;h=c.prototype.getValue.call(this,b,a);if(void 0===h||null===h){if(h=this.guessPrimaryWidgetStr(),null!==h)return this.getValue(h+"."+b,a)}else return h;return""};a.prototype.createScrollbar=
function(b){this.scrollbarInstance=new ad(b,{lib:{damping:.1,thumbMinSize:this.gridScrollSize,renderByPixels:!1,alwaysShowTracks:0===this.gridScrollAutohide?!1:!0,continuousScrolling:!0,wheelEventTarget:this.elem,plugins:{disableScroll:{direction:null}}},ext:{disableX:this.gridHorOverFlow==wa._groupHorOverflow.HIDDEN?!0:!1,disableY:this.gridVerOverFlow==wa._groupVerOverflow.HIDDEN?!0:!1,bgColor:this.gridScrollBgColor,color:this.gridScrollColor,contentSize:{width:this.width,height:this.height}}});
this.scrollbarInstance.addListener(this.scrollCallback.bind(this))};a.prototype.destroyScrollbar=function(){this.scrollbarInstance&&(this.scrollbarInstance.removeListener(),this.scrollbarInstance.destroy())};a.prototype.updateTrackPosition=function(b){var a=this.scrollbarInstance.getOffset();switch(b){case lb.X:this.scrollbarInstance&&this.gridHorOverFlow==wa._groupHorOverflow.SCROLL&&this.scrollbarInstance.setPosition(this.xScroll,a.y);break;case lb.Y:!this.scrollbarInstance||this.gridVerOverFlow!=
wa._groupVerOverflow.SCROLL&&this.gridVerOverFlow!=wa._groupVerOverflow.SCROLL_TMP||this.scrollbarInstance.setPosition(a.x,this.yScroll)}};a.prototype.render=function(){c.prototype.render.call(this);this._renderMask&a._renderFlags.DRWSCROLLBAR&&this.createScrollbar(this.elem);this._renderMask&a._renderFlags.SCROLLCONTENTSIZE&&this.scrollbarInstance.setContentSize({height:this.scrollContentHeight});this._renderMask&a._renderFlags.UPDATESCROLLBARX&&this.updateTrackPosition(lb.X);this._renderMask&a._renderFlags.UPDATESCROLLBARY&&
this.updateTrackPosition(lb.Y);this._renderMask&a._renderFlags.DRAWGRID&&(this.graphicGrid.delete(),this.graphicGrid.drawGrid());this._renderMask=0};a.prototype.setParentBounds=function(b,a,h,d,f){var k=this.width,g=this.height;c.prototype.setParentBounds.call(this,b,a,h,d,f);if(this.hasGridLayout())this.isClone||this.executeGridLayout();else if(!this.xformScaling){a=this.width;b=this.height;var k=0==k?0==a?1:a/1E-6:a/k,g=0==g?0==b?1:b/1E-6:b/g,m;for(m in this.wgts)b=this.wgts[m],a=b.getParentBounds(this),
b.setParentBounds(a.x*k,a.y*g,a.width*k,a.height*g,this)}};a.prototype.getGridSize=function(){return this.groupConfigurations[this.configurationId].gr.s};a.prototype.getGridRowsProps=function(){return this.groupConfigurations[this.configurationId].rowsProps};a.prototype.getGridColsProps=function(){return this.groupConfigurations[this.configurationId].colsProps};a.prototype.getGLColProps=function(){return this.gridLayoutInstance?this.gridLayoutInstance.getColProperties():null};a.prototype.getGLRowProps=
function(){return this.gridLayoutInstance?this.gridLayoutInstance.getRowProperties():null};a.prototype.getRowProps=function(b){return this.getGridRowsProps()[b]};a.prototype.getColProps=function(b){return this.getGridColsProps()[b]};a.prototype.getGridRowsNumber=function(){return this.groupConfigurations[this.configurationId].gr.grRows};a.prototype.getGridColsNumber=function(){return this.groupConfigurations[this.configurationId].gr.grCols};a.prototype.getGridOverflow=function(){return{h:this.gridHorOverFlow,
v:this.gridVerOverFlow}};a.prototype.getGridUnderflow=function(){return{h:this.gridHorUnderFlow,v:this.gridVerUnderFlow}};a.prototype.getGridGlobalStrokeCollapsed=function(){return this.gridGlobalStrokeCollapsed};a.prototype.getGlobalStrokeMode=function(){return this.groupConfigurations[this.configurationId].gr.grGStkMode};a.prototype.isGlobalStrokeCollaptionActive=function(){return 1===this.gridGlobalStrokeCollapsed};a.prototype.isGlobalStrokeModeFixed=function(){return 1==this.getGlobalStrokeMode()};
a.prototype.getGlobalStrokeWidth=function(){return this.groupConfigurations[this.configurationId].gr.grGStkWidth};a.prototype.getGlobalStrokeColor=function(){return this.groupConfigurations[this.configurationId].gr.grGStkColor};a.prototype.getGridGroupConfigurations=function(){return this.groupConfigurations?this.groupConfigurations:null};a.prototype.initGridLayout=function(){this.gridLayoutInstance=new wa;this.groupConfigurations=this.getConfigurationClones();this.graphicGrid=new $f(this);this.configurationId=
-1;this.updateGridLayoutConfiguration()};a.prototype.updateGridLayoutConfiguration=function(){var b=this.checkGridConfiguration(this.groupConfigurations);if(b.id!==this.configurationId){var a=!1;this instanceof Pa&&(a=!0);this.configurationId=b.id;this.gridLayoutInstance.init(this,b.cl,a);this.gridHorOverFlow=this.groupConfigurations[this.configurationId].gr.grHOF;this.gridVerOverFlow=this.groupConfigurations[this.configurationId].gr.grVOF;this.gridHorUnderFlow=this.groupConfigurations[this.configurationId].gr.grHUF;
this.gridVerUnderFlow=this.groupConfigurations[this.configurationId].gr.grVUF;this.gridGlobalStrokeCollapsed=this.groupConfigurations[this.configurationId].gr.grGStkCollapsed;this.gridScrollBgColor=this.groupConfigurations[this.configurationId].gr.grSclBgColor;this.gridScrollColor=this.groupConfigurations[this.configurationId].gr.grSclColor;this.gridScrollSize=this.groupConfigurations[this.configurationId].gr.grSclSize;this.gridScrollAutohide=this.groupConfigurations[this.configurationId].gr.grSclAutohide;
this.gridScrollOffset=this.groupConfigurations[this.configurationId].gr.grSclOffset}};a.prototype.updateChildren=function(){for(var b in this.wgts){var a=this.wgts[b];"TableGroupWgt"===a.getJMType()&&a.update()}};a.prototype.executeGridLayout=function(){this.updateGridLayoutConfiguration();this.gridLayoutInstance.applyAlgorithm(this,this.updateChildren.bind(this));this.graphicGrid.delete();this.graphicGrid.drawGrid()};a.prototype.updateLanguage=function(){for(var b in this.wgts)this.wgts[b].updateLanguage()};
a.prototype.setCWMLTextMgr=function(b){this.cwMLMgr=b};a.prototype.getCWMLTextMgr=function(){return this.cwMLMgr};a.prototype.getAttributeLinks=function(){return this.links};a.prototype.hasMLManager=function(){return null!=this.cwMLMgr};a.prototype.checkGridConfiguration=function(b){for(var a=b.length,c=0;c<a;c++){var d=b[c-1],f=b[c],k=f.gr.s?f.gr.s:this.width;if(this.width>(d?d.gr.s:0)&&this.width<=k||c==a-1)return{cl:f,id:c}}return{cl:b[a-1],id:a-1}};a.prototype.cloneConf=function(b){var a={},c;
for(c in b)a[c]="object"==typeof b[c]?this.cloneConf(b[c]):b[c];return a};a.prototype.getConfigurationClones=function(){for(var b=[],a=0;a<this.grid.length;a++)b.push(this.cloneConf(this.grid[a]));return b};a.prototype.getGridProperties=function(){return this.gridLayoutInstance?this.gridLayoutInstance.gridProperties:null};a.prototype.getOverflow=function(){var b=this.getGridProperties();return void 0!=b.grHOF&&void 0!=b.grVOF?{h:b.grHOF,v:b.grVOF}:null};a.prototype.getScrollbarAutohide=function(){return this.gridScrollAutohide};
a.prototype.getScrollbarSize=function(){return this.gridScrollSize};a.prototype.getScrollbarOffsets=function(){var b={top:0,left:0};if(this.scrollbarInstance){var a=this.scrollbarInstance.getScrollTop(),c=this.scrollbarInstance.getScrollLeft();b.top=g.getActivePage().isFitToSizeEnable()?a*g.getActivePage().sFactor:a;b.left=g.getActivePage().isFitToSizeEnable()?c*g.getActivePage().sFactor:c}return b};a.prototype.getYScrollPosition=function(){return this.scrollbarInstance?this.scrollbarInstance.getOffset().y:
0};a.prototype.getXScrollPosition=function(){return this.scrollbarInstance?this.scrollbarInstance.getOffset().x:0};a.prototype.getScrollbarContentElem=function(){return this.scrollbarInstance?this.scrollbarInstance.getContentEl():null};a.prototype.getScrollbarContainerElem=function(){return this.scrollbarInstance?this.scrollbarInstance.getContainerEl():null};a.prototype.hasScrollbar=function(){return null!=this.scrollbarInstance?!0:!1};a.prototype.getChildren=function(){return this.wgts};a.prototype.getLayoutSize=
function(){return this.hasGridLayout()?this.getGridProperties().s:null};a.prototype.destroy=function(){c.prototype.destroy.call(this);this.scrollbarInstance&&(this.scrollbarInstance.removeListener(),this.scrollbarInstance.destroy());this.xforms=null;return!0};a.prototype.addAction=function(b,a){c.prototype.addAction.call(this,b,a);var h=g.getActiveProject().getCWidgetMgr(),d;h&&(d=h.getAttributeLink(this.ctype,b));if(void 0===d||0==d.length)d=[b];for(var h=0,f=d.length;h<f;h++){var k=d[h];if("*"==
k.charAt(0)&&"."==k.charAt(1)){var q=k.lastIndexOf("."),m=k.substr(q+1),k=this.getWidget(k.substring(0,q),!0,this.isTemplateWgt);null!=k&&k.addAction(m,a)}}};a.prototype.getGraphicModule=function(){return this.isModuleInstance()&&this.project.getCWidgetMgr().hasGfxInheritance(this.ctype)?this:c.prototype.getGraphicModule.call(this)};a.prototype.addXForm=function(b,a){this.xforms||(this.xforms={});this.xforms[b]=a};a.prototype.getXForm=function(b){if(void 0!==this.xforms)return this.xforms[b]};a.prototype.addActiveElement=
function(b){this.activeElements.push(b)};a.prototype.isModuleInstance=function(){return null!=this.ctype&&""!=this.ctype};a.prototype.deactivateWidgetPrototypes=function(){c.prototype.deactivateWidgetPrototypes.call(this)};a.prototype.scrollCallback=function(){if(0<this.activeElements.length)for(var b in this.activeElements)this.activeElements[b].remove();this.scrollbarInstance&&(b=this.scrollbarInstance.getLimit(),this.setXScroll(this.scrollbarInstance.getScrollLeft()),this.setYScroll(this.scrollbarInstance.getScrollTop()),
this.setValue("relHorScrollPos",this.xScroll/b.x,null),this.setValue("relVerScrollPos",this.yScroll/b.y,null))};a.prototype.getScrollbar=function(){return this.scrollbarInstance};a.prototype.setXScroll=function(b){this.xScroll=b};a.prototype.setYScroll=function(b){this.yScroll=b};a.prototype.setMountingPoint=function(b){this.mountingPoint=b};a.prototype.getMountingPoint=function(){return this.mountingPoint};a.jmType="GroupWgt";a._renderFlags={DRAWGRID:2,DRWSCROLLBAR:4,UPDATESCROLLBARX:8,UPDATESCROLLBARY:16,
SCROLLCONTENTSIZE:32};return a}(l);g.fn.hmiGroup=function(c,a,b,e){return new Va(this,c,a,b,e)};g.addWidgetDefinition("hmiGroup",Va);var ec=function(c){function a(b,a,h,d,f){a=c.call(this,b.wgtId,a,h,d,f)||this;a.groupName=b.wgtId;a.srv=g.activeProject.getCommunticationObj();a.tagMgr=void 0!==a.tagMgr?a.tagMgr:null;a.tags=void 0!==a.tags?a.tags:null;a._cbId=void 0!==a._cbId?a._cbId:null;return a}p(a,c);a.prototype.stop=function(){g.getActiveProject().getTagMgr().unsubscribeGroup(this.wgtId)};a.prototype.getCallbackId=
function(){return this._cbId};a.prototype.setCallbackId=function(b){this._cbId=b};a.prototype.destroy=function(){this.tagMgr=this.tags=null;return c.prototype.destroy.call(this)};a.prototype.containsTag=function(b){return 1===this.tags[b]};a.prototype.removeDataLink=function(b){};a.jmType="GroupSubscribeWgt";return a}(l);g.fn.hmiGroupSubscribeWgt=function(c,a,b,e){return new ec(this,c,a,b,e)};g.addWidgetDefinition("hmiGroupSubscribeWgt",ec);var md=function(c){function a(b,a,h,d,f){b=c.call(this,b.wgtId,
a,h,d,f)||this;b.mlWgts={};b.loadedFonts=[];b.generateLangCodeMap();(a=b.loadValue("curLangId"))&&a!=b.curLangId?b.changeLanguage(a):b.changeLanguage(b.curLangId);return b}p(a,c);a.prototype.generateLangCodeMap=function(){this.mapLangCodeToLangId={};for(var b in this.langs)this.mapLangCodeToLangId[this.langs[b].langCode]=this.langs[b].langId};a.prototype.subscribe=function(b,a){this.mlWgts[b]=a};a.prototype.unsubscribe=function(b){delete this.mlWgts[b]};a.prototype.changeLanguage=function(b){if(this.langs[b]){if(this.curLangId!=
b){var a=t.getModule("Tag");this.curLangId=b;this.sendUpdate("curLangId",this.getValue("curLangId"),a.QUALITY_GOOD);this.sendUpdate("curLangName",this.getValue("curLangName"),a.QUALITY_GOOD);this.sendNotification("up-lang")}this.saveValue("curLangId");a=this.langs[b].defaultFont;-1==this.loadedFonts.indexOf(a)&&(g.import("_loadFontFace")([this.langs[b].defaultFont]),this.loadedFonts.push(a));for(var c in this.mlWgts)if(this.mlWgts[c])this.mlWgts[c](b)}};a.prototype.setValue=function(b,a,c,d){switch(b){case "curLangId":return b=
"L"+a,void 0!==this.langs[b]&&b!=this.curLangId&&this.changeLanguage(b),!0}return!1};a.prototype.getValue=function(b){switch(b){case "curLangId":return this.curLangId.substr(1);case "curLangName":return this.langs[this.curLangId].name;case "curLangCode":return this.langs[this.curLangId].langCode;case "langNameList":b=[];for(var a in this.langs)b.push(this.langs[a].name);return b.join(",")}return null};a.prototype.getLanguageFont=function(b){return(b=this.langs[b])?b.defaultFont:""};a.prototype.getCurrentLanguage=
function(){return this.curLangId};a.prototype.getCurrentLangIndex=function(){return parseInt(this.curLangId.substr(1))};a.prototype.getCurrentLangCode=function(){return this.getLangCodeFromLangId(this.getCurrentLanguage())};a.prototype.getLangIdFromLangCode=function(b){return this.mapLangCodeToLangId[b]};a.prototype.getLangCodeFromLangId=function(b){return this.langs[b].langCode};a.jmType="MultiLangMgrWgt";return a}(l);g.fn.hmiMultiLangMgr=function(c,a,b,e){return new md(this,c,a,b,e)};g.addWidgetDefinition("hmiMultiLangMgr",
md);var nd=function(c){function a(b,a,h,d,f){b=c.call(this,b.wgtId,a,h,d,f)||this;b.clickWgtId=null;return b}p(a,c);Object.defineProperty(a.prototype,"encodedUrl",{get:function(){return this._encodedUrl},set:function(b){this._encodedUrl=b},enumerable:!1,configurable:!0});a.prototype.render=function(){c.prototype.render.call(this);this._renderMask&a._renderFlags.FILL&&this.updateBackground();if(this._renderMask&a._renderFlags.UPDATE){var b=this.elem.getElementsByTagName("img");0<b.length&&(b[0].src=
this.base64)}this._renderMask&a._renderFlags.UPDATESVG&&((b=this.elem.getElementsByTagName("svg"))&&0<b.length&&b[0].parentNode.removeChild(b[0]),b=this.elem.appendChild((new DOMParser).parseFromString(this.SVG_code,"utf8").documentElement),b[0].setAttribute("width",this.width.toString()),b[0].setAttribute("height",this.height.toString()));this._renderMask=0};a.prototype.updateBackground=function(){var b=$("."+a.backgroundClass,this.elem);b.length?b.css("fill",this.bgColor):$("svg",this.elem).css("fill",
this.bgColor)};a.prototype.setValue=function(b,e,h,d){d=!1;if(null!=this.elem)switch(b){case "fill":isNaN(e)&&void 0!=e&&(this.isBadValue(e,!0,h)?d=!0:this.bgColor!=e&&(0==e.indexOf("#")&&1<e.length&&8>=e.length&&(this.bgColor=e),d=!0,this._renderMask|=a._renderFlags.FILL,this.sendUpdate(b,this.bgColor,null)));break;case "base64":case "imageBase64":this.base64!=e&&(this.base64=e,d=!0,this._renderMask|=a._renderFlags.UPDATE);break;case "SVG_code":this.SVG_code!=e&&(this.SVG_code=e,this._renderMask|=
a._renderFlags.UPDATESVG);break;default:c.prototype.setValue.call(this,b,e,h)}d&&g.addToRender(this)};a.prototype.setParentBounds=function(b,a,h,d,f){c.prototype.setParentBounds.call(this,b,a,h,d,f);this.updateOnResize()};a.prototype.updateOnResize=function(b){c.prototype.updateOnResize.call(this,b);this.imageOpt||(b=this.elem.getElementsByTagName("svg"))&&0<b.length&&(b[0].setAttribute("width",this.width.toString()),b[0].setAttribute("height",this.height.toString()))};a.backgroundClass="bgColor00";
a._renderFlags={FILL:1,UPDATESVG:2,WIDTH:4,HEIGHT:8,UPDATE:16};a.jmType="ImageWgt";return a}(l);g.fn.hmiImage=function(c,a,b,e){return new nd(this,c,a,b,e)};g.addWidgetDefinition("hmiImage",nd);var od=function(c){function a(b,e,h,d,f){b=c.call(this,b.wgtId,e,h,d,f)||this;b.bkElem=b.elem.querySelector("."+a.backgroundClass);b.backgroundColor=b.bkElem.getAttribute("fill");return b}p(a,c);a.prototype.applyStrokeColor=function(){this.elem.getElementsByTagName("svg")[0].firstElementChild.setAttribute("stroke",
this.strokeColor)};a.prototype.applyStrokeWidth=function(){var b=this.elem.getElementsByTagName("svg")[0].firstElementChild,a=(this.width-this.strokeWidth)/this.width,c=(this.height-this.strokeWidth)/this.height;ha(b,"center");ga(b,"scale( "+a+","+c+" )");b.setAttribute("stroke-width",""+this.strokeWidth)};a.prototype.render=function(){c.prototype.render.call(this);this._renderMask&a._renderFlags.FILL&&this.updateBackground();if(this._renderMask&a._renderFlags.UPDATESVG&&this.elem.getElementsByTagName("svg")[0]){var b=
this.elem.getElementsByTagName("svg")[0],e=this.width/parseFloat(b.getAttribute("width")),h=this.height/parseFloat(b.getAttribute("height"));ha(b,"top left");ga(b,"scale("+e+","+h+")")}this._renderMask&a._renderFlags.STRK&&this.applyStrokeColor();this._renderMask&a._renderFlags.STRKWIDTH&&this.applyStrokeWidth();this._renderMask=0};a.prototype.updateBackground=function(){null!=this.bkElem&&this.bkElem.setAttribute("fill",this.backgroundColor)};a.prototype.setValue=function(b,c,h,d){d=!1;var f="#000";
if(null!=this.elem){switch(b){case "fill":this.isBadValue(c,!0,h)||this.strokeColor==c||(this.validateColor(c)&&(f=c),this.backgroundColor=f,d=!0,this.sendUpdate(b,this.backgroundColor,h));this._renderMask|=a._renderFlags.FILL;break;case "stroke":this.strokeColor!=c&&this.validateColor(c)&&(this.strokeColor=c,this._renderMask|=a._renderFlags.STRK,d=!0,this.sendUpdate(b,this.strokeColor,h));break;case "stroke-width":this.strokeWidth!=c&&(this.strokeWidth=c,this._renderMask|=a._renderFlags.STRKWIDTH,
d=!0);break;default:l.prototype.setValue.call(this,b,c,h)}d&&g.addToRender(this)}};a.prototype.validateColor=function(b){return void 0==b?!1:"number"!=typeof b&&(0==b.indexOf("#")&&1<b.length&&8>=b.length||"r"===b.charAt(0)&&"g"===b.charAt(1)&&"b"===b.charAt(2))?!0:!1};a.prototype.getValue=function(b){return"fill"==b?this.backgroundColor:c.prototype.getValue.call(this,b)};a.prototype.setParentBounds=function(b,a,h,d,f){c.prototype.setParentBounds.call(this,b,a,h,d,f);this.updateOnResize()};a.prototype.updateOnResize=
function(b){c.prototype.updateOnResize.call(this,b);this._renderMask|=a._renderFlags.UPDATESVG;g.addToRender(this)};a.prototype.destroy=function(){this.backgroundColor=this.bkElem=null;return c.prototype.destroy.call(this)};a.backgroundClass="bgColor00";a._renderFlags={FILL:2,UPDATESVG:4,STRK:8,STRKWIDTH:16};a.jmType="ShapeWgt";return a}(l);g.fn.hmiShape=function(c,a,b,e){return new od(this,c,a,b,e)};g.addWidgetDefinition("hmiShape",od);(function(c){c[c.INT=0]="INT";c[c.FLOAT=1]="FLOAT";c[c.HEXL=
2]="HEXL";c[c.HEXU=3]="HEXU";c[c.EXP=4]="EXP";c[c.EXPD=5]="EXPD";c[c.THOUSAND=6]="THOUSAND"})(Q||(Q={}));(function(c){c[c.TEXT=0]="TEXT";c[c.NUMBER=1]="NUMBER";c[c.DATETIME=2]="DATETIME"})(V||(V={}));(function(c){c[c.TIME_ONLY=0]="TIME_ONLY";c[c.DATE_ONLY=1]="DATE_ONLY";c[c.DATE_SEP_TIME=2]="DATE_SEP_TIME";c[c.TIME_SEP_DATE=3]="TIME_SEP_DATE"})(Xb||(Xb={}));var cb=function(){function c(a,b,c){this.date=void 0!==a?a:new Date;this.format=b;this.configuration=c;void 0!==this.format&&(this.options=t.import("TextFormatUtil").parseDateTimeFormat(b,
c))}c.prototype.setDate=function(a){this.date=new Date(a)};c.prototype.setFormat=function(a,b){this.format=a;this.options=t.import("TextFormatUtil").parseDateTimeFormat(a,void 0!==b?b:this.configuration);this.configuration=b};c.prototype.setConfiguration=function(a){var b=!1;this.configuration.longDateFormat!=a.longDateFormat&&(this.configuration.longDateFormat=a.longDateFormat,b=!0);this.configuration.shortDateFormat!=a.shortDateFormat&&(this.configuration.shortDateFormat=a.shortDateFormat,b=!0);
this.configuration.serverOffset!=a.serverOffset&&(this.configuration.longDateFormat=a.longDateFormat,b=!0);b&&(this.options=t.import("TextFormatUtil").parseDateTimeFormat(this.format,this.configuration));return b};c.prototype.showMilliSeconds=function(){this.options.milliseconds=!0};c.prototype.getSeparator=function(){return this.options.sep};c.prototype.getOrder=function(){return this.options.order};c.prototype.splitFormat=function(a){for(var b=-1,c=-1,h=-1,d=-1,f=-1,k=-1,g=0,m=a.length;g<m;g++){var l=
a.charAt(g),p="M"==l||"d"==l||"D"==l||"y"==l||"Y"==l,l="s"==l||"h"==l||"H"==l||"m"==l||"A"==l||"P"==l;-1==b&&p&&(-1!=d&&(f=g-1),b=g);-1==d&&l&&(-1!=b&&(c=g-1),d=g);p&&(h=g);l&&(k=g)}-1!=b&&-1==c&&(c=a.length);-1!=d&&-1==f&&(f=a.length);return[-1!=b&&-1!=c?a.substring(b,h+1):"",-1!=d&&-1!=f?a.substring(d,k+1):""]};c.prototype.formatDateTimeAndSplit=function(a,b){if(void 0===this.format)return[];var c=this.splitFormat(this.options.format),h=this.options.format;this.options.format=c[0];var d=t.import("TextFormatUtil").formatDateTime(this.date,
a,this.options,b?b:this.configuration);this.options.format=c[1];c=t.import("TextFormatUtil").formatDateTime(this.date,a,this.options,b?b:this.configuration);this.options.format=h;return[d,c]};c.prototype.formatDateTime=function(a,b){return void 0===this.format?"":t.import("TextFormatUtil").formatDateTime(this.date,a,this.options,b?b:this.configuration)};c.prototype.formatDateTimeValue=function(){var a=this.format,b=!1;a.match(/(ap|a)/i)&&(b=!0);b=this.computeTimeParams(b);a=a.replace(/(ap|a)/i,b.amPm);
a=a.replace(/MMM/,b.months[b.dt.getMonth()]);a=a.replace(/DD/,b.cdate);a=a.replace(/YYYY/,b.cyear4);a=a.replace(/YY/,b.cyear2);a=a.replace(/MM/,b.cmonth);a=a.replace(/(hh|h)/,b.hrs);a=a.replace(/mm/,b.mts);a=a.replace(/ss/,b.sec);return a.trim()};c.prototype.computeTimeParams=function(a){var b={months:"Jan Feb Mar Apr May June July Aug Sep Oct Nov Dec".split(" ")};if(!(this.date instanceof Date))return null;b.dt=this.date;b.cdate=10>this.date.getDate()?"0"+this.date.getDate().toString():this.date.getDate().toString();
b.cmonth=10>this.date.getMonth()+1?"0"+(this.date.getMonth()+1).toString():(this.date.getMonth()+1).toString();b.cyear2=this.date.getFullYear().toString().slice(2);b.cyear4=this.date.getFullYear().toString();b.hrs=10>this.date.getHours()?"0"+this.date.getHours().toString():this.date.getHours().toString();b.mts=10>this.date.getMinutes()?"0"+this.date.getMinutes():this.date.getMinutes().toString();b.sec=10>this.date.getSeconds()?"0"+this.date.getSeconds():this.date.getSeconds().toString();a&&(b.amPm=
12>parseInt(b.hrs)?"AM":"PM",b.hrs=13>parseInt(b.hrs)?b.hrs:10>parseInt(b.hrs)-12?"0"+(parseInt(b.hrs)-12).toString():(parseInt(b.hrs)-12).toString());return b};return c}(),pd;(function(c){c[c.INT=0]="INT";c[c.FLOAT=1]="FLOAT";c[c.HEXL=2]="HEXL";c[c.HEXU=3]="HEXU";c[c.EXP=4]="EXP";c[c.EXPD=5]="EXPD";c[c.THOUSAND=6]="THOUSAND"})(pd||(pd={}));var qd=function(c){function a(b,e,h,d,f){b=c.call(this,b.wgtId,e,h,d,f)||this;b.setDefaultState();void 0===b.width&&(b.width=parseFloat(b.elem.style.width.split("px")[0]));
void 0===b.height&&(b.height=parseFloat(b.elem.style.height.split("px")[0]));void 0===b.cx&&(b.cx=b.width/2);void 0===b.cy&&(b.cy=b.height/2);void 0===b.radiusX&&(b.radiusX=b.cx);void 0===b.radiusY&&(b.radiusY=b.cy);b.labelNames&&(b.listLablesNames=b.labelNames.split(","));b.updateMaxTextSize();"Time"==b.dataType&&(b.parseTimeFormat(),b.activateHandler=b.getActivateHandler(),c.prototype.bindEvents.call(b,{loadWgt:b.activateHandler}));b._renderMask=a._renderFlags.MIN|a._renderFlags.MAX|a._renderFlags.LBSFREQ|
a._renderFlags.FNSIZE;b.smartAlignment&&(b._renderMask|=a._renderFlags.OVERFLOW);g.addToRender(b);b.initialized=!0;return b}p(a,c);a.prototype.setDefaultState=function(){this.reverse=void 0!==this.reverse?this.reverse:0;this.min=void 0!==this.min?this.min:0;this.max=void 0!==this.max?this.max:500;this.labels=void 0!==this.labels?this.labels:10;this.startAngle=void 0!==this.startAngle?this.startAngle:0*Math.PI/180;this.stopAngle=void 0!==this.stopAngle?this.stopAngle:90*Math.PI/180;this.cx=void 0!==
this.cx?this.cx:0;this.cy=void 0!==this.cy?this.cy:0;this.range=void 0!==this.range?this.range:500;this.fontSize=void 0!==this.fontSize?this.fontSize:10;this.fontFamily=void 0!==this.fontFamily?this.fontFamily:"Thaoma";this.fontColor=void 0!==this.fontColor?this.fontColor:"rgb( 0,0,0 )";this.dataFormat=void 0!==this.dataFormat?this.dataFormat:"Numeric";this.dataType=void 0!==this.dataType?this.dataType:"Number";this.invokablePropsList=["fill","fontColor"];this.timeSpec=void 0!==this.timeSpec?this.timeSpec:
"local";this.smartAlignment=void 0!==this.smartAlignment?this.smartAlignment:!1;this._renderMask=0};a.prototype.getActivateHandler=function(){var b=this;return function(){b.dateFormatter.setConfiguration({longDateFormat:b.project.getValue("longDateFormat"),shortDateFormat:b.project.getValue("shortDateFormat"),serverOffset:b.project.getSystemPropertiesMgr().getServerOffset()})&&(b._renderMask|=a._renderFlags.MIN,b._renderMask|=a._renderFlags.MAX,$hmi.addToRender(b))}};a.prototype.updateMaxTextSize=
function(){if("vert"==this.form)this.maxTextSize={width:this.width,height:this.fontSize};else if("Time"==this.dataType){var b=-1!=this.dataFormat.indexOf("A")?this.dataFormat+"A":this.dataFormat;this.maxTextSize=a.getMeasureText(b,this.fontFamily,this.fontSize)}else if(b=Math.max(this.min,this.max),b=this.getValueByFormat(b),this.maxTextSize=a.getMeasureText(" "+b,this.fontFamily,this.fontSize),this.listLablesNames&&0<this.listLablesNames.length){for(var b=this.labelNames[0],c=0;c<this.listLablesNames.length;c++)this.listLablesNames[c].length>
b.length&&(b=this.listLablesNames[c]);this.maxTextSize=a.getMeasureText(b,this.fontFamily,this.fontSize)}};a.prototype.render=function(){c.prototype.render.call(this);this._renderMask&a._renderFlags.OVERFLOW&&(this.elem.style.overflow="visible");if(this._renderMask&(a._renderFlags.MIN|a._renderFlags.MAX|a._renderFlags.LBSFREQ|a._renderFlags.FNSIZE|a._renderFlags.REVERSE|a._renderFlags.REDRAW))switch(this.form){case "horiz":this.drawLinear(!1);break;case "vert":this.drawLinear(!0);break;case "round":this.drawRadial()}this._renderMask&
a._renderFlags.FNCOLOR&&(this.elem.style.color=this.fill);this._renderMask=0};a.prototype.removeChildren=function(){for(;this.elem.hasChildNodes();)this.elem.removeChild(this.elem.firstChild)};a.prototype.drawRadial=function(){if(this.initialized){var b=this.cx,a=this.cy,c=this.radiusX,d=this.radiusY,f=this.startAngle,k,g,m;this.min>this.max&&(this.max=this.min);this.elem.setAttribute("data-cx",this.radiusX.toString());this.elem.setAttribute("data-cy",this.radiusY.toString());this.removeChildren();
var l=(this.stopAngle-this.startAngle)/(this.labels-1),p=(this.max-this.min)/(this.labels-1),r=this.min;this.reverse&&(p=-p,r=this.max);for(var t,u=document.createDocumentFragment(),v=0;v<this.labels;v++)k=Math.cos(Math.PI*f/180),g=Math.sin(Math.PI*f/180),k=b-(c-this.maxTextSize.width/2-3)*k,g=a-(d-this.maxTextSize.height/2-3)*g,k-=this.maxTextSize.width/2,g-=this.maxTextSize.height/2,1>l?m="":this.listLablesNames&&this.listLablesNames[v]?m=this.listLablesNames[v]:(r=Math.round(r*Math.pow(10,6))/
Math.pow(10,6),m=this.getValueByFormat(r)),t=document.createElement("div"),m=document.createTextNode(m),t.style.fontSize=this.fontSize+"px",t.style.fontFamily=this.fontFamily,t.style.position="absolute",t.style.width=this.maxTextSize.width+"px",t.style.height=this.maxTextSize.height+"px",t.style.top=g.toFixed(2)+"px",t.style.left=k.toFixed(2)+"px",t.style.textAlign="center",t.appendChild(m),r+=p,f+=l,u.appendChild(t);this.elem.appendChild(u)}};a.prototype.drawLinear=function(b){if(this.initialized){this.removeChildren();
this.min>this.max&&(this.max=this.min);var a=(this.max-this.min)/(this.labels-1),c=this.min;this.reverse&&(a=-a,c=this.max);b?this.drawVertical(c,a):this.drawHorizontal(c,a)}};a.prototype.drawVertical=function(b,a){var c=this.maxTextSize.height,d=this.maxTextSize.width,f=0,f=this.smartAlignment?(this.height+c-this.labels*c)/(this.labels-1)+c:(this.height-c)/(this.labels-1),k=0;switch(this.align){case 0:k=0;break;case 1:k=this.width-d;break;case 2:k=this.width/2-d/2}d=c/2;this.smartAlignment&&(d=-d);
for(var g=document.createDocumentFragment(),m=0;m<this.labels;m++){var l=void 0;this.listLablesNames&&this.listLablesNames[m]?l=this.listLablesNames[m]:(b=Math.round(b*Math.pow(10,6))/Math.pow(10,6),l=this.getValueByFormat(b));var p=void 0;switch(this.align){case 0:p="left";break;case 1:p="right";break;default:p="center"}var r=d-c/2;this.smartAlignment&&(r=d);g.appendChild(this.createLabel(l,r,k,p));d+=f;b+=a}this.elem.appendChild(g)};a.prototype.drawHorizontal=function(b,a){var c=0,d,f=this.maxTextSize.height,
k=this.maxTextSize.width;d=this.smartAlignment?(this.width+k-this.labels*k)/(this.labels-1)+k:(this.width-k)/(this.labels-1);switch(this.align){case 0:c=0;break;case 1:c=this.height-f;break;case 2:c=this.height/2-f/2}f=k/2;this.smartAlignment&&(f=-f);for(var g=document.createDocumentFragment(),m=0;m<this.labels;m++){var l=void 0;this.listLablesNames&&this.listLablesNames[m]?l=this.listLablesNames[m]:(b=Math.round(b*Math.pow(10,6))/Math.pow(10,6),l=this.getValueByFormat(b));var p=f-k/2;this.smartAlignment&&
(p=f);g.appendChild(this.createLabel(l,c,p,"center"));f+=d;b+=a}this.elem.appendChild(g)};a.prototype.createLabel=function(b,a,c,d){var f=document.createElement("div");f.style.fontSize=this.fontSize+"px";f.style.fontFamily=this.fontFamily;f.style.position="absolute";f.style.width=this.maxTextSize.width+"px";f.style.height=this.maxTextSize.height+"px";f.style.top=a+"px";f.style.left=c+"px";f.style.textAlign=d;f.appendChild(document.createTextNode(b));this.core.browserOptimizations.forceLayers&&f.setAttribute("class",
"hacklayer willcnt");return f};a.prototype.parseNumberFormat=function(){void 0!==this.format&&""!=this.format&&"none"!=this.format&&(this.formatOptions=g.import("TextFormatUtil").parseFormat(this.format),this.decimalDigits=this.formatOptions.decimalPlaces,this.leadingDigits=this.formatOptions.leadingDigits)};a.prototype.parseTimeFormat=function(){var b={longDateFormat:this.project.getValue("longDateFormat"),shortDateFormat:this.project.getValue("shortDateFormat"),serverOffset:this.project.getSystemPropertiesMgr().getServerOffset()};
this.dateFormatter=new cb(new Date,this.dataFormat,b)};a.prototype.updateStyle=function(b){if(b.longDateFormat||b.shortDateFormat)this.parseTimeFormat(),this._renderMask|=a._renderFlags.MIN,this._renderMask|=a._renderFlags.MAX,$hmi.addToRender(this)};a.prototype.formatText=function(b){var a=this.project?this.project.getValue("fieldsStyle"):null;return g.import("TextFormatUtil").formatText(this.formatOptions,b,a,!1)};a.prototype.getValueByFormat=function(b){switch(this.dataType){case "Number":return this.parseNumberFormat(),
this.formatText(b);case "Text":return b;case "Time":return this.dateFormatter.setDate(b),this.dateFormatter.formatDateTime(this.timeSpec)}};a.prototype.setValue=function(b,e,h,d){var f=!1;switch(b){case "min":if(this.isBadValue(e,!1,h))return!1;parseFloat(e)!=this.min&&(this.min=parseFloat(e),this.updateMaxTextSize(),this._renderMask|=a._renderFlags.MIN,f=!0,this.sendUpdate(b,this.min,h));break;case "max":if(this.isBadValue(e,!1,h))return!1;parseFloat(e)!=this.max&&(this.max=parseFloat(e),this.updateMaxTextSize(),
this._renderMask|=a._renderFlags.MAX,f=!0,this.sendUpdate(b,this.max,h));break;case "labelFreq":if(this.isBadValue(e,!1,h))return!1;e=parseFloat(e);0>e&&(e=0);this.labels!=e&&(this.labels=e,this._renderMask|=a._renderFlags.LBSFREQ,f=!0,this.sendUpdate(b,this.labels,h));break;case "numStates":if(this.isBadValue(e,!1,h))return!1;e=parseFloat(e);e=0<e?e:0;this.labels!=e&&(this.labels=e,this.max=this.min+this.labels-1,this._renderMask|=a._renderFlags.LBSFREQ,f=!0,this.sendUpdate(b,this.labels,h));break;
case "fill":case "fontColor":d="#000";this.isBadValue(e,!0,h)||this.fill==e?this.fill!=d&&(/^rgb\(\s*\d+,\s*\d+\s*,\s*\d+\s*\)$/.test(e)?d=e:"string"==typeof e&&0==e.indexOf("#")&&1<e.length&&8>=e.length&&(d=e),this.fill=d,f=!0,this.sendUpdate(b,d,h)):f=!0;f&&(this._renderMask|=a._renderFlags.FNCOLOR);break;case "font-size":if(this.isBadValue(e,!1,h))return!1;b=parseFloat(e);10>b&&(b=10);this.fontSize!=b&&(this.fontSize=b,f=!0,this._renderMask|=a._renderFlags.FNSIZE);break;case "reverseScale":case "!reverseScale":if(this.isBadValue(e,
!1,h))return!1;e=parseInt(e);"vert"==this.form&&"!reverseScale"==b&&(e=1-e);this.reverse!=e&&(this.reverse=e,f=!0,this._renderMask|=a._renderFlags.REVERSE,this.sendUpdate(b,this.reverse,h));break;case "visibility2":l.prototype.setValue.call(this,"visibility",e,h,d);break;case "usingFormat":e!=this.format&&void 0!==e&&(f=!0,this.format=e,this.updateMaxTextSize(),this._renderMask|=a._renderFlags.REDRAW,this.sendUpdate(b,this.format,h));break;case "decimalDigits":e!=this.decimalDigits&&void 0!==e&&(f=
!0,e=10<e||0>e?this.decimalDigits:e,this.formatOptions.decimalPlaces=this.decimalDigits=e,this.updateMaxTextSize(),this._renderMask|=a._renderFlags.REDRAW,this.sendUpdate(b,this.decimalDigits,h));break;case "leadingDigits":e!=this.leadingDigits&&void 0!==e&&(f=!0,e=10<e||0>e?this.leadingDigits:e,this.formatOptions.leadingDigits=this.leadingDigits=e,this.updateMaxTextSize(),this._renderMask|=a._renderFlags.REDRAW,this.sendUpdate(b,this.leadingDigits,h));break;case "startAngle":this.startAngle!=e&&
(this.startAngle=parseFloat(e),this._renderMask|=a._renderFlags.REDRAW,f=!0,this.sendUpdate(b,this.startAngle,h));break;case "stopAngle":case "endAngle":this.stopAngle!=e&&(360<e&&(e=360),this.stopAngle=parseFloat(e),this._renderMask|=a._renderFlags.REDRAW,f=!0,this.sendUpdate(b,this.stopAngle,h));break;case "dataFormat":void 0!=e&&this.dataFormat!=e&&(this.dataFormat=e,this.parseTimeFormat(),this._renderMask|=a._renderFlags.MIN,this._renderMask|=a._renderFlags.MAX,f=!0,this.sendUpdate(b,this.dataFormat,
h));break;default:c.prototype.setValue.call(this,b,e,h,d)}f&&g.addToRender(this);return!0};a.prototype.getValue=function(b){return"fill"==b||"fontColor"==b?this.fill?this.fill:this.elem.style.color:"undefined"!=typeof this[b]?this[b]:l.prototype.getValue.call(this,b)};a.prototype.setParentBounds=function(b,c,h,d,f){var k=this.width,q=this.height;l.prototype.setParentBounds.call(this,b,c,h,d,f);this.radiusX*=this.width/k;this.radiusY*=this.height/q;this._renderMask|=a._renderFlags.REDRAW;g.addToRender(this)};
a.getMeasureText=function(b,a,c){if("string"!=typeof b||"string"!=typeof a||"number"!=typeof c)throw"getMeasureText(): Invalid parameter type !";var d=document.createElement("canvas").getContext("2d");d.font=c+"px "+a;return{width:d.measureText(b).width,height:c}};a.prototype.destroy=function(){c.prototype.unbindEvents.call(this,{loadWgt:this.activateHandler});return c.prototype.destroy.call(this)};a._renderFlags={MIN:2,MAX:4,LBSFREQ:8,FNCOLOR:16,FNSIZE:32,REVERSE:64,UPLBLSIZE:128,REDRAW:256,OVERFLOW:512};
a.jmType="LabelsWgt";return a}(l);g.fn.hmiLabels=function(c,a,b,e){return new qd(this,c,a,b,e)};g.addWidgetDefinition("hmiLabels",qd);var Ea;(function(c){c[c.VERTICAL=0]="VERTICAL";c[c.HORIZONTAL=1]="HORIZONTAL";c[c.ROUND=2]="ROUND"})(Ea||(Ea={}));var rd=function(c){function a(b,e,h,d,f){b=c.call(this,b.wgtId,e,h,d,f)||this;b.line=null;b.pathMajor=null;b.pathMinor=null;b.pathHalf=null;a.TicksRender||(e=b.core.import("JMTicksRender"),a.TicksRender=new e.TicksRender);b.updateSVGReferences(b.elem.getElementsByTagName("svg")[0]);
b.smartAlignment=void 0!==b.smartAlignment?b.smartAlignment:!1;b.smartAlignment&&(b._renderMask|=a._renderFlags.OVERFLOW,b.core.addToRender(b));return b}p(a,c);a.prototype.updateSVGReferences=function(b){this.svg=b;b.getElementsByTagName("path")&&(this.pathMajor=this.svg.querySelector(".jm-ticks-major"),this.pathMinor=this.svg.querySelector(".jm-ticks-minor"),this.pathHalf=this.svg.querySelector(".jm-ticks-half"))};a.prototype.render=function(){c.prototype.render.call(this);this._renderMask&a._renderFlags.OVERFLOW&&
(this.elem.style.overflow="visible");this._renderMask&a._renderFlags.STROKE_MINOR_COLOR&&(this.form==Ea.VERTICAL||this.form==Ea.HORIZONTAL?this.pathMinor.setAttribute("fill",this.strokeMinorColor):this.pathMinor.setAttribute("stroke",this.strokeMinorColor));if(this._renderMask&a._renderFlags.STROKE_MAJOR_COLOR)if(this.form==Ea.VERTICAL||this.form==Ea.HORIZONTAL){if(this.pathMajor.setAttribute("fill",this.strokeMajorColor),this.pathHalf&&this.pathHalf.setAttribute("fill",this.strokeMajorColor),this.svg){var b=
this.svg.querySelectorAll(".jm-ticks-line");if(b)for(var e=0,h=b.length;e<h;e++)b[e].setAttribute("stroke",this.strokeMajorColor)}}else if(this.pathMajor.setAttribute("stroke",this.strokeMajorColor),this.pathHalf&&this.pathHalf.setAttribute("stroke",this.strokeMajorColor),this.svg&&(b=this.svg.querySelectorAll(".jm-ticks-line")))for(e=0,h=b.length;e<h;e++)b[e].setAttribute("stroke",this.strokeMajorColor);if((this._renderMask&a._renderFlags.UPDATE||this._renderMask&a._renderFlags.NEWSIZE)&&a.TicksRender){b=
void 0;if(this.form==Ea.ROUND)b=a.TicksRender.generateTicksCodeRoundPath(document,this);else if(this.form==Ea.HORIZONTAL||this.form==Ea.VERTICAL)b=a.TicksRender.generateTicksCodeHVPath(document,this);e=this.svg.parentElement;e.removeChild(this.svg);e.appendChild(b);this.updateSVGReferences(b)}this._renderMask=0};a.prototype.setValue=function(b,e,h,d){d=!1;switch(b){case "majorTicks":case "labelFreq":if(this.isBadValue(e,!0,h))return!1;this.majorTicks!=e&&(d=e,2>e&&(d=2),this.majorTicks=d,this._renderMask|=
a._renderFlags.UPDATE,d=!0,this.sendUpdate(b,e,h));break;case "minorTicks":case "tickFreq":if(this.isBadValue(e,!0,h))return!1;var f=e;0>e&&(f=0);this.minorTicks!=f&&(this.minorTicks=f,this._renderMask|=a._renderFlags.UPDATE,d=!0,this.sendUpdate(b,e,h));break;case "align":if(this.isBadValue(e,!0,h))return!1;this.align!=e&&(this.align=e,this._renderMask|=a._renderFlags.UPDATE,d=!0,this.sendUpdate(b,e,h));break;case "max":if(this.isBadValue(e,!0,h))return!1;this.max!=e&&(this.max=e,this._renderMask|=
a._renderFlags.UPDATE,d=!0,this.sendUpdate(b,e,h));break;case "majorThickness":case "stroke-width":if(this.isBadValue(e,!0,h))return!1;this.majorThickness!=e&&(this.majorThickness=0==e?1:e,this._renderMask|=a._renderFlags.UPDATE,d=!0,this.sendUpdate(b,e,h));break;case "majorTicksLength":case "tickSize2":if(this.isBadValue(e,!0,h))return!1;this.majorTicksLength!=e&&(this.majorTicksLength=e,this._renderMask|=a._renderFlags.UPDATE,d=!0,this.sendUpdate(b,e,h));break;case "minorThickness":case "minorStroke-width":if(this.isBadValue(e,
!0,h))return!1;this.minorThickness!=e&&(this.minorThickness=0==e?1:e,this._renderMask|=a._renderFlags.UPDATE,d=!0,this.sendUpdate(b,e,h));break;case "minorTicksLength":case "tickSize":if(this.isBadValue(e,!0,h))return!1;this.minorTicksLength!=e&&(this.minorTicksLength=e,this._renderMask|=a._renderFlags.UPDATE,d=!0,this.sendUpdate(b,e,h));break;case "startAngle":if(this.isBadValue(e,!0,h))return!1;this.startAngle!=e&&(this.startAngle=e,this._renderMask|=a._renderFlags.UPDATE,d=!0,this.sendUpdate(b,
e,h));break;case "endAngle":if(this.isBadValue(e,!0,h))return!1;this.endAngle!=e&&(this.endAngle=e,this._renderMask|=a._renderFlags.UPDATE,d=!0,this.sendUpdate(b,e,h));break;case "strokeMinor":this.isBadValue(e,!0,h)?this.strokeMinorColor="#000000":"string"==typeof e&&this.strokeMinorColor!=e&&(this.strokeMinorColor=(d=0==e.indexOf("#")&&1<e.length&&8>=e.length||-1!=e.indexOf("rgb"))?e:"#000000");this.sendUpdate(b,this.strokeMinorColor,h);this._renderMask|=a._renderFlags.STROKE_MINOR_COLOR;d=!0;break;
case "strokeMajor":this.isBadValue(e,!0,h)?this.strokeMajorColor="#000000":"string"==typeof e&&this.strokeMajorColor!=e&&(this.strokeMajorColor=(d=0==e.indexOf("#")&&1<e.length&&8>=e.length||-1!=e.indexOf("rgb"))?e:"#000000");this.sendUpdate(b,this.strokeMajorColor,h);this._renderMask|=a._renderFlags.STROKE_MAJOR_COLOR;d=!0;break;case "visibility2":c.prototype.setValue.call(this,"visibility",e,h,null);break;case "alarmMax":case "alarmMin":case "alarmColorMajor":case "alarmColorMinor":case "alarmMajorWidth":case "alarmMinorWidth":case "halfMajorTick":case "halfMajorTickSize":case "reverseScale":if(this.isBadValue(e,
!0,h))return!1;this[b]!=e&&(this[b]=e,this._renderMask|=a._renderFlags.UPDATE,d=!0,this.sendUpdate(b,e,h));break;case "!reverseScale":if(this.isBadValue(e,!0,h))return!1;this.form==Ea.VERTICAL&&(e=!e);this.reverseScale!=e&&(this.reverseScale=e,this._renderMask|=a._renderFlags.UPDATE,d=!0,this.sendUpdate(b,e,h));break;case "frame":if(this.isBadValue(e,!0,h))return!1;this.tFrame!=e&&(this.tFrame=e,this._renderMask|=a._renderFlags.UPDATE,d=!0,this.sendUpdate(b,e,h));break;default:c.prototype.setValue.call(this,
b,e,h,null)}d&&g.addToRender(this);return!0};a.prototype.setParentBounds=function(b,a,h,d,f){c.prototype.setParentBounds.call(this,b,a,h,d,f);this.updateOnResize()};a.prototype.updateOnResize=function(b){c.prototype.updateOnResize.call(this,b);this._renderMask|=a._renderFlags.UPDATE;g.addToRender(this)};a.prototype.destroy=function(){this.pathMinor=this.pathMajor=this.line=this.svg=null;return c.prototype.destroy.call(this)};a._renderFlags={STROKE_MINOR_COLOR:2,STROKE_MAJOR_COLOR:4,UPDATE:8,NEWSIZE:16,
OVERFLOW:32};a.jmType="TicksWgt";a.TicksRender=null;return a}(l);g.fn.hmiTicks=function(c,a,b,e){return new rd(this,c,a,b,e)};g.addWidgetDefinition("hmiTicks",rd);var Cc=function(c){function a(b,e,h,d,f){b=c.call(this,b.wgtId,e,h,d,f)||this;b.setDefaultState();-1!=b.groupID&&b.parentPage.getProject().groupButtonIn(b,b.groupID);b.imageOpt=!1!==h.jmOptimization;b.authCode=b.getAuthorizations();b.isClone&&b.changeInternalElementsIds();"standard"==b.form?void 0!==b.classReleased&&void 0!==b.classPressed?
b.curState=-1!=b.elem.className.indexOf(b.classPressed)?1:0:(b.divPressed=b.elem.querySelector("#"+CSS.escape(b.wgtId+"_pressed")),b.divReleased=b.elem.querySelector("#"+CSS.escape(b.wgtId+"_released")),b.curState=1==parseInt(b.divPressed.style.opacity)?1:0):(b.dwnFill&&(b.curState=b.elem.style.background==b.dwnFill?1:0),b.dwnStroke&&(b.curState=b.elem.style.borderColor==b.dwnStroke?1:0));b.events={mousedown:!0,touchstart:!0};b.wgtsOnTop=[];if(b.parentWidget&&b.parentWidget.constructor==Va)for(h=
b.elem.nextSibling;h;)b.wgtsOnTop.push(h),h=h.nextSibling;b._animStatus=b.curState;0==b.toggle&&1==b.curState&&(b.curState=0,b._renderMask|=a._renderFlags.VALUE,b.render());return b}p(a,c);a.prototype.setDefaultState=function(){this.curState=void 0===this.curState?0:this.curState;this.toggle=void 0===this.toggle?0:this.toggle;this.action=void 0===this.action?"write":this.action;this.numStates=void 0===this.numStates?2:this.numStates;this.form=void 0===this.form?"standard":this.form;this.strokeWidth=
void 0===this.strokeWidth?1:this.strokeWidth;this.backgroundClass=void 0===this.backgroundClass?"bgColor00":this.backgroundClass;this.backgroundColor=void 0===this.backgroundColor?"":this.backgroundColor;this.dx=void 0===this.dx?2:this.dx;this.dy=void 0===this.dy?2:this.dy;this.groupID=void 0===this.groupID?-1:this.groupID;this.downTextColor=void 0===this.downTextColor?"rgb(0,0,0)":this.downTextColor;this.upTextColor=void 0===this.upTextColor?"rgb(0,0,0)":this.upTextColor;this.invokablePropsList=
["value"];this._renderMask=this._animStatus=0;this._lockEvent=!1};a.prototype.doMouseDown=function(b,a){var c=this;if(this.disabled)return!1;if(this.umgr&&this.authCode==this.umgr.getWidgetAuthorizationCodes().RDONLY)return this.project.getValue("onAccessDenied")&&this.showHideAccessDeniedIcon(),!1;if(this._lockEvent)return!1;this._lockEvent=!0;setTimeout(function(){c._lockEvent=!1},100);this.setValue("value",this.toggle?1===this.curState?0:1:1,null);var d=this.doWriteValue("value",this.curState);
this.toggle&&-1!=this.groupID&&d.then(function(){return c.project.updateButtonGroupedByID(c,c.groupID)});this.updateLabelColor();return!0};a.prototype.doMouseUp=function(b,a){if(this.disabled||this.umgr&&this.authCode==this.umgr.getWidgetAuthorizationCodes().RDONLY)return!1;this.toggle||(this.setValue("value",0,null),this.doWriteValue("value",this.curState),this.updateLabelColor());return!0};a.prototype.rdUpdateFillColor=function(b,a){if("standard"==this.form)for(var c=b.querySelectorAll("."+this.backgroundClass),
d=0,f=c.length;d<f;d++){var k=c[d];k.style.fill?k.style.fill=a:k.setAttribute("fill",a)}else this.elem.style.background=a};a.prototype.offsetTopWgts=function(b){if(this.s3D)for(var a=0,c=this.wgtsOnTop.length;a<c;a++){var d=this.wgtsOnTop[a];if(3!=d.nodeType){var f=parseInt(d.style.top.split("px")[0])||0,k=parseInt(d.style.left.split("px")[0])||0;b?(d.style.top=f+this.dy+"px",d.style.left=k+this.dx+"px"):(d.style.top=f-this.dy+"px",d.style.left=k-this.dx+"px")}}};a.prototype.rdStandardButtonValue=
function(){var b=this,c=this.core.browserOptimizations.forceLayers;if(this.isRaster){var h,d=this.elem.className.split(" ");this.curState?(h=d.indexOf(this.classReleased),-1!=h&&(this._animStatus=a._enStatus.IS_PRESSED,d.splice(h,1),this.elem.className=d.join(" ")+" "+this.classPressed,this.offsetTopWgts(1))):c?this.elem&&0==this.curState&&(h=d.indexOf(this.classPressed),-1!=h&&(this._animStatus=a._enStatus.IS_RELEASED,d.splice(h,1),this.elem.className=d.join(" ")+" "+this.classReleased,this.offsetTopWgts(0))):
setTimeout(function(){b.elem&&0==b.curState&&(h=d.indexOf(b.classPressed),-1!=h&&(b._animStatus=a._enStatus.IS_RELEASED,d.splice(h,1),b.elem.className=d.join(" ")+" "+b.classReleased,b.offsetTopWgts(0)))},50)}else this.curState?(this._animStatus=a._enStatus.IS_PRESSED,this.divPressed.style.opacity="1",this.divReleased.style.opacity="0",this.offsetTopWgts(1)):c?(this._animStatus=a._enStatus.IS_RELEASED,this.divPressed.style.opacity="0",this.divReleased.style.opacity="1",this.offsetTopWgts(0)):setTimeout(function(){b.elem&&
(b._animStatus=a._enStatus.IS_RELEASED,b.divPressed.style.opacity="0",b.divReleased.style.opacity="1",b.offsetTopWgts(0))},50)};a.prototype.rdShapeButtonValue=function(){var b=this,c=this.core.browserOptimizations.forceLayers;this.curState?(this._animStatus=a._enStatus.IS_PRESSED,this.dwnFill&&(this.elem.style.background=this.dwnFill),this.dwnStroke&&(this.elem.style.borderColor="none"==this.dwnStroke?"transparent":this.dwnStroke)):c?(this._animStatus=a._enStatus.IS_RELEASED,this.upFill&&(this.elem.style.background=
this.upFill),this.upStroke&&(this.elem.style.borderColor="none"==this.upStroke?"transparent":this.upStroke)):setTimeout(function(){b.elem&&(b._animStatus=a._enStatus.IS_RELEASED,b.upFill&&(b.elem.style.background=b.upFill),b.upStroke&&(b.elem.style.borderColor="none"==b.upStroke?"transparent":b.upStroke))},50)};a.prototype.render=function(){if(!c.prototype.render.call(this))return!1;this._renderMask&a._renderFlags.VALUE&&("standard"===this.form?this.rdStandardButtonValue():"rectangle"!==this.form&&
"oval"!==this.form||this.rdShapeButtonValue());this._renderMask&a._renderFlags.FILL&&this.rdUpdateFillColor(this.divReleased,this.upFill);this._renderMask&a._renderFlags.DOWN_FILL&&this.rdUpdateFillColor(this.divPressed,this.dwnFill);this._renderMask=0;return!0};a.prototype.setValue=function(b,e,h,d){switch(b){case "value":if(this.isBadValue(e,!1,h))return!1;e=parseFloat(1==e?1:0);if(isNaN(e))return!1;e=1<e||0>e?0:e;this.curState!=e&&(this.curState=e,this._renderMask|=a._renderFlags.VALUE,this.render(),
this.sendUpdate(b,this.curState,h));break;case "bkgColor":case "upColor":d=!1;isNaN(e)&&(this.isBadValue(e,!0,h)?d=!0:this.upFill!=e&&(this.upFill=this.validateColor(e)?e:"#000",d=!0));d&&(this._renderMask|=a._renderFlags.FILL,this.core.addToRender(this),this.sendUpdate(b,this.upFill,h));break;case "downFillColor":case "pushColor":if(isNaN(e)){if(this.isBadValue(e,!0,h))return!1;this.dwnFill!=e&&(this.dwnFill=this.validateColor(e)?e:"#000",this._renderMask|=a._renderFlags.DOWN_FILL,this.core.addToRender(this),
this.sendUpdate(b,this.dwnFill,h))}break;case "fill":if(isNaN(e)){if(this.isBadValue(e,!0,h))return!1;d=!1;this.dwnFill!=e&&(this.dwnFill=this.validateColor(e)?e:"#000",this.sendUpdate(b,this.dwnFill,h,null),this._renderMask|=a._renderFlags.DOWN_FILL,d=!0);this.upFill!=e&&(this.upFill=this.validateColor(e)?e:"#000",this.sendUpdate(b,this.upFill,h,null),this._renderMask|=a._renderFlags.FILL,d=!0);d&&g.addToRender(this)}break;case "needleColor":if(isNaN(e)){if(this.isBadValue(e,!0,h))return!1;this.dwnStroke!=
e&&(this.dwnStroke=this.validateColor(e)?e:"#000",this._renderMask|=a._renderFlags.VALUE,this.core.addToRender(this),this.sendUpdate(b,this.dwnStroke,h))}break;case "stroke":if(isNaN(e)){if(this.isBadValue(e,!0,h))return!1;this.upStroke!=e&&(this.upStroke=this.validateColor(e)?e:"#000",this._renderMask|=a._renderFlags.VALUE,this.core.addToRender(this),this.sendUpdate(b,this.upStroke,h))}break;case "downTextColor":this.downTextColor!=e&&(this.downTextColor=this.validateColor(e)?e:"#000",this.updateLabelColor());
break;case "upTextColor":this.upTextColor!=e&&(this.upTextColor=this.validateColor(e)?e:"#000",this.updateLabelColor());break;default:return c.prototype.setValue.call(this,b,e,h,d)}return!0};a.prototype.validateColor=function(b){return b&&(0==b.indexOf("#")&&1<b.length&&8>=b.length||"r"===b.charAt(0)&&"g"===b.charAt(1)&&"b"===b.charAt(2)||"none"==b)?!0:!1};a.prototype.getValue=function(b){return"value"==b?this.curState:"fill"==b||"bkgColor"==b?this.upFill:"downFillColor"==b||"pushColor"==b?this.dwnFill:
"needleColor"==b?this.dwnStroke:"stroke"==b?this.upStroke:c.prototype.getValue.call(this,b)};a.prototype.changeInternalElementsIds=function(){for(var b=this.elem.querySelectorAll(".jm-wgt, .jm-wgt>div"),a=0,c=b.length;a<c;a++){var d=b[a];-1!=d.id.indexOf("_pressed")&&(d.id=d.id.replace(d.id,this.wgtId+"_pressed"));-1!=d.id.indexOf("_released")&&(d.id=d.id.replace(d.id,this.wgtId+"_released"))}};a.prototype.destroy=function(){if(this.destroyed)return!1;if(!this.core.browserOptimizations.forceLayers&&
0==this.curState&&this._animStatus==a._enStatus.IS_PRESSED)if("standard"===this.form)if(this.isRaster){var b=this.elem.className.split(" "),c=b.indexOf(this.classPressed);-1!=c&&(b.splice(c,1),this.elem.className=b.join(" ")+" "+this.classReleased,this.offsetTopWgts(0))}else this.divPressed.style.opacity="0",this.divReleased.style.opacity="1",this.offsetTopWgts(0);else this.upFill&&(this.elem.style.background=this.upFill),this.upStroke&&(this.elem.style.borderColor="none"==this.upStroke?"transparent":
this.upStroke);this.wgtsOnTop=[];this.divReleased=this.divPressed=null;return l.prototype.destroy.call(this)};a.prototype.setParentBounds=function(b,a,h,d,f){c.prototype.setParentBounds.call(this,b,a,h,d,f);this.updateOnResize()};a.prototype.updateOnResize=function(b){c.prototype.updateOnResize.call(this,b);if(!this.imageOpt){(b=this.divPressed.getElementsByTagName("svg"))&&0<b.length&&(b[0].setAttribute("width",this.width.toString()),b[0].setAttribute("height",this.height.toString()));var a=this.divReleased.getElementsByTagName("svg");
b&&0<b.length&&(a[0].setAttribute("width",this.width.toString()),a[0].setAttribute("height",this.height.toString()))}};a.prototype.addDataLink=function(b){c.prototype.addDataLink.call(this,b);"value"===b.attr&&"r"===b.rw&&(this.disabled=!0)};a.prototype.updateLabelColor=function(){if(this.changeTextColor&&this.parentWidget&&this.parentWidget.wgts)for(var b in this.parentWidget.wgts){var a=this.parentWidget.wgts[b];"LabelWgt"==a.getJMType()&&a.setProperty("fill",this.curState?this.downTextColor:this.upTextColor)}};
a.jmType="ButtonWgt";a._renderFlags={VALUE:2,FILL:4,DOWN_FILL:8};a._enStatus={IS_RELEASED:0,IS_PRESSED:1};return a}(l);g.fn.hmiButton=function(c,a,b,e){return new Cc(this,c,a,b,e)};g.addWidgetDefinition("hmiButton",Cc);var ag=function(c){function a(b,a,h,d,f){var k=c.call(this,b,a,h,d,f)||this;b=k.core.import("JMGestures");k.gestureMgr=new b.GestureManager;k.gestureMgr.installGesture("onGesturePan",new b.Pan,{exclusive:!0});k.gestureMgr.installGesture("onGesturePinch",new b.Pinch,{exclusive:!0});
k.gestureMgr.installGesture("onGestureRotate",new b.Rotate,{exclusive:!0});k.gestureMgr.installGesture("onGestureSwipeRight",new b.SwipeRight);k.gestureMgr.installGesture("onGestureSwipeLeft",new b.SwipeLeft);k.gestureMgr.installGesture("onGestureSwipeUp",new b.SwipeUp);k.gestureMgr.installGesture("onGestureSwipeDown",new b.SwipeDown);k.gestureMgr.installGesture("onGesturePinchOpen",new b.PinchOpen);k.gestureMgr.installGesture("onGesturePinchClosed",new b.PinchClose);k.gestureMgr.installGesture("onGestureRotateClockwise",
new b.RotateClockWise);k.gestureMgr.installGesture("onGestureRotateAntiClockwise",new b.RotateAntiClockWise);k.gestureMgr.registerHandler(function(b,a){var c=k[b];if(c)for(var e=0;e<c.length;e++)k.core.doAction(k.wgtId,c[e],a)});return k}p(a,c);a.prototype.enablePassthru=function(){this.gestureMgr.disableDetection()};a.prototype.disablePassthru=function(){this.gestureMgr.enableDetection()};a.prototype.doMouseDown=function(b,a){if(this.disabled||this.umgr&&this.authCode==this.umgr.getWidgetAuthorizationCodes().RDONLY)return!1;
"touchstart"==a.type&&this.gestureMgr.send({type:"start",data:a},this.boundingRect);return!0};a.prototype.doMouseUp=function(b,a){if(this.disabled||this.umgr&&this.authCode==this.umgr.getWidgetAuthorizationCodes().RDONLY)return!1;a&&"touchend"==a.type&&this.gestureMgr.send({type:"end",data:a},this.boundingRect);return!0};a.prototype.doMouseMove=function(b,a){if(this.disabled||this.umgr&&this.authCode==this.umgr.getWidgetAuthorizationCodes().RDONLY)return!1;"touchmove"==a.type&&this.gestureMgr.send({type:"move",
data:a},this.boundingRect);return!0};a.prototype.doMouseCancel=function(b,a){if(this.disabled||this.umgr&&this.authCode==this.umgr.getWidgetAuthorizationCodes().RDONLY)return!1;"touchcancel"==a.type&&this.gestureMgr.send({type:"cancel",data:a},this.boundingRect);return!0};a.prototype.isGestureDetected=function(){return this.gestureMgr.isGestureDetected()};a.jmType="GestureAreaWgt";return a}(Cc);g.addWidgetDefinition("hmiGestureArea",ag);var mb;(function(c){c[c.SOLID=0]="SOLID";c[c.DASH=1]="DASH";
c[c.DOT=2]="DOT";c[c.DASH_DOT=3]="DASH_DOT";c[c.DASH_DOT_DOT=4]="DASH_DOT_DOT"})(mb||(mb={}));var sd=function(c){function a(b,e,h,d,f){b=c.call(this,b.wgtId,e,h,d,f)||this;b.xStart=0;b.yStart=0;b.xEnd=0;b.yEnd=0;b.svgWidth=0;b.svgHeight=0;b.updateSVGContainerSize();b.updateLineElementBounds();b._renderMask|=a._renderFlags.REDRAW;g.addToRender(b);return b}p(a,c);a.prototype.generateSVGContainer=function(){var b=document.createElementNS("http://www.w3.org/2000/svg","svg");b.setAttribute("width",this.svgWidth.toString());
b.setAttribute("height",this.svgHeight.toString());b.setAttribute("style","position:absolute;left:"+-this.strokeWidth+"px;top:"+-this.strokeWidth+"px;");return b};a.prototype.generateLine=function(){var b=document.createElementNS("http://www.w3.org/2000/svg","line");b.setAttribute("x1",this.xStart.toString());b.setAttribute("y1",this.yStart.toString());b.setAttribute("x2",this.xEnd.toString());b.setAttribute("y2",this.yEnd.toString());b.setAttribute("stroke-width",this.strokeWidth.toString());b.setAttribute("stroke",
this.strokeColor);b.setAttribute("stroke-linecap","square");switch(this.lineStyle){case mb.DASH:b.setAttribute("stroke-dasharray","20, 10");break;case mb.DOT:b.setAttribute("stroke-dasharray","6, 10");break;case mb.DASH_DOT:b.setAttribute("stroke-dasharray","20, 10, 5, 10");break;case mb.DASH_DOT_DOT:b.setAttribute("stroke-dasharray","20, 10, 5, 10, 5, 10")}return b};a.prototype.render=function(){var b;c.prototype.render.call(this);if(this._renderMask&a._renderFlags.REDRAW){this.elem.style.overflow=
"visible";null===(b=this.elem.firstElementChild)||void 0===b?void 0:b.remove();b=this.generateSVGContainer();var e=this.generateLine();b.appendChild(e);this.elem.appendChild(b)}this._renderMask=0;return!0};a.prototype.updateSVGContainerSize=function(){this.svgWidth=this.width+2*this.strokeWidth;this.svgHeight=this.height+2*this.strokeWidth};a.prototype.updateLineElementBounds=function(){switch(this.anchorIdx){case 0:this.xStart=0+this.strokeWidth;this.yStart=0+this.strokeWidth;this.xEnd=this.svgWidth-
this.strokeWidth;this.yEnd=this.svgHeight-this.strokeWidth;break;case 1:this.xStart=0+this.strokeWidth;this.yStart=this.svgHeight-this.strokeWidth;this.xEnd=this.svgWidth-this.strokeWidth;this.yEnd=0+this.strokeWidth;break;case 2:this.xStart=this.svgWidth-this.strokeWidth;this.yStart=0+this.strokeWidth;this.xEnd=0+this.strokeWidth;this.yEnd=this.svgHeight-this.strokeWidth;break;case 3:this.xStart=this.svgWidth-this.strokeWidth,this.yStart=this.svgHeight-this.strokeWidth,this.xEnd=0+this.strokeWidth,
this.yEnd=0+this.strokeWidth}};a.prototype.setValue=function(b,e,h,d){var f=!1;switch(b){case "stroke":this.strokeColor!=e&&"string"==typeof e&&(this.strokeColor=e,this._renderMask|=a._renderFlags.REDRAW,f=!0);break;case "stroke-width":this.strokeWidth!=e&&(this.strokeWidth=e,0>=this.strokeWidth&&(this.strokeWidth=1),this.updateSVGContainerSize(),this._renderMask|=a._renderFlags.REDRAW,f=!0);break;case "linestyle":this.lineStyle!=e&&(this.lineStyle=e,this._renderMask|=a._renderFlags.REDRAW,f=!0);
break;case "anchorIdx":this.anchorIdx!=e&&(this.anchorIdx=e,this.updateLineElementBounds(),this._renderMask|=a._renderFlags.REDRAW,f=!0);break;default:c.prototype.setValue.call(this,b,e,h,d)}f&&g.addToRender(this)};a.prototype.setParentBounds=function(b,e,h,d,f){c.prototype.setParentBounds.call(this,b,e,h,d,f);this.updateSVGContainerSize();this.updateLineElementBounds();this._renderMask|=a._renderFlags.REDRAW;g.addToRender(this)};a._renderFlags={REDRAW:1};return a}(l);g.fn.hmiLine=function(c,a,b,
e){return new sd(this,c,a,b,e)};g.addWidgetDefinition("hmiLine",sd);var Fa;(function(c){c[c.VERTICAL=0]="VERTICAL";c[c.HORIZONTAL=1]="HORIZONTAL";c[c.ROUND=2]="ROUND"})(Fa||(Fa={}));var nb;(function(c){c[c.TOP_OR_LEFT=0]="TOP_OR_LEFT";c[c.BOTTOM_OR_RIGHT=1]="BOTTOM_OR_RIGHT";c[c.CENTER=2]="CENTER"})(nb||(nb={}));var Dc=function(c){function a(b,a,h,d,f){b=c.call(this,b.wgtId,a,h,d,f)||this;b.svgRoundGeometry={bg:null,fg:null};b.__renderMask=0;b.invokablePropsList=["alarmMin","alarmMax","stroke","strokeWidth"];
b.initialized=!0;b.endAngle=b.endAngle||0;b.startAngle=b.startAngle||0;b.alarmMin=b.alarmMin||0;b.alarmMax=b.alarmMax||0;b.min=b.min||0;b.max=b.max||0;b.form==Fa.VERTICAL||b.form==Fa.HORIZONTAL?b.svgLinearGeometry=b.elem.querySelector("line"):(b.svgRoundGeometry.bg=b.elem.querySelector("path:nth-child(1)"),b.svgRoundGeometry.fg=b.elem.querySelector("path:nth-child(2)"));return b}p(a,c);a.prototype.render=function(){c.prototype.render.call(this);this._renderMask&a._renderFlags.REDRAW&&this.redraw();
this._renderMask&a._renderFlags.STWIDTH&&this.redraw("strokeWidth");this._renderMask&a._renderFlags.STCOLOR&&(this.svgLinearGeometry&&this.svgLinearGeometry.setAttribute("stroke",this.stroke),this.svgRoundGeometry&&this.svgRoundGeometry.fg&&(this.svgRoundGeometry.fg.setAttribute("stroke",this.stroke),this.svgRoundGeometry.bg.setAttribute("stroke",this.backgroundColor)));if(this._renderMask&a._renderFlags.UPDATESVG&&this.elem.getElementsByTagName("svg")[0]){var b=this.elem.getElementsByTagName("svg")[0];
b.style.width=this.width+"px";b.style.height=this.height+"px";this.redraw()}this._renderMask=0};a.prototype._checkLimit=function(b){b>this.max&&(b=this.max);b<this.min&&(b=this.min);return b};a.prototype.redraw=function(b){var a=this.min,c=this.max,d=this.alarmMax;this.alarmMin>this.alarmMax&&(d=this.alarmMin);d>c&&(d=c);var f=this.alarmMin;this.alarmMin>this.alarmMax&&(f=this.alarmMax);f<a&&(f=a);this.form==Fa.ROUND?this.drawRndScale(a,c,f,d,b):this.form==Fa.HORIZONTAL?this.drawHrzScale(a,c,f,d,
b):this.form==Fa.VERTICAL&&this.drawVrtScale(a,c,f,d,b)};a.prototype.drawRndScale=function(b,a,c,d,f){var k=this.cx-this.strokeWidth/2,g=this.cy-this.strokeWidth/2,m=0,l=0;a-=b;0!=a&&(this.reverse?c<d&&(m=this.endAngle-(this.endAngle-this.startAngle)*(d-b)/a,l=this.endAngle-(this.endAngle-this.startAngle)*(c-b)/a):c<d&&(m=this.startAngle+(this.endAngle-this.startAngle)*(c-b)/a,l=this.startAngle+(this.endAngle-this.startAngle)*(d-b)/a));b=$c(this.cx,this.cy,k,g,this.startAngle,this.endAngle);k=$c(this.cx,
this.cy,k,g,m,l);this.svgRoundGeometry.bg&&(this.svgRoundGeometry.bg.setAttribute("d",b),"strokeWidth"===f&&this.svgRoundGeometry.bg.setAttribute("stroke-width",this.strokeWidth.toString()));this.svgRoundGeometry.fg&&(this.svgRoundGeometry.fg.setAttribute("d",k),"strokeWidth"===f&&this.svgRoundGeometry.fg.setAttribute("stroke-width",this.strokeWidth.toString()))};a.prototype.drawHrzScale=function(b,a,c,d,f){var k=0,g=0,m=0,l=0;a-=b;0!=a&&(0==this.reverse?(k=this.width*(c-b)/a,m=this.width*(d-b)/a):
(k=this.width-this.width*(c-b)/a,m=this.width-this.width*(d-b)/a),this.align==nb.TOP_OR_LEFT?(g=this.strokeWidth/2,l=this.strokeWidth/2):this.align==nb.BOTTOM_OR_RIGHT&&(g=this.height-this.strokeWidth/2,l=this.height-this.strokeWidth/2));this.svgLinearGeometry&&(this.svgLinearGeometry.setAttribute("x1",k.toString()),this.svgLinearGeometry.setAttribute("y1",g.toString()),this.svgLinearGeometry.setAttribute("x2",m.toString()),this.svgLinearGeometry.setAttribute("y2",l.toString()),"strokeWidth"==f&&
(this.svgLinearGeometry.setAttribute("stroke-width",this.strokeWidth.toString()),this.elem.style.height=this.strokeWidth+"px"))};a.prototype.drawVrtScale=function(b,a,c,d,f){var k=0,g=0,m=0,l=0;a-=b;0!=a&&(0==this.reverse?(g=this.height*(c-b)/a,l=this.height*(d-b)/a):(g=this.height-this.height*(c-b)/a,l=this.height-this.height*(d-b)/a),this.align==nb.TOP_OR_LEFT?(k=this.strokeWidth/2,m=this.strokeWidth/2):this.align==nb.BOTTOM_OR_RIGHT&&(k=this.width-this.strokeWidth/2,m=this.width-this.strokeWidth/
2));this.svgLinearGeometry&&(this.svgLinearGeometry.setAttribute("x1",k.toString()),this.svgLinearGeometry.setAttribute("y1",g.toString()),this.svgLinearGeometry.setAttribute("x2",m.toString()),this.svgLinearGeometry.setAttribute("y2",l.toString()),"strokeWidth"==f&&(this.svgLinearGeometry.setAttribute("stroke-width",this.strokeWidth.toString()),this.elem.style.width=this.strokeWidth+"px"))};a.prototype.setValue=function(b,c,h,d){d=!1;if(this.isBadValue(c,!1,h))return!1;switch(b){case "min":this.min!=
c&&(c>this.max&&(this.max=c),this.min=c,this._renderMask|=a._renderFlags.REDRAW,d=!0,this.sendUpdate(b,this.min,h));break;case "max":this.max!=c&&(c<this.min&&(this.min=c),this.max=c,this._renderMask|=a._renderFlags.REDRAW,d=!0,this.sendUpdate(b,this.max,h));break;case "alarmMax":this.alarmMax!=c&&(this.alarmMax=parseFloat(c),this._renderMask|=a._renderFlags.REDRAW,d=!0,this.sendUpdate(b,this.alarmMax,h));break;case "alarmMin":this.alarmMin!=c&&(this.alarmMin=parseFloat(c),this._renderMask|=a._renderFlags.REDRAW,
d=!0,this.sendUpdate(b,this.alarmMin,h));break;case "stroke-width":0>c&&(c=0);this.strokeWidth!=c&&(this.strokeWidth=parseFloat(c),this._renderMask|=a._renderFlags.STWIDTH,d=!0,this.sendUpdate(b,this.strokeWidth,h));break;case "startAngle":c>this.endAngle&&(c=this.endAngle);this.startAngle!=c&&(this.startAngle=parseFloat(c),this._renderMask|=a._renderFlags.REDRAW,d=!0);break;case "endAngle":c<this.startAngle?c=this.startAngle:360<c&&(c=360);this.endAngle!=c&&(this.endAngle=parseFloat(c),this._renderMask|=
a._renderFlags.REDRAW,d=!0);break;case "stroke":case "strokeColor":b="#000";this.stroke!=c&&(/^rgb\(\s*\d+,\s*\d+\s*,\s*\d+\s*\)$/.test(c)?b=c:"string"==typeof c&&0==c.indexOf("#")&&1<c.length&&8>=c.length&&(b=c),this.strokeColor=this.stroke=b,d=!0,this._renderMask|=a._renderFlags.STCOLOR);break;case "backgroundColor":b="#000";this.backgroundColor!=c&&(/^rgb\(\s*\d+,\s*\d+\s*,\s*\d+\s*\)$/.test(c)?b=c:"string"==typeof c&&0==c.indexOf("#")&&1<c.length&&8>=c.length&&(b=c),this.backgroundColor=b,d=!0,
this._renderMask|=a._renderFlags.STCOLOR);break;case "reverseScale":if(this.isBadValue(c,!1,h))return!1;c=parseInt(c);this.reverse!=c&&(this.reverse=c,d=!0,this._renderMask|=a._renderFlags.REDRAW,this.sendUpdate(b,this.reverse,h));break;case "visibility":l.prototype.setValue.call(this,"visibility",c,h);break;default:l.prototype.setValue.call(this,b,c,h)}d&&g.addToRender(this);return!0};a.prototype.setParentBounds=function(b,c,h,d,f){l.prototype.setParentBounds.call(this,b,c,h,d,f);this._renderMask|=
a._renderFlags.UPDATESVG;g.addToRender(this)};a.prototype.destroy=function(){return l.prototype.destroy.call(this)};a._renderFlags={REDRAW:1,STWIDTH:2,STCOLOR:4,UPDATESVG:8};a.jmType="ScaleWgt";return a}(l);Object.defineProperty(Dc.prototype,"form",{get:function(){return this._form},set:function(c){switch(c){case "vertical":this._form=Fa.VERTICAL;break;case "horizontal":this._form=Fa.HORIZONTAL;break;case "round":this._form=Fa.ROUND}}});g.fn.hmiScale=function(c,a,b,e){return new Dc(this,c,a,b,e)};
g.addWidgetDefinition("hmiScale",Dc);var fc=function(c){function a(b,a,h,d,f){b=c.call(this,b.wgtId,a,h,d,f)||this;b._fontRenderMask=0;return b}p(a,c);Object.defineProperty(a.prototype,"lang",{get:function(){this._lang||(this._lang=this.parentPage.getExportedLanguage());return this._lang},set:function(b){this._lang=b},enumerable:!1,configurable:!0});a.prototype.render=function(){c.prototype.render.call(this);this._fontRenderMask&a._fontRenderFlags.FONT_STYLE_UPDATE&&this.updateFontStyles();this._fontRenderMask=
0;return!0};a.prototype.hasDynamicVariables=function(){return this.variablesMap&&"undefined"!==typeof this.variablesMap&&"undefined"!==typeof this.__texts};a.prototype.textCanContainsVariables=function(b){return"string"===typeof b&&b.includes("[")&&b.includes("]")};a.prototype.textsCanContainsVariables=function(b){var a=this;return b.some(function(b){return a.textCanContainsVariables(b)})};a.prototype.dynamicVariablesArePresent=function(){return null!==this.variablesMap};a.prototype.variablesAreInitialized=
function(){return"undefined"!==typeof this.variablesState&&null!==this.variablesState};a.prototype.parseNewTextVariables=function(b,a,c){void 0===a&&(a=!0);void 0===c&&(c=-1);this.unloadAllVariables();var d=this.textLiveTagParser;void 0===d&&(d=this.textLiveTagParser=new (g.import("TextLiveTagParser.ts")));for(var f={},k={},q,m=0;m<b.length;m++){var l=b[m];"undefined"!==typeof l&&(q=b.indexOf(l),f[q]=d.parseTextVariables(l,this.lang),k[q]=d.getVariablesMap(),q=d.getVariables())}q?(this.__texts=f,
this.variables=q,this.variablesMap=k,null!=this.variablesMap&&a&&this.loadEmbeddedTagDataLinks(c,!0)):(this.prepareTextToRender(f),this.renderText())};a.prototype.loadDynamicTagsForText=function(b,a){this.hasDynamicVariables()&&this.loadEmbeddedTagDataLinks(b,a)};a.prototype.loadEmbeddedTagDataLinks=function(b,a){var c=this;if(-1===b){var d=function(b){Be.of(f.variablesMap[b][f.lang]).map(function(d){c.createDataLinksForText(parseInt(b),d,a);return d})},f=this,k;for(k in this.__texts)d(k)}else this.variablesMap[b]&&
this.createDataLinksForText(b,this.variablesMap[b][this.lang],a);this.renderText()};a.prototype.createDataLinksForText=function(b,a,c){for(var d=0;d<a.length;d++){var f=a[d];this.addDataLinkToTextVariable(b,f,this.variables[f],c)}};a.prototype.unloadDynamicDataLinks=function(){if(this.variablesState)for(var b in this.variablesState){var a=this.variablesState[b].link;a&&a.unmount().destroy();this.variablesState[b].link=null}};a.prototype.unloadAllVariables=function(){if(this.variablesState){for(var b in this.variablesState){var a=
this.variablesState[b].link;a&&a.unmount().destroy()}this.variablesState=null}this.__texts=this.variablesMap=null};a.prototype.addDataLinkToTextVariable=function(b,c,h,d){h=!1;var f=null;if(void 0===this.variablesState||null===this.variablesState)this.variablesState={};(f=this.variablesState[c])?null==f.link?(f.link=g.createDataLink(this,null,null).readFromStringAndSetTarget(this.variables[c],this,c,a.defaultFormats).mount().update(),null!==f.value&&this.updateVariableInTexts(c,b),h=!0):(f.pos[b]||
(f.pos[b]=this.getVariableOccurrencesInText(b,c)),null!==f.value&&(this.updateVariableInTexts(c,b),this.prepareTextToRender(this.getValueOfAllDynamicTexts()))):(f=g.createDataLink(this,null,null).readFromStringAndSetTarget(this.variables[c],this,c,a.defaultFormats).mount(),this.variablesState[c]={link:f,value:void 0,pos:{}},this.variablesState[c].pos[b]=this.getVariableOccurrencesInText(b,c),this.variablesState[c].link.update(),null!==this.variablesState[c].value&&this.updateVariableInTexts(c,b),
h=!0);h&&d&&this.variablesState[c].link.subscribeForDatasourceNotification()};a.prototype.getVariableOccurrencesInText=function(b,a){var c=this.__texts[b],d=c.indexOf(a),f=[];do f.push(d),d=c.indexOf(a,d+a.length);while(-1!=d);return f};a.prototype.parseColor=function(b,a){return/(?:#|0x)(?:[a-f0-9]{3}|[a-f0-9]{6})\b|(?:rgb|hsl)a?\([^\)]*\)/.test(b)?b:a||"#000000"};a.prototype.updateVariable=function(b,a){var c=this.variablesState[b];return c&&c.value!==a?(c.value=a,!0):!1};a.prototype.setValue=function(b,
e,h,d){var f=!1;if(this.isBadValue(e,!0,h))return!1;switch(b){case "font-bold":this.fontBold!=e&&(f=!0,this.fontBold=e,this.sendUpdate(b,this.fontBold,h,null));break;case "fill":case "fontColor":this.fontColor!=e&&(f=!0,this.fontColor=this.parseColor(e),this.sendUpdate(b,this.fontColor,h,null));break;case "font-family":case "fontFamily":this.fontFamily!=e&&(f=!0,this.fontFamily=e,this.sendUpdate(b,this.fontFamily,h,null));break;case "font-size":case "fontSize":this.fontSize!=e&&(e=1>parseInt(e)?1:
parseInt(e),f=!0,this.fontSize=e,this.sendUpdate(b,this.fontSize,h,null));break;case "font-style":this.fontStyle!=e&&(f=!0,this.fontStyle=e,this.sendUpdate(b,this.fontStyle,h,null));break;case "font-underline":this.fontUnderline!=e&&(f=!0,this.fontUnderline=e,this.sendUpdate(b,this.fontUnderline,h,null));break;default:c.prototype.setValue.call(this,b,e,h,d)}f&&(this._fontRenderMask|=a._fontRenderFlags.FONT_STYLE_UPDATE,g.addToRender(this));return!0};a.prototype.getValue=function(b,a){var h;switch(b){case "font-bold":h=
this.fontBold;break;case "fill":case "font-color":h=this.fontColor;break;case "font-family":h=this.fontFamily;break;case "font-size":h=this.fontSize;break;case "font-style":h=this.fontStyle;break;case "font-underline":h=this.fontUnderline;break;default:h=c.prototype.getValue.call(this,b,a)}return h};a.prototype.updateVariableInTexts=function(b,a){var c=!1;if(this.variablesState[b])if(-1==a){var d=this.variablesState[b].pos,f;for(f in d){var k=d[f];this.updateVariableInText(b,parseInt(f),k)&&!c&&(c=
!0)}}else void 0!=this.variablesState[b].pos[a]&&(c=this.updateVariableInText(b,a,this.variablesState[b].pos[a]));return c};a.prototype.updateVariableInText=function(b,a,c){if(c){for(var d=!1,f=0,k=c.length;f<k;f++){var g=c[f];0<=g&&(d=this.variablesState[b].value,this.__texts[a][g]=null===d||void 0===d?"NaN":d,d=!0)}return d}return!0};a.prototype.varToTagName=function(b,a){return"string"==typeof b&&"$"==b.charAt(0)&&"{"==b.charAt(1)&&"}"==b.charAt(b.length-1)?"["+a[b]+"]":b};a.prototype.getValueOfDynamicText=
function(b){var a=this;return this.__texts[b].map(function(b){return a.varToTagName(b,a.variables)}).join("")};a.prototype.getValueOfAllDynamicTexts=function(){var b=this,a={},c;for(c in this.__texts)a[c]=this.__texts[c].map(function(a){return b.varToTagName(a,b.variables)}).join("");return a};a.prototype.isVariableATagInCache=function(b){b=this.variables[b];var a=b.lastIndexOf("[");-1!=a&&0<a-1&&"\\"!=b.charAt(a-1)&&(b=b.substring(0,a));return b?g.activeProject.hasTagInCache(b):!1};a.prototype.isLiveTagsEnabled=
function(){return this.liveTags};a.prototype.allowUpdateLanguageOnProps=function(b){if(this.isClone)return!0;for(var a=this.lang!=this.getPageMLTextMgr().getCurrentLanguage(),c=0;c<b.length;c++)if(this["has"+b[c]+"PropInDatalinks"])return!1;return this.isMl&&a};a.prototype.renderText=function(){};a.prototype.prepareTextToRender=function(b){return!1};a._fontRenderFlags={FONT_STYLE_UPDATE:2};a.defaultFormats=[{feature:'format("#.000000")',tagType:7},{feature:'format("#.000000")',tagType:8}];return a}(l);
g.addWidgetDefinition("hmiTextBasedWidget",fc);var xa;(function(c){c[c.NONE=0]="NONE";c[c.CURRENT=1]="CURRENT";c[c.ALL=2]="ALL"})(xa||(xa={}));var gc=function(c){function a(b,a,h,d,f){b=c.call(this,b,a,h,d,f)||this;b.updatingMessagesLanguage=!1;b.setDefaultState();b._renderMask=0;b.addActivationHandler();b.authCode=b.getAuthorizations();b.numStates=b.getSpanElems().length;b.initDataIdxToIdxMap();b.isClone&&b.removeSelectricDOM();b.invokablePropsList=["fill","fontColor"];return b}p(a,c);a.prototype.removeSelectricDOM=
function(){var b=this.elem.querySelector(".selectric");b&&b.remove()};a.prototype.addActivationHandler=function(){var b=this,a=g.getEventMgr();a&&(this.activateHandler=function(){b.isLiveTagsEnabled()&&b.hasDynamicVariables()?(b.hasInputKeyboardEnabled()&&(b.dynamicTagMode=xa.ALL),b.dynamicTagMode==xa.CURRENT?b.loadDynamicTagsForText(b.value):b.loadDynamicTagsForText(-1),b.project.getTagMgr().subscribeDynamicTags()):b.dynamicTagMode=xa.NONE},this.deactivateHandler=function(){b.isLiveTagsEnabled()&&
b.hasDynamicVariables()&&b.unloadDynamicDataLinks();b._hideCombobox()},a.on(this.parentPage.elem,"loadWgt",this.activateHandler),a.on(this.parentPage.elem,"unloadWgt",this.deactivateHandler))};a.prototype.setDefaultState=function(){this.value=void 0===this.value?null:this.value;this.numStates=void 0===this.numStates?0:this.numStates;this.messages=void 0===this.messages?null:this.messages;this.permission=void 0===this.permission?"rw":this.permission;this.editable=void 0===this.editable?!1:this.editable;
this.comboBoxStatus=void 0===this.comboBoxStatus?0:this.comboBoxStatus;this.mlAttributeLinked=void 0===this.mlAttributeLinked?!1:this.mlAttributeLinked;this.frameFill=void 0===this.frameFill?"transparent":this.frameFill;this.fontBold=void 0===this.fontBold?!1:this.fontBold;this.fontUnderline=void 0===this.fontUnderline?!1:this.fontUnderline;this.fontSize=void 0===this.fontSize?null:this.fontSize;this.fontFamily=void 0===this.fontFamily?"":this.fontFamily};a.prototype.getSpanElems=function(){return this.elem.getElementsByTagName("span")};
a.prototype.initDataIdxToIdxMap=function(){this.dataIdxToIdx={};for(var b=this.getSpanElems(),a=0;a<b.length;a++){var c=b[a];null!=c&&(c=parseInt(c.getAttribute("data-idx")),isNaN(c)||(this.dataIdxToIdx[c]=a))}};a.prototype.applyHorizontalTextAlignment=function(){if(this.elem&&this.align){switch(this.align){case "left":this.elem.classList.remove("jm-align-center","jm-align-right");break;case "center":this.elem.classList.remove("jm-align-left","jm-align-right");break;case "right":this.elem.classList.remove("jm-align-left",
"jm-align-center")}this.elem.classList.add("jm-align-"+this.align)}};a.prototype.applyVerticalTextAlignment=function(){if(this.elem&&this.valign){switch(this.valign){case "middle":this.elem.classList.remove("jm-align-top","jm-align-bottom");break;case "top":this.elem.classList.remove("jm-align-middle","jm-align-bottom");break;case "bottom":this.elem.classList.remove("jm-align-top","jm-align-middle")}this.elem.classList.add("jm-align-"+this.valign)}};a.prototype.disableAllTextAlignmentOnComboWrapper=
function(){this.elem&&this.elem.classList.remove("jm-align-top","jm-align-middle","jm-align-bottom","jm-align-left","jm-align-center","jm-align-right")};a.prototype.render=function(){c.prototype.render.call(this);this._renderMask&a._renderFlags.INITWRAP&&(g.browserOptimizations.forceLayers&&($(this.elem).hasClass("jm-hacklayer")||$(this.elem).addClass("jm-hacklayer")),this._createNode(),this._attachEvents());if(this._renderMask&a._renderFlags.VALUE&&0<this.numStates){for(var b=this.getSpanElems(),
e=0;e<b.length;e++)b[e].style.display=e==this.dataIdxToIdx[this.value]?"block":"none";this.combowrap&&this.updateWrapper()}this._renderMask&a._renderFlags.MSGES&&1!=this.comboBoxStatus&&this.setGroupMessages();this._renderMask&a._renderFlags.FRCOLOR&&(this.elem.style.backgroundColor=this.frameFill);this._renderMask&a._renderFlags.ALIGN&&this.applyHorizontalTextAlignment();this._renderMask&a._renderFlags.VALIGN&&this.applyVerticalTextAlignment();this._renderMask&a._renderFlags.UPDATEWRAP&&(this.closeBtn&&
this.closeBtn.updateBounds(),this.combowrap&&this.combowrap.updateCustomSelectricSize(),this.combowrap&&this.combowrap.updateCloneBounds());this._renderMask&L._renderFlags.FRAME&&(this.frame?(this.elem.style.border=this.frameSize+"px solid "+this.frameColor,this.elem.style["background-color"]=this.frameFill):(this.elem.style.border="",this.elem.style["background-color"]=""));this._renderMask=0;return!0};a.prototype.updateSelectedIndex=function(){this.select.selectedIndex=null!=this.dataIdxToIdx[this.value]?
this.dataIdxToIdx[this.value]:-1};a.prototype.validateColor=function(b){return void 0==b?!1:0==b.indexOf("#")&&1<b.length&&8>=b.length||"r"===b.charAt(0)&&"g"===b.charAt(1)&&"b"===b.charAt(2)?!0:!1};a.prototype.renderText=function(){this._renderMask|=a._renderFlags.VALUE;this._renderMask|=a._renderFlags.MSGES;g.addToRender(this)};a.prototype.setValue=function(b,e,h,d){var f=this,k=!1;c.prototype.setValue.call(this,b,e,h,d);if("value"==b){if(this.isBadValue(e,!1,h))return!1;e=parseFloat(e);if(isNaN(e))return!1;
this.value!=e&&(this.value=e,this.select&&this.updateSelectedIndex(),this.isLiveTagsEnabled()&&this.dynamicTagMode==xa.CURRENT&&this.loadDynamicTagsForText(this.value,!0),this._renderMask|=a._renderFlags.VALUE,k=!0,this.sendUpdate(b,this.value,h))}else if("messages"==b){if(this.messages!=e){k=function(b,a){var c=function(b){var a=0;f.dataIdxToIdx={};f.messages=[];for(var c in b)f.dataIdxToIdx[Number(c)]=a++,f.messages.push(b[c])},e=function(b){f.messages=b;if(!f.updatingMessagesLanguage)for(f.dataIdxToIdx=
[],b=0;b<f.messages.length;b++)f.dataIdxToIdx[b]=b};switch(a){case 0:e(b.split(","));break;case 1:e(b);break;case 2:c(b)}};"string"==typeof e?k(e,0):e instanceof Array?k(e,1):e instanceof Object?k(e,2):this.messages=[""];this.isLiveTagsEnabled()&&this.textsCanContainsVariables(this.messages)?(this.parseNewTextVariables(this.messages),k=this.prepareTextToRender(this.getValueOfAllDynamicTexts())):this.isLiveTagsEnabled()&&this.dynamicVariablesArePresent()&&this.unloadAllVariables();if(this.textsCanContainsVariables(this.messages))switch(this.parseNewTextVariables(this.messages,
!1),this.dynamicTagMode){case xa.CURRENT:this.loadDynamicTagsForText(this.value,!0);break;case xa.ALL:this.loadDynamicTagsForText(-1,!0)}this._renderMask|=a._renderFlags.MSGES;k=!0;this.sendUpdate(b,this.messages instanceof Array?this.messages.join(","):this.messages,h)}}else if("fill"==b||"fontColor"==b)this.fill!=this.fontColor&&(this.fill=this.fontColor);else if("align"==b){if(this.align===e)return!1;this.align!=e&&(this.align=e,k=!0,this._renderMask|=a._renderFlags.ALIGN,this.sendUpdate(b,e,h))}else if("valign"==
b){if(this.valign===e)return!1;this.valign!=e&&(this.valign=e,k=!0,this._renderMask|=a._renderFlags.VALIGN,this.sendUpdate(b,e,h))}else if("frame"==b){if(this.isBadValue(e,!1,h))return!1;e=parseFloat(e);this.frame!=e&&(this.frame=e,this._renderMask|=L._renderFlags.FRAME,k=!0,this.sendUpdate(b,this.frame,h))}else if("frameColor"==b)isNaN(e)?this.isBadValue(e,!0,h)?(this.frameColor="#000",k=!0):this.frameColor!=e&&(this.frameColor=this.validateColor(e)?e:"#000",this._renderMask|=L._renderFlags.FRAME,
k=!0,this.sendUpdate(b,this.frameColor,h)):(this.frameColor="#000",this._renderMask|=L._renderFlags.FRAME,k=!0);else if("frameSize"==b){if(this.isBadValue(e,!1,h))return!1;e=parseFloat(e);1>e&&(e=1);e!=this.frameSize&&(this.frameSize=e,this._renderMask|=L._renderFlags.FRAME,k=!0,this.sendUpdate(b,this.frameSize,h))}else if("frameFill"==b)isNaN(e)&&void 0!=e?this.isBadValue(e,!0,h)?(this.frameFill="#000",k=!0):this.frameFill!=e&&(this.frameFill=this.validateColor(e)?e:"#000",this._renderMask|=L._renderFlags.FRAME,
k=!0,this.sendUpdate(b,this.frameFill,h)):(this.frameFill="#000",this._renderMask|=L._renderFlags.FRAME,k=!0);else if(this.isLiveTagsEnabled()&&0==b.indexOf("${")&&this.variablesAreInitialized()){if(this.isVariableATagInCache(b)&&this.isBadValue(e,!0,h),this.updateVariable(b,e)){e=!1;switch(this.dynamicTagMode){case xa.CURRENT:e=this.updateVariableInTexts(b,this.value);break;case xa.ALL:e=this.updateVariableInTexts(b,-1)}e&&(k=this.prepareTextToRender(this.getValueOfAllDynamicTexts()))}}else c.prototype.setValue.call(this,
b,e,h,d);k&&g.addToRender(this);return!0};a.prototype.prepareTextToRender=function(b){null==this.messages&&(this.messages=[]);for(var c in b)this.messages[this.dataIdxToIdx[c]]=b[c];this._renderMask|=a._renderFlags.MSGES;return!0};a.prototype.setGroupMessages=function(){var b=[];if(void 0!=this.messages){var a;a=this.messages;1<a.length?b=a.slice(0):"null"==a[0]?b.push(" "):b.push(a[0]);a=this.getSpanElems();for(var c=Object.keys(this.dataIdxToIdx),d=0;d<b.length;d++)if(a[d])a[d].setAttribute("data-idx",
c[d].toString()),a[d].innerHTML=b[d];else{var f=a[d-1].cloneNode(!1);f.setAttribute("data-idx",c[d].toString());f.innerHTML=b[d];this.elem.appendChild(f)}this.numStates=a.length;for(c=0;c<a.length;c++)a[c].style.display=c==this.dataIdxToIdx[this.value]?"block":"none";this.numStates!=b.length&&this.rmUnusedSpan(this.numStates-b.length);this.updateMsgSelect()}};a.prototype.rmUnusedSpan=function(b){for(var a=0;a<b;a++)$("span:last-child",this.elem).remove();this.numStates=this.getSpanElems().length;
this.setValue("value",this.value,null)};a.prototype.updateMsgSelect=function(){this.editable&&($(this.select).remove(),this._hideCombobox(),this.combowrap&&this.combowrap.removeWrapper(),this._createNode())};a.prototype.getValue=function(b){switch(b){case "viewindex":b=this.viewindex;break;case "messages":b=this.messages instanceof Array?this.messages.join(","):this.messages;break;default:b=l.prototype.getValue.call(this,b)}return b};a.prototype.getText=function(b){return this.getPageMLTextMgr().getText(b,
this)};a.prototype.updateLanguage=function(){if(this.allowUpdateLanguageOnProps(["Messages"])){var b=this.getPageMLTextMgr(),a=b.getCurrentFont(),b=b.getCurrentLanguage(),c=Array(this.mlIds.length),d=void 0;this.mlMap&&(d=this.mlMap[b]);void 0!=d&&(a=d);this.elem.style.fontFamily!=a&&(this.elem.style.fontFamily=a);if(this.isDynamicLinkedProperty("messages"))this.renderText();else if(null!=c&&(this.lang!=b||this.isClone)){a=0;for(d=this.mlIds.length;a<d;a++)c[a]=this.getText(String(this.mlIds[a]));
this.lang=b;this.messages!=c?(this.updatingMessagesLanguage=!0,this.setValue("messages",c,null),this.updatingMessagesLanguage=!1):this.renderText()}}};a.prototype._createNode=function(){var b=this,a,c,d,f,k;this.select=document.createElement("select");for(var g=this.getSpanElems(),m=0;m<this.numStates;m++)k="",c=g[m],d=document.createElement("option"),f=document.createElement("p"),a=parseInt(c.getAttribute("data-idx")),this.viewindex&&(k=""+a+" - "),k+=c.textContent,a=document.createTextNode(k),f.appendChild(a),
d.appendChild(f),this.select.appendChild(d);this.select.selectedIndex=this.value;this._isNativeSelectCompatible()?this.authCode!=this.getWidgetAuthorizationCodes().RDONLY&&(this.combowrap=new P(this),this.closeBtn=new Ub(this),$(this.closeBtn.elem).on("touchstart click",function(a){a.stopPropagation();b._hideCombobox()}),this.updateWrapper(),this.combowrap.hideWrapper(),this.combowrap.bindEvents()):(this._attachChangeEvent(),this.select.setAttribute("style","position:absolute;width:"+(this.width+
2)+"px;height:"+(this.height+2)+"px;left:-1px;top:-1px;z-index:9999;display:none"),$(this.elem).prepend(this.select))};a.prototype._showCombobox=function(){this._detachEvents();this._closeOpenedSelect();this._isNativeSelectCompatible()?(this.combowrap.showWrapper(),this._addCloseButton()):this.select.style.display="block";this.comboBoxStatus=1};a.prototype._hideCombobox=function(){0!=this.comboBoxStatus&&(this._attachEvents(),this._isNativeSelectCompatible()?(this.combowrap.detachClone(),this.combowrap.hideWrapper(),
this._removeCloseButton()):this.select.style.display="none",this.comboBoxStatus=0)};a.prototype._addCloseButton=function(){this.closeBtn.updateBounds();this.parentWidget instanceof Pa?this.parentWidget.appendToScrollContent(this.closeBtn.elem):this.parentWidget.elem.appendChild(this.closeBtn.elem)};a.prototype._removeCloseButton=function(){this.closeBtn&&$(this.closeBtn.elem).detach()};a.prototype._attachEvents=function(){this.events={mousedown:!0,touchstart:!0}};a.prototype._detachEvents=function(){this.events=
{mousedown:!1,touchstart:!1}};a.prototype.hasInputKeyboardEnabled=function(){return this.authCode!=this.getWidgetAuthorizationCodes().RDONLY&&"r"!=this.permission&&!this.disabled};a.prototype.doMouseUp=function(b,a){a.preventDefault();if(this.authCode==this.getWidgetAuthorizationCodes().RDONLY||"r"==this.permission||this.disabled)return!1;this._showCombobox();return!0};a.prototype.doMouseDown=function(b,a){a.preventDefault();return"r"==this.permission||this.disabled?!1:this.authCode==this.getWidgetAuthorizationCodes().RDONLY?
(this.project.getValue("onAccessDenied")&&this.showHideAccessDeniedIcon(),!1):!0};a.prototype.addDataLink=function(b){l.prototype.addDataLink.call(this,b);"value"==b.attr&&this.hasPropInDatalinks("Value");"messages"==b.attr&&this.hasPropInDatalinks("Messages");b.tgtWgt==this&&this.initDataLinkSideEffects(b,b.attr)};a.prototype.initDataLinkSideEffects=function(b,c){if("value"==c)if("r"==b.rw||"Formula"==b.srcType)this.permission="r";else if(this.authCode==this.getWidgetAuthorizationCodes().FULL||this.authCode==
this.getWidgetAuthorizationCodes().DEFAULT)this.editable=!0,this._renderMask|=a._renderFlags.INITWRAP,g.addToRender(this),this.hasInputKeyboardEnabled()&&(this.dynamicTagMode=xa.ALL,this.loadDynamicTagsForText(-1))};a.prototype._attachChangeEvent=function(){var b=this;$(this.select).change(function(a){b.select.selectedIndex!=b.value&&(b.setValue("value",b.select.selectedIndex,null,null),b.doWriteValue("value",b.select.selectedIndex),b._hideCombobox())})};a.prototype.onChange=function(b){b=this.getSpanElems()[b].getAttribute("data-idx");
this.setValue("value",parseInt(b),null,null);this.doWriteValue("value",parseInt(b));this._hideCombobox()};a.prototype.onClose=function(){this.combowrap&&this.combowrap.detachClone()};a.prototype.updateWrapper=function(){this.updateSelectedIndex();this.combowrap.update(this.select.selectedIndex)};a.prototype._closeOpenedSelect=function(){var b=this.parentPage,c;for(c in b.wgts)b.wgts[c].constructor==a&&b.wgts[c].elem.id!=this.elem.id&&b.wgts[c]._hideCombobox()};a.prototype.setParentBounds=function(b,
e,h,d,f){c.prototype.setParentBounds.call(this,b,e,h,d,f);this._isNativeSelectCompatible()&&(this._renderMask|=a._renderFlags.UPDATEWRAP,g.addToRender(this))};a.prototype.destroy=function(){if(this.destroyed)return!1;this.combowrap&&(this.combowrap.removeObjects(),delete this.combowrap);this._isNativeSelectCompatible()&&this._removeCloseButton();this._detachEvents();return l.prototype.destroy.call(this)};a.prototype.updateFontStyles=function(){this.elem&&(this.elem.style.color=this.fill,this.elem.style.fontFamily=
this.fontFamily,this.elem.style.fontSize=this.fontSize+"px",this.elem.style.fontStyle=this.fontStyle,this.elem.style.fontWeight=this.fontBold?"bold":"normal",this.elem.style.textDecoration=this.fontUnderline?"underline":"initial")};a.jmType="MsgTextWgt";a._renderFlags={VALUE:1,MSGES:2,INITWRAP:4,UPLANG:8,CREATEBTN:16,FRCOLOR:32,ALIGN:64,VALIGN:128,UPDATEWRAP:256,FRAME:512};return a}(fc);g.fn.hmiMsgText=function(c,a,b,e){return new gc(this,c,a,b,e)};g.addWidgetDefinition("hmiMsgText",gc);var Qa;(function(c){c[c.BMP=
1]="BMP";c[c.SVG=0]="SVG";c[c.CORRUPT=-1]="CORRUPT"})(Qa||(Qa={}));var td=function(c){function a(b,e,h,d,f){b=c.call(this,b.wgtId,e,h,d,f)||this;b.setDefaultState();b._svgUse=b.elem.getElementsByTagName("use")[0];e=null!==b.elem.getAttribute("data-frame")?parseInt(b.elem.getAttribute("data-frame")):b.value||0;b._imgRef=b.images[b.continuos?0>e?0:e%b.numStates:e];e!=b.value&&(b._renderMask|=a._renderFlags.VALUE,g.addToRender(b));return b}p(a,c);a.prototype.setDefaultState=function(){this.value=void 0===
this.value?null:this.value;this.numStates=void 0===this.numStates?null:this.numStates;this.images=void 0===this.images?null:this.images;this._imgRef=void 0===this._imgRef?null:this._imgRef;this._svgUse=void 0===this._svgUse?null:this._svgUse;this.animate=void 0===this.animate?!1:this.animate;this.updateRate=void 0===this.updateRate?1E3:this.updateRate;this.animTimer=void 0===this.animTimer?null:this.animTimer;this.animValue=void 0===this.animValue?-1:this.animValue;this._renderMask=0};a.prototype.render=
function(){c.prototype.render.call(this);var b;this._renderMask&a._renderFlags.VALUE&&(b=this._changeImage(this.value),null!==b&&this.elem.setAttribute("data-frame",b));this._renderMask&a._renderFlags.ANIMATE&&(b=this._changeImage(this.animValue),null!==b&&this.elem.setAttribute("data-frame",b));this._renderMask=0};a.prototype.setOptions=function(b){null!=b&&(l.prototype.setOptions.call(this,b),void 0!=b.value&&this.setValue("value",b.value,null),void 0!=b.updateRate&&(this.animInterval=parseInt(b.updateRate)),
void 0!=b.animate&&(this.animate=b.animate)&&this.startAnimation())};a.prototype.animateImages=function(){var b=this.animValue+1;this.animValue=b=b>=this.numStates?0:b;this._renderMask|=a._renderFlags.ANIMATE;g.addToRender(this);this.animate&&this.startAnimation()};a.prototype.startAnimation=function(){var b=this;this.animTimer=window.setTimeout(function(){b.animateImages()},this.updateRate)};a.prototype.stopAnimation=function(){clearTimeout(this.animTimer)};a.prototype.setValue=function(b,c,h,d){if(this.isBadValue(c,
!1,h))return!1;if("value"==b||"frame"==b){c="boolean"==typeof c?!0===c?1:0:parseFloat(c);if(isNaN(c))return!1;this.value!=c&&(this.value=c,this.animate&&(this.animValue=c),this._renderMask|=a._renderFlags.VALUE,g.addToRender(this))}else if("animate"==b){c=parseFloat(c);if(isNaN(c))return!1;this.animate!=c&&(0==c?(this.animate=!1,this.stopAnimation()):(this.animate=!0,0<this.updateRate&&this.startAnimation()),this.sendUpdate(b,c,h))}else if("updateRate"==b){c=parseFloat(c);if(isNaN(c))return!1;0>c&&
(c=0);this.updateRate!=c&&(this.updateRate=c,this.stopAnimation(),this.animate&&0!=c&&this.startAnimation(),this.sendUpdate(b,c,h))}else l.prototype.setValue.call(this,b,c,h,d);return!0};a.prototype.getValue=function(b){return"value"==b||"frame"===b?this.value:l.prototype.getValue.call(this,b)};a.prototype._changeImage=function(b){b=this.continuos?0>b?0:b%this.numStates:b;var a=this.images[b];if(!a)return null;var c=this._imgRef&&this._imgRef[Qa.BMP],d=this._imgRef&&this._imgRef[Qa.SVG];c?this.elem.classList.remove(c):
d&&(this._svgUse.style.opacity="0");a[Qa.BMP]?this.elem.classList.add(a[Qa.BMP]):a[Qa.SVG]&&(this._svgUse.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","#"+a[Qa.SVG]),this._svgUse.style.opacity="1");this._imgRef=a;return b};a.prototype.destroy=function(){if(this.destroyed)return!1;this._imgRef=this._svgUse=this.images=null;this.animate&&this.stopAnimation();return c.prototype.destroy.call(this)};a._renderFlags={VALUE:1,ANIMATE:2};a.jmType="MultiStateImageWgt";return a}(l);g.fn.hmiMultiStateImage=
function(c,a,b,e){return new td(this,c,a,b,e)};g.addWidgetDefinition("hmiMultiStateImage",td);var ud=function(c){function a(b,a,h,d,f){b=c.call(this,b.wgtId,a,h,d,f)||this;b.setDefaultState();b.value=[];b.quality={};b.alarmMgr=g.activeProject.getWidget("_AlarmsMgr",!0);b.tableWgt=f;b.tableIdx=b.tableWgt.addColumnWgt(b);return b}p(a,c);a.prototype.setDefaultState=function(){this.colType=void 0===this.colType?0:this.colType;this.hasChanged=void 0===this.hasChanged?!0:this.hasChanged;this.dataLinkTag=
void 0===this.dataLinkTag?null:this.dataLinkTag;this.dataLinkSrc=void 0===this.dataLinkSrc?null:this.dataLinkSrc;this.visibility=void 0===this.visibility?!0:this.visibility;this.length=void 0===this.length?0:this.length;this.hasQuality=void 0===this.hasQuality?!1:this.hasQuality;this.numberFormat=void 0===this.numberFormat?"DD/MM/YYYY hh:mm:ss":this.numberFormat};a.prototype.render=function(){this._baseRenderMask&this._baseRenderFlags.VISIBLE&&(this.visible?this.elem.style.display="":(this.elem.style.display=
"none",this.tableWgt.hideColumn(this.tableIdx)));this._baseRenderMask&=~this._baseRenderFlags.VISIBLE;l.prototype.render.call(this)};a.prototype.addDataLink=function(b){c.prototype.addDataLink.call(this,b);this.initDataLinkSideEffects(b,b.getAttribute())};a.prototype.initDataLinkSideEffects=function(b,a){"value"==a&&(this.dataLinkTag=b.getTag(),this.dataLinkSrc=b.getDataSrc(),this.getDataFromSource(b.getTag()))};a.prototype.getDataFromSource=function(b){if("AlarmsMgrWgt"==this.dataLinkSrc.getJMType()){if(this.dataLinkSrc.isDataReady()){var a=
t.getModule("Tag"),c=this.dataLinkSrc.getDataValues(b);"undefined"!=typeof c&&(this.setValue("value",c,a.QUALITY_GOOD,-1),"alEnable"!=b||this.hasQuality||(this.quality=this.dataLinkSrc.getDataValuesQuality(b),this.hasQuality=!0));this.tableWgt.columnReady()}}else this.tableWgt.columnReady()};a.prototype.getDataReference=function(b){return this.dataLinkSrc.getAlarmNameByIndex(b)};a.prototype.getTagLinkedToValue=function(){return this.dataLinkTag};a.prototype.getSrcLinkedToValue=function(){return this.dataLinkSrc};
a.prototype.getValue=function(b,a){var h;return"value"==b?(-1==a?h=this.value:this.value instanceof Array?(h=this.value[a],this.dataLinkSrc&&"AlarmsMgrWgt"==this.dataLinkSrc.getJMType()&&(h=this._replaceLiveData(h,a))):h=this.value,h):"width"==b?this.width:c.prototype.getValue.call(this,b)};a.prototype._replaceLiveData=function(b,a){if("string"==typeof b&&"alDescription"==this.dataLinkTag){var c=this.alarmMgr.getAlarmByIndex(a),d=c.liveData.d,c=c.liveTags,f=this.parentPage.getPageMLTextMgr().getCurrentLanguage(),
d="string"==typeof d[f]?d[d[f]]:d[f];if(null==d)return b;for(var f=null==c?0:c.length,k=0,g=d.length;k<g;k++){var m=new RegExp("\\[\\$"+k+"\\:[-]?\\d*\\]","g"),l=-1,p=b.search(m);if(-1!=p)var l=b.indexOf(":"),r=b.indexOf("]"),l=parseInt(b.substring(l+1,r));r="";-1!=p&&k<f&&(t.getModule("Tag"),r=""===c[k]&&l!=v.STRING?"nan":c[k]);b=b.replace(m,this.formatValue(r,d[k]))}}return b};a.prototype.applyTrasformation=function(b,a){var c=a.indexOf("("),d=a.indexOf(")");if(-1!=c&&-1!=d){var f=a.substring(0,
c),c=a.substring(c+1,d),f=new (g.getActiveProject().getWidgetDefinition("hmi"+f));b=f.execute(null,b,"w",f.getParametersFromString(c))}else-1!=a.indexOf("#")&&(f=g.import("TextFormatUtil"),b=f.format(f.parseFormat(a),b,null,!1));return b};a.prototype.formatValue=function(b,a){var c=$b.parseString(a);"nan"!==b&&(0!=c.elemList.length||isNaN(b)||0==b%1||(c.elemList=['format("#.000000")']),b=c.elemList.reduce(this.applyTrasformation,b));return b};a.prototype.isEmpty=function(){return 0==this.length};
a.prototype.updateStyle=function(b){!b.longDateFormat&&!b.shortDateFormat||"SHORT-DATE"!=this.numberFormat&&"LONG-DATE"!=this.numberFormat||(this.tableWgt.refreshRequest(),this.hasChanged=!0)};a.prototype.setValue=function(b,a,h,d){if("value"==b)void 0!==d&&(-1==d||a instanceof Array?a instanceof Array?this.value=a:(this.value=a,this.tableWgt.refreshRequest()):this.value&&(this.value[d]=a,"undefined"!=typeof a&&"undefined"!=typeof h&&"number"==typeof d&&(this.quality[d]=h,this.hasQuality=!0)),this.value&&
(this.length=this.value.length)),this.hasChanged=!0;else return c.prototype.setValue.call(this,b,a,h,d);return!0};a.prototype.getQuality=function(b){var a=this.dataLinkSrc.getAlarmNameByIndex(b);return null!=this.dataLinkSrc.getAlarmByName(a).alRemoteEnable&&this.hasQuality?this.quality[b]:t.getModule("Tag").QUALITY_GOOD};a.prototype.destroy=function(){if(this.destroyed)return!1;this.value=this.dataLinkSrc=this.dataLinkTag=this.tableWgt=null;return c.prototype.destroy.call(this)};a.prototype.getType=
function(){return this.colType};a.jmType="ColumnWgt";return a}(l);g.fn.hmiColumn=function(c,a,b,e){return new ud(this,c,a,b,e)};g.addWidgetDefinition("hmiColumn",ud);var vd=function(c){function a(b,a,h,d,f){var k=c.call(this,b.wgtId,a,h,d,f)||this;k.initColNumUpdate=0;k.initialized=!1;k.setDefaultState();k.columnsWgt=[];k.rowsToDisplay=[];k.prevRowsToDisplay=[];k.alarmsMgr=k.project.getWidget("_AlarmsMgr",!0);void 0!==k.filterString&&k.filterString.toString()!=k._defaultFilter.toString()&&(k.filterString=
new RegExp(h.filterString,"i"));void 0!==k.filterString1&&(k.filterString1=new RegExp(h.filterString1,"i"));k.authCode=k.getAuthorizations();k.isTemplateWgt&&k.setIdForTemplate();k._headerColumns=k.elem.getElementsByTagName("th");k.colsWidth=[];k.tbBGColor=k.elem.querySelector(".jm-bodytable").style.backgroundColor;k.initializeTable();k.dateFormatter=new cb;g.getEventMgr()&&(k.activateHandler=function(){return k.load()},k.deactivateHandler=function(){return k.unload()},c.prototype.bindEvents.call(k,
{loadWgt:k.activateHandler}),c.prototype.bindEvents.call(k,{unloadWgt:k.deactivateHandler}));return k}p(a,c);a.prototype.setDefaultState=function(){this._defaultFilter=void 0===this._defaultFilter?/^((Not Triggered Acked|Not Triggered Not Acked|Triggered).*$)/i:this._defaultFilter;this.filterString=void 0===this.filterString?/^((Not Triggered Acked|Not Triggered Not Acked|Triggered).*$)/i:this.filterString;this.filterString1=void 0===this.filterString1?RegExp(""):this.filterString1;this.filterCol=
void 0===this.filterCol?0:this.filterCol;this.filterCol1=void 0===this.filterCol1?null:this.filterCol1;this.defaultSortCol=void 0===this.defaultSortCol?0:this.defaultSortCol;this.enableSort=void 0===this.enableSort?!1:this.enableSort;this.sortOrder=void 0===this.sortOrder?1:this.sortOrder;this.filterChanged=void 0===this.filterChanged?!0:this.filterChanged;this.timer=void 0===this.timer?null:this.timer;this.isActiveAlarm=void 0===this.isActiveAlarm?null:this.isActiveAlarm;this.colsWidth=void 0===
this.colsWidth?null:this.colsWidth;this.clusterize=void 0===this.clusterize?null:this.clusterize;this.tbBGColor=void 0===this.tbBGColor?"#ffffff":this.tbBGColor;this.bgColor=void 0===this.bgColor?"#fff":this.bgColor;this.fgColor=void 0===this.fgColor?"#000":this.fgColor;this._getBGColorFromAlCache=void 0===this._getBGColorFromAlCache?!1:this._getBGColorFromAlCache;this._getFGColorFromAlCache=void 0===this._getFGColorFromAlCache?!1:this._getFGColorFromAlCache;this._queuedRefreshReq=void 0===this._queuedRefreshReq?
!1:this._queuedRefreshReq;this.typeContainer={HISTORICAL:"historical",ACTIVE:"active"};this.invokablePropsList=["tableBGColor"];this._webkitCustomScrollV="WebKit/534.34";this._renderMask=0};a.prototype.load=function(){var b=this;this.headerClickHandler=function(a){b.orderRows(a.target)};for(var a=0,c=this._headerColumns.length;a<c;a++)this._headerColumns[a].setAttribute("data-colN",a.toString()),this.authCode!=this.umgr.getWidgetAuthorizationCodes().RDONLY&&this._headerColumns[a].addEventListener("click",
this.headerClickHandler);this.populate();this.initialized=!0};a.prototype.unload=function(){for(var b=0,a=this._headerColumns.length;b<a;b++)this._headerColumns[b].removeEventListener("click",this.headerClickHandler);this.stopRefresh();$(".jm-hmi-msg",this.elem).off("click");$("input:checkbox",this.elem).off("click");this.dataSrc.unsubscribeWgt(this);this.rowsToDisplay=[];this.prevRowsToDisplay=[];this.initColNumUpdate=0;this.initialized=!1;this.empty()};a.prototype.orderRows=function(b){this._headerColumns[this.defaultSortCol].style.textDecoration=
"";this.defaultSortCol=parseFloat(b.getAttribute("data-colN"));this.sortOrder=this.sortOrder?0:1;this._headerColumns[this.defaultSortCol].style.textDecoration="underline";this.populate()};a.prototype.render=function(){l.prototype.render.call(this);this._renderMask&a._renderFlags.REFRESH&&this.updateView();this._renderMask&a._renderFlags.BGCOLOR&&(this.elem.querySelector(".jm-bodytable").style.backgroundColor=this.tbBGColor);this._renderMask=0};a.prototype.columnReady=function(){this.initColNumUpdate++;
this.initColNumUpdate>=this.columnsWgt.length&&this.initialized&&this.populate()};a.prototype.getValue=function(b){return"filterString"==b?this.filterString:"filterAttr"==b?(b=this.columnsWgt[this.filterCol])?b.getTagLinkedToValue():"":"filterString1"==b?this.filterString1:"filterAttr1"==b?(b=this.columnsWgt[this.filterCol1])?b.getTagLinkedToValue():"":l.prototype.getValue.call(this,b)};a.prototype.addColumnWgt=function(b){this.colsWidth.push(b.getValue("width"));return this.columnsWgt.push(b)-1};
a.prototype.updateData=function(){g.getActivePage().wgtId!=this.parentPage.wgtId&&this.parentPage.wgtId!=g.getFocusPage().wgtId||this.populate()};a.prototype.updateSelectColumn=function(){this._updateCheckboxes()};a.prototype.setIdForTemplate=function(){var b=this.elem.children[0].firstChild,a=b.nextSibling,c=a.firstChild;$(b).attr("id","hdr_"+this.wgtId);$(a).attr("id","container_"+this.wgtId);$(c).attr("id","tbl"+this.wgtId)};a.prototype.initializeTable=function(){var b=this.elem.children[0].firstChild,
a=$(this.elem.firstElementChild),c=g.browserScrollbarWidth,d=parseFloat(b.getAttribute("hdr-w")),f=0,k=40,q=$(b).next();-1!=navigator.userAgent.indexOf(this._webkitCustomScrollV)?($(this.elem.childNodes[1]).addClass("webkitbar"),q.addClass("webkitbar")):k=c;f="none"!=b.childNodes[0].style.display?this.height-28:this.height;a.scrollLeft(0);q.css({height:f-c+"px",width:d+"px","padding-right":k+"px"});this.authCode==this.umgr.getWidgetAuthorizationCodes().RDONLY&&(b=this.elem.getElementsByClassName("clusterize"),
a=this.elem.getElementsByClassName("clusterize-scroll"),b[0].className+=" lockscrollx",a[0].className+=" lockscrolly")};a.prototype.setValue=function(b,c,h,d){null!=this.elem&&(-1<b.indexOf("filterString")?null!=c&&String(new RegExp(c))!=String(this[b])&&(this[b]=new RegExp(c),this.filterChanged=!0,this.populate()):"tableBGColor"==b?this.isBadValue(c,!0,h)||this.tbBGColor==c||(this.tbBGColor="number"==typeof c?"#000":c,this._renderMask|=a._renderFlags.BGCOLOR,g.addToRender(this)):"bgColor"==b?this._getBGColorFromAlCache||
this.isBadValue(c,!0,h)||this.bgColor==c||(this.bgColor="number"==typeof c?"#000":c,this._renderMask|=a._renderFlags.REFRESH,g.addToRender(this)):"fgColor"!=b||this._getFGColorFromAlCache||this.isBadValue(c,!0,h)||this.fgColor==c||(this.fgColor="number"==typeof c?"#000":c,this._renderMask|=a._renderFlags.REFRESH,g.addToRender(this)))};a.prototype.refreshRequest=function(){var b=this;0==this._queuedRefreshReq&&(this._queuedRefreshReq=!0,setTimeout(function(){b.populate();b._queuedRefreshReq=!1},0))};
a.prototype.hideColumn=function(b){var a=this.elem.querySelector(".jm-bodytable").getElementsByTagName("th");null!=a&&null!=a[b]&&"none"!=a[b].style.display&&(a[b].style.display="none")};a.prototype.refreshTableContent=function(){this.rowStyle=Array(this.rowsToDisplay.length);for(var b=this.rowsToDisplay.length,c=this.columnsWgt.length,h=0;h<c;h++){this.tableContent[h]=[];for(var d=0;d<b;d++){var f=this.columnsWgt[h],k=this.rowsToDisplay[d],q=f.getValue("value",k),m="text-overflow:ellipsis;";"alSelect"==
f.dataLinkTag&&(this.checkboxColumnWgt=f);0==f.visible&&(m+="display:none;");switch(f.getType()){case 2:m+="text-align:center;word-break:break-all;";f.getQuality(k).isQualityGood()?(q="<input type='checkbox' data-datalink='"+f.getTagLinkedToValue()+"' data-tableid=\""+this.elem.id+'" data-dataref="'+f.getDataReference(k)+'" '+(q?"checked=true":""),this.authCode==this.umgr.getWidgetAuthorizationCodes().RDONLY&&(q+=" disabled "),q+=" />"):q="<div class='jm-bad jm-align-center-table-old' style='position:relative'></div>";
this.tableContent[h][d]='<td style="'+m+'">'+q+"</td>";break;case 4:this.tableContent[h][d]=m?'<td style="'+m+'">':"<td>";var l,m=typeof q;"string"==m||"number"==m?l=new Date(q):"undefined"!=typeof q&&(l=new Date(q.format()));l=this.isActiveAlarm?this.getLocalDate(l):new Date(q);q={longDateFormat:this.project.getValue("longDateFormat"),shortDateFormat:this.project.getValue("shortDateFormat"),serverOffset:this.project.getSystemPropertiesMgr().getServerOffset()};this.dateFormatter.setDate(l);this.dateFormatter.setFormat(f.numberFormat,
q);q=this.dateFormatter.formatDateTime("local");this.tableContent[h][d]+=q;this.tableContent[h][d]+="</td>";break;case 5:this.tableContent[h][d]=m?'<td style="'+m+'">':"<td>";0!==q&&void 0!=q&&(q=document.createElement("div"),$(q).css({width:"15px",height:"15px",margin:"0 auto",display:"block","background-size":"contain",opacity:"0.7"}),q.setAttribute("class",f.imgPath+" jm-hmi-img"),q.setAttribute("data-dataref",f.getDataReference(k)),this.tableContent[h][d]+=q.outerHTML);this.tableContent[h][d]+=
"</td>";break;default:this.tableContent[h][d]=m?'<td style="'+m+'">':"<td>",this.tableContent[h][d]=q instanceof Date?this.tableContent[h][d]+q.getTime():this.tableContent[h][d]+(void 0===q?"":q),this.tableContent[h][d]+="</td>"}"alState"!=f.getTagLinkedToValue()||this.rowStyle[d]||(this.rowStyle[d]=[2],this.isActiveAlarm?this.rowStyle[d][0]=[this.alarmsMgr.getDataValues("BGColor")[k],this.alarmsMgr.getDataValues("FGColor")[k]]:(q=f.getSrcLinkedToValue().getAlarmNameByIndex(k),k=f.getSrcLinkedToValue().getAlarmStateCodeByIndex(k),
k=this.alarmsMgr.getAlarmByName(q).getColorsByStateCode(k),this.rowStyle[d][0]=[k.bg,k.fg]));f.hasChanged=!1}}this._renderMask|=a._renderFlags.REFRESH;g.addToRender(this)};a.prototype.populate=function(){this.elem&&(this.tableContent=[],0<this.columnsWgt.length&&(this.prevRowsToDisplay=nc(this.rowsToDisplay),this._filterColumn(),this._sortColumn()),this.refreshTableContent())};a.prototype.empty=function(){this.tableContent=[];this.rowsToDisplay=[]};a.prototype.updateView=function(){var b=this,a=[],
c,d,f,k=this.rowsToDisplay.length,g=this.isActiveAlarm?this.typeContainer.ACTIVE:this.typeContainer.HISTORICAL;for(d=0;d<k;d++){c="<tr";f=this.bgColor;this._getBGColorFromAlCache&&(f=this.rowStyle[d][0][0]);var m=this.fgColor;this._getFGColorFromAlCache&&(m=this.rowStyle[d][0][1]);c+=' style="background-color:'+f+";color:"+m+';"';c+=">";for(f=0;f<this.columnsWgt.length;f++)c+=this.tableContent[f][d];c+="</tr>";a.push(c)}c=this.elem.querySelector(".jm-bodytable").id;null==this.clusterize?this.clusterize=
new Clusterize({rows:a,scrollId:c,contentId:g+"_"+this.elem.id,rows_in_block:20,blocks_in_cluster:3,show_no_data_row:!1,callbacks:{clusterChanged:function(){b.isActiveAlarm&&(b._updateCheckboxes(),b._updateUserActions())},clusterWillChange:function(){b.isActiveAlarm&&(b._unbindCheckboxes(),b._unbindUserActions())}}}):this.clusterize.update(a);if(this.authCode!=this.umgr.getWidgetAuthorizationCodes().RDONLY)$(":checkbox",this.elem).on("click",this._updateManager());this.filterChanged=!1};a.prototype._setUserAction=
function(b,a){var c=this.alarmsMgr.getAlarmByName(b).userActions,d;for(d in c)if(c[d].t==g.actionMgr.enActionType.JS)g.doAction(a,c[d]);else{var f=g.getAction("hmiAction"+c[d].c);f.setParameters(c[d]);g.doAction(a,f)}};a.prototype._updateUserActions=function(){var b=this;if(this.authCode!=this.umgr.getWidgetAuthorizationCodes().RDONLY)$(".jm-hmi-img",this.elem).on("click",function(){b._setUserAction($(this).data("dataref"),b.elem.id)})};a.prototype._unbindUserActions=function(){$(".jm-hmi-img",this.elem).off()};
a.prototype.clear=function(){null!=this.clusterize&&this.clusterize.update([])};a.prototype._updateCheckboxes=function(){var b,a,c,d=$("input:checkbox[data-datalink]");this.checkboxColumnWgt&&(this.checkboxColumnWgt.hasChanged=!0);if(this.authCode!=this.umgr.getWidgetAuthorizationCodes().RDONLY)$(":checkbox",this.elem).on("click",this._updateManager());if(null!=this.clusterize){b=d.length;for(var f=0;f<b;f++)a=d[f].getAttribute("data-dataref"),c=d[f].getAttribute("data-datalink"),a=this.alarmsMgr.getAlarmByName(a),
(a.isDirty(c)?a.getDirtyValue(c):a.getValue(c))?d[f].setAttribute("checked",!0):d[f].removeAttribute("checked")}};a.prototype._unbindCheckboxes=function(){$(":checkbox",this.elem).off()};a.prototype.updateDOMAttributes=function(){var b=this.elem.querySelector("tbody");b&&(this.isActiveAlarm?b.setAttribute("id",this.typeContainer.ACTIVE+"_"+this.elem.id):b.setAttribute("id",this.typeContainer.HISTORICAL+"_"+this.elem.id))};a.prototype.addDataLink=function(b){c.prototype.addDataLink.call(this,b);if("AlarmsMgrWgt"==
b.dataSrc.getJMType()||"EventBufferWgt"==b.dataSrc.getJMType()){this.dataSrc=b.dataSrc;this.isActiveAlarm="AlarmsMgrWgt"==this.dataSrc.getJMType();this.dataSrc.subscribeWgt(this,null);this.updateDOMAttributes();var a=b.getAttribute();b=b.getTag();if("BGColor"==b&&"bgColor"==a&&this.isActiveAlarm||"alBGColor"==b&&"bgColor"==a&&!this.isActiveAlarm)this._getBGColorFromAlCache=!0;if("FGColor"==b&&"fgColor"==a&&this.isActiveAlarm||"alFGColor"==b&&"fgColor"==a&&!this.isActiveAlarm)this._getFGColorFromAlCache=
!0}};a.prototype.addBlink=function(b){var a,c;if("activeTable"==this.typeTable){for(var d=0;d<this.rowsToDisplay.length;d++)this.rowsToDisplay[d]==b&&(c=d+1);b=$(this.elem).find("tr").eq(c).children();a=b.not("td:nth-child(1)").not("td:nth-child(8)");$(a).fadeToggle(700,function(){$(a).fadeToggle(800)})}};a.prototype.stopRefresh=function(){"number"==typeof this.timer&&(clearTimeout(this.timer),delete this.timer)};a.prototype._filterColumn=function(){this.rowsToDisplay=[];if(this.columnsWgt[0].isEmpty())return!1;
for(var b=0;b<this.columnsWgt[0].value.length;b++){var a=!1,c=this.columnsWgt[this.filterCol].value[b];"alEnable"==this.columnsWgt[this.filterCol].dataLinkTag?(c=this.alarmsMgr.getAlarmByName(this.alarmsMgr.getAlarmName(b)),c=c.alEnable,c=this.filterString.test(c)||this.filterString.test(c?"1":"0")):c=this.filterString.test(c);c&&(null==this.filterCol1?a=!0:(c=this.columnsWgt[this.filterCol1].value[b],"alEnable"==this.columnsWgt[this.filterCol1].dataLinkTag?(c=this.alarmsMgr.getAlarmByName(this.alarmsMgr.getAlarmName(b)),
c=c.alEnable,a=this.filterString1.test(c)||this.filterString1.test(c?"1":"0")):this.filterString1.test(c)&&(a=!0)));a?this.rowsToDisplay.push(b):(a=this.getDatalink("selectionAttr"))&&"AlarmsMgrWgt"==a.dataSrc.getJMType()&&a.dataSrc.updateAlarmByIndex(b,a.tag,!1)}return!0};a.prototype._sortColumn=function(){for(var b=[],a={},c=0,d=!0,c=0;c<this.rowsToDisplay.length;c++){if(this.enableSort)a=this.columnsWgt[this.defaultSortCol].value[this.rowsToDisplay[c]];else if(a=this.columnsWgt[this.defaultSortCol].getSrcLinkedToValue().getUnorderedPosition(this.rowsToDisplay[c]),
null==a){d=!1;break}a={index:this.rowsToDisplay[c],value:a};b.push(a)}if(d){var f=this.sortOrder,k=this.enableSort;b.sort(function(b,a){if(k&&1==f){var c=a;a=b;b=c}return"string"==typeof b.value?b.value.localeCompare(a.value):b.value-a.value});for(c=0;c<this.rowsToDisplay.length;c++)this.rowsToDisplay[c]=b[c].index}};a.prototype.deleteTable=function(b){if(0==b)$("table tbody",this.elem).children().remove();else for(var a=$("table tr",this.elem).length-1,c=b;c<a;c++)$("table tbody tr:eq("+b+")",this.elem).remove()};
a.prototype._updateManager=function(){var b=this;return function(){var a=$(this);a.prop("checked",this.checked);var c=a.data("dataref"),a=a.data("datalink");"alSelect"==a?b.alarmsMgr.setSelectAlarm(c,this.checked):"alEnable"==a&&b.alarmsMgr.setEnableAlarm(c,this.checked)}};a.prototype.getLocalDate=function(b){if(void 0===b)return new Date(0);var a=moment().utcOffset();return new Date(b.getTime()+6E4*a)};a.prototype.updateLanguage=function(){var b=this.getPageMLTextMgr(),a=b.getCurrentFont(),c;this.mlMap&&
(c=this.mlMap[b.getCurrentLanguage()]);void 0!=c&&(a=c);c=$(".jm-text",this.elem);a&&$("#container_"+this.wgtId).css("font-family",a);for(var a=0,d=c.length;a<d;a++){var f=this.parentWidget.getWidget(c[a].id).mlIds[0],f=b.getText(f);null!=f&&(c[a].childNodes[0].textContent=f)}};a.prototype.setParentBounds=function(b,a,h,d,f){c.prototype.setParentBounds.call(this,b,a,h,d,f);this.updateView()};a.prototype.destroy=function(){if(this.destroyed)return!1;this._headerColumns=null;this.clusterize&&(this.clusterize.destroy(!0),
this.clusterize=null);this.isActiveAlarm&&(this._unbindCheckboxes(),this._unbindUserActions());c.prototype.unbindEvents.call(this,{loadWgt:this.activateHandler,unloadWgt:this.deactivateHandler});return c.prototype.destroy.call(this)};a.jmType="TableWgt";a._renderFlags={REFRESH:1,BGCOLOR:2};return a}(l);g.fn.hmiTable=function(c,a,b,e){return new vd(this,c,a,b,e)};g.addWidgetDefinition("hmiTable",vd);var wd=function(c){function a(b,a,h,d,f){b=c.call(this,b.wgtId,a,h,d,f)||this;b.setDefaultState();b.setValue("value",
b.curState,null);return b}p(a,c);a.prototype.setDefaultState=function(){this.curState=void 0!==this.curState?this.curState:0;this.backgroundClass=void 0!==this.backgroundClass?this.backgroundClass:"bgColor00";this.colors=void 0!==this.colors?this.colors:["green","red"];this.strokeColor=void 0!==this.strokeColor?this.strokeColor:"#FFF";this.numStates=void 0!==this.numStates?this.numStates:2;this.disabled=void 0!==this.disabled?this.disabled:!1;this._renderMask=0};a.prototype.render=function(){c.prototype.render.call(this);
if(this._renderMask&a._renderFlags.VALUE){var b=Math.abs(this.value%this.numStates),b=this.colors[b],e=this.elem.getElementsByClassName(this.backgroundClass);0<e.length?(e=e[0],e.style.fill?e.style.fill=b:e.setAttribute("fill",b)):(e=this.elem.getElementsByTagName("svg"),0<e.length&&(e[0].style.fill=b));this.elem&&this.elem.setAttribute("data-c",b)}this._renderMask&a._renderFlags.STROKE&&(b=this.elem.getElementsByTagName("path"),0<b.length&&(b[0].style.stroke=this.strokeColor));this._renderMask=0};
a.prototype.setValue=function(b,e,h,d){switch(b){case "value":case "frame":if(this.isBadValue(e,!1,h))return!1;this.value!=e&&(this.value=this.curState="boolean"==typeof e?1==e?1:0:parseInt(e),this._renderMask|=a._renderFlags.VALUE,this.core.addToRender(this),this.sendUpdate(b,this.value,h));break;case "stroke":if(this.isBadValue(e,!1,h))return!1;this.strokeColor!=e&&(this.project.validateColor(e)?this.strokeColor=e:this.strokeColor="rgb(0,0,0)",this._renderMask|=a._renderFlags.STROKE,this.core.addToRender(this),
this.sendUpdate(b,e,h));default:return c.prototype.setValue.call(this,b,e,h,d)}return!0};a.prototype.getValue=function(b,a){switch(b){case "value":case "frame":return this.curState;case "stroke":return this.strokeColor;case "bkgColor":return this.colors.join(";");default:return c.prototype.getValue.call(this,b)}};a._renderFlags={VALUE:1,STROKE:2};a.jmType="IndicatorWgt";return a}(l);g.fn.hmiIndicator=function(c,a,b,e){return new wd(this,c,a,b,e)};g.addWidgetDefinition("hmiIndicator",wd);var Da=function(c){function a(b,
a,h,d,f){var k=c.call(this)||this;k.wgtId=b;k.studioId=a;k.parentPage=d;k.parentWidget=f;k.parentWidget&&(b=k.parentWidget.getGraphicModule())&&b.addXForm(k.wgtId,k);for(var g in h)k[g]=h[g];k.dLink=null;return k}p(a,c);a.prototype.setDLink=function(b){this.dLink=b;this.updateDataLink()};a.prototype.updateDataLink=function(){if(null!=this.dLink){var b=this.dLink.tagIndex,a=g.cache.getTag(this.dLink.tag);a&&this.dLink.setWgtValue(a.value instanceof Array?a.value[b]:a.value,b,a.getQuality())}};a.prototype.addDataLink=
function(b){c.prototype.addDataLink.call(this,b)};a.prototype.addOptions=function(b){if(null!=b)for(var a in b)this[a]=b[a]};a.prototype.getGraphicModule=function(){return this.parentWidget.getGraphicModule()};a.prototype.getParametersFromString=function(b){return{}};a.prototype.destroy=function(){this.dLink=null;c.prototype.destroy.call(this)};return a}(lc);g.fn.hmiXform=function(c,a,b,e){return new Da(this,c,a,b,e)};g.addWidgetDefinition("hmiXform",Da);var dc=function(c){function a(b,a,h,d,f){b=
c.call(this,b?b.wgtId:null,a,h,d,f)||this;b.parametersDefinition=[];b.parametersDefinitionStr="";b.parameters={};b.$Vars={};b.map$AttrLink={};b.num$AttrLink=0;b.evaluateExpression();return b}p(a,c);a.prototype.evaluateExpression=function(){if(void 0!==this.compiledExpression){var b=new Set(this.compiledExpression.match(/(\$)\d+/g));this.parametersDefinition=Array.from(b.values());this.parametersDefinitionStr="{"+this.parametersDefinition.join(",")+"}";try{(function(){eval("this.compiledFunction = function( "+
this.parametersDefinitionStr+"){ return ("+this.compiledExpression+"); }")}).call(this)()}catch(a){}}};a.prototype.setValue=function(b,a){0==b.indexOf("$")&&this.parametersDefinition.includes(b)&&(this.$Vars[b]=void 0===a||null===a?"":a,null!=this.map$AttrLink[b]&&this.updateExpressionParams())};a.prototype.updateExpressionParams=function(){var b=t.getModule("Tag"),a=0,c;for(c in this.map$AttrLink)if(void 0!==this.$Vars[c]){var d=this.map$AttrLink[c];this.parameters[c]=d.tagType===v.INT64?0==this.$Vars[c].length?
void 0:fromString(this.$Vars[c]):d.tagType===v.UINT64?0==this.$Vars[c].length?void 0:fromString(this.$Vars[c],!0,10):this.$Vars[c];a++}null!=this.dLink&&this.parametersDefinition.length==a&&this.dLink.setWgtValue(void 0,void 0,b.QUALITY_GOOD)};a.prototype.getCompiledExpression=function(){return this.compiledExpression};a.prototype.getValue=function(){return{compiledExpression:this.compiledExpression,colorPalette:this.colorPalette}};a.prototype.getVarValue=function(b){return this.$Vars[b]};a.prototype.getMapAttrLink=
function(){return this.map$AttrLink};a.prototype.getNumAttrLink=function(){return this.num$AttrLink};a.prototype.addDataLink=function(b){c.prototype.addDataLink.call(this,b);this.initDataLinkSideEffects(b,b.attr)};a.prototype.initDataLinkSideEffects=function(b,a){0==a.indexOf("$")&&(null==this.map$AttrLink[a]&&this.num$AttrLink++,this.map$AttrLink[a]=b,void 0!==this.$Vars[a]&&this.updateExpressionParams())};a.prototype.removeDataLink=function(b){0==b.attr.indexOf("$")&&(delete this.map$AttrLink[b.attr],
0<this.num$AttrLink&&this.num$AttrLink--)};a.prototype.unsubscribeDataLink=function(b){this.removeDataLink(b)};a.prototype.execute=function(b,a,c,d){b=a;if(null!=d)try{b=this.compiledFunction(this.parameters);var f=d.colorPalette;if(f){var k=new Map;f.split(",").forEach(function(b){b=b.split("#");k.set(b[0],"#"+b[1])});var g=b.toString();k.has(g)&&(b=k.get(g))}}catch(m){}return b};a.prototype.writeToString=function(b,a){var c="="+this.compiledExpression+";[",d=0;if(this.dataLinks)for(var f in this.dataLinks){var k=
this.dataLinks[f].writeToString(),c=c+((0==d?"":";")+k);d++}return c+"]"};a.prototype.readFromString=function(b,a){for(var h=0,d=b.length,f=0,k=0;f<d;){var q=b[f];if("'"==q||'"'==q){for(var m=q,q=f+1,l=!1;q<d;){if(b[q]==m&&"\\"!=b[q-1]){l=!0;f=q;break}q++}if(!l)return null}else if(";"==q&&"\\"!=b[f-1])this.compiledExpression=b.substr(0,f),this.evaluateExpression(),k++;else if("["==q&&(0<f?"\\"!=b[f-1]:1)){do{q=f+1;k="";for(m=0;q<d;){l=b[q];if(";"==l&&"\\"!=b[q-1]){f=q;break}else if("["==l&&"\\"!=
b[q-1])m++;else if("]"==l&&"\\"!=b[q-1])if(0<m)m--;else{f=q+1;break}k+=l;q++}0!=k.length&&(q=g.createDataLink(this,null,null),q.readFromString(k),q.mount(),q.update(),c.prototype.addDataLink.call(this,q),h++)}while(f<d);break}f++}};return a}(Da);g.fn.hmiFormulaXForm=function(c,a,b,e){return new dc(this,c,a,b,e)};g.addWidgetDefinition("hmiFormulaXForm",dc);var xd=function(c){function a(b,a,h,d,f){return c.call(this,b?b.wgtId:null,a,h,d,f)||this}p(a,c);a.prototype.setValue=function(b,a){this[b.toLowerCase()]=
a;isNaN(this.bitIndex)||c.prototype.updateDataLink.call(this)};a.prototype.getValue=function(){return{bitIndex:this.bitIndex}};a.prototype.execute=function(b,a,c,d){var f=a;0!=a%1&&(a=Math.round(a));if(null!=d){d=parseInt(d.bitIndex);f=1<<d;if("w"==c)return c=b.getTagValue(),b=t.getModule("Tag").getNumberOfBits(b.getTagType())-1,0>a||1<a||d>b?c:1==a?c|f:c&~f;f=(a&f)>>d}return f};a.prototype.writeToString=function(b,a){return""+this.bitIndex};a.prototype.readFromString=function(b){b&&c.prototype.addOptions.call(this,
{bitIndex:parseInt(b)})};a.prototype.getParametersFromString=function(b){return{strXForm:parseInt(b)}};return a}(Da);g.fn.hmiBitIndexXForm=function(c,a,b,e){return new xd(this,c,a,b,e)};g.addWidgetDefinition("hmiBitIndexXForm",xd);var yd=function(c){function a(b,a,h,d,f){return c.call(this,b?b.wgtId:null,a,h,d,f)||this}p(a,c);a.prototype.setValue=function(b,a){this[b.toLowerCase()]=a;isNaN(this.byteIndex)||c.prototype.updateDataLink.call(this)};a.prototype.getValue=function(){return{byteIndex:this.byteIndex}};
a.prototype.execute=function(b,a,c,d){var f=a,k=!1;0!=a%1&&(a=Math.round(a));if(null!=d){d=8*parseInt(d.byteIndex);var g;32<=d?k=!0:g=255<<d;f=0;f=b.getTagValue();if("w"==c){if(k)return f;f=(f&~g)+(a<<d)}else if(k){if(64<=d)return 0;if(56<=d&&0>f)return-1;g=this._leftShift(255,d);f=this._rightShift(this._and(a,g),d)}else f=(a&g)>>>d}return f};a.prototype._leftShift=function(b,a){return b*Math.pow(2,a)};a.prototype._rightShift=function(b,a){return b/Math.pow(2,a)};a.prototype._and=function(b,a){for(var c=
0,d=0,f=0;64>f;){var k=b&1073741823&a;b=Math.floor(b/1073741824);a=Math.floor(a/1073741824);for(var g=c++;g--;)k*=1073741824;d+=k;f+=30}return d};a.prototype._not=function(b){0>b&&(b>>>=0);for(var a=0,c=0;0!=b;){var d=~(1073741823&b);b=Math.floor(b/1073741824);for(var f=a++;f--;)d*=1073741824;c+=d}return c};a.prototype.writeToString=function(b,a){return""+this.byteIndex};a.prototype.readFromString=function(b){b&&c.prototype.addOptions.call(this,{byteIndex:parseInt(b)})};a.prototype.getParametersFromString=
function(b){return{byteIndex:parseInt(b)}};return a}(Da);g.fn.hmiByteIndexXForm=function(c,a,b,e){return new yd(this,c,a,b,e)};g.addWidgetDefinition("hmiByteIndexXForm",yd);var zd=function(c){function a(b,a,h,d,f){return c.call(this,b?b.wgtId:null,a,h,d,f)||this}p(a,c);a.prototype.setValue=function(b,a){this[b.toLowerCase()]=a;this.colorPalette&&this.colorMap&&this.updateDataLink()};a.prototype.getValue=function(){return{colorPalette:this.colorPalette,colorMap:this.colorMap}};a.prototype.execute=
function(b,a,c,d){b=d.colorPalette;d=d.colorMap;c=b.length;return null==a||null==b||0==b.length||1==b.length&&""==b[0]?null:null!=d?b[this.getPaletteIndexFromColorMap(a,d)%c]:b[this.getPaletteIndexFromPalette(a)%c]};a.prototype.isValueInInterval=function(b,a){return a>=b.min&&a<=b.max?!0:!1};a.prototype.getIntervalMinMax=function(b){return{min:parseFloat(b.split("-")[0]),max:parseFloat(b.split("-")[1])}};a.prototype.isSingleValueValid=function(b,a){if(isNaN(parseFloat(b))&&a==b)return!0;var c=parseFloat(b);
return 1E-5>=Math.abs(a-c)?!0:!1};a.prototype.getPaletteIndexFromPalette=function(b){return"string"==typeof b?isNaN(parseFloat(b))?0:parseFloat(b):b};a.prototype.getPaletteIndexFromColorMap=function(b,a){for(var c=null,d=0;d<a.length;d++)for(var f=a[d].v.split(","),k=0;k<f.length;k++){var g=f[k].trim();if(-1!=g.indexOf("-")){g=this.getIntervalMinMax(g);if(this.isValueInInterval(g,b))return a[d].i;b>g.max&&(c=d)}else if(this.isSingleValueValid(g,b))return a[d].i}return"string"==typeof b?isNaN(parseFloat(b))?
0:parseFloat(b):null==c?b:c};a.prototype.writeToString=function(b,a){var c=[],d,f,k;for(k in this.colorMap)d=this.colorMap[k].v,f=this.colorPalette[k],c.push(d+f);return c.join()};a.prototype.readFromString=function(b){c.prototype.addOptions.call(this,this.getParametersFromString(b))};a.prototype.getParametersFromString=function(b){if(b){b=b.split(",");var a=[],c;for(c in b)a.push({i:Number(c),v:b[c][0]}),b[c]=b[c].substring(1);return{colorMap:a,colorPalette:b}}return{}};return a}(Da);g.fn.hmiColorPaletteCustomXForm=
function(c,a,b,e){return new zd(this,c,a,b,e)};g.addWidgetDefinition("hmiColorPaletteCustomXForm",zd);var Ad=function(c){function a(b,a,h,d,f){return c.call(this,b?b.wgtId:null,a,h,d,f)||this}p(a,c);a.prototype.setValue=function(b,a){this[b.toLowerCase()]=a;isNaN(this.inputMin)||isNaN(this.inputMax)||isNaN(this.outputMin)||isNaN(this.outputMax)||c.prototype.updateDataLink.call(this)};a.prototype.getValue=function(){return{inputMin:this.inputMin,inputMax:this.inputMax,outputMin:this.outputMin,outputMax:this.outputMax}};
a.prototype.execute=function(b,a,c,d){var f,k;"w"==c?(b=this.outputMin,d=this.outputMax,c=this.inputMin,k=this.inputMax):(b=this.inputMin,d=this.inputMax,c=this.outputMin,k=this.outputMax);0!=d-b&&(f=(k-c)/(d-b),f=f*a+(c-f*b));return f};a.prototype.writeToString=function(b,a){return""+this.inputMin+","+this.inputMax+","+this.outputMin+","+this.outputMax};a.prototype.readFromString=function(b){b&&(b=b.split(","),c.prototype.addOptions.call(this,{inputMin:Number(b[0]),inputMax:Number(b[1]),outputMin:Number(b[2]),
outputMax:Number(b[3])}))};a.prototype.getParametersFromString=function(b){return b?(b=b.split(","),{inputMin:Number(b[0]),inputMax:Number(b[1]),outputMin:Number(b[2]),outputMax:Number(b[3])}):{}};return a}(Da);g.fn.hmiRangeXForm=function(c,a,b,e){return new Ad(this,c,a,b,e)};g.addWidgetDefinition("hmiRangeXForm",Ad);var Bd=function(c){function a(b,a,h,d,f){return c.call(this,b?b.wgtId:null,a,h,d,f)||this}p(a,c);a.prototype.setValue=function(b,a){this[b.toLowerCase()]=a;isNaN(this.scale)||isNaN(this.mod)||
isNaN(this.offset)||c.prototype.updateDataLink.call(this)};a.prototype.getValue=function(){return{scale:this.scale,offset:this.offset,mod:this.mod}};a.prototype.addDataLink=function(b){c.prototype.addDataLink.call(this,b);this.initDataLinkSideEffects(b,b.attr)};a.prototype.initDataLinkSideEffects=function(b,a){};a.prototype.execute=function(b,a,c,d){b=d.scale;var f=d.mod;d=d.offset;var k=a;null==d&&(d=0);null==b&&(b=1);null==f&&(f=1);if(a instanceof Array)if(a[0]instanceof Object)for(var g=0,m=a.length;g<
m;g++)k[g].v=this.scaleValue(c,b,d,f,a[g].v);else for(g=0,m=a.length;g<m;g++)k[g]=this.scaleValue(c,b,d,f,a[g]);else k=this.scaleValue(c,b,d,f,a);return k};a.prototype.scaleValue=function(b,a,c,d,f){"w"==b?0!=a&&(f=d/a*(f-c)):0!=d&&(f=a/d*f+c);return f};a.prototype.writeToString=function(b,a){var c="";if(this.dataLinks)for(var d in this.dataLinks){var f=this.dataLinks[d];switch(f.attr){case "Scale":c+=this.scale+"["+f.getTag()+"],";break;case "Mod":c+=this.mod+"["+f.getTag()+"],";break;case "Offset":c+=
this.offset+"["+f.getTag()+"]"}}else c+=this.scale+","+this.mod+","+this.offset;return c};a.prototype.readFromString=function(b){if(b){b=b.split(",");for(var a=void 0,h=void 0,d=void 0,f=void 0,k=void 0,q=k=f=void 0,m=void 0,f=!1,l=0;l<b.length;l++){switch(l){case 0:q=b[0];break;case 2:q=b[1];break;case 1:q=b[2]}(f=-1==q.indexOf("[")?!1:!0)?(f=q.indexOf("[")+1,k=q.indexOf("]"),f=q.substring(f,k),m=parseFloat(q.split("[")[0]),k=g.createDataLink(this,null,null),k.readFromString(f),this.addDataLink(k),
k.update(),k.mount()):m=parseFloat(q);a=0==l?m:a;h=1==l?m:h;d=2==l?m:d}c.prototype.addOptions.call(this,{scale:a,offset:h,mod:d})}};a.prototype.getParametersFromString=function(b){return b?(b=b.split(","),{scale:b[0],mod:b[1],offset:b[2]}):{}};return a}(Da);g.fn.hmiScaleXForm=function(c,a,b,e){return new Bd(this,c,a,b,e)};g.addWidgetDefinition("hmiScaleXForm",Bd);var Cd=function(c){function a(b,a,h,d,f){return c.call(this,b?b.wgtId:null,a,h,d,f)||this}p(a,c);a.prototype.getValue=function(){return{format:this.format}};
a.prototype.addDataLink=function(b){c.prototype.addDataLink.call(this,b);this.initDataLinkSideEffects(b,b.attr)};a.prototype.initDataLinkSideEffects=function(b,a){};a.prototype.execute=function(b,a,c,d){(b=d.format)&&'"'==b.charAt(0)&&'"'==b.charAt(d.format.length-1)&&(b=b.substring(1,d.format.length-1));var f=g.import("TextFormatUtil"),k=f.parseFormat(b);return a instanceof Array?a.map(function(b){return f.format(k,b,null,!1)}):f.format(k,a,null,!1)};a.prototype.writeToString=function(b,a){return"format("+
this.format+")"};a.prototype.readFromString=function(b){void 0!=b&&c.prototype.addOptions.call(this,{format:b})};a.prototype.getParametersFromString=function(b){return{format:b}};return a}(Da);g.fn.hmiFormatXForm=function(c,a,b,e){return new Cd(this,c,a,b,e)};g.addWidgetDefinition("hmiformat",Cd);var Pa=function(c){function a(b,a,h,d,f){var k=c.call(this,b,a,h,d,f)||this;k.currSelRow=-1;k.prevSelRow=-1;k.filterColName="";k.filterSrcType="";k.clearDOM=!1;k.sortedWidgets=[];k.updateScrollContent=!1;
k.proxyTable=null;k.rowsToRender=new Map;k.rowsToRemove=new Map;k.refreshMode=!0;k.promiseStack=[];k.resolveScroll=[];k.enableLoadingPanel=!0;k.sortingRules=[];b=k.wgtId+"_proxy";a=g.import("TableGroupController");h=g.import("DynamicTableGrid");k.tableController=new a;k.dynamicGridInstance=new h;k.invokablePropsList=k.invokablePropsList.concat(["model","tableModel","currentRow","precachedPages"]);k.proxyTable=new Ec(b,b,{tableGroup:k},d,d);k.initLoadingPanel();k.loadInitDOMStructure();k.renderLoading();
g.getEventMgr()&&(k.activateHandler=function(){return k.load()},k.deactivateHandler=function(){return k.unload()},c.prototype.bindEvents.call(k,{loadWgt:k.activateHandler,unloadWgt:k.deactivateHandler}));return k}p(a,c);a.prototype.load=function(){this.showLoading();c.prototype.executeActivationCallback.call(this)&&(this.events={mousedown:!0,touchstart:!0},this.isWgtActive=!0,this.hasDataSource()&&this.dataSource.parentPage instanceof eb&&this.dataSource.notifyUpdate())};a.prototype.unload=function(){if(c.prototype.executeDeactivationCallback.call(this)){if(this.scrollbarInstance){var b=
this.scrollbarInstance.getOffset();this.xScroll=b.x;this.yScroll=b.y;this.prevSelRow=this.currSelRow=-1}this.resetRowMaps();this.promiseStack=[];this.resolveScroll=[];this.tableController.destroyHeaderDelegates();this.tableController.destroyBodyDelegates();this.events={mousedown:!1,touchstart:!1};this.isWgtActive=!1}};a.prototype.initLoadingPanel=function(){var b=document.createElement("div");b.id=this.wgtId+"_loading";b.style.width=this.width+"px";b.style.height=this.height+"px";b.style.backgroundColor=
"white";b.style.display="flex";b.style.opacity="0";b.style.justifyContent="center";b.style.alignItems="center";b.classList.add("jm-hacklayer");b.innerHTML='\n\t\t<svg version="1.1" id="loader-1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t\t\twidth="40px" height="40px" viewBox="0 0 40 40" enable-background="new 0 0 40 40" xml:space="preserve">\n\t\t\t<path opacity="0.2" fill="#000" d="M20.201,5.169c-8.254,0-14.946,6.692-14.946,14.946c0,8.255,6.692,14.946,14.946,14.946\n\t\t\t\ts14.946-6.691,14.946-14.946C35.146,11.861,28.455,5.169,20.201,5.169z M20.201,31.749c-6.425,0-11.634-5.208-11.634-11.634\n\t\t\t\tc0-6.425,5.209-11.634,11.634-11.634c6.425,0,11.633,5.209,11.633,11.634C31.834,26.541,26.626,31.749,20.201,31.749z"/>\n\t\t\t<path fill="#000" d="M26.013,10.047l1.654-2.866c-2.198-1.272-4.743-2.012-7.466-2.012h0v3.312h0\n\t\t\t\tC22.32,8.481,24.301,9.057,26.013,10.047z">\n\t\t\t\t<animateTransform attributeType="xml"\n\t\t\t\tattributeName="transform"\n\t\t\t\ttype="rotate"\n\t\t\t\tfrom="0 20 20"\n\t\t\t\tto="360 20 20"\n\t\t\t\tdur="0.5s"\n\t\t\t\trepeatCount="indefinite"/>\n\t\t\t\t</path>\n\t\t</svg>\n\t\t';
this.loadingPanel=b};a.prototype.removeDataSrcSubscription=function(){this.hasDataSource()&&this.dataSource.unsubscribeWgt(this.proxyTable)};a.prototype.doMouseUp=function(b,a){if(a){var c=a.target.classList.contains("scrollbar-track"),d=a.target.classList.contains("scrollbar-thumb");c||d||b.wgt.isInHeader||(c=this.tableController.getRowIndexByRowYPosition(b.y),0>c&&c>this.tableController.getRowsNumber()&&(c=-1),this.setValue("currentRow",c,null,null))}};a.prototype.deactivateWidgetPrototypes=function(){for(var b in this.wgts)this.wgts[b].deactivateWidgetPrototypes()};
a.prototype.invalidateMtxChain=function(){this.initInvMtxChain=!1;var b=this.tableController.getViewMap(),a;for(a in b){var c=b[a].getWidgets(),d;for(d in c){var f=c[d];f.initInvMtxChain=!1;f.wgts&&f.invalidateMtxChain()}}};a.prototype.loadInitDOMStructure=function(){this.fragment=document.createDocumentFragment();var b=document.createElement("div"),a=document.createElement("div");b.id=this.wgtId+".header";b.style.position="relative";b.style.width=this.width+"px";a.id=this.wgtId+".body";a.style.position=
"relative";a.style.width=this.width+"px";a.style.height=this.height+"px";a.style.overflow="hidden";this.fragment.appendChild(b);this.fragment.appendChild(a);this.renderDynamicHeaderGridElement();this.renderDynamicTableGridElement()};a.prototype.deleteOutRows=function(){var b=this.elem.querySelector("#"+CSS.escape(this.wgtId+".table-grid")),a=this.scrollbarInstance.getContentEl();this.rowsToRemove.forEach(function(c){var d=c.getWidgets(),f=c.getGraphicGridRow();if(c.isWgtsInDOM){for(var k in d){var g=
a.querySelector("#"+CSS.escape(d[k].wgtId));null!=g&&a.contains(g)&&g.remove()}b.contains(f)&&f.remove();c.isWgtsInDOM=!1;c.isGridInDOM=!1}})};a.prototype.renderLoading=function(){var b=this.elem.querySelector("#"+this.wgtId+"_loading"),a=null;this.scrollbarInstance&&(a=this.scrollbarInstance.getContentEl());this.enableLoadingPanel?(this.loadingPanel.style.opacity="1",null==b?null==a?this.elem.appendChild(this.loadingPanel):a.appendChild(this.loadingPanel):b.style.opacity="1"):b&&(b.style.opacity=
"0")};a.prototype.renderTableBodyGrid=function(b,a){this.dynamicGridInstance.applyRowElementStyles(this,b);a.appendChild(b.getGraphicGridRow());b.isGridInDOM=!0};a.prototype.renderTableBodyWidgets=function(b,a){var c=b.getWidgets(),d;for(d in c){var f=c[d],k=f.getParentBounds(this),g=b.getTop()+f.getLayout().tMargin;f.setParentBounds(k.x,g,k.width,k.height,this);f.updateLanguage();a.appendChild(f.elem)}b.isWgtsInDOM=!0};a.prototype.renderTableBody=function(){var b=this,a=this.elem.querySelector("#"+
CSS.escape(this.wgtId+".table-grid")),c=this.getGLColProps(),d=this.getGridColsNumber();this.clearDOM&&(this.clearTableHeaderDOM(),this.clearTableBodyDOM(),this.clearDOM=!1);a&&(a.style.left=c[0].colPos+"px",a.style.width=c[d].colPos-c[0].colPos+"px");var f=document.createDocumentFragment(),g=document.createDocumentFragment(),c=this.scrollbarInstance.getContentEl();this.rowsToRender.forEach(function(a){b.renderTableBodyGrid(a,f);b.renderTableBodyWidgets(a,g)});a.appendChild(f);c.appendChild(g)};a.prototype.renderTableHeaderGrid=
function(){var b=this.elem.querySelector("#"+CSS.escape(this.wgtId+".table-grid-header")),a=this.tableHeaderRow.getGraphicGridRow(),c=this.getGLColProps(),d=this.getGridColsNumber();b&&(b.style.left=c[0].colPos+"px",b.style.width=c[d].colPos-c[0].colPos+"px");this.dynamicGridInstance.applyRowElementStyles(this,this.tableHeaderRow);b.appendChild(a)};a.prototype.renderTableHeaderWidgets=function(){for(var b=this.tableHeaderRow,a=this.elem.querySelector("#"+CSS.escape(this.wgtId+".header")),c=b.getWidgets(),
d=document.createDocumentFragment(),f=0;f<c.length;f++){var g=c[f],q=g.getParentBounds(this),m=b.getTop(),l=b.getHeight();g.setParentBounds(q.x,m,q.width,l,this);g.updateLanguage();d.appendChild(g.elem)}a.appendChild(d)};a.prototype.renderTableHeader=function(){var b=this.elem.querySelector("#"+CSS.escape(this.wgtId+".header")),a=this.elem.querySelector("#"+CSS.escape(this.wgtId+".body"));this.clearTableHeaderDOM();if(b){var c=this.getHeaderHeight();b.style.display="block";b.style.height=c+"px";b.style.width=
this.scrollContentWidth+"px";a.style.height=this.height-c+"px";this.renderTableHeaderGrid();this.renderTableHeaderWidgets()}};a.prototype.renderHeaderScroll=function(){this.scrollbarInstance&&this.hasHeader()&&(this.elem.querySelector("#"+CSS.escape(this.wgtId+".header")).style.left=-this.scrollbarInstance.getOffset().x+"px")};a.prototype.clearTableHeaderDOM=function(){if(this.hasHeader()){var b=this.elem.querySelector("#"+CSS.escape(this.wgtId+".header")),a=this.elem.querySelector("#"+CSS.escape(this.wgtId+
".table-grid-header"));null!==b&&null!==a&&(b.innerHTML="",a.innerHTML="",b.appendChild(a))}};a.prototype.clearTableBodyDOM=function(){var b=this.scrollbarInstance.getContentEl(),a=this.elem.querySelector("#"+CSS.escape(this.wgtId+".table-grid"));null!==b&&null!==a&&(b.innerHTML="",a.innerHTML="",b.appendChild(a))};a.prototype.updateBodySize=function(){var b=this.elem.querySelector("#"+CSS.escape(this.wgtId+".body"));b&&(b.style.width=this.width+"px",b.style.height=this.height-this.getHeaderHeight()+
"px")};a.prototype.updateHeaderSize=function(){var b=this.elem.querySelector("#"+CSS.escape(this.wgtId+".header"));b&&(b.style.width=this.width+"px")};a.prototype.updateScrollContentSize=function(){this.updateScrollContent&&this.scrollbarInstance&&(this.scrollbarInstance.setContentSize({height:this.scrollContentHeight}),this.scrollbarInstance.update(),this.updateScrollContent=!1)};a.prototype.updateDOMStructure=function(){if(this.fragment){this.clearDOM&&(this.elem.innerHTML="");var b=this.fragment.querySelector("#"+
CSS.escape(this.wgtId+".body"));b.style.width=this.width+"px";b.style.height=this.height+"px";this.elem.appendChild(this.fragment);this.createScrollbar(b);this.dynamicGridInstance.applyExternalBorderStyles(this)}this.fragment=null};a.prototype.renderDynamicHeaderGridElement=function(){var b=this.fragment.querySelector("#"+CSS.escape(this.wgtId+".header")),a=this.fragment.querySelector("#"+CSS.escape(this.wgtId+".table-grid-header"));a||(a=document.createElement("div"),a.id=this.wgtId+".table-grid-header",
a.classList.add("jm-dynamic-grid-header"),b.appendChild(a))};a.prototype.renderDynamicTableGridElement=function(){var b=this.fragment.querySelector("#"+CSS.escape(this.wgtId+".body")),a=this.fragment.querySelector("#"+CSS.escape(this.wgtId+".table-grid"));a||(a=document.createElement("div"),a.id=this.wgtId+".table-grid",a.classList.add("jm-dynamic-grid"),b.appendChild(a))};a.prototype.renderSelection=function(){this.dynamicGridInstance.changeRowBackgroundColor(this)};a.prototype.render=function(){c.prototype.render.call(this);
this.tableRenderMask&a._renderFlagsTableGroup.UPHEADERSIZE&&this.updateHeaderSize();this.tableRenderMask&a._renderFlagsTableGroup.UPBODYSIZE&&this.updateBodySize();if(this.tableRenderMask&a._renderFlagsTableGroup.RENDERVIEW){this.updateDOMStructure();this.deleteOutRows();this.renderTableBody();this.activateDelegates();this.invalidateMtxChain();for(var b=0;b<this.resolveScroll.length;b++)this.resolveScroll[b](!0);this.resolveScroll=[]}this.tableRenderMask&a._renderFlagsTableGroup.UPSCROLLCONTENTSIZE&&
(this.updateScrollContentSize(),this.refreshMode&&(this.resetScrollbarPosition(),this.refreshMode=!1));this.tableRenderMask&a._renderFlagsTableGroup.RENDERSELECTION&&this.renderSelection();this.tableRenderMask&a._renderFlagsTableGroup.RENDERHEADER&&this.renderTableHeader();this.tableRenderMask&a._renderFlagsTableGroup.RENDERSCROLLHEADER&&this.renderHeaderScroll();this.tableRenderMask&a._renderFlagsTableGroup.LOADING&&this.renderLoading();this.tableRenderMask=0};a.prototype.showLoading=function(){this.enableLoadingPanel=
!0;this.tableRenderMask|=a._renderFlagsTableGroup.LOADING;g.addToRender(this)};a.prototype.hideLoading=function(){this.enableLoadingPanel=!1;this.tableRenderMask|=a._renderFlagsTableGroup.LOADING;g.addToRender(this)};a.prototype.renderView=function(){this.tableRenderMask|=a._renderFlagsTableGroup.RENDERVIEW;this.tableRenderMask|=a._renderFlagsTableGroup.UPSCROLLCONTENTSIZE;g.addToRender(this)};a.prototype.renderHeader=function(){this.tableRenderMask|=a._renderFlagsTableGroup.RENDERHEADER;g.addToRender(this)};
a.prototype.scrollHeader=function(){this.tableRenderMask|=a._renderFlagsTableGroup.RENDERSCROLLHEADER;$hmi.addToRender(this)};a.prototype.setTableBorder=function(b){this.elem.style.border=b};a.prototype.setScrollContentSize=function(b,a){this.scrollContentWidth=void 0==b?0:isNaN(b)?0:Number(b);this.scrollContentHeight=void 0==a?0:isNaN(a)?0:Number(a)};a.prototype.setRowTopBottomBounds=function(b){var a=b.getWidgets(),c;for(c in a){var d=a[c],f=b.getIndex(),g=this.tableController.getTableGeometryMap(),
q=b.getTStroke(),m=b.getBStroke(),l=b.isHeader?0:g.getRowTop(f),f=b.isHeader?this.getHeaderHeight():g.getRowHeight(f),g=l,p=f,l=l+q,f=f-q-m;b.setTop(l);b.setGeometryTop(g);b.setHeight(f);b.setGeometryHeight(p);d.top=l;d.height=f}};a.prototype.addTableHeaderRow=function(b){this.tableHeaderRow=b;this.setRowTopBottomBounds(b);this.renderHeader()};a.prototype.addTableRow=function(b){this.rowsToRender.set(b.getIndex(),b);this.setRowTopBottomBounds(b)};a.prototype.removeTableRow=function(b){this.rowsToRemove.set(b.getIndex(),
b)};a.prototype.resetRowMaps=function(){this.rowsToRender.clear();this.rowsToRemove.clear()};a.prototype.deactivateDelegates=function(){g.evtMgr.trigger(this.elem,"unloadWgt")};a.prototype.activateDelegates=function(){g.evtMgr.trigger(this.elem,"loadWgt")};a.prototype.getDynamicGrid=function(){return this.dynamicGridInstance};a.prototype.getPrecachedPages=function(){return this.precachedPages};a.prototype.getSortedProtoWidgets=function(){return this.sortedWidgets};a.prototype.getSelRowIndex=function(){return this.currSelRow};
a.prototype.getPrevSelRowIndex=function(){return this.prevSelRow};a.prototype.getRowAtIndex=function(b){return this.tableController.getRowAtIndex(b)};a.prototype.getModelTotalHeight=function(){return this.tableController.getTotalHeight()};a.prototype.getHeaderHeight=function(){return this.tableController.getHeaderHeight()};a.prototype.getRowPrototypeHeight=function(b){return this.tableController.getRowPrototypeHeight(this,b)};a.prototype.getHeader=function(){return this.tableController.getHeader()};
a.prototype.hasHeader=function(){return this.tableController.hasHeader()};a.prototype.getXScrollPosition=function(){return this.scrollbarInstance?this.scrollbarInstance.getOffset().x:0};a.prototype.getYScrollPosition=function(){return this.scrollbarInstance?this.scrollbarInstance.getOffset().y:0};a.prototype.getWidgetsOfRow=function(b){var a=[],c;for(c in this.wgts){var d=this.wgts[c];if(!(d instanceof r)){var f=this.getGridSize(),f=d.getGridPosition(f),g=f.cOcc;f.rOcc==b&&a.splice(g-1,0,d)}}return a};
a.prototype.findNestedWgt=function(b,a){if(b.wgtId==a)return b;if(null!=b.wgts)for(var c in b.wgts){var d=this.findNestedWgt(b.wgts[c],a);if(null!=d)return d}return null};a.prototype.getWidget=function(b,a,h){h=c.prototype.getWidget.call(this,b,a,h);if(null!==h)return h;if(!this.tableController)return null;var d=this.tableController.getViewMap(),f=this.tableController.getHeader(),g;for(g in d){a=d[g].getWidgets();for(var q in a)if(h=this.findNestedWgt(a[q],b),null!=h)return h}if(null!=f){a=f.getWidgets();
for(var m in a)if(g=a[m],g=this.findNestedWgt(a[m],b),null!=g)return g}return null};a.prototype.getPropertyIndex=function(b,a,c,d){d=-1;if(this.proxyTable){var f=this.proxyTable.getModel()[0]._h;if(b<f.length&&(b=f[b],a<b.length&&(c=b[a].indexOf(c),-1!=c))){for(f=d=0;f<a;f++)d+=b[f].length;d+=c}}return d};a.prototype.mapToModel=function(b){var a=this.getProxyTable();return a&&(a=a.getProxedModelItems(),a[b])?a[b].originalIndex:-1};a.prototype.setSortingRulesJS=function(b){if(b instanceof Array){var a=
[];b=b.filter(function(b){return void 0!==b._c&&void 0!==b._m&&void 0!==b._t?(a.push(b._c),!0):!1});this.setSortingRules(b);this.updateProxySortingRules()}};a.prototype.updateProxySortingRules=function(){this.proxyTable&&this.proxyTable.updateSortingRules(this.sortingRules)};a.prototype.updateLanguage=function(){this.hasDataSource()&&this.dataSource.updateLanguage()};a.prototype.getText=function(b,a){return this.tableController.getText(b,a)};a.prototype.setParentBounds=function(b,e,h,d,f){c.prototype.setParentBounds.call(this,
b,e,h,d,f);this.updateScrollContent=!0;this.tableRenderMask|=a._renderFlagsTableGroup.UPHEADERSIZE;this.tableRenderMask|=a._renderFlagsTableGroup.UPBODYSIZE;this.tableRenderMask|=a._renderFlagsTableGroup.UPSCROLLCONTENTSIZE;$hmi.addToRender(this)};a.prototype.updateGeometry=function(){this.updateGridLayoutConfiguration();this.gridLayoutInstance.applyAlgorithm(this);this.update()};a.prototype.executeGridLayout=function(){this.updateGeometry()};a.prototype.setXScroll=function(b){this.xScroll=b};a.prototype.setYScroll=
function(b){this.yScroll=b};a.prototype.getPromiseFunction=function(b){var a=this;return function(){return new Promise(function(c){a.resolveScroll.push(c);a.tableController.scrollTo(a,b.yPos,b.force)})}};a.prototype.scrollTo=function(b){this.promiseStack.push(this.getPromiseFunction(b));this.fire()};a.prototype.fire=function(){var b=this;this.promiseStack.length&&this.promiseStack.shift()().then(function(){b.resetRowMaps();b.fire()})};a.prototype.scrollTable=function(b){var a=this.tableController.getStartIndex(),
a=this.tableController.getTableGeometryMap().getRowTop(a+b);null===a&&(a=0<b?this.getModelTotalHeight():0);this.scrollbarInstance.scrollTo(this.xScroll,a)};a.prototype.resetScrollbarPosition=function(){this.scrollbarInstance&&(this.setXScroll(0),this.setYScroll(0),this.setValue("relHorScrollPos",0,null,null),this.setValue("relVerScrollPos",0,null,null))};a.prototype.setRefreshMode=function(b){this.refreshMode=b};a.prototype.setModel=function(){this.hideLoading();this.resetRowMaps();this.updateGeometry()};
a.prototype.update=function(){this.updateScrollContent=this.clearDOM=!0;this.tableHeaderRow=null;this.tableController.update(this);this.scrollTo({yPos:this.yScroll,force:!0})};a.prototype.addWidget=function(b,a){c.prototype.addWidget.call(this,b,a);this.disabled&&a.setValue("disabled",1,null,null);var h=a.getLayout();if(null!==h){var d=h.rOcc-1,h=h.cOcc-1;null==this.sortedWidgets[d]&&(this.sortedWidgets[d]=[]);this.sortedWidgets[d].splice(h,0,a)}};a.prototype.scrollCallback=function(){if(0<this.activeElements.length)for(var b in this.activeElements)this.activeElements[b].remove();
if(this.scrollbarInstance){b=this.scrollbarInstance.getLimit();var a=this.scrollbarInstance.getScrollTop(),c=this.scrollbarInstance.getScrollLeft();this.setXScroll(c);this.setYScroll(a);this.setValue("relHorScrollPos",this.xScroll/b.x,null,null);this.setValue("relVerScrollPos",this.yScroll/b.y,null,null);this.scrollHeader();this.scrollTo({yPos:this.yScroll});b.y==a&&this.dataSource&&0==this.proxyTable.fetchMoreRunning&&this.proxyTable.executeFetchMoreOnScroll()}};a.prototype.subscribeProxyToDataSrc=
function(b){b.dataSrc.subscribeWgt(this.proxyTable,null)};a.prototype.addDataLink=function(b){c.prototype.addDataLink.call(this,b);switch(b.attr){case "tableModel":this.subscribeProxyToDataSrc(b);this.dataSource=b.dataSrc;this.proxyTable.dataSource=b.dataSrc;break;case "filter":this.filterColName=b.tag;this.filterSrcType=b.srcType;break;case "rowsBg":this.rowsBgTag=b.tag;break;case "sorting1":this.sortingRules.push({_c:b.tag,_m:this.sortingMode1,_t:this.sortingType1});break;case "sorting2":this.sortingRules.push({_c:b.tag,
_m:this.sortingMode2,_t:this.sortingType2});break;case "sorting3":this.sortingRules.push({_c:b.tag,_m:this.sortingMode3,_t:this.sortingType3})}};a.prototype.getOffsetTop=function(){return this.hasHeader()?this.getHeaderHeight():0};a.prototype.getOffsetLeft=function(){return 0};a.prototype.getProject=function(){return g.getActiveProject()};a.prototype.getProxyTable=function(){return this.proxyTable};a.prototype.getModel=function(){return this.proxyTable.getModel()};a.prototype.getProxyModel=function(){return this.proxyTable.getProxyModel()};
a.prototype.hasRowAtIndex=function(b){return 0<=b&&b<this.getGridRowsNumber()};a.prototype.hasDataSource=function(){return void 0!==this.dataSource};a.prototype.doOnDataUpdate=function(b,a,c,d,f,k){if(void 0!=this.onDataUpdate)if("beginSetModel"!=c&&"endSetModel"!=c||0!=this.jsProxyModel){b={oldValue:a,newValue:b,attrName:c,mode:f,index:d,cb:k};a=this.onDataUpdate;for(c=0;c<a.length;c++)g.doAction(this.wgtId,a[c],b);g.actionMgr.doActions()}else k(b);else k(b)};a.prototype.setValue=function(b,e,h,
d){var f=!1;switch(b){case "model":case "tableModel":if(void 0!==e&&e instanceof Array){if(0<e.length&&e[0]._h instanceof Array){var k=e[1]._h;d=e[0];var q=k?e[1]:null,k=k?e.slice(2):e.slice(1);this.proxyTable.setRefreshMode(!0);this.proxyTable.resetModel();this.proxyTable.appendProps(d);this.proxyTable.appendHeader(q);this.proxyTable.appendBody(k);this.proxyTable.evaluateModel()}this.sendUpdate(b,e,h)}break;case "currentRow":this.currSelRow!==e&&(this.prevSelRow=this.currSelRow,this.currSelRow=e,
this.tableRenderMask|=a._renderFlagsTableGroup.RENDERSELECTION,this.sendUpdate(b,this.currSelRow,h),this.doOnDataUpdate(this.currSelRow,this.prevSelRow,b,0,"R",function(){}),f=!0);break;case "precachedPages":e!==this.precachedPages&&(0>e?e=0:4<e&&(e=4),this.precachedPages=e,this.sendUpdate(b,this.precachedPages,h));break;case "filter":this.proxyTable&&this.parentPage.wgtId==g.getFocusPage().wgtId&&this.proxyTable.setValue(b,e,h);break;default:c.prototype.setValue.call(this,b,e,h,d)}f&&g.addToRender(this)};
a.prototype.getValue=function(b){switch(b){case "model":case "tableModel":return this.proxyTable.getModel();case "currentRow":return this.currSelRow;case "precachedPages":return this.precachedPages;default:return c.prototype.getValue.call(this,b)}};a.prototype.isSortingEnabled=function(){return 0<this.sortingRules.length};a.prototype.isFilterEnabled=function(){return""!=this.filterColName||"Formula"==this.filterSrcType};a.prototype.getSortingRules=function(){return this.sortingRules};a.prototype.setSortingRules=
function(b){this.sortingRules=b};a.prototype.addSortingRules=function(b){for(var a=0;a<b.length;a++)this.sortingRules.unshift(b[a])};a.prototype.removeSortingRulesByColumnNames=function(b){this.sortingRules=this.sortingRules.filter(function(a){return-1==b.indexOf(a._c)})};a.prototype.appendToScrollContent=function(b){this.scrollbarInstance&&this.scrollbarInstance.getContentEl().appendChild(b)};a.prototype.destroy=function(){c.prototype.destroy.call(this);this.removeDataSrcSubscription();this.resetRowMaps();
this.promiseStack=[];this.resolveScroll=[];this.tableController.destroyHeaderDelegates();this.tableController.destroyBodyDelegates();this.tableController=null;return!0};a._renderFlagsTableGroup={RENDERVIEW:1,RENDERSELECTION:2,RENDERHEADER:4,RENDERSCROLLHEADER:8,UPHEADERSIZE:16,UPBODYSIZE:32,UPSCROLLCONTENTSIZE:64,LOADING:128};a.jmType="TableGroupWgt";return a}(Va);g.fn.hmiTableGroupWgt=function(c,a,b,e){return new Pa(this,c,a,b,e)};g.addWidgetDefinition("hmiTableGroupWgt",Pa);var fb=function(c){function a(b,
a,h,d,f){var k=c.call(this,b.wgtId,a,h,d,f)||this;k.unsubscribeDynamicTags=function(){var b=this;this.dynamicTagMgr.unsubscribeTags(function(a){return!b.isTagSubscribeInActiveGroup(a)})};k.dataLinks={};k.activeCgiGroups={};b=k.core.import("DynamicTagSubscriber.ts");k.dynamicTagMgr=new b;k.status=0;k.sbsQueue=[];k.initPromiseReady();if(!g.enablePjctWidgetServerReq)return k;k.parentWidget.waitWgtReady().then(function(){k.srv=k.parentWidget.getCommunticationObj();k.dynamicTagMgr.setServerInterface(k.srv);
k.srv.getConf().then(function(b){k.readConfiguration(b)}).catch(function(){g.getAction("hmiActionShowMessage").execute(null,{msg:"Error loading groups configuration file. Reloading..."},3);setTimeout(function(){k.project.getCommunticationObj().loadIndex()},2E3)})});return k}p(a,c);a.prototype.readConfiguration=function(b){var a=this;this.groupsInfo=b["groups.json"];this.status=1;this.srv.getConf("tags.json").then(function(b){a.tagsInfo=b["tags.json"];a.status=2;a.resolveWgtReady(!0);if(!g.isTestModeActive()){a.srv.subscribeNotification("tags",
function(b){a.onDataReady(b)});b=0;for(var c=a.sbsQueue.length;b<c;b++)a.cerateSubscription(a.sbsQueue[b].sbsWgtId,a.sbsQueue[b].pageObj);a.sbsQueue=[];a.sendNotification("tagmgrready")}}).catch(function(){g.getAction("hmiActionShowMessage").execute(null,{msg:"Error loading tags configuration file. Reloading..."},3);setTimeout(function(){a.project.getCommunticationObj().loadIndex()},2E3)})};a.prototype.getGroupInfo=function(b){return this.groupsInfo[b]};a.prototype.getTagInfo=function(b){return this.tagsInfo&&
this.tagsInfo[b]?this.tagsInfo[b]:null};a.prototype.isReady=function(){return 2==this.status};a.prototype.subscribeForTagsNotification=function(b){this.srv.subscribeTags(b)};a.prototype.unsubscribeForTagsNotification=function(b){this.srv.unsubscribeTags(b)};a.prototype.subscribeGroup=function(b,a,c){void 0===c&&(c=!0);2==this.status?this.cerateSubscription(b,a,c):this.sbsQueue.push({sbsWgtId:b,pageObj:a})};a.prototype.cerateSubscription=function(b,a,c){if(this.groupsInfo[b]){var d=new ec({wgtId:b},
b,{groupName:b,pollRate:this.pollRate,tagMgr:this,tags:this.groupsInfo[b].tgs},a,a),f=this.activeCgiGroups[b];a=a.wgtId;if(null==f)this.activeCgiGroups[b]={group:d,status:c,pages:[a],groupId:b};else{null!=f.group&&d.setCallbackId(f.group.getCallbackId());f.group=d;var g=f.pages;-1==g.indexOf(a)&&g.push(a);f.status=!0}c&&(b=this.srv.subscribeGroups([b],null),d.setCallbackId(b))}};a.prototype.onDataReady=function(b){for(var a,c=[],d=0,f=b.length;d<f;d++)a=b[d],this.core.updateTagsCache(a.n,a)&&c.push(a);
this.sendNotification("indexedtagsetready",b);b=c;d=0;for(c=b.length;d<c;d++){a=g.cache.getTag(b[d].n);var f=a.getValue(),k=this.dataLinks[a.name];if(k)for(var q=0,m=k.length;q<m;q++)if(a.isQualityGood()){var l=0;0!=k[q].tagIndex?l=k[q].tagIndex:k[q].tgtWgt.index&&(l=k[q].tgtWgt.index);if(Array.isArray(f))if("Index"==k[q].attr)k[q].setWgtValue(f,l,a.getQuality(),null,a.ts);else if(-1==l)k[q].setWgtValue(f,l,a.getQuality());else if(void 0==f[l]){var p=t.getModule("Quality");k[q].setWgtValue(f[l],l,
new p(0),null,a.ts)}else k[q].setWgtValue(f[l],l,a.getQuality(),null,a.ts);else k[q].setWgtValue(f,-1,a.getQuality(),null,a.ts)}else k[q].setWgtValue(null,-1,a.getQuality(),null,a.ts)}};a.prototype.isTagSubscribeInActiveGroup=function(b){for(var a in this.activeCgiGroups){var c=this.activeCgiGroups[a],d=c.group;if(c.status&&null!==d&&d.containsTag(b))return!0}return!1};a.prototype.isTagSubscribed=function(b){return this.isTagSubscribeInActiveGroup(b)||this.dynamicTagMgr.isTagSubscribed(b)};a.prototype.addDataLink=
function(b){var a=this,c=b.tag;if(!this.isTagSubscribeInActiveGroup(c)){var d=this.project.getPageMgr();d.isPrecaching()?d.waitPrecacheEnd().then(function(){a.dynamicTagMgr.addTag(c)}):this.dynamicTagMgr.addTag(c)}this.dataLinks[c]?(d=this.dataLinks[c],b.hasStructuredTag()&&d[d.length-1]===b||d.push(b)):(this.dataLinks[c]=[],this.dataLinks[c].push(b))};a.prototype.removeDataLink=function(b){var a=this.dataLinks[b.tag],c=null;if(null!=a){for(var d=0,f=a.length;d<f;d++)if(a[d].getId()==b.getId()){c=
d;break}null!=c&&(a.splice(c,1),0==a.length&&delete this.dataLinks[b.tag])}this.dynamicTagMgr.removeTag(b.tag)};a.prototype.subscribeDataLink=function(b){this.addDataLink(b)};a.prototype.unsubscribeDataLink=function(b){this.removeDataLink(b)};a.prototype.updateDataLink=function(b){var a=t.getModule("Tag"),c=g.cache.getTag(b.tag),d=b.tagIndex;void 0==d&&(d=-1);c?this.sendUpdate(b.tag,c.getValue(d),c.getQuality(),d):this.sendUpdate(b.tag,"",a.QUALITY_GOOD,d)};a.prototype.subscribeDynamicTags=function(){var b=
this;this.dynamicTagMgr.subscribeTags();var a=this.project.getPageMgr();a.isPrecaching()&&a.waitPrecacheEnd().then(function(){b.dynamicTagMgr.subscribeTags()})};a.prototype.subscribePageGroups=function(b){for(var a in this.activeCgiGroups){var c=this.activeCgiGroups[a];if(c&&-1!=c.pages.indexOf(b)&&0==c.status){var d=g.getFocusPage();c.group=new ec({wgtId:c.groupId},c.groupId,{groupName:c.groupId,pollRate:this.pollRate,tagMgr:this,tags:this.groupsInfo[c.groupId].tgs},d,d);d=this.srv.subscribeGroups([c.groupId],
null);c.group.setCallbackId(d);c.status=!0}}};a.prototype.unsubscribePageGroups=function(b){for(var a in this.activeCgiGroups)if(-1!=this.activeCgiGroups[a].pages.indexOf(b)){var c=this.activeCgiGroups[a].group.getCallbackId();this.srv.unsubscribeGroups([c]);this.activeCgiGroups[a].status=!1;this.activeCgiGroups[a].group=null}};a.prototype.setValue=function(b,a,c,d){var f=g.cache.getTag(b),k=null,l;d?(k=new H,d=void 0,f&&(d=f.clone()),k=this.setTagValue(b,a,c,k,!1,d)):f&&this.dataLinks[b]&&(d=f.getQuality(),
l=void 0,f.value instanceof Array&&0<=c?(f=g.cache.getTag(b).clone(!1),c<f.value.length&&(f.value[c]=parseFloat(a),l=f.value)):l=a,l=new (t.getModule("Tag"))(b,c,l,"S_OK"),l.setQuality(d),g.cache.updateTag(b,l)&&this.sendUpdate(b,a,d,c));return null===k?l?(b=new H(l.getQuality(),l.getValue(),l.getValueType(),"S_OK",l.ts),Promise.resolve(b)):Promise.resolve(null):k};a.prototype.setTagValue=function(b,a,c,d,f,g){var l=this,m=t.getModule("Tag");this.tagsInfo[b]&&this.tagsInfo[b].t==v.TIME&&("string"==
typeof a&&(a=parseInt(a)),a=(new Date(1E3*a)).toISOString());return f?this.srv.writeTag(new m(b,c),a,d,!0):this.srv.writeTag(new m(b,c),a,d,!1).then(function(b){return l.processWriteTagResponse(b,g)})};a.prototype.processWriteTagResponse=function(b,a){if(null!=b&&null!=b.tgs[0]){var c=b.tgs[0],d=y.getCode(c.code),f=void 0;if(!c.code||0<d){if(!c.code||y.getCode(c.readCode)==y.status.S_OK)return f={n:c.name,v:{q:c.quality,v:c.value,ts:c.ts,idx:c.idx}},this.onDataReady([f]),d=g.cache.getTag(c.name),
new H(d.getQuality(),d.getValue(),d.getValueType(),c.code,d.ts)}else switch(d){case y.status.E_WRITE_FORBIDDEN:if(a)return f={n:a.name,v:{q:a.quality.getStatus(),v:a.value,ts:a.ts,idx:a.index}},this.onDataReady([f]),d=g.cache.getTag(c.name),new H(d.getQuality(),d.getValue(),d.getValueType(),c.code,d.ts)}}return null};a.prototype.sendUpdate=function(b,a,c,d){var f=this.dataLinks[b],g=new (t.getModule("Quality"))(0);if(f)for(var l=0,m=f.length;l<m;l++){var n=0;-1!=f[l].tagIndex?n=f[l].tagIndex:f[l].tgtWgt.index&&
(n=f[l].tgtWgt.index);if(f[l].tag==b)if(f[l].dataSrc.getValue(f[l].tag)instanceof Array){if(-1==d||-1==n||d==n){var p=f[l].dataSrc.getValue(f[l].tag).length;0>n||n>p-1?f[l].setWgtValue(a,n,g):f[l].setWgtValue(a,n,c)}}else f[l].setWgtValue(a,n,c)}};a.prototype.getTagValue=function(b,a){var c=this,d=t.getModule("Tag");if("undefined"!=typeof g.getTagFromCache(b)){var f=g.getTagFromCache(b),d=f.getValue();d.constructor==Array&&-1!=a&&(f=new H,f.setValue(d[a]));return $.Deferred().resolve(f)}return this.srv.readTag(new d(b,
a)).then(function(d){return d?d:c.getTagValue(b,a)})};a.prototype.getValue=function(b,a){var c=t.getModule("Tag"),d=this,f=g.cache.getTag(b);return f?(void 0==a&&(a=-1),f.getValue(a)):this.srv.readTag(new c(b,0)).then(function(a){return a&&a.getMessageStatus().getValue()!=y.status.E_TIMEOUT?a.getValue():d.getValue(b)})};a.prototype.stepTag=function(b,a,c,d,f){return this.srv.stepTags([{name:b,arrayIndex:a,params:{s:c,no:f?1:0,l:d}}])};a.prototype.toggleTag=function(b,a,c){return this.srv.toggleBitTags([{name:b,
arrayIndex:a,params:{i:c}}])};a.prototype.setBitTag=function(b,a,c){return this.srv.setBitTags([{name:b,arrayIndex:a,params:{i:c}}])};a.prototype.resetBitTag=function(b,a,c){return this.srv.resetBitTags([{name:b,arrayIndex:a,params:{i:c}}])};a.jmType="TagMgrWgt";return a}(l);g.fn.hmiTagMgr=function(c,a,b,e){return new fb(this,c,a,b,e)};g.addWidgetDefinition("hmiTagMgr",fb);var cd=function(){function c(){this.style=document.getElementById("jm-dyn-style");null===this.style&&(this.style=document.createElement("style"),
this.style.setAttribute("id","jm-dyn-style"),document.head.appendChild(this.style));this.sheet=this.style.sheet}c.prototype.selector=function(a,b){this.sheet.insertRule(a+" { "+b+" }",this.sheet.cssRules.length);return a};c.prototype.removeStyleRule=function(a){for(var b=this.sheet.cssRules,c=0,h=b.length;c<h;c++){var d=b[c];if(1==d.type&&d.selectorText==a)return this.sheet.deleteRule(c),!0}return!1};c.prototype.removeKeyframesRule=function(a){for(var b=this.sheet.cssRules,c=0,h=b.length;c<h;c++){var d=
b[c];if(7==d.type&&d.name==a)return this.sheet.deleteRule(c),!0}return!1};return c}(),ka;(function(c){c[c.NONE=0]="NONE";c[c.SLOW=1]="SLOW";c[c.NORMAL=2]="NORMAL";c[c.FAST=3]="FAST"})(ka||(ka={}));var Dd=function(c){function a(b,e,h,d,f){b=c.call(this,b,e,h,d,f)||this;b.setDefaultState();b.textCnt=b.elem.querySelector(".jm-text");b.fontColor=b.textCnt.style.color;if(b.hasDynamicVariables()||b.scrollMode!=ka.NONE)b.addActivationHandler(),b.scrollMode!=ka.NONE&&(b._renderMask|=a._renderFlags.SCROLL,
g.addToRender(b));return b}p(a,c);a.prototype.addActivationHandler=function(){var b=this;g.getEventMgr()&&(this.activateHandler=function(){c.prototype.executeActivationCallback.call(b)&&(b.isLiveTagsEnabled()&&b.hasDynamicVariables()&&(b.loadDynamicTagsForText(0),b.project.getTagMgr().subscribeDynamicTags()),b.scrollMode!=ka.NONE&&(b._renderMask|=a._renderFlags.SCROLL,g.addToRender(b)),b.isWgtActive=!0)},this.deactivateHandler=function(){c.prototype.executeDeactivationCallback.call(b)&&(b.isLiveTagsEnabled()&&
b.hasDynamicVariables()&&b.unloadDynamicDataLinks(),b.scrollMode!=ka.NONE&&b.disableScroll&&(b.currentScrollSpeed=0,b.disableScroll(),b.writeText(b.text)),b.isWgtActive=!1)},c.prototype.bindEvents.call(this,{loadWgt:this.activateHandler,unloadWgt:this.deactivateHandler}))};a.prototype.setDefaultState=function(){this.text=void 0!==this.text?this.text:null;this.fontColor=void 0!==this.fontColor?this.fontColor:null;this.fontFamily=void 0!==this.fontFamily?this.fontFamily:null;this.masked=void 0!==this.masked?
this.masked:null;this.currentScrollSpeed=void 0!==this.currentScrollSpeed?this.currentScrollSpeed:0;this.scrollMode=void 0!==this.scrollMode?this.scrollMode:0;this.disableScroll=void 0!==this.disableScroll?this.disableScroll:null;this.invokablePropsList=["fill","fontColor"];this._renderMask=0};a.prototype.render=function(){c.prototype.render.call(this);if(this._renderMask&a._renderFlags.VALUE){var b=null===this.text?"":this.text;this.masked?this.writeMaskedText(b):this.writeText(b)}this._renderMask&
a._renderFlags.SCROLL&&this.renderScrolling();this._renderMask&L._renderFlags.FRAME&&(this.frame?(this.elem.style.border=this.frameSize+"px solid "+this.frameColor,this.elem.style["background-color"]=this.frameFill):(this.elem.style.border="",this.elem.style["background-color"]=""));this._renderMask=0;return!0};a.prototype.renderScrolling=function(){var b=0;if(0!=this.scrollMode){switch(this.scrollMode){case ka.SLOW:b=a.SPEED.SLOW;break;case ka.NORMAL:b=a.SPEED.NORMAL;break;case ka.FAST:b=a.SPEED.FAST}0!=
this.currentScrollSpeed&&null!=this.disableScroll&&this.disableScroll();this.enableScrolling(this.elem,this.textCnt,b)}else null!=this.disableScroll&&this.disableScroll();this.currentScrollSpeed=b};a.prototype.writeText=function(b){var a=this,c=this.textCnt.querySelector("p"),d=function(b){var d;c?d=c.cloneNode(!0):(d=document.createElement("p"),d.style.wordBreak="break-word",d.style.whiteSpace=a.wrapping?"pre-wrap":"noWrap");d.textContent=b;return d};if(-1==b.indexOf("&#xa;"))this.textCnt&&(this.textCnt.textContent=
"",this.textCnt.appendChild(d(b)));else if(this.textCnt){this.textCnt.textContent="";b=b.split("&#xa;");for(var f=document.createDocumentFragment(),g=0,l=b.length;g<l;g++)f.appendChild(d(b[g]));this.textCnt.appendChild(f)}};a.prototype.writeMaskedText=function(b){b=b.toString().length;for(var a="",c=0;c<b;c++)a+=this.maskChar;this.writeText(a)};a.prototype.validateColor=function(b){return void 0==b?!1:0==b.indexOf("#")&&1<b.length&&8>=b.length||"r"===b.charAt(0)&&"g"===b.charAt(1)&&"b"===b.charAt(2)?
!0:!1};a.prototype.setValue=function(b,e,h,d){var f=!1;c.prototype.setValue.call(this,b,e,h,d);switch(b){case "value":case "text":if(this.isBadValue(e,!0,h))return!1;this.text!=e&&(this.isLiveTagsEnabled()&&this.textCanContainsVariables(e)?this.parseNewTextVariables([e]):(this.isLiveTagsEnabled()&&this.dynamicVariablesArePresent()&&this.unloadAllVariables(),f=this.prepareToRender(e)),this.sendUpdate(b,this.text,h));break;case "fill":case "fontColor":0!=this.scrollMode&&this.fontColor!=e&&(this._renderMask|=
a._renderFlags.SCROLL);break;case "font-family":0!=this.scrollMode&&this.fontFamily!=e&&(this._renderMask|=a._renderFlags.SCROLL);break;case "masked":this.masked!=e&&void 0!=e&&(this.masked=e,this._renderMask|=a._renderFlags.VALUE,0!=this.scrollMode&&(this._renderMask|=a._renderFlags.SCROLL),f=!0,this.sendUpdate(b,this.masked,h));break;case "scrollMode":if(this.scrollMode!=e&&void 0!=e){switch(e){case ka.NORMAL:case ka.FAST:case ka.SLOW:this.scrollMode=e;break;default:this.scrollMode=ka.NONE}this._renderMask|=
a._renderFlags.SCROLL;f=!0;this.sendUpdate(b,this.scrollMode,h);this.activateHandler||this.addActivationHandler()}break;case "frame":if(this.isBadValue(e,!1,h))return!1;e=parseFloat(e);this.frame!=e&&(this.frame=e,this._renderMask|=L._renderFlags.FRAME,f=!0,this.sendUpdate(b,this.frame,h));break;case "frameColor":isNaN(e)?this.isBadValue(e,!0,h)?(this.frameColor="#000",f=!0):this.frameColor!=e&&(this.frameColor=this.validateColor(e)?e:"#000",this._renderMask|=L._renderFlags.FRAME,f=!0,this.sendUpdate(b,
this.frameColor,h)):(this.frameColor="#000",this._renderMask|=L._renderFlags.FRAME,f=!0);break;case "frameSize":if(this.isBadValue(e,!1,h))return!1;e=parseFloat(e);1>e&&(e=1);e!=this.frameSize&&(this.frameSize=e,this._renderMask|=L._renderFlags.FRAME,f=!0,this.sendUpdate(b,this.frameSize,h));break;case "frameFill":isNaN(e)&&void 0!=e?this.isBadValue(e,!0,h)?(this.frameFill="#000",f=!0):this.frameFill!=e&&(this.frameFill=this.validateColor(e)?e:"#000",this._renderMask|=L._renderFlags.FRAME,f=!0,this.sendUpdate(b,
this.frameFill,h)):(this.frameFill="#000",this._renderMask|=L._renderFlags.FRAME,f=!0);break;default:this.isLiveTagsEnabled()&&0==b.indexOf("${")&&this.variablesAreInitialized()?(e=void 0===e?null:e,this.isVariableATagInCache(b)&&this.isBadValue(e,!0,h),this.updateVariable(b,e)&&(this.updateVariableInTexts(b,0),f=this.prepareToRender(this.getValueOfDynamicText(0)),this.sendUpdate("text",this.text,h,d))):c.prototype.setValue.call(this,b,e,h,d)}f&&g.addToRender(this);return!0};a.prototype.getValue=
function(b){return"value"==b?this.text:c.prototype.getValue.call(this,b)};a.prototype.renderText=function(){this._renderMask|=a._renderFlags.VALUE;g.addToRender(this)};a.prototype.prepareTextToRender=function(b){return b&&b[0]?this.prepareToRender(b[0]):!1};a.prototype.prepareToRender=function(b){if(void 0===b)return!1;b=null!=b?b.toString():"";return this.text!==b?(this.text=b,this._renderMask|=a._renderFlags.VALUE,0!=this.scrollMode&&(this._renderMask|=a._renderFlags.SCROLL),!0):!1};a.prototype.getText=
function(b){return this.getPageMLTextMgr().getText(b,this)};a.prototype.updateLanguage=function(){if(this.allowUpdateLanguageOnProps(["Text"])){var b=this.getText(String(this.mlIds[0]));if(null!=b){var a=this.getPageMLTextMgr(),c=a.getCurrentLanguage(),a=a.getCurrentFont(),d=void 0;this.mlMap&&(d=this.mlMap[c]);void 0!=d&&(a=d);a!=this.fontFamily&&this.setValue("font-family",a,null,null);this.isDynamicLinkedProperty("text")?this.renderText():null==b||this.lang==c&&!this.isClone||(this.lang=c,this.text!=
b?this.setValue("text",b,null,null):this.renderText())}}};a.prototype.addDataLink=function(b){c.prototype.addDataLink.call(this,b);this.initDataLinkSideEffects(b,b.attr)};a.prototype.initDataLinkSideEffects=function(b,a){"value"!=a&&"text"!=a||this.hasPropInDatalinks("Text")};a.prototype.destroy=function(){this.textCnt=null;this.unloadAllVariables();c.prototype.unbindEvents.call(this,{loadWgt:this.activateHandler});c.prototype.unbindEvents.call(this,{unloadWgt:this.deactivateHandler});return c.prototype.destroy.call(this)};
a.prototype.enableSingleLineScrolling=function(b,a,c){var d=new cd,f=this.wgtId,g=a.getElementsByTagName("p")[0],l=parseFloat(b.style.width.split("px")[0]);b=g.scrollWidth;if(l>=b)return function(){};g.textContent=this.text+this.text;a=Math.round(a.textContent.length*c);var m="jm-scroll-kf-"+f;d.selector("@keyframes "+m,"0% {\n\t\t\t\t-moz-transform: translateX(0px);\n\t\t\t\t/* Firefox bug fix */\n\t\t\t\t-webkit-transform: translateX(0px);\n\t\t\t\t/* Firefox bug fix */\n\t\t\t\ttransform: translateX(0px);\n\t\t\t}\n\t\t\t100% {\n\t\t\t\t-moz-transform: translateX(-"+
b+"px);\n\t\t\t\t/* Firefox bug fix */\n\t\t\t\t-webkit-transform: translateX(-"+b+"px);\n\t\t\t\t/* Firefox bug fix */\n\t\t\t\ttransform: translateX(-"+b+"px);\n\t\t\t}");var n="jm-scroll-"+f;d.selector("."+n,"\n\t\t\twhite-space: nowrap;\n\t\t\t-moz-transform: translateX(0px);\n\t\t\t-webkit-transform: translateX(0px);\n\t\t\ttransform: translateX(0px);\n\t\t\t-moz-animation: "+m+" "+a+"s linear infinite;\n\t\t\t-webkit-animation: "+m+" "+a+"s linear infinite;\n\t\t\tanimation: "+m+" "+a+"s linear infinite;\n\t\t\t");
(f=g.getAttribute("class"))?g.setAttribute("class",f+" "+n):g.setAttribute("class"," "+n);return function(){d.removeKeyframesRule(m);d.removeStyleRule("."+n);g.setAttribute("class",g.getAttribute("class").replace(" "+n,""))}};a.prototype.isMultiLineText=function(b){b=b.getElementsByTagName("p");return 1<b.length||this.wrapping&&(this.elem.style["white-space"]="no-wrap",b=b[0].scrollWidth,this.elem.style["white-space"]="pre-wrap",this.width>=b)?!0:!1};a.prototype.enableScrolling=function(b,a,c){this.isMultiLineText(a)?
this.enableMultiLinesScrolling(b,a,c):this.disableScroll=this.enableSingleLineScrolling(b,a,c)};a.prototype.scrollMLTexts=function(b,a,c,d,f){var g=this;if(f){var l=c.getElementsByTagName("p"),m=l.length;if(1==m)f=l[0],f.textContent=f.textContent.substring(1)+f.textContent.charAt(0);else{b.appendChild(c);0==l.length&&(l=b.firstChild.getElementsByTagName("p"));f=l[0];if(0!=f.textContent.length)l=l[l.length-1],m=f.textContent.charAt(0),f.textContent=f.textContent.substring(1),l.textContent+=m;else{for(f=
0;f<m-1;f++)l[f].textContent=l[f+1].textContent;l[m-1].textContent=""}a.appendChild(c)}this.animationTime=Date.now()}var n;this.scrollMode!=ka.NONE&&(n=requestAnimationFrame(function(){Date.now()-g.animationTime>=d?g.scrollMLTexts(b,a,c,d,!0):g.scrollMLTexts(b,a,c,d,!1)}));this.disableScroll=function(){cancelAnimationFrame(n)}};a.prototype.enableMultiLinesScrolling=function(b,c,h){var d=document.createDocumentFragment();switch(h){case a.SPEED.SLOW:h=1E3*h+200;break;case a.SPEED.NORMAL:h=1E3*h+100;
break;case a.SPEED.FAST:h=1E3*h+25}this.scrollMLTexts(d,b,c,h,!0)};a.prototype.updateFontStyles=function(){this.textCnt&&(this.textCnt.style.color=this.fontColor,this.textCnt.style.fontFamily=this.fontFamily,this.textCnt.style.fontSize=this.fontSize+"px",this.textCnt.style.fontStyle=this.fontStyle,this.textCnt.style.fontWeight=this.fontBold?"bold":"normal",this.textCnt.style.textDecoration=this.fontUnderline?"underline":"initial")};a._renderFlags={VALUE:1,SCROLL:2,FRAME:4};a.jmType="LabelWgt";a.SPEED=
{NORMAL:.1,SLOW:.2,FAST:.025};return a}(fc);g.fn.hmiLabel=function(c,a,b,e){return new Dd(this,c,a,b,e)};g.addWidgetDefinition("hmiLabel",Dd);var Ed=function(c){function a(b,a,h,d,f){var k=c.call(this,b,a,h,d,f)||this;k.subTrendFormats={};if(!$hmi.enablePjctWidgetServerReq)return k;k.initPromiseReady();$hmi.isTestModeActive()||k.parentWidget.waitWgtReady().then(function(){k._srv=g.getActiveProject().getCommunticationObj();k._srv.getConf().then(function(b){b=b["trends.json"];k._commonTSTitle=b.commonTSTitle;
k._conf=b.trends;k._mlTexts=b.mlTexts;k.resolveWgtReady(!0)}).catch(function(){g.getAction("hmiActionShowMessage").execute(null,{msg:"Error loading trends configuration. Reloading..."},3);setTimeout(function(){location.href=window.location.protocol+"//"+location.host+"/index.html"},2E3)})});return k}p(a,c);a.prototype.escapeString=function(b){return b.replace(/(\\\[)/g,"\\\\[").replace(/(\\\])/g,"\\\\]")};a.prototype.moveTrendWindow=function(b,a,c){b=this.getWidgetSubscribed(b);"page"===c?b.moveTrendWindow(a,
{x:b.xPageSize,y:b.y1-b.y0}):b.moveTrendWindow(a,{x:b.xPageSize/10,y:(b.y1-b.y0)/10})};a.prototype.showTrendCursor=function(b,a){var c=this.getWidgetSubscribed(b);if(c){var d=c.getGridWgt();d&&(d.setCursorVisibility(a),c.refreshCurves())}};a.prototype.scrollTrendCursor=function(b,a,c,d){if(b=this.getWidgetSubscribed(b)){var f=b.getGridWgt();f&&(f.scrollTrendCursor(a,c,d),b.isScatter()&&b.refreshCurves())}};a.prototype.scrollTrendToTime=function(b,a,c){this.getWidgetSubscribed(b).scrollTrendToTime(a,
c)};a.prototype.refreshTrend=function(b){b=this.getWidgetSubscribed(b);for(var a in b.getAllSubscriptions()){var c=b.getWidgetSubscribed(a);(c instanceof C||c instanceof U)&&c.refreshTrend()}};a.prototype.zoomTrendWindow=function(b,a,c){b=this.getWidgetSubscribed(b);c?b.zoomX(a):b.zoomY(a)};a.prototype.resetZoom=function(b,a){this.getWidgetSubscribed(b).resetZoom(a)};a.prototype.changePageDuration=function(b,a){this.getWidgetSubscribed(b).changePageDuration(a)};a.prototype.pauseTrend=function(b){this.getWidgetSubscribed(b).stopTrendTimer()};
a.prototype.resumeTrend=function(b){this.getWidgetSubscribed(b).resumeTrendTimer()};a.prototype.getCommunticationObj=function(){return this._srv};a.prototype.getSubscribedWgtId=function(b){var a=this.getAllSubscriptions();if(a)for(var c in a){var d=a[c].getWidget();if(d.studioId==b&&d.parentPage.wgtId===g.getFocusPage().wgtId)return c}return null};a.prototype.restoreTrendDefault=function(b){(b=this.getWidgetSubscribed(b))&&b.restoreDefault()};a.prototype.setTrendView=function(b,a,c,d,f){(b=this.getWidgetSubscribed(b))&&
b.setView(a,c,d,f)};a.prototype.getTrendConfiguration=function(b){return this._conf[b]};a.prototype.getMLTexts=function(){return this._mlTexts};a.prototype.getTitleValue=function(b,a){var c=g.getActiveProject().getMultiLanguageMgr(),d=this.getSubTrendMLIds(b,a),f=null;if(void 0===d)return this.escapeString(a);var d=d[0],k;for(k in this._mlTexts[d]){var l=c.getLangCodeFromLangId(k);null===f&&(f={_c:"ml",mltext:{}});f.mltext[l]=""===this._mlTexts[d][k]?this.escapeString(a):this._mlTexts[d][k]}return f};
a.prototype.getSubTrendMLIds=function(b,a){if(this.hasValidSubtrendMLData(b,a))return this._conf[b].subtrends[a].mlData.mlIds};a.prototype.getSubTrendMLVariables=function(b,a){if(this.hasValidSubtrendMLData(b,a))return this._conf[b].subtrends[a].mlData.lD};a.prototype.getSubTrends=function(b){return this.hasValidTrendConfiguration(b)?this._conf[b].subtrends:{}};a.prototype.getSubTrendNames=function(b){return Object.keys(this._conf[b].subtrends)};a.prototype.getCommonTSTitleConf=function(){return this._commonTSTitle};
a.prototype.getConfiguration=function(){return this._conf};a.prototype.hasValidTrendConfiguration=function(b){return this._conf&&void 0!==this._conf[b]&&void 0!==this._conf[b].subtrends};a.prototype.hasValidSubtrendConfiguration=function(b,a){return this.hasValidTrendConfiguration(b)&&void 0!==this._conf[b].subtrends[a]};a.prototype.hasValidSubtrendMLData=function(b,a){return this.hasValidSubtrendConfiguration(b,a)&&void 0!==this._conf[b].subtrends[a].mlData};a.prototype.hasHighResolutionSampling=
function(b){return this._conf[b]&&this._conf[b].hr};a.prototype.getSamplingTime=function(b){return this._conf[b]&&this._conf[b].st};a.prototype.getFormatOptions=function(b){return g.import("TextFormatUtil").parseFormat(this.subTrendFormats[b].format)};a.prototype.setUsingFormat=function(b,a){void 0===this.subTrendFormats[b]&&(this.subTrendFormats[b]={});void 0===a&&(a="");this.subTrendFormats[b].format=a};a.prototype.setDecimalDigits=function(b,a){void 0===this.subTrendFormats[b]&&(this.subTrendFormats[b]=
{});void 0===a&&(a=-1);this.subTrendFormats[b].decimalDigits=a;this.subTrendFormats[b].format=this.getDynamicFormat(b)};a.prototype.setLeadingDigits=function(b,a){void 0===this.subTrendFormats[b]&&(this.subTrendFormats[b]={});void 0===a&&(a=-1);this.subTrendFormats[b].leadingDigits=a;this.subTrendFormats[b].format=this.getDynamicFormat(b)};a.prototype.addDecimalDigitsToFormat=function(b,a){b+=".";for(var c=0;c<a;c++)b+="0";return b};a.prototype.addLeadingDigitsToFormat=function(b,a){for(var c=1;c<
a;c++)b="0"+b;return b};a.prototype.getDynamicFormat=function(b){var a=this.subTrendFormats[b].format,c=this.subTrendFormats[b].decimalDigits;b=this.subTrendFormats[b].leadingDigits;a=0<=a.indexOf("h")?"#h":0<=a.indexOf("H")?"#H":"#";void 0!==c&&"#"===a&&0<c&&(a=this.addDecimalDigitsToFormat(a,c));void 0!==b&&0<b&&(a=this.addLeadingDigitsToFormat(a,b));return a};a.jmType="TrendMgrWgt";return a}(l);g.fn.hmiTrendMgr=function(c,a,b,e){return new Ed(this,c,a,b,e)};g.addWidgetDefinition("hmiTrendMgr",
Ed);var L=function(c){function a(b,a,h,d,f){b=c.call(this,b.wgtId,a,h,d,f)||this;b.tagTypeOnValue=-1;b.setDefaultState();a=b.elem.getElementsByTagName("span");b.fontSize=parseFloat(a[0].style.fontSize)||parseFloat(b.elem.style.fontSize);b.fontColor=a[0].style.color;b.kpdType=h.keypad;b.parseFormat();b.triggerRenderField();g.getEventMgr()&&(b.activateHandler=b.getActivateHandler(),c.prototype.bindEvents.call(b,{loadWgt:b.activateHandler}));return b}p(a,c);a.prototype.setDefaultState=function(){this.rw=
void 0!==this.rw?this.rw:this instanceof Fc?"r":"rw";this.format=void 0!==this.format?this.format:"#";this.decimalDigits=void 0!==this.decimalDigits?parseInt(this.decimalDigits):null;this.leadingDigits=void 0!==this.leadingDigits?parseInt(this.leadingDigits):null;this.value=void 0!==this.value?this.value:null;this.min=void 0!==this.min?this.min:null;this.max=void 0!==this.max?this.max:null;this.frame=void 0!==this.frame?this.frame:0;this.stroke=void 0!==this.stroke?this.stroke:1;this.strokeColor=
void 0!==this.strokeColor?this.strokeColor:"#000";this.backgroundColor=void 0!==this.backgroundColor?this.backgroundColor:null;this.maskChar=void 0!==this.maskChar?this.maskChar:"*";this.keypad=void 0!==this.keypad?this.keypad:0;this.invokablePropsList=["value","min","max","fill","fontColor"];this._keypadMask=this._renderMask=0};a.prototype.getActivateHandler=function(){var b=this;return function(){b.events={mousedown:!0,touchstart:!0};if(b.formatOptions.formatType==V.NUMBER){var a=b.project.getValue("fieldsStyle"),
c=!1;b.formatStyle.decimalSymbol!=a.decimalSymbol&&(b.formatStyle.decimalSymbol=a.decimalSymbol,c=!0);b.formatStyle.thousandSymbol!=a.thousandSymbol&&(b.formatStyle.thousandSymbol=a.thousandSymbol,c=!0);b.formatStyle.digitsGrouping!=a.digitsGrouping&&(b.formatStyle.digitsGrouping=a.digitsGrouping,c=!0);c&&b.triggerRenderField()}}};a.prototype.addDataLink=function(b){c.prototype.addDataLink.call(this,b);this.initDataLinkSideEffects(b,b.attr)};a.prototype.initDataLinkSideEffects=function(b,a){"value"==
a&&(this.rw=b.rw,"w"!=this.rw&&"rw"!=this.rw&&(this.events={}),"Tag"==b.srcType&&(this.tagTypeOnValue=b.tagType))};a.prototype.doMouseUp=function(b,c){if(g.isTestModeActive()||this.getAuthorizations()!=this.umgr.getWidgetAuthorizationCodes().RDONLY)if("w"===this.rw||"rw"===this.rw)this._renderMask|=a._renderFlags.KEYPAD,1==this.keypad?(this._keypadMask|=a._renderKeypad.KEYPAD_NUM,g.addToRender(this)):2==this.keypad&&(this._keypadMask|=a._renderKeypad.KEYPAD_TXT,g.addToRender(this))};a.prototype.destroy=
function(){c.prototype.unbindEvents.call(this,{loadWgt:this.activateHandler});return c.prototype.destroy.call(this)};a.prototype.escapeRegExpChar=function(b){return-1!="\\^$*+?.".split("").indexOf(b)?"\\"+b:b};a.prototype._getCurrentKeyValue=function(b){b=this.elem.getElementsByTagName("span");var a="";if(0==b.length)return"";a=b[0].textContent;this.formatOptions.formatType==V.NUMBER&&(this.showThousandSeparator&&this.formatStyle.thousandSymbol&&(a=a.replace(new RegExp(this.escapeRegExpChar(this.formatStyle.thousandSymbol),
"g"),"")),"."!=this.formatStyle.decimalSymbol&&(a=a.replace(this.formatStyle.decimalSymbol,".")));return a};a.prototype.getInputFormatPattern=function(){var b=this.formatOptions;if(b.formatType==V.NUMBER)switch(b.numericFormat){case Q.HEXL:case Q.HEXU:return"hex";case Q.EXP:case Q.EXPD:return"exp"}return""};a.prototype.showKeyPad=function(b,c){if(this.disabled)return!1;var h=g.keyboardFactory.createKeyboard(this,c=1==this.masked?"password":c,this.getInputFormatPattern(),this._getCurrentKeyValue(b[0]),
"",g.keyboardType);h.setKeyboardLayer(g.getKeyboardLayer());h.show();this._renderMask|=a._renderFlags.FOCUS;var d=this;h.onSave(function(b,a,c){c=a;var e=!0;"number"==b&&(c=parseFloat(a),c<d.min||c>d.max)&&(e=!1);e&&(c=d._formatInputValue(b,c),d.setValue("value",c,null,0),d.doWriteValue("value",d.value));h.hide()});h.onCancel(function(){h.hide()});h.onKeyUp(function(b){13===b.keyCode?$("#jm-save").click():27===b.keyCode&&$("#jm-discard").click()});return!0};a.prototype.keypadWriteValue=function(){this.doWriteValue("value",
this.value)};a.prototype.getVerticalAlignment=function(){if(this.elem){if(this.elem.classList.contains("jm-align-top"))return"top";if(this.elem.classList.contains("jm-align-middle"))return"middle";if(this.elem.classList.contains("jm-align-bottom"))return"bottom"}return""};a.prototype._formatInputValue=function(b,a){var c=this.formatOptions;if(c.formatType==V.NUMBER){if(c.numericFormat==Q.HEXL||c.numericFormat==Q.HEXU){var c=(new RegExp(/^-?[0-9a-f]+$/,"gi")).test(a),d=g.import("hexToDecimal");c&&
(a=d(a,this.tagTypeOnValue))}else null!==this.min&&null!==this.max&&(c.numericFormat!=Q.EXP&&c.numericFormat!=Q.EXPD||"."==this.formatStyle.decimalSymbol||(a=a.replace(this.formatStyle.decimalSymbol,".")),a=parseFloat(a));a=a<this.min||a>this.max?this.value:a}return a};a.prototype.maskedValue=function(b){var a="";b=this.formatOptions.formatType==V.TEXT?b.length:this.formatText(b).toString().length;for(var c=0;c<b;c++)a+=this.maskChar;return a};a.prototype.writeText=function(b){null==b&&(b="");void 0!==
this.elem.childNodes[1]&&(this.elem.childNodes[1].textContent=b)};a.prototype.render=function(){if(!c.prototype.render.call(this))return!1;g.browserOptimizations.forceLayers&&0==this.elem.classList.contains("jm-hacklayer")&&this.elem.classList.add("jm-hacklayer");if(this._renderMask&a._renderFlags.VALUE)if(this.formatOptions.formatType==V.TEXT){var b=null===this.value?"":this.value;this.masked?this.writeText(this.maskedValue(b)):this.writeText(b)}else this.formatOptions.formatType==V.NUMBER&&(b=null===
this.value?"":this.formatText(this.value),this.masked?this.writeText(this.maskedValue(b)):this.writeText(b));this._renderMask&a._renderFlags.FRAME&&(this.frame?(this.elem.style.border=this.stroke+"px solid "+this.strokeColor,this.elem.style["background-color"]=this.backgroundColor):(this.elem.style.border="",this.elem.style["background-color"]=""));this._renderMask&a._renderFlags.FILL&&(this.elem.querySelector(".jm-text").style.color=this.fontColor);this._renderMask&a._renderFlags.FONT_STYLES_UPDATE&&
(b=this.elem.querySelector(".jm-text"))&&(b.style.fontWeight=this.fontBold?"bold":"normal",b.style.color=this.fontColor,b.style.fontFamily=this.fontFamily,b.style.fontSize=this.fontSize+"px",b.style.fontStyle=this.fontStyle,b.style.textDecoration=this.fontUnderline?"underline":"initial");if(this._renderMask&a._renderFlags.KEYPAD){switch(this._keypadMask){case a._renderKeypad.KEYPAD_TXT:this.showKeyPad(this.$elem,"text");break;case a._renderKeypad.KEYPAD_NUM:this.showKeyPad(this.$elem,"number")}this._keypadMask=
0}this._renderMask&a._renderFlags.FOCUS&&(b=document.getElementById("jm-nField"))&&(b.focus(),b.select());if(this._renderMask&a._renderFlags.ALIGN&&this.elem){switch(this.align){case "left":this.elem.classList.remove("jm-align-center","jm-align-right");break;case "center":this.elem.classList.remove("jm-align-left","jm-align-right");break;case "right":this.elem.classList.remove("jm-align-left","jm-align-center")}this.elem.classList.add("jm-align-"+this.align)}if(this._renderMask&a._renderFlags.VALIGN&&
this.elem){switch(this.valign){case "top":this.elem.classList.remove("jm-align-middle","jm-align-bottom");break;case "middle":this.elem.classList.remove("jm-align-top","jm-align-bottom");break;case "bottom":this.elem.classList.remove("jm-align-top","jm-align-middle")}this.elem.classList.add("jm-align-"+this.valign)}this._renderMask=0;return!0};a.prototype.setFormatValue=function(b,c){if(this.isBadValue(b,!1,c))return!1;this.value!==b&&(this.value=b,"boolean"==typeof b&&(this.value=1==b?1:0),this._renderMask|=
a._renderFlags.VALUE,g.addToRender(this));return!0};a.prototype.validateColor=function(b){return void 0==b?!1:0==b.indexOf("#")&&1<b.length&&8>=b.length||"r"===b.charAt(0)&&"g"===b.charAt(1)&&"b"===b.charAt(2)?!0:!1};a.prototype.setValue=function(b,c,h,d){var f=!1,k="#000";if(null!=this.elem){if("value"==b){var q=this.value;c instanceof Array&&(c=0>d||d>c.length?"":c[d]);if(this.setFormatValue(c,h))this.value!=q&&(q=this.value,this.value instanceof Date&&(q=this.value.getTime()/1E3),this.sendUpdate(b,
q,h));else return!1}else if("usingFormat"==b||"format"==b)c!=this.format&&void 0!==c&&(this.format=c,this.parseFormat(),this.triggerRenderField(),this.sendUpdate(b,this.format,h));else if("decimalDigits"==b)c!=this.decimalDigits&&void 0!==c&&(c=10<c||0>c?this.decimalDigits:c,q=this.formatOptions,q.decimalPlaces=this.decimalDigits=c,this.format=g.import("TextFormatUtil").generateDynamicFormat(q),this.parseFormat(),this.triggerRenderField(),this.sendUpdate(b,this.decimalDigits,h));else if("leadingDigits"==
b)c!=this.leadingDigits&&void 0!==c&&(c=10<c||0>c?this.leadingDigits:c,q=this.formatOptions,q.leadingDigits=this.leadingDigits=c,this.format=g.import("TextFormatUtil").generateDynamicFormat(q),this.parseFormat(),this.triggerRenderField(),this.sendUpdate(b,this.leadingDigits,h));else if("frame"==b){if(this.isBadValue(c,!1,h))return!1;c=parseFloat(c);this.frame!=c&&(this.frame=c,this._renderMask|=a._renderFlags.FRAME,f=!0,this.sendUpdate(b,this.frame,h))}else if("min"==b){if(this.isBadValue(c,!1,h))return!1;
parseFloat(c)!=this.min&&(this.min=parseFloat(c),this.sendUpdate(b,this.min,h))}else if("max"==b){if(this.isBadValue(c,!1,h))return!1;parseFloat(c)!=this.max&&(this.max=parseFloat(c),this.sendUpdate(b,this.max,h))}else if("font-bold"==b&&this.fontBold!=c)f=!0,this.fontBold=c,this._renderMask|=a._renderFlags.FONT_STYLES_UPDATE,this.sendUpdate(b,this.fontBold,h);else if("font-color"!=b&&"fill"!=b||this.fontColor==c)if("font-family"==b&&this.fontFamily!=c)f=!0,this.fontFamily=c,this._renderMask|=a._renderFlags.FONT_STYLES_UPDATE,
this.sendUpdate(b,this.fontFamily,h);else if("font-style"==b&&this.fontStyle!=c)f=!0,this.fontStyle=c,this._renderMask|=a._renderFlags.FONT_STYLES_UPDATE,this.sendUpdate(b,this.fontStyle,h);else if("font-underline"==b&&this.fontUnderline!=c)f=!0,this.fontUnderline=c,this._renderMask|=a._renderFlags.FONT_STYLES_UPDATE,this.sendUpdate(b,this.fontUnderline,h);else if("font-size"==b||"fontSize"==b)f=!0,q=parseFloat(c),this.fontSize!=q&&(this.fontSize=parseFloat(c),this._renderMask|=a._renderFlags.FONT_STYLES_UPDATE,
this.sendUpdate(b,this.fontSize,h));else if("frameColor"==b||"stroke"==b)isNaN(c)?this.isBadValue(c,!0,h)?(this.strokeColor=k,f=!0):this.strokeColor!=c&&(this.strokeColor=this.validateColor(c)?c:k,f=!0,this.sendUpdate(b,this.strokeColor,h)):(this.strokeColor=k,f=!0),f&&(this._renderMask|=a._renderFlags.FRAME);else if("frameSize"==b){if(this.isBadValue(c,!1,h))return!1;c=parseFloat(c);1>c&&(c=1);c!=this.stroke&&(this.stroke=c,this._renderMask|=a._renderFlags.FRAME,f=!0,this.sendUpdate(b,this.stroke,
h))}else if("frameFill"==b)k="#000",isNaN(c)&&void 0!=c?this.isBadValue(c,!0,h)?(this.backgroundColor=k,f=!0):this.backgroundColor!=c&&(this.backgroundColor=this.validateColor(c)?c:k,f=!0,this.sendUpdate(b,this.backgroundColor,h)):(this.backgroundColor=k,f=!0),f&&(this._renderMask|=a._renderFlags.FRAME);else if("Index"==b)for(q in d=this.index=parseInt(c),this.dataLinks)k=this.dataLinks[q],c=k.dataSrc.getValue(k.tag),c instanceof Array&&!isNaN(d)&&k.attr!=b&&(k=t.getModule("Quality"),d>c.length-1||
0>d?this.setValue("value",c[d],new k(0),0):this.setValue("value",c[d],h,0));else if("masked"==b)this.masked!=c&&(this.masked=c,this._renderMask|=a._renderFlags.VALUE,f=!0,this.sendUpdate(b,this.masked,h));else if("align"==b){if(this.align===c)return!1;this.align!=c&&(this.align=c,f=!0,this._renderMask|=a._renderFlags.ALIGN,this.sendUpdate(b,c,h))}else if("valign"==b){if(this.valign===c)return!1;this.valign!=c&&(this.valign=c,f=!0,this._renderMask|=a._renderFlags.VALIGN,this.sendUpdate(b,c,h))}else"showThousandSeparator"==
b?this.showThousandSeparator!=c&&(this.showThousandSeparator=c,this._renderMask|=a._renderFlags.VALUE,this.sendUpdate(b,c,h),f=!0):"rw"==b?this.rw!=c&&(this.rw=c,f=!0,this.sendUpdate(b,c,h)):l.prototype.setValue.call(this,b,c,h,d);else isNaN(c)&&(this.isBadValue(c,!0,h)?(this.fontColor=k,f=!0):this.fontColor!=c&&(this.fontColor=this.validateColor(c)?c:k,f=!0,this.sendUpdate(b,this.fontColor,h))),f&&(this._renderMask|=a._renderFlags.FONT_STYLES_UPDATE);f&&g.addToRender(this)}return!0};a.prototype.getValue=
function(b){return"value"==b?this.value instanceof Date?this.value.getTime()/1E3:this.value:"format"==b?this.format:"decimalDigits"==b?this.decimalDigits:"leadingDigits"==b?this.leadingDigits:"font-bold"==b?this.fontBold:"font-family"==b?this.fontFamily:"font-size"==b?this.fontSize:"font-style"==b?this.fontStyle:"font-underline"==b?this.fontUnderline:"fill"==b||"fontColor"==b?this.fontColor?this.fontColor:this.elem.style.color:"rw"==b?this.rw:"frameColor"==b||"stroke"==b?this.strokeColor:c.prototype.getValue.call(this,
b)};a.prototype.triggerRenderField=function(){"undefined"!=typeof this.value&&this.formatOptions.formatType!=V.TEXT&&(this._renderMask|=a._renderFlags.VALUE,g.addToRender(this))};a.prototype.updateStyle=function(b){if(b.decimalSymbol||b.thousandSymbol||b.digitsGrouping)b=this.project?this.project.getValue("fieldsStyle"):null,this.formatStyle={decimalSymbol:b.decimalSymbol,thousandSymbol:b.thousandSymbol,digitsGrouping:b.digitsGrouping},this.triggerRenderField()};a.prototype.formatText=function(b){-1!=
this.formatOptions.oldDigitsGrouping&&(this.formatStyle.digitsGrouping=this.formatOptions.oldDigitsGrouping);return g.import("TextFormatUtil").formatText(this.formatOptions,b,this.formatStyle,this.showThousandSeparator,this.tagTypeOnValue)};a.prototype.parseFormat=function(){var b=this.project?this.project.getValue("fieldsStyle"):null;this.formatStyle={decimalSymbol:b.decimalSymbol,thousandSymbol:b.thousandSymbol,digitsGrouping:b.digitsGrouping};this.formatOptions=g.import("TextFormatUtil").parseFormat(this.format);
this.decimalDigits=this.formatOptions.decimalPlaces;this.leadingDigits=this.formatOptions.leadingDigits;-1!=this.formatOptions.oldDigitsGrouping&&(this.showThousandSeparator=!0)};a._renderFlags={VALUE:2,FRAME:4,FILL:8,FONT_STYLES_UPDATE:16,KEYPAD:32,FOCUS:64,ALIGN:128,VALIGN:256,FORMAT:512};a._renderKeypad={KEYPAD_NUM:8,KEYPAD_TXT:16,KEYPAD_HIDE:32};a.jmType="NumericWgt";return a}(l);g.fn.hmiNumeric=function(c,a,b,e){return new L(this,c,a,b,e)};g.addWidgetDefinition("hmiNumeric",L);var Fc=function(c){function a(b,
a,h,d,f){b=c.call(this,b,a,h,d,f)||this;b.keyboardInputFormat="YYYY-MM-DD HH:mm:ss";b.updateDOMReference();return b}p(a,c);a.prototype.getActivateHandler=function(){var b=this,a=c.prototype.getActivateHandler.call(this);return function(){a();switch(b.format){case "LONG-DATE":b.projectConf.longDateFormat!=b.project.getValue("longDateFormat")&&b.parseFormat();break;case "SHORT-DATE":b.projectConf.shortDateFormat!=b.project.getValue("shortDateFormat")&&b.parseFormat()}}};a.prototype.doMouseUp=function(b,
c){(g.isTestModeActive()||this.getAuthorizations()!=this.umgr.getWidgetAuthorizationCodes().RDONLY)&&("w"===this.rw||"rw"===this.rw)&&this.dataLinks&&0<this.countDataLinks()&&null!=this.datetimeField&&(this._renderMask|=a._renderFlags.KEYPAD,this._keypadMask|=a._renderKeypad.KEYPAD_DATETIME,g.addToRender(this))};a.prototype.setDefaultState=function(){c.prototype.setDefaultState.call(this);this.timeSpec=void 0!==this.timeSpec?this.timeSpec:null};a.prototype.parseFormat=function(){this.projectConf=
{longDateFormat:this.project.getValue("longDateFormat"),shortDateFormat:this.project.getValue("shortDateFormat"),serverOffset:this.project.getSystemPropertiesMgr().getServerOffset()};this.formatOptions=g.import("TextFormatUtil").parseDateTimeFormat(this.format,this.projectConf);this._renderMask|=L._renderFlags.VALUE;this.core.addToRender(this)};a.prototype.updateStyle=function(b){(b.longDateFormat||b.shortDateFormat)&&this.parseFormat()};a.prototype.updateDOMReference=function(){this.datetimeField=
this.elem.querySelector(".jm-hmi-datetime")};a.prototype._getCurrentKeyValue=function(b){return moment(b.textContent,this.formatOptions.format).format(this.keyboardInputFormat)};a.prototype.formatKeyboardInput=function(b,a,c){return"datetime"==b?(c=this.keyboardInputFormat.split(" "),b=c[0],c=c[1],a.date||(a.date=moment(this.value).format(b)),a.time||(a.time=moment(this.value).format(c)),moment(a.date+" "+a.time,this.keyboardInputFormat).toDate()):new Date};a.prototype.keypadWriteValue=function(){var b=
this.value;this.formatOptions.formatType==V.DATETIME&&(b=Math.round(this.getTimeForSever()/1E3));this.doWriteValue("value",b)};a.prototype.getTimeForSever=function(){var b=this.value.getTime();switch(this.timeSpec){case "global":return b-6E4*(new Date).getTimezoneOffset();case "server":return b-=6E4*this.project.getSystemPropertiesMgr().getServerOffset(),b-6E4*(new Date).getTimezoneOffset()}return b};a.prototype.removeChildNodes=function(b){for(b=b.childNodes;0<b.length;)b[0].parentNode.removeChild(b[0])};
a.prototype.render=function(){if(!this.elem)return!1;if(this._renderMask&L._renderFlags.VALUE&&this.formatOptions.formatType==V.DATETIME){var b=g.import("TextFormatUtil").formatDateTime(this.value,this.timeSpec,this.formatOptions,this.projectConf),e=this.elem.querySelector(".jm-hmi-datetime");null!=e&&(e.textContent=b)}if(this._renderMask&L._renderFlags.KEYPAD){switch(this._keypadMask){case a._renderKeypad.KEYPAD_DATETIME:this.showKeyPad(this.datetimeField,"datetime")}this._keypadMask=0}this._renderMask&
L._renderFlags.FOCUS&&((b=document.getElementById("jm-nFiledDate"))&&b.select&&(b.focus(),b.select()),(b=document.getElementById("jm-nFiledTime"))&&b.select&&(b.focus(),b.select()));c.prototype.render.call(this);this._renderMask=0;return!0};a.prototype.setDateTimeValue=function(b,a,c){if(void 0==b)return!1;if(void 0==c||0==c||"string"==typeof c)c=-1;a=$.type(b);if("date"!=a)if("number"==a){if(b=new Date(1E3*b),"date"!=$.type(b))return!1}else"string"==a?""===b?b=new Date(0):(b=new Date(b),isNaN(b.getTime())&&
(b=b.setTime(0))):b=b.toDate();this.value!==b&&(this.value=b,-1!=c&&this.project&&this.project.getSystemPropertiesMgr().setValue("System Time",Math.round(this.getTimeForSever()/1E3)),this._renderMask|=L._renderFlags.VALUE,g.addToRender(this));return!0};a.prototype.setValue=function(b,a,h,d,f){if(null!=this.elem)if("value"==b)d=this.value,this.setDateTimeValue(a,h,f)&&this.value!=d&&(a=this.value,this.value instanceof Date&&(a=this.value.getTime()/1E3),this.sendUpdate(b,a,h));else return c.prototype.setValue.call(this,
b,a,h,d);return!0};a.prototype.getAttrValueTagType=function(){var b=this.getDatalink("value");return b?b.tagType:null};a.prototype.getAttrValueDataSource=function(){var b=this.getDatalink("value");return b?b.dataSrc:null};a.prototype.syncTimeWithSever=function(b,a){switch(this.timeSpec){case "global":return b-6E4*a;case "server":b-=6E4*a;var c=this.project.getSystemPropertiesMgr();c&&(c=c.getServerOffset(),720<c&&(c-=65536),b-=6E4*c)}return b};a.prototype.showKeyPad=function(b,a){var c=this;if(this.disabled)return!1;
var d=this._getCurrentKeyValue(b),f=g.keyboardFactory.createKeyboard(this,a,this.formatOptions.format,d,this.keyboardInputFormat,g.keyboardType);f.setKeyboardLayer(g.getKeyboardLayer());f.show();this._renderMask|=L._renderFlags.FOCUS;f.onSave(function(b,a,e){a=c.formatKeyboardInput(b,a,e);b=a.getTime();a=a.getTimezoneOffset();e=c.getAttrValueTagType();var d=c.getAttrValueDataSource();null!==e&&e!==v.TIME&&"SysPropMgrWgt"!=d.getJMType()?b=c.syncTimeWithSever(b,a):c.formatOptions.formatType==V.DATETIME&&
(b=c.syncTimeWithSever(b,a));c.setValue("value",new Date(b),null,0,-1);b=Math.round(b/1E3);c.doWriteValue("value",b);f.hide()});f.onCancel(function(){f.hide()});f.onKeyUp(function(b){13===b.keyCode?$("#jm-save").click():27===b.keyCode&&$("#jm-discard").click()});return!0};a._renderKeypad=Ia(Ia({},L._renderKeypad),{KEYPAD_DATETIME:2});return a}(L);g.fn.hmiDateTime=function(c,a,b,e){return new Fc(this,c,a,b,e)};g.addWidgetDefinition("hmiDateTime",Fc);var Fd=function(c){function a(b,a,h,d,f){return c.call(this,
b.wgtId,a,h,d,f)||this}p(a,c);a.prototype.setDefaultOption=function(b,a){switch(b){case "variables":this.map=new Map(a);break;default:c.prototype.setDefaultOption.call(this,b,a)}};a.prototype.setValue=function(b,a,c){var d=this.map.get(b);void 0!==d&&d!=a&&(this.map.set(b,a),this.sendUpdate(b,a,c))};a.prototype.getValue=function(b){return this.map&&this.map.get(b)};a.prototype.destroy=function(){return this.destroyed?!1:c.prototype.destroy.call(this)};a.prototype.setParentBounds=function(b,a,c,d,
f){};a.prototype.getParentBounds=function(b){return{x:0,y:0,width:0,height:0}};a.jmType="VariablesWgt";return a}(l);g.fn.hmiVariablesWgt=function(c,a,b,e){return new Fd(this,c,a,b,e)};g.addWidgetDefinition("hmiVariablesWgt",Fd);var G;(function(c){c[c.HISTORY=0]="HISTORY";c[c.REALTIME=1]="REALTIME";c[c.SCATTER=2]="SCATTER"})(G||(G={}));var Wb=function(c){function a(b,a,h,d,f){var k=c.call(this,b.wgtId,a,h,d,f)||this;k.currentTime=0;k.lastCurrentTime=0;k.setDefaultState();k.ySize=k._initYZoom=k.y1-
k.y0;if(k.trendType==G.SCATTER)k.endTime=k.stopTime,k._initXZoom=k.endTime-k.startTime,void 0==k.y0&&(k.y0=0);else if(k.trendType==G.REALTIME||k.trendType==G.HISTORY)k._initXZoom=k.getPDIndex(k.pageDuration);k._dStartTime=k.startTime;k._dEndTime=k.endTime;k._dY0=k.y0;k._dY1=k.y1;k._dYSize=k.ySize;k._dPageDuration=k.pageDuration;g.cache.hasWgtProps(k.elem.id)&&k.loadCachedValues();k._initWindowView();k._isPaused=!1;k._initialized=!1;k._updateXDuration=!1;k._forceBoundsUpdate=!1;k._prevXDiff=-1;k._prevYDiff=
-1;k.events={mousedown:!0,touchstart:!0};g.getEventMgr()&&(k.activateHandler=function(){c.prototype.executeActivationCallback.call(k)&&(k.load(),k.isWgtActive=!0)},k.deactivateHandler=function(){c.prototype.executeDeactivationCallback.call(k)&&(k.unload(),k.isWgtActive=!1)},c.prototype.bindEvents.call(k,{loadWgt:k.activateHandler,unloadWgt:k.deactivateHandler}));return k}p(a,c);a.prototype.setDefaultState=function(){this.pageDuration=void 0===this.pageDuration?3E5:this.pageDuration;this.refreshRate=
void 0===this.refreshRate?4E3:this.refreshRate;this.startTime=void 0===this.startTime?0:this.startTime;this.endTime=void 0===this.endTime?1E3:this.endTime;this.ySize=void 0===this.ySize?100:this.ySize;this.y0=void 0===this.y0?0:this.y0;this.y1=void 0===this.y1?100:this.y1;this.isPrt=void 0===this.isPrt?!1:this.isPrt;this.maxXZoom=void 0==this.maxXZoom?20:this.maxXZoom;this.xStart=void 0===this.xStart?null:this.xStart;this.xEnd=void 0===this.xEnd?null:this.xEnd;this.yStart=void 0===this.yStart?null:
this.yStart;this.yEnd=void 0===this.yEnd?null:this.yEnd;this.gridXTickDivider=void 0===this.gridXTickDivider?null:this.gridXTickDivider;this._renderMask=0;this._mvPoint={endX:null,endY:null};this.timer=null};a.prototype.showBackground=function(){if(this.isPrt||this.isScatter())this.elem.style.boxSizing="border-box",this.elem.style.backgroundColor=this.fill,this.elem.style.border="1px solid "+this.stroke};a.prototype._initWindowView=function(){this.isScatter()?(this.endTime=this.stopTime,this.xPageSize=
this.endTime-this.startTime):(this.endTime=(new Date).getTime(),this.startTime=this.endTime-this.pageDuration,this.xPageSize=this.pageDuration);this.bands&&!this.isScatter()&&(this.clBand=new Ga(this.wgtId+"_cb",{width:this.width,height:this.height,minX:this.startTime,maxX:this.endTime,minY:this.y0||0,maxY:this.y1||100,bands:this.bands}))};a.prototype.load=function(){this.gridXTickDivider=this.grid.getValue("gridX");var b=this.project.getTrendMgr();if(b&&(b.subscribeWgt(this,function(){}),this.getAllSubscriptions()))switch(this.trendType){case G.SCATTER:this.update();
this.drawCurves();break;case G.REALTIME:case G.HISTORY:this.startAutoUpdate()}};a.prototype.unload=function(){clearInterval(this.timer);this.timer=null;var b=this.elem.id;switch(this.trendType){case G.SCATTER:g.cache.setWgtProp(b,"xDuration",this.xPageSize);g.cache.setWgtProp(b,"min",this.startTime);g.cache.setWgtProp(b,"max",this.endTime);g.cache.setWgtProp(b,"y1",this.y1);break;case G.REALTIME:case G.HISTORY:g.cache.setWgtProp(b,"xDuration",this.getPDIndex(this.pageDuration)),g.cache.setWgtProp(b,
"xZoom",this._zXIdx)}g.cache.setWgtProp(b,"y0",this.y0);g.cache.setWgtProp(b,"yDuration",this.ySize);this.clBand&&this.clBand.clearCanvasContext();this.project.getTrendMgr().unsubscribeWgt(this)};a.prototype.getWindowView=function(){var b={xStart:this.startTime,xEnd:this.endTime,yStart:this.y0,yEnd:this.y1,pEnd:!1};if(0==this._initialized)switch(this.startPoint){case 0:b.xStart=this.currentTime;b.xEnd=this.currentTime+this.xPageSize;break;case 1:b.xStart=this.currentTime-this.xPageSize/2;b.xEnd=this.currentTime+
this.xPageSize/2;break;case 2:b.xStart=this.currentTime-this.xPageSize,b.xEnd=this.currentTime}return b};a.prototype.startAutoUpdate=function(){var b=this;null==this.timer&&(this.update(),0!=this.refreshRate&&(this.timer=window.setInterval(function(){b.update()},this.refreshRate)))};a.prototype.stopAutoUpdate=function(){null!==this.timer&&(clearInterval(this.timer),this.timer=null)};a.prototype.update=function(){var b=g.activeProject.getSystemPropertiesMgr();this.currentTime=b?b.getTime():(new Date).getTime();
switch(this.trendType){case G.REALTIME:this.updateRealTime();break;case G.HISTORY:this.updateHistoric();break;case G.SCATTER:this.updateScatter()}this.grid&&this.setValue("cursor-timestamp",this.grid.getXCursor(),null);this.lastCurrentTime=this.currentTime};a.prototype.drawCurves=function(){this._renderMask|=a._renderFlags.CURVES;g.addToRender(this)};a.prototype._draw=function(){var b=this.getAllSubscriptions(),a=!0,c;for(c in b){var d=b[c].getWidget();if("TrendCurveWgt"==d.getJMType()||"XYCurveWgt"==
d.getJMType())a&&(d.clearCanvas(),a=!1),d.renderCurve()}};a.prototype.loadCachedValues=function(){var b=g.cache.getWgtProp(this.elem.id,"xDuration"),a=g.cache.getWgtProp(this.elem.id,"yDuration");this.isScatter()?(this.pageDuration=b,this.startTime=g.cache.getWgtProp(this.elem.id,"min"),this.stopTime=g.cache.getWgtProp(this.elem.id,"max")):(this.pageDuration=1E3*this.getPDFromIndex(b),this._zXIdx=g.cache.getWgtProp(this.elem.id,"xZoom"));this.ySize=a;this.y0=g.cache.getWgtProp(this.elem.id,"y0");
this.isScatter()?this.y1=g.cache.getWgtProp(this.elem.id,"y1"):this.y1=this.y0+this.ySize};a.prototype.getNextMinute=function(b){b=new Date(b);b.setMinutes(b.getMinutes()+1);b.setSeconds(0);return b.getTime()};a.prototype.updateXDuration=function(b){if(this.trendType==G.SCATTER)b.xEnd=b.xStart+this.xPageSize;else{var a=this.xPageSize/(this.gridXTickDivider-1);this.currentTime<b.xStart?(b.xEnd=this.currentTime+a,b.xStart=b.xEnd-this.xPageSize):(b.xEnd=this.getNextMinute(b.xEnd),b.xStart=b.xEnd-this.xPageSize,
this.currentTime<b.xStart&&(b.xEnd=this.currentTime+a,b.xStart=b.xEnd-this.xPageSize))}this._updateXDuration=!1};a.prototype.updateYDuration=function(b){b.yEnd=b.yStart+this.ySize;this._updateYDuration=!1};a.prototype.updateDuration=function(b){this._updateXDuration&&this.updateXDuration(b);this._updateYDuration&&this.updateYDuration(b)};a.prototype.updateWindowView=function(b){this.setValue("max",b.xEnd,null);this.setValue("min",b.xStart,null);this.setValue("y0",b.yStart,null);this.setValue("y1",
b.yEnd,null)};a.prototype.updateScatter=function(){var b=this.getWindowView();this.calculateSpaceWindow(b);this.updateDuration(b);0==this._initialized&&(this._initialized=!0);this.updateWindowView(b)};a.prototype.updateRealTime=function(){var b=this.getWindowView();this.enableTimeWindow(b);this.updateDuration(b);0==this._initialized?(0===this.maxInSeconds&&6E4<this.pageDuration&&(b.xEnd=6E4*Math.floor((b.xEnd+6E4)/6E4),b.xStart=b.xEnd-this.xPageSize),this._initialized=!0):b.pEnd&&0===this.maxInSeconds&&
(b.xEnd=6E4*Math.floor((b.xEnd+6E4)/6E4),b.xStart=b.xEnd-this.xPageSize);this.updateWindowView(b)};a.prototype.updateHistoric=function(){var b=this.getWindowView();this.enableTimeWindow(b);this.updateDuration(b);0==this._initialized&&(0===this.maxInSeconds&&6E4<this.pageDuration&&(b.xEnd=6E4*Math.floor((b.xEnd+6E4)/6E4),b.xStart=b.xEnd-this.xPageSize),this._initialized=!0);this.updateWindowView(b)};a.prototype.calculateSpaceWindow=function(b){b.xStart=this.startTime;b.xEnd=this.startTime+this.xPageSize;
b.yStart=this.y0;b.yEnd=this.y1;return b};a.prototype.enableTimeWindow=function(b){if(this.isTrendPageEnded()){var a=this.xPageSize/(this.gridXTickDivider-1);b.xStart=this.currentTime-this.xPageSize+a;b.xEnd=this.currentTime+a;this._forceBoundsUpdate=!1;b.pEnd=!0}else this._forceBoundsUpdate=!0};a.prototype.isTrendPageEnded=function(){return this.currentTime>=this.endTime&&this.lastCurrentTime<=this.endTime?!0:!1};a.prototype.getGridWgt=function(){return this.grid};a.prototype.render=function(){c.prototype.render.call(this);
this._renderMask&a._renderFlags.CLBANDS&&this.bands&&!this.isScatter()&&this._initialized&&(this.clBand.setXRange(this.startTime,this.endTime),this.clBand.setYRange(this.y0,this.y1),this.clBand.drawBands());this._renderMask&a._renderFlags.BGCOLOR&&(this.elem.style.backgroundColor=this.fill);this._renderMask&a._renderFlags.STROKE&&(this.elem.style.boxSizing="border-box",this.elem.style.border="solid",this.elem.style.borderWidth="1px",this.elem.style.borderColor=this.stroke);this._renderMask&a._renderFlags.UPDATECBCANVAS&&
this.clBand.updateSize(this.width,this.height);this._renderMask&a._renderFlags.CURVES&&this._draw();this._renderMask=0};a.prototype.refreshCurves=function(){this._renderMask|=a._renderFlags.CURVES;g.addToRender(this)};a.prototype.setValue=function(b,e,h,d){d=!1;if(this.isBadValue(e,!1,h))return!1;switch(b){case "min":e="string"==typeof e?parseFloat(e):e;this.startTime!=e&&(this.startTime=e,this.minInSeconds=Math.floor(this.startTime/1E3),this.clBand&&(this._renderMask|=a._renderFlags.CLBANDS,d=!0),
this.trendType==G.SCATTER&&(this.xPageSize=this.endTime-this.startTime,this._renderMask|=a._renderFlags.CURVES,d=!0),this.sendUpdate(b,this.startTime,h));this._forceBoundsUpdate&&this.sendUpdate(b,this.startTime,h);break;case "max":e="string"==typeof e?parseFloat(e):e;this.endTime!=e&&(this.endTime=e,this.maxInSeconds=Math.floor(this.endTime/1E3),this.clBand&&(this._renderMask|=a._renderFlags.CLBANDS,d=!0),this.trendType==G.SCATTER&&(this.xPageSize=this.endTime-this.startTime,this._renderMask|=a._renderFlags.CURVES,
d=!0),this.sendUpdate("maxInSeconds",this.maxInSeconds,h),this.sendUpdate(b,this.endTime,h));this._forceBoundsUpdate&&this.sendUpdate(b,this.endTime,h);break;case "y0":e="string"==typeof e?parseFloat(e):e;this.y0!=e&&(this.y0=e,this.clBand&&(this._renderMask|=a._renderFlags.CLBANDS,d=!0),this.trendType==G.SCATTER&&(this.ySize=this.y1-this.y0,this._renderMask|=a._renderFlags.CURVES,d=!0),this.sendUpdate(b,this.y0,h));this._forceBoundsUpdate&&this.sendUpdate(b,this.y0,h);break;case "y1":e="string"==
typeof e?parseFloat(e):e;this.y1!=e&&(this.y1=e,this.clBand&&(this._renderMask|=a._renderFlags.CLBANDS,d=!0),this.trendType==G.SCATTER&&(this.ySize=this.y1-this.y0,this._renderMask|=a._renderFlags.CURVES,d=!0),this.sendUpdate(b,this.y1,h));this._forceBoundsUpdate&&this.sendUpdate(b,this.y1,h);break;case "fill":this.fill!=e&&(this.fill=e,this._renderMask|=a._renderFlags.BGCOLOR,d=!0,this.sendUpdate(b,this.fill,h));break;case "stroke":e="string"==typeof e?parseFloat(e):e;this.stroke!=e&&(this.stroke=
e,this._renderMask|=a._renderFlags.STROKE,d=!0,this.sendUpdate(b,this.stroke,h));break;case "pageDuration":e="string"==typeof e?parseFloat(e):e;if(this.pageDuration!=e){var f;this.trendType==G.REALTIME||this.trendType==G.HISTORY?1>e||e>this.maxXZoom?(e=-1,f=0):(this._zXIdx=e,f=1E3*this.getPDFromIndex(e)):this.trendType==G.SCATTER&&(f=e);this.pageDuration=this.xPageSize=f;this.clBand&&(this._renderMask|=a._renderFlags.CLBANDS,d=!0);this.sendUpdate(b,e,h);this._updateXDuration=!0;this.stopAutoUpdate();
this.update();this.startAutoUpdate()}break;case "ySize":e="string"==typeof e?parseFloat(e):e;this.ySize!=e&&(this.ySize=e,this.sendUpdate(b,this.ySize,h),this._updateYDuration=!0,this.stopAutoUpdate(),this.update(),this.startAutoUpdate());break;case "cursor-timestamp":this.cursorTimestamp!=e&&(this.cursorTimestamp=e,this.sendUpdate(b,this.trendType==G.SCATTER?this.cursorTimestamp:new Date(this.cursorTimestamp),h));break;case "minInSeconds":this.minInSeconds!=e&&(this.minInSeconds=e,this.setValue("min",
Math.round(1E3*this.minInSeconds),h));break;case "maxInSeconds":this.maxInSeconds!=e&&(0!==this.maxInSeconds&&0===e?(this.maxInSeconds=e,this._initialized=!1,this.startAutoUpdate()):(this.maxInSeconds=e,0!=this.maxInSeconds&&(this.stopAutoUpdate(),this.update())),this.setValue("max",Math.round(1E3*this.maxInSeconds),h));break;default:c.prototype.setValue.call(this,b,e,h)}d&&g.addToRender(this);return!0};a.prototype.sendUpdateExceptCurveWgt=function(b,a,c){var d;if(this.dataLinks)for(var f in this.dataLinks)d=
this.dataLinks[f],d.tag===b&&d.tgtWgt!==this&&"TrendCurveWgt"!=d.tgtWgt.getJMType()&&d.setWgtValue(a,void 0,c)};a.prototype.sendUpdateCurveWgt=function(b,a){var c;if(this.dataLinks)for(var d in this.dataLinks)c=this.dataLinks[d],"min"===c.tag&&c.tgtWgt!==this&&"TrendCurveWgt"==c.tgtWgt.getJMType()&&c.tgtWgt.updateMinMax(b,a)};a.prototype._updateXRange=function(){this.sendUpdateExceptCurveWgt("min",this.startTime,null);this.sendUpdateExceptCurveWgt("max",this.endTime,null);this.sendUpdateCurveWgt(this.startTime,
this.endTime)};a.prototype._updateYRange=function(){this.sendUpdate("y0",this.y0,null);this.sendUpdate("y1",this.y1,null)};a.prototype.getValue=function(b){if("min"==b)return this.startTime;if("max"==b)return this.endTime;if("pageDuration"==b){b=this.getPDIndex(this.pageDuration);if(1>b||b>this.maxXZoom)b=-1;return b}return"cursor-timestamp"==b?this.cursorTimestamp:"maxInSeconds"==b?Math.round(this.endTime/1E3):this[b]?this[b]:c.prototype.getValue.call(this,b)};a.prototype.forceUpdate=function(){return this._forceBoundsUpdate};
a.prototype.doMouseDown=function(b){this._mvPoint.endX=this.endTime;this._mvPoint.endY=this.y1};a.prototype.doMouseUp=function(b){this._prevYDiff=this._prevXDiff=-1;this._mvPoint.endX=null;this._mvPoint.endY=null};a.prototype.doMouseMove=function(b){if(this._initialized){var a=b.deltaX,c=b.deltaY;if(b.nxtPoints)this._handlePinchEvent(b);else{b=!1;if(0!=a){var d=b=void 0;b=void 0;b=this.xPageSize*a/this.width;d=Math.round(this._mvPoint.endX-b);b=Math.round(d-this.xPageSize);this.startTime!=b&&(this.startTime=
b);this.endTime!=d&&(this.endTime=d);this._updateXRange();b=!0}0!=c&&(a=b=a=void 0,a=this.ySize*c/this.height,b=this._mvPoint.endY+a,a=b-this.ySize,this.y0!=a&&(this.y0=a),this.y1!=b&&(this.y1=b),this._updateYRange(),b=!0);b&&(this.drawCurves(),this.sendUpdate("maxInSeconds",Math.floor(this.endTime/1E3)))}}};a.prototype._handlePinchEvent=function(b){var a=Math.abs(b.nxtPoints.x-b.x);b=Math.abs(b.nxtPoints.y-b.y);var c=!1,d=!1;0<this._prevXDiff&&(c=!0);0<this._prevYDiff&&(d=!0);(c||d)&&this.zoomOnPinchAction(c,
d,a-this._prevXDiff,b-this._prevYDiff);this._prevXDiff=a;this._prevYDiff=b};a.prototype.zoomOnPinchAction=function(b,a,c,d){null!=b&&(c=c/(this.width/(this.endTime-this.startTime))/2,b=this.startTime+c,c=this.endTime-c,this.setValue("min",b,null),this.setValue("max",c,null),this.xPageSize=this.endTime-this.startTime,this.ySize=this.y1-this.y0);null!=a&&(c=d/(this.height/(this.y1-this.y0))/2,a=this.y0+c,d=this.y1-c,this.setValue("y0",a,null),this.setValue("y1",d,null),this.ySize=this.y1-this.y0);this.drawCurves()};
a.prototype.changePageDuration=function(b){this.isScatter()||this.setValue("pageDuration",b,null)};a.prototype.moveTrendWindow=function(b,a){switch(b){case "left":this.setValue("min",this.startTime-a.x,null);this.setValue("max",this.endTime-a.x,null);break;case "right":this.setValue("min",this.startTime+a.x,null);this.setValue("max",this.endTime+a.x,null);break;case "up":this.setValue("y0",this.y0+a.y,null);this.setValue("y1",this.y1+a.y,null);break;case "down":this.setValue("y0",this.y0-a.y,null),
this.setValue("y1",this.y1-a.y,null)}this.drawCurves()};a.prototype.scrollTrendToTime=function(b,a){var c,d;if(void 0!=a&&!this.isScatter()){a*=1E3;switch(b){case 0:c=a;d=a+this.xPageSize;break;case 1:c=a-this.xPageSize/2;d=a+this.xPageSize/2;break;case 2:c=a-this.xPageSize,d=a}this.setValue("min",c,null);this.setValue("max",d,null)}this.drawCurves()};a.prototype.zoomX=function(b){var a;if(this.trendType==G.REALTIME||this.trendType===G.HISTORY)this._zXIdx||(this._zXIdx=this._initXZoom),this._zXIdx=
b?1<this._zXIdx?this._zXIdx-1:this._zXIdx:this._zXIdx<=this.maxXZoom?this._zXIdx+1:this._zXIdx,this.setValue("pageDuration",this._zXIdx,null),this.drawCurves();this.trendType==G.SCATTER&&(this.endTime>=this.startTime&&(b?this.setValue("max",this.endTime-(this.endTime-this.startTime)/3):this.setValue("max",this.startTime+3*(this.endTime-this.startTime)/2),a=this.endTime-this.startTime),this.setValue("pageDuration",a,null),this.drawCurves())};a.prototype.zoomY=function(b){var a;this.y1>=this.y0&&(G.SCATTER?
(a=this.y1-this.y0,b?this.setValue("y1",this.y1-a/3):this.setValue("y1",this.y0+3*a/2),this.setValue("ySize",this.y1-this.y0,null)):(a=b?this.ySize-this.ySize/3:this.ySize+this.ySize/2,this.setValue("ySize",a,null)),this.drawCurves())};a.prototype.resetZoom=function(b){if(b){if(this.trendType==G.REALTIME||this.trendType==G.HISTORY)this._zXIdx=this._initXZoom;this.setValue("pageDuration",this._initXZoom,null)}else this.setValue("ySize",this._initYZoom,null);this.drawCurves()};a.prototype.getPDIndex=
function(b){for(var c in a.xDurationMap)if(a.xDurationMap[c]==Math.round(b/1E3))return parseInt(c);return null};a.prototype.resumeTrendTimer=function(){this.currentTime>this.endTime&&(this._initialized=!1);this._isPaused=!1;this.load()};a.prototype.stopTrendTimer=function(){this._isPaused=!0;this.stopAutoUpdate()};a.prototype.getPDFromIndex=function(b){return a.xDurationMap[b]};a.prototype.isRealtime=function(){return this.trendType==G.REALTIME};a.prototype.isScatter=function(){return this.trendType==
G.SCATTER};a.prototype.isHistorical=function(){return this.trendType==G.HISTORY};a.prototype.getTrendType=function(){return this.trendType};a.prototype.isInitialized=function(){return this._initialized};a.prototype.isOnPause=function(){return this._isPaused};a.prototype.restoreDefault=function(){if(this.trendType==G.HISTORY||this.trendType==G.REALTIME){var b={xStart:0,xEnd:0,yStart:0,yEnd:0};this.enableTimeWindow(b);this.setValue("min",b.xStart);this.setValue("max",b.xEnd)}else this.trendType==G.SCATTER&&
(this.setValue("min",this._dStartTime),this.setValue("max",this._dEndTime));this.setValue("y0",this._dY0);this.setValue("y1",this._dY1);this.update()};a.prototype.setView=function(b,a,c,d){if(this.trendType==G.HISTORY||this.trendType==G.REALTIME)a*=1E3,b*=1E3;if(c==d||0==c)c=this._dY0,d=this._dY1;if(b==a||0==b)this.trendType==G.HISTORY||this.trendType==G.REALTIME?(this.pageDuration=this.xPageSize=this._dPageDuration,a=this.getNextMinute(this.currentTime),b=a-this.xPageSize,this.enableTimeWindow({xStart:b,
xEnd:a,yStart:0,yEnd:0})):this.trendType==G.SCATTER&&(b=this._dStartTime,a=this._dEndTime);this.setValue("min",b);this.setValue("max",a);this.pageDuration=this.xPageSize=a-b;this.setValue("y0",c);this.setValue("y1",d);this.ySize=d-c;this.update()};a.prototype.destroy=function(){if(this.destroyed)return!1;this.unload();c.prototype.unbindEvents.call(this,{loadWgt:this.activateHandler,unloadWgt:this.deactivateHandler});return c.prototype.destroy.call(this)};a.prototype.subscribeWgt=function(b,a){c.prototype.subscribeWgt.call(this,
b,a);"GridWgt"==b.getJMType()&&(this.grid=b)};a.prototype.isCursorVisible=function(){return this.grid?this.grid.isCursorVisible():!1};a.jmType="TrendWindowWgt";a.xDurationMap={1:60,2:300,3:600,4:1800,5:3600,6:7200,7:14400,8:28800,9:43200,10:86400,11:172800,12:432E3,13:604800,14:1209600,15:2419200,16:7776E3,17:15552E3,18:31536E3,19:63072E3,20:157766400};a._renderFlags={CLBANDS:2,BGCOLOR:4,STROKE:8,CURVES:16,UPDATECBCANVAS:32};return a}(l);g.fn.hmiTrendWindowWgt=function(c,a,b,e){return new Wb(this,
c,a,b,e)};g.addWidgetDefinition("hmiTrendWindowWgt",Wb);var Gd=function(c){function a(b,a,h,d,f){b=c.call(this,b,a,h,d,f)||this;b.value=g.cache.getWgtProp(b.wgtId,"value");return b}p(a,c);a.prototype.render=function(){if(!this.elem)return!1;if(this._renderMask&L._renderFlags.VALUE){if(this.formatOptions.formatType==V.TEXT&&null!=this.value)switch(this.ebt){case 0:this.writeText(this.value);break;case 1:this.writeText("");break;case 2:this.writeText(this.maskedValue(this.value))}this._renderMask=0<
this._renderMask?this._renderMask-=L._renderFlags.VALUE:0}c.prototype.render.call(this);return!0};a.prototype.setValue=function(b,a,h,d){if(null!=this.elem){var f=!1;switch(b){case "editType":this.ebt!=a&&(this.ebt=a,this._renderMask|=L._renderFlags.VALUE,f=!0,this.sendUpdate(b,this.ebt,h));break;case "value":this.value!=a&&(this.value=a,this._renderMask|=L._renderFlags.VALUE,g.cache.setWgtProp(this.wgtId,"value",this.value),f=!0,this.sendUpdate(b,this.value,h));break;case "Color":this.backgroundColor!=
a&&(this.backgroundColor=a,this._renderMask|=L._renderFlags.FRAME,f=!0,this.sendUpdate(b,this.backgroundColor,h));break;default:c.prototype.setValue.call(this,b,a,h,d)}f&&g.addToRender(this)}return!0};a.prototype.destroy=function(){return c.prototype.destroy.call(this)};a.prototype.showKeyPad=function(b,a){return this.disabled?!1:c.prototype.showKeyPad.call(this,b,"password")};a.jmType="EditBoxWgt";return a}(L);g.fn.hmiEditBoxWgt=function(c,a,b,e){return new Gd(this,c,a,b,e)};g.addWidgetDefinition("hmiEditBoxWgt",
Gd);var M;(function(c){c[c.ERROR_OK=0]="ERROR_OK";c[c.ERROR_NOTAUTHORIZED=1]="ERROR_NOTAUTHORIZED";c[c.ERROR_CONNECTIONLOST=2]="ERROR_CONNECTIONLOST";c[c.ERROR_WRONGUSERPASS=3]="ERROR_WRONGUSERPASS";c[c.ERROR_WRONGPASS=4]="ERROR_WRONGPASS";c[c.ERROR_ACTIONNOTEXECUTED=5]="ERROR_ACTIONNOTEXECUTED";c[c.ERROR_PASSNOTMATCH=6]="ERROR_PASSNOTMATCH";c[c.ERROR_PASSTOOSHORT=7]="ERROR_PASSTOOSHORT";c[c.ERROR_PASSMISSNUM=8]="ERROR_PASSMISSNUM";c[c.ERROR_PASSMISSSPECHAR=9]="ERROR_PASSMISSSPECHAR";c[c.ERROR_SAMEPASS=
10]="ERROR_SAMEPASS";c[c.ERROR_USEREXIST=11]="ERROR_USEREXIST";c[c.ERROR_PASSEMPTY=12]="ERROR_PASSEMPTY";c[c.ERROR_PASSEXPIRED=13]="ERROR_PASSEXPIRED";c[c.ERROR_PASSEXPIRING=14]="ERROR_PASSEXPIRING";c[c.ERROR_NEED_PASWD_CHANGE=15]="ERROR_NEED_PASWD_CHANGE";c[c.ERROR_USERDONTEXIST=16]="ERROR_USERDONTEXIST";c[c.ERROR_GROUPDONTEXIST=17]="ERROR_GROUPDONTEXIST";c[c.ERROR_NOGROUPSPECIFIED=18]="ERROR_NOGROUPSPECIFIED";c[c.ERROR_INVALIDARG=19]="ERROR_INVALIDARG";c[c.ERROR_FAILED=20]="ERROR_FAILED";c[c.ERROR_PASSMISS_NUMBER_AND_SPECHAR=
21]="ERROR_PASSMISS_NUMBER_AND_SPECHAR";c[c.ERROR_PASSMISS_CASE=22]="ERROR_PASSMISS_CASE";c[c.ERROR_PASSMISS_NUMBER_AND_CASE=23]="ERROR_PASSMISS_NUMBER_AND_CASE";c[c.ERROR_PASSMISS_SPECHAR_AND_CASE=24]="ERROR_PASSMISS_SPECHAR_AND_CASE";c[c.ERROR_PASSMISS_NUMBER_AND_SPECHAR_AND_CASE=25]="ERROR_PASSMISS_NUMBER_AND_SPECHAR_AND_CASE";c[c.ERROR_USER_MADE_INACTIVE=26]="ERROR_USER_MADE_INACTIVE";c[c.ERROR_WRONGUSERPASS_DELAY=27]="ERROR_WRONGUSERPASS_DELAY";c[c.ERROR_LDAP_CANT_CONNECT_TO_SERVER=28]="ERROR_LDAP_CANT_CONNECT_TO_SERVER";
c[c.ERROR_LDAP_MODULE_NOT_INITIALIZED=29]="ERROR_LDAP_MODULE_NOT_INITIALIZED";c[c.ERROR_LDAP_INVALID_CREDENTIALS=30]="ERROR_LDAP_INVALID_CREDENTIALS"})(M||(M={}));var u;(function(c){c[c.UM_S_VERSION_OK=5]="UM_S_VERSION_OK";c[c.UM_E_USER_MADE_INACTIVE=4]="UM_E_USER_MADE_INACTIVE";c[c.UM_S_OK_NEED_PASWD_CHANGE=3]="UM_S_OK_NEED_PASWD_CHANGE";c[c.UM_S_OK_PWD_WILL_EXPIRE=2]="UM_S_OK_PWD_WILL_EXPIRE";c[c.UM_S_OK=1]="UM_S_OK";c[c.UM_E_FAIL=-50]="UM_E_FAIL";c[c.UM_E_USER_DONT_EXIST=-49]="UM_E_USER_DONT_EXIST";
c[c.UM_E_GROUP_DONT_EXIST=-48]="UM_E_GROUP_DONT_EXIST";c[c.UM_E_NO_GROUP_SPECIFIED=-47]="UM_E_NO_GROUP_SPECIFIED";c[c.UM_E_USER_ALREADY_EXIST=-46]="UM_E_USER_ALREADY_EXIST";c[c.UM_E_PASS_DONT_MATCH=-45]="UM_E_PASS_DONT_MATCH";c[c.UM_E_UNAUTHORIZED_USER=-44]="UM_E_UNAUTHORIZED_USER";c[c.UM_E_NO_SESSION_EXIST=-43]="UM_E_NO_SESSION_EXIST";c[c.UM_E_SESSION_EXPIRED=-42]="UM_E_SESSION_EXPIRED";c[c.UM_E_SESSION_ALREADY_EXIST=-41]="UM_E_SESSION_ALREADY_EXIST";c[c.UM_E_LOGIN_FAIL=-40]="UM_E_LOGIN_FAIL";c[c.UM_E_RE_LOGIN_ATTEMPT=
-39]="UM_E_RE_LOGIN_ATTEMPT";c[c.UM_E_NEED_LOGIN=-38]="UM_E_NEED_LOGIN";c[c.UM_E_TOO_MANY_USERS=-37]="UM_E_TOO_MANY_USERS";c[c.UM_E_FTP_READ_FORBIDDEN=-36]="UM_E_FTP_READ_FORBIDDEN";c[c.UM_E_FTP_WRITE_FORBIDDEN=-35]="UM_E_FTP_WRITE_FORBIDDEN";c[c.UM_E_NOT_ALLOWED=-34]="UM_E_NOT_ALLOWED";c[c.UM_E_INVALIDARG=-33]="UM_E_INVALIDARG";c[c.UM_E_ILLEGAL_FORMAT=-32]="UM_E_ILLEGAL_FORMAT";c[c.UM_E_ACCES_DENIED=-31]="UM_E_ACCES_DENIED";c[c.UM_E_CHANGE_PASSWORD=-30]="UM_E_CHANGE_PASSWORD";c[c.UM_E_MUST_CONTAIN_SPECIAL_CHAR=
-29]="UM_E_MUST_CONTAIN_SPECIAL_CHAR";c[c.UM_E_MUST_CONTAIN_NUMBERS=-28]="UM_E_MUST_CONTAIN_NUMBERS";c[c.UM_E_PASSWORD_TOO_SHORT=-27]="UM_E_PASSWORD_TOO_SHORT";c[c.UM_E_SIMILAR_PREV_PSWD=-26]="UM_E_SIMILAR_PREV_PSWD";c[c.UM_E_PASSWORD_EXPIRED=-25]="UM_E_PASSWORD_EXPIRED";c[c.UM_E_MUST_CONTAIN_NUMBERS_AND_SP_CHAR=-24]="UM_E_MUST_CONTAIN_NUMBERS_AND_SP_CHAR";c[c.UM_E_MUST_CONTAIN_CASE=-23]="UM_E_MUST_CONTAIN_CASE";c[c.UM_E_MUST_CONTAIN_NUMBERS_AND_CASE=-22]="UM_E_MUST_CONTAIN_NUMBERS_AND_CASE";c[c.UM_E_MUST_CONTAIN_SP_CHAR_AND_CASE=
-21]="UM_E_MUST_CONTAIN_SP_CHAR_AND_CASE";c[c.UM_E_MUST_CONTAIN_NUMBERS_SPCHAR_AND_CASE=-20]="UM_E_MUST_CONTAIN_NUMBERS_SPCHAR_AND_CASE";c[c.UM_E_USER_OR_PASS_WRONG=-19]="UM_E_USER_OR_PASS_WRONG";c[c.UM_E_USER_OR_PASS_WRONG_DELAY=-18]="UM_E_USER_OR_PASS_WRONG_DELAY";c[c.UM_E_LDAP_CANT_CONNECT_TO_SERVER=-17]="UM_E_LDAP_CANT_CONNECT_TO_SERVER";c[c.UM_E_LDAP_MODULE_NOT_INITIALIZED=-16]="UM_E_LDAP_MODULE_NOT_INITIALIZED";c[c.UM_E_LDAP_INVALID_CREDENTIALS=-15]="UM_E_LDAP_INVALID_CREDENTIALS"})(u||(u={}));
var Zb=function(c){function a(b,a,h,d,f){var k=c.call(this,b.wgtId,a,h,d,f)||this;k.setDefaultState();k.initPromiseReady();k._initialized=!1;k._isDefaultUser=!1;k._isChangePasswdAction=!1;k._logOffTimer={};if(!g.enablePjctWidgetServerReq)return k.parentWidget.waitWgtReady().then(function(){k.srv=g.getActiveProject().getCommunticationObj()}),k;k.infologin={};k.commoninfo={};k._homepages={};k.parentWidget.waitWgtReady().then(function(){k.srv=g.activeProject.getCommunticationObj();k.srv.getConf().then(function(b){var a;
b=k._deepFreeze(b["usermgmt.json"]);k._securityEnable=b.securityEnable;k._forceRemoteLogin=b.forceRemoteLogin;b.common&&(k.commoninfo.pwdd=b.common.pwdDuration);if(k._securityEnable){k._loadGroupObject();var c=k._getUserInfos(b);if(null!=c){var e=c.grobj;k._initialized=!0;k._auth=e.authUI;k._homepages=e.homepages;k._useLastVisitedPage=e.useLastVisitedPage;b.defUsr==c.name&&b.defUsrGrp==c.grname&&(k._isDefaultUser=!0);k.currentUser.username=c.name;k.currentUser.group=c.grname;k.currentUser.idxot=c.idxot;
k.currentUser.exception=c.exception;k.sendNotification("login");k.currentToken=null===(a=window.localStorage)||void 0===a?void 0:a.getItem("token");k._updateCurrentUser();k.saveValue("_hmiusergroup");e.timers&&k.startTimer(null!=e.timers[c.idxot]?e.timers[c.idxot]:c.idxot,function(){g.getAction("hmiActionLogOut").execute()})}else g.getAction("hmiActionLogOut").execute()}else k._initialized=!0;k.resolveWgtReady(!0)}).catch(function(){g.getAction("hmiActionShowMessage").execute(null,{msg:"Error loading user management map. Reloading..."},
3);setTimeout(function(){k.project.getCommunticationObj().loadIndex()},2E3)})});return k}p(a,c);a.convertServerErrorCode=function(b){switch(b){case u.UM_S_OK_NEED_PASWD_CHANGE:b=M.ERROR_NEED_PASWD_CHANGE;break;case u.UM_S_OK_PWD_WILL_EXPIRE:b=M.ERROR_PASSEXPIRING;break;case u.UM_S_OK:b=M.ERROR_OK;break;case u.UM_E_FAIL:b=M.ERROR_FAILED;break;case u.UM_E_USER_DONT_EXIST:b=M.ERROR_USERDONTEXIST;break;case u.UM_E_GROUP_DONT_EXIST:b=M.ERROR_GROUPDONTEXIST;break;case u.UM_E_NO_GROUP_SPECIFIED:b=M.ERROR_NOGROUPSPECIFIED;
break;case u.UM_E_USER_ALREADY_EXIST:b=M.ERROR_USEREXIST;break;case u.UM_E_PASS_DONT_MATCH:b=M.ERROR_WRONGPASS;break;case u.UM_E_UNAUTHORIZED_USER:b=M.ERROR_NOTAUTHORIZED;break;case u.UM_E_NOT_ALLOWED:b=M.ERROR_NOTAUTHORIZED;break;case u.UM_E_INVALIDARG:b=M.ERROR_INVALIDARG;break;case u.UM_E_ILLEGAL_FORMAT:b=M.ERROR_INVALIDARG;break;case u.UM_E_ACCES_DENIED:b=M.ERROR_NOTAUTHORIZED;break;case u.UM_E_MUST_CONTAIN_SPECIAL_CHAR:b=M.ERROR_PASSMISSSPECHAR;break;case u.UM_E_MUST_CONTAIN_NUMBERS:b=M.ERROR_PASSMISSNUM;
break;case u.UM_E_MUST_CONTAIN_CASE:b=M.ERROR_PASSMISS_CASE;break;case u.UM_E_MUST_CONTAIN_NUMBERS_AND_SP_CHAR:b=M.ERROR_PASSMISS_NUMBER_AND_SPECHAR;break;case u.UM_E_MUST_CONTAIN_NUMBERS_AND_CASE:b=M.ERROR_PASSMISS_NUMBER_AND_CASE;break;case u.UM_E_MUST_CONTAIN_SP_CHAR_AND_CASE:b=M.ERROR_PASSMISS_SPECHAR_AND_CASE;break;case u.UM_E_MUST_CONTAIN_NUMBERS_SPCHAR_AND_CASE:b=M.ERROR_PASSMISS_NUMBER_AND_SPECHAR_AND_CASE;break;case u.UM_E_PASSWORD_TOO_SHORT:b=M.ERROR_PASSTOOSHORT;break;case u.UM_E_SIMILAR_PREV_PSWD:b=
M.ERROR_SAMEPASS;break;case u.UM_E_PASSWORD_EXPIRED:b=M.ERROR_PASSEXPIRED;break;case u.UM_E_USER_OR_PASS_WRONG:b=M.ERROR_WRONGUSERPASS;break;case u.UM_E_USER_OR_PASS_WRONG_DELAY:b=M.ERROR_WRONGUSERPASS_DELAY;break;default:b=M.ERROR_FAILED}return b};a.UMErrorCodeToString=function(b){switch(b){case u.UM_S_OK_PWD_WILL_EXPIRE:b="#S_OK_PWD_WILL_EXPIRE";break;case u.UM_S_OK:b="#S_OK";break;case u.UM_E_FAIL:b="#E_FAIL";break;case u.UM_E_USER_DONT_EXIST:b="#E_USER_DONT_EXIST";break;case u.UM_E_USER_OR_PASS_WRONG:b=
"#E_USER_OR_PASS_WRONG";break;case u.UM_E_USER_OR_PASS_WRONG_DELAY:b="#E_USER_OR_PASS_WRONG_DELAY";break;case u.UM_E_GROUP_DONT_EXIST:b="#E_GROUP_DONT_EXIST";break;case u.UM_E_NO_GROUP_SPECIFIED:b="#E_NO_GROUP_SPECIFIED";break;case u.UM_E_USER_ALREADY_EXIST:b="#E_USER_ALREADY_EXIST";break;case u.UM_E_PASS_DONT_MATCH:b="#E_PASS_DONT_MATCH";break;case u.UM_E_NO_SESSION_EXIST:b="#E_NO_SESSION_EXIST";break;case u.UM_E_SESSION_EXPIRED:b="#E_SESSION_EXPIRED";break;case u.UM_E_SESSION_ALREADY_EXIST:b="#E_SESSION_ALREADY_EXIST";
break;case u.UM_E_LOGIN_FAIL:b="#E_LOGIN_FAIL";break;case u.UM_E_RE_LOGIN_ATTEMPT:b="#E_RE-LOGIN_ATTEMPT";break;case u.UM_E_NEED_LOGIN:b="#E_NEED_LOGIN";break;case u.UM_E_TOO_MANY_USERS:b="#E_TOO_MANY_USERS";break;case u.UM_E_FTP_READ_FORBIDDEN:b="#E_FTP_READ_FORBIDDEN";break;case u.UM_E_FTP_WRITE_FORBIDDEN:b="#E_FTP_WRITE_FORBIDDEN";break;case u.UM_E_NOT_ALLOWED:b="#E_NOT_ALLOWED";break;case u.UM_E_INVALIDARG:b="#E_INVALIDARG";break;case u.UM_E_ILLEGAL_FORMAT:b="#E_ILLEGAL_FORMAT";break;case u.UM_E_ACCES_DENIED:b=
"#E_ACCES_DENIED";break;case u.UM_E_UNAUTHORIZED_USER:b="#E_UNAUTHORIZED_USER";break;case u.UM_E_CHANGE_PASSWORD:b="#E_CHANGE_PASSWORD";break;case u.UM_E_MUST_CONTAIN_SPECIAL_CHAR:b="#E_MUST_CONTAIN_SPECIAL_CHAR";break;case u.UM_E_MUST_CONTAIN_NUMBERS:b="#E_MUST_CONTAIN_NUMBERS";break;case u.UM_E_MUST_CONTAIN_NUMBERS_AND_SP_CHAR:b="#E_MUST_CONTAIN_NUMBERS_AND_SP_CHAR";break;case u.UM_E_MUST_CONTAIN_NUMBERS_SPCHAR_AND_CASE:b="#UM_E_MUST_CONTAIN_NUMBERS_SPCHAR_AND_CASE";break;case u.UM_E_MUST_CONTAIN_NUMBERS_AND_CASE:b=
"#UM_E_MUST_CONTAIN_NUMBERS_AND_CASE";break;case u.UM_E_MUST_CONTAIN_SP_CHAR_AND_CASE:b="#UM_E_MUST_CONTAIN_SP_CHAR_AND_CASE";break;case u.UM_E_MUST_CONTAIN_CASE:b="#UM_E_MUST_CONTAIN_CASE";break;case u.UM_E_PASSWORD_TOO_SHORT:b="#E_PASSWORD_TOO_SHORT";break;case u.UM_E_SIMILAR_PREV_PSWD:b="#E_SIMILAR_PREV_PSWD";break;case u.UM_E_PASSWORD_EXPIRED:b="#E_PASSWORD_EXPIRED";break;case u.UM_E_USER_MADE_INACTIVE:b="#E_USER_INACTIVE";break;default:b="#E_FAIL"}return b};a.getErrorMsgCode=function(b){switch(b){case "#S_OK_PWD_WILL_EXPIRE":b=
a.convertServerErrorCode(u.UM_S_OK_PWD_WILL_EXPIRE);break;case "#S_OK":b=a.convertServerErrorCode(u.UM_S_OK);break;case "#E_FAIL":b=a.convertServerErrorCode(u.UM_E_FAIL);break;case "#E_USER_DONT_EXIST":b=a.convertServerErrorCode(u.UM_E_USER_DONT_EXIST);break;case "#E_USER_OR_PASS_WRONG":b=a.convertServerErrorCode(u.UM_E_USER_OR_PASS_WRONG);break;case "#E_USER_OR_PASS_WRONG_DELAY":b=a.convertServerErrorCode(u.UM_E_USER_OR_PASS_WRONG_DELAY);break;case "#E_GROUP_DONT_EXIST":b=a.convertServerErrorCode(u.UM_E_GROUP_DONT_EXIST);
break;case "#E_NO_GROUP_SPECIFIED":b=a.convertServerErrorCode(u.UM_E_NO_GROUP_SPECIFIED);break;case "#E_USER_ALREADY_EXIST":b=a.convertServerErrorCode(u.UM_E_USER_ALREADY_EXIST);break;case "#E_PASS_DONT_MATCH":b=a.convertServerErrorCode(u.UM_E_PASS_DONT_MATCH);break;case "#E_NO_SESSION_EXIST":b=a.convertServerErrorCode(u.UM_E_NO_SESSION_EXIST);break;case "#E_SESSION_EXPIRED":b=a.convertServerErrorCode(u.UM_E_SESSION_EXPIRED);break;case "#E_SESSION_ALREADY_EXIST":b=a.convertServerErrorCode(u.UM_E_SESSION_ALREADY_EXIST);
break;case "#E_LOGIN_FAIL":b=a.convertServerErrorCode(u.UM_E_LOGIN_FAIL);break;case "#E_RE-LOGIN_ATTEMPT":b=a.convertServerErrorCode(u.UM_E_RE_LOGIN_ATTEMPT);break;case "#E_NEED_LOGIN":b=a.convertServerErrorCode(u.UM_E_NEED_LOGIN);break;case "#E_TOO_MANY_USERS":b=a.convertServerErrorCode(u.UM_E_TOO_MANY_USERS);break;case "#E_FTP_READ_FORBIDDEN":b=a.convertServerErrorCode(u.UM_E_FTP_READ_FORBIDDEN);break;case "#E_FTP_WRITE_FORBIDDEN":b=a.convertServerErrorCode(u.UM_E_FTP_WRITE_FORBIDDEN);break;case "#E_NOT_ALLOWED":b=
a.convertServerErrorCode(u.UM_E_NOT_ALLOWED);break;case "#E_INVALIDARG":b=a.convertServerErrorCode(u.UM_E_INVALIDARG);break;case "#E_ILLEGAL_FORMAT":b=a.convertServerErrorCode(u.UM_E_ILLEGAL_FORMAT);break;case "#E_ACCES_DENIED":b=a.convertServerErrorCode(u.UM_E_ACCES_DENIED);break;case "#E_UNAUTHORIZED_USER":b=a.convertServerErrorCode(u.UM_E_UNAUTHORIZED_USER);break;case "#E_CHANGE_PASSWORD":b=a.convertServerErrorCode(u.UM_E_CHANGE_PASSWORD);break;case "#E_MUST_CONTAIN_SPECIAL_CHAR":b=a.convertServerErrorCode(u.UM_E_MUST_CONTAIN_SPECIAL_CHAR);
break;case "#E_MUST_CONTAIN_NUMBERS":b=a.convertServerErrorCode(u.UM_E_MUST_CONTAIN_NUMBERS);break;case "#E_MUST_CONTAIN_NUMBERS_AND_SP_CHAR":b=a.convertServerErrorCode(u.UM_E_MUST_CONTAIN_NUMBERS_AND_SP_CHAR);break;case "#UM_E_MUST_CONTAIN_NUMBERS_SPCHAR_AND_CASE":b=a.convertServerErrorCode(u.UM_E_MUST_CONTAIN_NUMBERS_SPCHAR_AND_CASE);break;case "#UM_E_MUST_CONTAIN_NUMBERS_AND_CASE":b=a.convertServerErrorCode(u.UM_E_MUST_CONTAIN_NUMBERS_AND_CASE);break;case "#UM_E_MUST_CONTAIN_SP_CHAR_AND_CASE":b=
a.convertServerErrorCode(u.UM_E_MUST_CONTAIN_SP_CHAR_AND_CASE);break;case "#UM_E_MUST_CONTAIN_CASE":b=a.convertServerErrorCode(u.UM_E_MUST_CONTAIN_CASE);break;case "#E_PASSWORD_TOO_SHORT":b=a.convertServerErrorCode(u.UM_E_PASSWORD_TOO_SHORT);break;case "#E_SIMILAR_PREV_PSWD":b=a.convertServerErrorCode(u.UM_E_SIMILAR_PREV_PSWD);break;case "#E_PASSWORD_EXPIRED":b=a.convertServerErrorCode(u.UM_E_PASSWORD_EXPIRED);break;case "#E_USER_INACTIVE":b=a.convertServerErrorCode(u.UM_E_USER_MADE_INACTIVE);break;
default:b=a.convertServerErrorCode(u.UM_E_FAIL)}return b};a.prototype.setDefaultState=function(){this.templatesDir=void 0===this.templatesDir?"../umtemplates/":this.templatesDir;this.currentUser={username:"",group:"",idxot:""}};a.prototype.getValue=function(b){return"username"==b?this.currentUser.username:"group"==b?this.currentUser.group:"ClientID"==b?parseInt(this.infologin.clientID):null};a.prototype._getUserInfos=function(b){var a;if(""!=g.urlParameters.usr){var c=!1,d;for(d in b)if("object"==
typeof b[d]&&b[d].users){var f=b[d].users.indexOf(g.urlParameters.usr);if(-1!=f){a={name:g.urlParameters.usr,grname:d,grobj:b[d],idxot:f,exception:b[d].exceptions[f]};c=!0;break}}c||(a={name:g.urlParameters.usr,grname:g.urlParameters.g,grobj:b[g.urlParameters.g],idxot:g.urlParameters.ot,exception:!1})}else if(null!=this._hmiusergroup)a={},a.name=this._hmiusergroup.lastUser,a.grname=this._hmiusergroup.lastGroup,a.grobj=b[this._hmiusergroup.lastGroup],a.idxot=this._hmiusergroup.lastOt,a.exception=this._hmiusergroup.lastException,
this.infologin.clientID=this._hmiusergroup.lastClientID;else if(this.srv.isLogged())if(b.defUsr&&b.defUsrGrp)a={name:b.defUsr,grname:b.defUsrGrp,grobj:b[b.defUsrGrp],idxot:b[b.defUsrGrp].users.indexOf(b.defUsr),exception:b[b.defUsrGrp].exceptions.indexOf(b.defUsr)};else return null;else return null;return a};a.prototype._deepFreeze=function(b){for(var a in b)"object"==typeof b[a]&&null!==b[a]&&this._deepFreeze(b[a]);return Object.freeze(b)};a.prototype._updateCurrentUser=function(){null==this._hmiusergroup?
this._hmiusergroup={lastUser:this.currentUser.username,lastGroup:this.currentUser.group,lastOt:this.currentUser.idxot,lastException:this.currentUser.exception,grps:[],lastClientID:this.infologin.clientID}:(this._hmiusergroup.lastUser=this.currentUser.username,this._hmiusergroup.lastGroup=this.currentUser.group,this._hmiusergroup.lastOt=this.currentUser.idxot,this._hmiusergroup.lastException=this.currentUser.exception,this._hmiusergroup.lastClientID=this.infologin.clientID)};a.prototype._storeGroup=
function(b){for(var a=!0,c=0;c<this._hmiusergroup.grps.length;c++){var d=this._hmiusergroup.grps[c];if(d.name==b.name&&d.pjct==b.pjct){this._hmiusergroup.grps.splice(c,1,b);a=!1;break}}a&&this._hmiusergroup.grps.push(b);return this.saveValue("_hmiusergroup")};a.prototype._storeObject=function(){this._hmiusergroup=this.loadValue("_hmiusergroup");this._updateCurrentUser();this._storeGroup({page:{id:g.getActivePage().studioId,type:g.getActivePage().constructor==eb?0:1},pjct:g.activeProject.studioId,
name:this.currentUser.group})};a.prototype.loadLastPageUsed=function(){var b=g.activeProject.studioId,a=this.currentUser.group;if(null!=this._hmiusergroup)for(var c in this._hmiusergroup.grps){var d=this._hmiusergroup.grps[c];if(d.name==a&&d.pjct==b&&1==d.page.type)return d.page.id}return null};a.prototype.storeLastPageUsed=function(){this._storeObject()};a.prototype._loadGroupObject=function(){(this._hmiusergroup=this.loadValue("_hmiusergroup"))&&void 0===this.infologin.clientID&&(this.infologin.clientID=
this._hmiusergroup.lastClientID)};a.prototype.getWidgetTreeAuthorizations=function(b){var c=this._isWidgetInMap(b);return c==a.wgtAuth.DEFAULT&&b.parentWidget?this.getWidgetTreeAuthorizations(b.parentWidget):c};a.prototype.getActionTreeAuthorizations=function(b,c,h){return"-1"==h?a.actAuth.ALLOWED:this._isActionInMap(b,c,h)==a.actAuth.DEFAULT&&b.parentWidget?this.getActionTreeAuthorizations(b.parentWidget,c,h):this._isActionInMap(b,c,h)};a.prototype.isPageHidden=function(b){var c,h;return void 0!==
(null===(h=null===(c=this._auth.widgets)||void 0===c?void 0:c[b])||void 0===h?void 0:h[b])?this._auth.widgets[b][b]==a.wgtAuth.HIDE:!1};a.prototype._isWidgetInMap=function(b){var c,h,d,f,g,l;if(b&&null!=this._auth.widgets){if(b.parentPage){var m=b.parentPage.studioId.toLowerCase(),n=null===(c=b.parentPage.templateStudioId)||void 0===c?void 0:c.toLowerCase();if(void 0!==(null===(h=this._auth.widgets[m])||void 0===h?void 0:h[m]))return this._auth.widgets[m][m];if(void 0!==(null===(d=this._auth.widgets[m])||
void 0===d?void 0:d[b.studioId]))return this._auth.widgets[m][b.studioId];if(b.isTemplateWgt){if(void 0!==(null===(f=this._auth.widgets[n])||void 0===f?void 0:f[n]))return this._auth.widgets[n][n];if(void 0!==(null===(g=this._auth.widgets[n])||void 0===g?void 0:g[b.studioId]))return this._auth.widgets[n][b.studioId]}}if(void 0!==(null===(l=this._auth.widgets[b.studioId])||void 0===l?void 0:l[b.studioId]))return this._auth.widgets[b.studioId][b.studioId];if(b.elem&&void 0!==this._auth.widgets[b.elem.dataset.widget])return this._auth.widgets[b.elem.dataset.widget];
if(b.ctype&&void 0!==this._auth.widgets[b.ctype])return this._auth.widgets[b.ctype]}return a.wgtAuth.DEFAULT};a.prototype._isActionInMap=function(b,c,h){var d,f,g,l,m,n,p,r,t,u,v;if(b&&null!=this._auth.actions){if(b.parentPage){var w=b.parentPage.studioId.toLowerCase(),x=null===(d=b.parentPage.templateStudioId)||void 0===d?void 0:d.toLowerCase();if(void 0!==(null===(f=this._auth.actions[w])||void 0===f?void 0:f[w]))return this._auth.actions[w][w];if(void 0!==(null===(l=null===(g=this._auth.actions[w])||
void 0===g?void 0:g[h])||void 0===l?void 0:l[b.studioId]))return this._auth.actions[w][h][b.studioId];if(b.isTemplateWgt){if(void 0!==(null===(m=this._auth.actions[x])||void 0===m?void 0:m[x]))return this._auth.actions[x][x];if(void 0!==(null===(p=null===(n=this._auth.actions[x])||void 0===n?void 0:n[h])||void 0===p?void 0:p[b.studioId]))return this._auth.actions[x][h][b.studioId]}if(null!=b.module&&(d=b.getGraphicModule())){if(void 0!==(null===(r=this._auth.actions[x])||void 0===r?void 0:r[d.studioId]))return this._auth.actions[x][d.studioId];
if(void 0!==(null===(t=this._auth.actions[w])||void 0===t?void 0:t[d.studioId]))return this._auth.actions[w][d.studioId]}}return void 0!=(null===(v=null===(u=this._auth.actions[b.studioId])||void 0===u?void 0:u[h])||void 0===v?void 0:v[b.studioId])?this._auth.actions[b.studioId][h][b.studioId]:void 0!==this._auth.actions[c]?this._auth.actions[c]:a.actAuth.DEFAULT}};a.prototype.startTimer=function(b,a){0<b&&(this._logOffTimer.callback=a,this._logOffTimer.interval=6E4*b,this._logOffTimer.timer=setTimeout(this._logOffTimer.callback,
this._logOffTimer.interval))};a.prototype.resetTimer=function(){this._logOffTimer.timer&&(clearTimeout(this._logOffTimer.timer),this._logOffTimer.timer=setTimeout(this._logOffTimer.callback,this._logOffTimer.interval))};a.prototype.loadUMForm=function(b,a){this._isChangePasswdAction=!0;(new (g.actionMgr.getActionDefinition("hmiActionLoadPage"))).execute(b,{pg:a})};a.prototype.changePwdAction=function(){var b=this,c=this.currentUser.username;if("changepassword"==g.getActivePage().studioId.toLowerCase()){var h=
this.getFormFields(),d=null==h[0].getValue("value")?"":h[0].getValue("value"),f=null==h[1].getValue("value")?"":h[1].getValue("value"),k=null==h[2].getValue("value")?"":h[2].getValue("value");f!=k?(c=a.getErrorMsgCode("#E_PASS_DONT_MATCH"),this.printMessage(c),this.clearFormFields([h[1],h[2]])):this.srv.changePwd(c,d,f,!1).then(function(c){c=c.code;var e=a.getErrorMsgCode(c);e!=a.convertServerErrorCode(u.UM_E_FAIL)&&("#S_OK"==c?b.srv.logOut().then(function(a){b.srv.loadLoginUI(!0,!0)},function(a){b.srv.loadLoginUI(!0,
!0)}):(b.printMessage(e),b.clearFormFields([h[0],h[1],h[2]])))})}};a.prototype.getFormFields=function(){var b=[];if("changepassword"==g.getActivePage().studioId.toLowerCase()){var a=null==g.getActivePage().getWidget("oldpassword_edit",!0)?g.getActivePage().getWidget("ChangePwdEditWgt1.oldpassword_edit",!0):g.getActivePage().getWidget("oldpassword_edit",!0),c=null==g.getActivePage().getWidget("newpassword_edit",!0)?g.getActivePage().getWidget("ChangePwdEditWgt1.newpassword_edit",!0):g.getActivePage().getWidget("newpassword_edit",
!0),d=null==g.getActivePage().getWidget("confirmpassword_edit",!0)?g.getActivePage().getWidget("ChangePwdEditWgt1.confirmpassword_edit",!0):g.getActivePage().getWidget("confirmpassword_edit",!0);b.push(a);b.push(c);b.push(d);b.push(g.getActivePage().getWidget("error_msg",!0))}return b};a.prototype.isUMTemplate=function(b){b instanceof Array&&(b=b[0]);var a=b.split("/");1<a.length&&(b=a[a.length-1]);return-1!=g.umTemplates.indexOf(b)?!0:!1};a.prototype.printMessage=function(b){if(null!=b){var a=g.getActivePage().getWidget("error_msg",
!0);a instanceof gc&&a.setValue("value",b,null,null)}};a.prototype.checkMessages=function(){if(null!=g.urlParameters.code&&!this._isChangePasswdAction){var b=g.getActivePage().studioId.toLowerCase();this.isUMTemplate(b)&&(b=a.convertServerErrorCode(g.urlParameters.code),this.printMessage(b))}};a.prototype.clearFormFields=function(b){var a=t.getModule("Tag"),c;for(c in b){var d=b[c];d.constructor==gc?d.setValue("value",-1,a.QUALITY_GOOD):d.setValue("value","",a.QUALITY_GOOD)}};a.prototype.clearAll=
function(){this.clearFormFields(this.getFormFields())};a.prototype.isDataReady=function(){return this._initialized};a.prototype.getHomePage=function(b){if(null!=b&&(b=this._homepages[b])){var a=b.indexOf(".jmx");return-1==b.indexOf(".jmx")?b:b.substring(0,a)}return null};a.prototype.useLastGroupPage=function(){return this._useLastVisitedPage};a.prototype.getAuthorizationMap=function(){return this._auth};a.prototype.isSecurityEnabled=function(){return this._securityEnable};a.prototype.isDefaultUser=
function(){return this._isDefaultUser};a.prototype.isForceRemoteLoginEnabled=function(){return this._forceRemoteLogin};a.prototype.setCurrentUser=function(b){this.currentUser.username=b};a.prototype.setPwdDuration=function(b){this.infologin.exDur=b};a.prototype.setDayRemainigs=function(b){this.infologin.exDays=b};a.prototype.setClientID=function(b){this.infologin.clientID=b};a.prototype.getWidgetAuthorizationCodes=function(){return l.wgtAuth};a.prototype.getActionAuthorizationCodes=function(){return a.actAuth};
a.jmType="UserGroupMgrWgt";a.actAuth={NOTALLOWED:0,ALLOWED:1,DEFAULT:2};return a}(l);g.fn.hmiUserGroupMgr=function(c,a,b,e){return new Zb(this,c,a,b,e)};g.addWidgetDefinition("hmiUserGroupMgr",Zb);var Ac=function(c){function a(b,a,h,d,f){var k=c.call(this,b.wgtId,a,h,d,f)||this;k.srv=k.project.getTrendMgr().getCommunticationObj();if(b=g.getEventMgr())k.activateHandler=function(){return k.load()},k.deactivateHandler=function(){return k.unload()},b.on(k.parentPage.elem,"loadWgt",k.activateHandler),
b.on(k.parentPage.elem,"unloadWgt",k.deactivateHandler);return k}p(a,c);a.prototype.load=function(){this.enabled=!0};a.prototype.unload=function(){this.enabled=!1};a.prototype.subscribeDataLink=function(b){var a=b.getTargetWidget();this.project.getTrendMgr().hasValidTrendConfiguration(a.getTrendNamePrefix())&&this.srv.subscribeTrend(a,function(a,c){b.setWgtValue(c,void 0,void 0)});c.prototype.subscribeDataLink.call(this,b)};a.prototype.unsubscribeDataLink=function(b){var a=b.getTargetWidget();this.project.getTrendMgr().hasValidTrendConfiguration(a.getTrendNamePrefix())&&
a instanceof bc&&this.srv.unsubscribeTrend(a);c.prototype.unsubscribeDataLink.call(this,b)};a.prototype.destroy=function(){if(this.destroyed)return!1;var b=g.getEventMgr();b.off(this.parentPage.elem,"loadWgt",this.activateHandler);b.off(this.parentPage.elem,"unloadWgt",this.deactivateHandler);this.unload();return c.prototype.destroy.call(this)};a.prototype.updateBufferTimeDuration=function(b){this.srv.updateTrendSubscription(b)};a.jmType="IdalTrendWgt";return a}(l);g.fn.hmiIdalTrendWgt=function(c,
a,b,e){return new Ac(this,c,a,b,e)};g.addWidgetDefinition("hmiIdalTrendWgt",Ac);var Id=function(c){function a(b,a,h,d,f){var k=c.call(this,b.wgtId,a,h,d,f)||this;k.hasTableSubscription=!1;k.hasDataSrcSubscription=!1;if(void 0===k.evType||void 0===k.subType)return k;k.setDefaultState();k.vars={alAlarmID:[],alDateTime:[],alDescription:[],alEventType:[],alName:[],alState:[],alStateCode:[],alValue:[],alGroups:[],alCustomField1:[],alCustomField2:[],evTimestamp:[],evDate:[],evTime:[],min:k.min,max:k.max,
eventCount:0,PageDuration:k.PageDuration};k.srv=g.getActiveProject().getCommunticationObj();k.alMgr=g.activeProject.getAlarmsMgr();k.currLangId=g.activeProject.getMultiLanguageMgr().curLangId;g.getEventMgr()&&(k.activateHandler=function(){k.load()},k.deactivateHandler=function(){k.unload()},c.prototype.bindEvents.call(k,{loadWgt:k.activateHandler}),c.prototype.bindEvents.call(k,{unloadWgt:k.deactivateHandler}));k.isMl=!0;return k}p(a,c);a.prototype.setInitStopTime=function(){var b=g.getActiveProject().getSystemPropertiesMgr().getValue("System Time");
this.setValue("max",b,null,null)};a.prototype.subscribeWgt=function(b,a){b&&(void 0===this._subscriptions[b.wgtId]?this._subscriptions[b.wgtId]=new Nb(b,a):this._subscriptions[b.wgtId].addCallback(a))};a.prototype.setDefaultState=function(){var b=g.cache.getWgtProp(this.wgtId,"PageDuration");null!=b?this.PageDuration=b:void 0!==this.defDur&&0<=this.defDur&&(this.PageDuration=this.getPageDurantion(this.defDur));this.PageDuration=void 0!=this.PageDuration?this.PageDuration:2;b=g.getActiveProject().getSystemPropertiesMgr().getValue("System Time");
this.max=void 0!==this.max?this.max:Math.ceil(b);0==this.getTimeFrame()?this.min=void 0!==this.min?this.min:Math.round(b-60):this.min=this.max-this.getTimeFrame();this.eventCount=void 0!==this.eventCount?this.eventCount:0;this.evType=14;this.subType=void 0!=this.subType?this.subType:1;this.currEvtId=void 0!==this.currEvtId?this.currEvtId:null};a.prototype.load=function(){var b=this,a=g.getActiveProject().getSystemPropertiesMgr().getValue("System Time");this.max=Math.ceil(a);this.min=this.max-this.getTimeFrame();
this.alarmEvent=new Hd(this.evType,this.subType,this.min,this.max,this.wgtId,this.buffName);if(this.srv.getConnectionStatus())this.subscribeEvent();else this.srv.onConnectionReady(function(){return b.subscribeEvent()})};a.prototype.subscribeEvent=function(){var b=this;this.currEvtId=this.srv.subscribeEvent(this.alarmEvent,function(a){b.onDataReady(a)})};a.prototype.updateDataSources=function(){for(var b in this._subscriptions){var a=this._subscriptions[b];if("TableHistoricAlarmSrcWgt"===a.w.getJMType())a.getCallbacks()[0]()}};
a.prototype.unload=function(){this.srv.unsubscribeEvent(this.alarmEvent)};a.prototype.onDataReady=function(b){var a=this.eventCount=b.length,c=0;this.setPrevVars();this.emptyVars();for(var d=0;d<a;d++){var f=b[d];if(14==f.type&&(1==f.evtType||4==f.evtType||5==f.evtType||6==f.evtType)){var f=f.data,g=this.alMgr.getAlarmById(f.id);if(null!=g){this.vars.alAlarmID.push(f.id);var l=f.ts;this.vars.alDateTime.push(l);this.vars.evTimestamp.push(l);var m=(new cb(new Date(l),"DD/MM/YYYY hh:mm:ss")).formatDateTimeValue().split(" ");
this.vars.evDate.push(m[0]);this.vars.evTime.push(m[1]);m=g.alDescription;"undefined"!=typeof this.alMgr.getAlarmsConfiguration().mlTexts[m]&&(m=this.alMgr.getAlarmsConfiguration().mlTexts[m][this.currLangId]);if(g.liveData)var n=g.liveData.d,p=this.parentPage.getPageMLTextMgr().getCurrentLanguage(),r=void 0,r="string"==typeof n[p]?n[n[p]]:n[p],m=this.alMgr.replaceHistLiveTags(m,r,f.d);this.vars.alDescription.push(m);this.vars.alEventType.push(this._getEventType(f.t));this.vars.alName.push(g.alName);
this.vars.alState.push(this._getAlarmState(f.st));this.vars.alStateCode.push(f.st);this.vars.alValue.push(f.v);this.vars.alGroups.push(g.alGroups);this.vars.alCustomField1.push(this.alMgr.getMLText(g.alCustomField1));this.vars.alCustomField2.push(this.alMgr.getMLText(g.alCustomField2));0==d&&(c=l)}}}0==a?this.clearTables():this.updateDataTables();0==this.PageDuration&&this.setValue("min",c/1E3)};a.prototype.isDataReady=function(){return!0};a.prototype.getDataValues=function(b){return this.vars[b]};
a.prototype.getAlarmNameByIndex=function(b){b=this.vars.alName[b];return null!=b?b:"nodata"};a.prototype.getAlarmStateCodeByIndex=function(b){return this.vars.alStateCode[b]};a.prototype._getEventType=function(b){switch(b){case 1:return"Triggered";case 2:return"Not Triggered";case 4:return"Acked";case 8:return"Reset";case 16:return"Enabled";case 32:return"Disabled";case 64:return"Flag Trigger Condition Changed";default:return""}};a.prototype._getAlarmState=function(b){switch(b){case 0:return"Not Triggered";
case 1:return"Disabled";case 2:return"Triggered";case 3:return"Triggered Not Acked";case 4:return"Not Triggered Acked";case 5:return"Not Triggered Not Acked";case 6:return"Triggered Acked";default:return""}};a.prototype.getUnorderedPosition=function(b){return null};a.prototype.updateDataTables=function(){var b=!1,a;for(a in this.dataLinks){var c=this.dataLinks[a].tag;if(this.vars[c]instanceof Array){if(this.eventCount){if($.isEmptyObject(this.prevVars)||this.eventCount==this.prevVars.alAlarmID.length||
(this.prevVars={},b=!0),!b)for(var d=0;d<this.eventCount;d++){var f=0==Object.keys(this.prevVars).length,g=f||this.vars[c][d]!=this.prevVars[c][d]&&!moment.isMoment(this.vars[c][d])&&!moment.isMoment(this.prevVars[c][d]),f=f||moment.isMoment(this.vars[c][d])&&moment.isMoment(this.prevVars[c][d])&&!this.vars[c][d].isSame(this.prevVars[c][d]);if(g||f)b=!0}}else"PageDuration"==c&&this.prevVars[c]!=this.vars[c]&&(b=!0);if(b)break}}if(b){for(var l in this.dataLinks)b=this.dataLinks[l],this.vars[b.tag]instanceof
Array&&b.setWgtValue(this.vars[b.tag],-1);this.clearTables();this.updateTables()}};a.prototype.getValue=function(b){return"PageDuration"==b?this.PageDuration:"min"==b?this.min:"max"==b?this.max:"PageDuration"==b?this.PageDuration:void 0!==this.vars[b]?this.vars[b]:l.prototype.getValue.call(this,b)};a.prototype.setValue=function(b,a,c,d){var f=this;d=!1;c=t.getModule("Tag").QUALITY_GOOD;if(-1<b.indexOf("PageDuration")){b="All"==a?0:parseInt(a,10);if(b==this.PageDuration)return!0;this.PageDuration=
b;this.vars.PageDuration=this.PageDuration;g.cache.setWgtProp(this.wgtId,"PageDuration",this.PageDuration);this.min=this.max-this.getTimeFrame();d=!0;this.sendUpdate("min",new Date(1E3*this.min),c,-1);this.sendUpdate("PageDuration",this.PageDuration,c,-1)}else if("min"==b)this.min=0===a?1:a,this.sendUpdate("min",new Date(1E3*this.min),c,-1);else if("max"==b||"MaxInSeconds"==b)this.max=a,this.min=this.max-this.getTimeFrame(),d=!0,this.sendUpdate("max",new Date(1E3*this.max),c,-1),this.sendUpdate("min",
new Date(1E3*this.min),c,-1);d&&(this.srv.unsubscribeEvent(this.alarmEvent),this.alarmEvent.setStartTime(this.min),this.alarmEvent.setEndTime(this.max),this.currEvtId=this.srv.subscribeEvent(this.alarmEvent,function(b){f.onDataReady(b)}),this.updateDataSources());return!0};a.prototype.sendUpdate=function(b,a,c,d){var f;if(this.dataLinks)for(var g in this.dataLinks)f=this.dataLinks[g],f.tag===b&&f.tgtWgt!==this&&f.setWgtValue(a,d,c,c)};a.prototype.setPrevVars=function(){this.prevVars={};for(var b in this.vars)Array.isArray(this.vars[b])&&
0<this.vars[b].length&&(this.prevVars[b]=this.vars[b].slice())};a.prototype.emptyVars=function(){this.vars={alAlarmID:[],alDateTime:[],alDescription:[],alEventType:[],alName:[],alState:[],alStateCode:[],alTime:[],alValue:[],alGroups:[],alCustomField1:[],alCustomField2:[],evDate:[],evTime:[],evTimestamp:[],min:this.vars.min,max:this.vars.max,eventCount:0,PageDuration:this.PageDuration}};a.prototype.updateLanguage=function(){var b=this,a=this.getPageMLTextMgr().getCurrentLanguage();if(a!=this.currLangId){var c=
g.import("deepClonePlainObject");this.currLangId=a;this.setPrevVars();this.vars=c(this.prevVars);var d=g.activeProject.getAlarmsMgr();this.vars.alName.forEach(function(a,c){var e=d.getAlarmByName(a);b.vars.alDescription[c]=d.getMLText(e.alDescription);b.vars.alCustomField1[c]=d.getMLText(e.alCustomField1);b.vars.alCustomField2[c]=d.getMLText(e.alCustomField2)});this.updateDataTables()}};a.prototype.getTimeFrame=function(){var b=a.timeFrame[this.PageDuration];return 0==b?this.max-1:void 0!==b?b:0};
a.prototype.getPageDurantion=function(b){for(var c in a.timeFrame)if(b==a.timeFrame[c])return parseInt(c);return 1};a.prototype.updateTables=function(){var b=this.getAllSubscriptions();if(b)for(var a in b){var c=b[a].getWidget();"TableWgt"==c.getJMType()&&c.updateData()}};a.prototype.clearTables=function(){var b=this.getAllSubscriptions();if(b)for(var a in b){var c=b[a].getWidget();"TableWgt"==c.getJMType()&&c.clear()}};a.prototype.getStartTime=function(b){return b?this.min:this.max};a.prototype.getStopTime=
function(b){return b?this.max:this.min};a.prototype.getEventType=function(){return this.evType};a.prototype.getSubType=function(){return this.subType};a.prototype.getEventBufferName=function(){return this.buffName};a.prototype._isInt=function(b){return 0===b%1};a.prototype.destroy=function(){if(this.destroyed)return!1;this.vars=null;this.setPrevVars();return this.destroyed=!0};a.timeFrame={0:0,1:60,2:300,3:600,4:1800,5:3600,6:7200,7:14400,8:28800,9:43200,10:86400,11:172800,12:432E3,13:604800,14:1209600,
15:2419200};a.jmType="EventBufferWgt";return a}(l);g.fn.hmiEventBufferWgt=function(c,a,b,e){return new Id(this,c,a,b,e)};g.addWidgetDefinition("hmiEventBufferWgt",Id);(function(c){c[c.ASCENDING=0]="ASCENDING";c[c.DESCENDING=1]="DESCENDING";c[c.TOGGLE=100]="TOGGLE"})(Oa||(Oa={}));(function(c){c[c.ALPHABET=0]="ALPHABET";c[c.NUMERIC=1]="NUMERIC"})(db||(db={}));var Yb=function(){function c(a){this.sortings=this.resolvedSortings=a._s||[];this.filter=this.resolvedFilter=a._f;this.header=a._h;this.isHeader=
!0===a._h?!0:!1;this.isProps=a._h instanceof Array?!0:!1;this.type=a._t;this.value=a._v;this.bg=a._bg;this._originalIndex=a.index;this.proxy=a.parent;this.visible=a.visible}Object.defineProperty(c.prototype,"resolvedSortings",{get:function(){return this._resolvedSortings},set:function(a){this._resolvedSortings=a},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"originalIndex",{get:function(){return this._originalIndex},set:function(a){this._originalIndex=a},enumerable:!1,configurable:!0});
Object.defineProperty(c.prototype,"visible",{get:function(){return this._visible},set:function(a){this._visible=a},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"resolvedFilter",{get:function(){return this._resolvedFilter},set:function(a){this._resolvedFilter=a},enumerable:!1,configurable:!0});c.prototype.updateToggleMap=function(){var a=this;if(this.isProps)for(var b=function(b){var f=c.sortings[b]._c;if(c.sortings[b]._m==Oa.TOGGLE){var h=g.getWidget(c.proxy.wgtId),l=function(c,
e){h.sortingToggleMap.set(c,e);a.sortings[b]._m=h.sortingToggleMap.get(c)};if(h.sortingToggleMap.has(f))return l(f,1==h.sortingToggleMap.get(f)?0:1),"continue";l(f,0)}},c=this,h=0;h<this.sortings.length;h++)b(h)};c.prototype.applyMl=function(){var a=g.activeProject.getMultiLanguageMgr().getCurrentLangCode();if(this.value)for(var b=0;b<this.value.length;b++)this.value[b]instanceof Object&&"ml"==this.value[b]._c&&(this.value[b]=this.value[b].mltext[a])};c.prototype.getBooleanFilterValue=function(a){var b=
!1;void 0===a&&(b=!0);"number"==typeof a&&(b=Boolean(a));"string"==typeof a&&(b=isNaN(Number(a))?!0:Boolean(Number(a)));"boolean"==typeof a&&(b=a);return b};c.prototype.initFilter=function(){this.resolvedFilter=this.filter instanceof Object?!1:this.filter=this.getBooleanFilterValue(this.filter)};c.prototype.isDatalink=function(a){return a._c&&"dl"==a._c?!0:!1};c.prototype.getDirectFormulaXForm=function(a){var b=this.proxy.getTableGroup(),c=b.getDatalink("filter"),b=b.filterSrcType;return c&&c.xforms&&
(c=c.xforms[0],"Formula"==b&&a.v&&"="==a.v.charAt(0))?c:null};c.prototype.getExpressionParams=function(a,b){var c=a.getMapAttrLink();a.getNumAttrLink();var h={},d;for(d in c){var f=c[d];f.tagType===v.INT64?h[d]="fromString('"+b.get(d)+"')":f.tagType===v.UINT64?h[d]="fromString('"+b.get(d)+"',true,10)":(f.tagType!==v.STRING&&b.get(d),h[d]=b.get(d))}return h};c.prototype.createDatalink=function(a,b,c,h){try{var d=g.createDataLink(b,a,{attr:h});d.readFromString(c);d.mount();this.proxy.setDynamicDatalinkToMap(d);
"Tag"==d.srcType&&this.proxy.addTagToSubscribe(d.tag)}catch(f){g.showErrorMessage("model_item_"+this._originalIndex,"TableGroupProxy: 'createDatalink' function",f.message)}};c.prototype.createSortingsDatalinks=function(){for(var a=g.getWidget(this.proxy.wgtId),b=0;b<this.sortings.length;b++){var c=this.sortings[b];this.isDatalink(c)&&this.createDatalink(null,a,c.v,"sort%"+this._originalIndex+"%"+b)}};c.prototype.resolveFilterFormulaValuesAtIndex=function(a){var b=this,c=this.proxy.getFilterXFormulaRows().get(this._originalIndex);
c.forEach(function(c,e,f){var k=a.getMapAttrLink()[e],l=c;if(k&&k.dataSrc.isTableDataSource){var k=b.proxy.getDynamicDatalinkFromMap("filter%"+b._originalIndex+"%"+e),m=c instanceof Object&&"dl"==c._c;k?l=(c=g.cache.getTag(k.tag))?c.getValue(c.tagIndex):"":m&&b.createDatalink(null,b.proxy,c.v,"filter%"+b._originalIndex+"%"+e)}else l=a.getVarValue(e);f.set(e,l)});return c};c.prototype.executeCompiledExpression=function(a){if(null===this.proxy.compiledFilterFunction){var b=this.getDirectFormulaXForm(this.filter);
this.proxy.setCompiledFunction(a,b.getCompiledExpression())}return this.proxy.compiledFilterFunction(a)};c.prototype.createFilterDatalinks=function(){this.isDatalink(this.filter)&&this.updateDatalinkFilter();this._visible=!0===this.resolvedFilter?!0:!1};c.prototype.updateStaticFilter=function(a){this.resolvedFilter=this.getBooleanFilterValue(a);this._visible=!0===this.resolvedFilter?!0:!1};c.prototype.updateDatalinkFilter=function(){var a=this.getDirectFormulaXForm(this.filter);if(a){var b=this.resolveFilterFormulaValuesAtIndex(a),
a=this.getExpressionParams(a,b);this.updateStaticFilter(this.executeCompiledExpression(a))}else null==this.proxy.getDatalink("filter%"+this._originalIndex)&&this.createDatalink(null,this.proxy,this.filter.v,"filter%"+this._originalIndex)};c.prototype.init=function(){this.updateToggleMap();this.initFilter();this.applyMl();this.createSortingsDatalinks();this.createFilterDatalinks()};c.prototype.setSortingValueAtIndex=function(a,b){this.resolvedSortings[b]=a};c.prototype.clone=function(){var a=g.import("deepClonePlainObject");
return new c(a({_bg:this.bg,_h:this.header,_v:this.value,_t:this.type,_f:this.resolvedFilter,_s:this.resolvedSortings,index:this.originalIndex,parentId:this.proxy.wgtId,visible:this.visible}))};c.prototype.toJSON=function(){var a={_bg:this.bg,_v:this.value,_t:this.type,_f:this.resolvedFilter,_s:this.resolvedSortings};if(this.isProps||this.isHeader)a._h=this.header;return a};return c}(),Jd;(function(c){c[c.PROPS_ROW=0]="PROPS_ROW";c[c.STD_ROW=1]="STD_ROW"})(Jd||(Jd={}));var Ec=function(c){function a(b,
a,h,d,f){var k=c.call(this,b,a,h,d,f)||this;k.model=[];k.proxyModel=[];k.refreshMode=!1;k.lastSampleTimestamp=0;k.startTime=0;k.stopTime=0;k.offset=0;k.visibleRows=0;k.hasHeader=!1;k.modelItems=[];k.proxedModelItems=[];k.filterXFormulaRows=new Map;k.filterXFormulaIndex=0;k.filterValue=!1;k.dynamicDatalinksMap=new Map;k.totalTagsToUnsubscribe=[];k.tagsToSubscribe=[];k.forceTagsUpdate=!1;k.debounceTime=200;k.tableDebounceTime=50;k._noMoreData=!1;k._isFetchMoreRunning=!1;k._sortingToggleMap=new Map;
k.compiledFilterFunction=null;g.getEventMgr()&&(k.activateHandler=function(){return k.load()},k.deactivateHandler=function(){return k.unload()},c.prototype.bindEvents.call(k,{loadWgt:k.activateHandler,unloadWgt:k.deactivateHandler}));return k}p(a,c);Object.defineProperty(a.prototype,"noMoreData",{get:function(){return this._noMoreData},set:function(b){this._noMoreData=b},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"dataSource",{get:function(){return this._dataSource},set:function(b){this._dataSource=
b},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"fetchMoreRunning",{get:function(){return this._isFetchMoreRunning},set:function(b){this._isFetchMoreRunning=b},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"sortingToggleMap",{get:function(){return this._sortingToggleMap},enumerable:!1,configurable:!0});a.prototype.load=function(){};a.prototype.unload=function(){this.unmountLinks();this.unsubscribeTags();this.model=[];this.proxyModel=[];this.modelItems=[];this.proxedModelItems=
[]};a.prototype.unmountLinks=function(){for(var b in this.dataLinks)this.parentPage&&this.parentPage.unregisterLink(this.dataLinks[b]),this.dataLinks[b].unmount()};a.prototype.updateDatalinks=function(){for(var b in this.dataLinks){var a=this.dataLinks[b];("Widget"==a.srcType||this.forceTagsUpdate)&&a.update()}this.forceTagsUpdate=!1};a.prototype.compareModelElements=function(b,a,c){if(void 0===this.modelItemProps.resolvedSortings[c])return 0;var d=this.modelItemProps.resolvedSortings[c]._m,f=b.resolvedSortings,
g=a.resolvedSortings;if(void 0===f[c]||void 0==g[c])return 0;var l=f[c],g=g[c],m=0;switch(this.modelItemProps.resolvedSortings[c]._t){case db.ALPHABET:m=l.localeCompare(g);break;case db.NUMERIC:l=isNaN(parseFloat(l))?0:parseFloat(l),g=isNaN(parseFloat(g))?0:parseFloat(g),m=l<g?-1:l>g?1:0}if(0>m)return d===Oa.ASCENDING?-1:1;if(0<m)return d===Oa.ASCENDING?1:-1;c++;return f.length>c?this.compareModelElements(b,a,c):0};a.prototype.parse=function(b){this.totalTagsToUnsubscribe=this.totalTagsToUnsubscribe.concat(this.tagsToSubscribe);
this.tagsToSubscribe=[];for(var a=0;a<b.length;a++){var c=new Yb(Ia(Ia({},b[a]),{parent:this,index:this.offset+a,visible:!1}));c.init();this.modelItems.push(c)}this.subscribeTags();this.updateDatalinks()};a.prototype.filter=function(){this.proxedModelItems=this.proxedModelItems.filter(function(b){return b.visible})};a.prototype.sort=function(){var b=this;this.proxedModelItems=this.proxedModelItems.sort(function(a,c){return b.compareModelElements(a,c,0)})};a.prototype.generateJSON=function(b){this.proxyModel=
[];this.modelItemProps&&this.proxyModel.push(this.modelItemProps.toJSON());this.modelItemHeader&&this.hasHeader&&this.proxyModel.push(this.modelItemHeader.toJSON());for(var a=0;a<b.length;a++)this.proxyModel.push(b[a].toJSON())};a.prototype.generateModelItemClones=function(b){for(var a=0;a<b.length;a++)this.proxedModelItems.push(b[a].clone())};a.prototype.generateProxyModel=function(){var b=void 0===this.dataSource;this.proxedModelItems=[];this.generateModelItemClones(this.modelItems);(b||this.tableGroup.isFilterEnabled()||
this.dataSource.hasFilter)&&this.filter();(b||this.tableGroup.isSortingEnabled())&&this.sort();this.visibleRows=this.proxedModelItems.length;this.generateJSON(this.proxedModelItems)};a.prototype.executeBeginSetModelOnDataUpdate=function(b){this.tableGroup&&this.tableGroup.doOnDataUpdate(this.proxyModel,0,"beginSetModel",0,"R",b)};a.prototype.executeEndSetModelOnDataUpdate=function(){this.tableGroup&&this.tableGroup.doOnDataUpdate(0,0,"endSetModel",0,"R",function(){})};a.prototype.updateProxyModel=
function(){var b=this;this.tableGroup.setRefreshMode(this.refreshMode);this.refreshMode=!1;this.visibleRows=0;this.generateProxyModel();0==this.checkForFetchMoreExecution()?(this.fetchMoreRunning=!1,0<this.proxyModel.length?this.executeBeginSetModelOnDataUpdate(function(a){"object"!=typeof a&&(a=b.proxyModel);b.proxyModel=a;b.tableGroup.setModel();b.executeEndSetModelOnDataUpdate()}):this.hideTableLoading()):(this.fetchMoreRunning=!0,this.dataSource.fetchMore(this.tableGroup))};a.prototype.evaluateModel=
function(){var b=this,a,c=g.import("_debounce");null===(a=this.tableDebounce)||void 0===a?void 0:a.cancel();this.tableDebounce=c(function(){return b.updateProxyModel()},this.tableDebounceTime);this.tableDebounce()};a.prototype.executeFetchMoreOnScroll=function(){this.fetchMoreRunning=!0;this.dataSource.fetchMore(this.tableGroup)};a.prototype.checkForFetchMoreExecution=function(){if(this.dataSource&&this.dataSource.isFetchEnabled){if(0==this.visibleRows&&0==this.noMoreData)return!0;var b=this.tableGroup.height,
a=this.tableGroup.getRowPrototypeHeight(1);if(this.visibleRows*a<b&&0==this.noMoreData)return!0}return!1};a.prototype.evaluateModelItems=function(){this.modelItems.forEach(function(b){b.updateDatalinkFilter()})};a.prototype.setValue=function(b,a,c,d){var f=this;if(0!=this.modelItems.length)if(c=function(b){var a,c=g.import("_debounce");null===(a=f.debounce)||void 0===a?void 0:a.cancel();f.debounce=c(function(){b.forEach(function(b){return b()})},f.debounceTime);f.debounce()},"filter"==b)this.tableGroup.showLoading(),
this.filterValue=a,c([this.evaluateModelItems.bind(this),this.updateProxyModel.bind(this)]);else if(-1!=b.indexOf("filter%")){if(b=Number(b.split("%")[1]),d=this.modelItems[b])"Formula"==this.tableGroup.filterSrcType?d.updateDatalinkFilter():d.updateStaticFilter(Boolean(a)),c([this.updateProxyModel.bind(this)])}else-1!=b.indexOf("sort%")&&(this.showTableLoading(),d=Number(b.split("%")[1]),b=Number(b.split("%")[2]),d=this.modelItems[d])&&(d.setSortingValueAtIndex(a,b),c([this.updateProxyModel.bind(this)]))};
a.prototype.updateSortingRules=function(b){this.dataSource&&(this.forceTagsUpdate=!0,this.dataSource.update())};a.prototype.getValue=function(b){return"filter"==b?this.filterValue:""};a.prototype.appendProps=function(b){this.model.push(b);this.modelItemProps=new Yb(Object.assign(Ia({},b),{parent:this,index:-1,visible:!1}));this.modelItemProps.init()};a.prototype.appendHeader=function(b){null!==b&&(this.hasHeader=!0,this.model.push(b),this.modelItemHeader=new Yb(Object.assign(Ia({},b),{parent:this,
index:-1,visible:!1})),this.modelItemHeader.init())};a.prototype.appendBody=function(b){this.model=this.model.concat(b);this.parse(b)};a.prototype.resetModel=function(){this.clearFilterXFormulaRows();this.unmountLinks();this.dynamicDatalinksMap.clear();this.refreshMode=!0;this.visibleRows=this.offset=0;this.model=[];this.proxyModel=[];this.modelItems=[];this.unsubscribeTags();this.totalTagsToUnsubscribe=[];this.tagsToSubscribe=[]};a.prototype.showTableLoading=function(){this.tableGroup&&this.tableGroup.showLoading()};
a.prototype.hideTableLoading=function(){this.tableGroup&&this.tableGroup.hideLoading()};a.prototype.setCompiledFunction=function(b,a){var c="{",d;for(d in b)c+=d+",";c=c.slice(0,-1);c+="}";try{(function(){eval("this.compiledFilterFunction = function( "+c+"){ return ("+a+"); }")}).call(this)()}catch(f){}};a.prototype.setRefreshMode=function(b){this.refreshMode=b};a.prototype.setOffset=function(b){this.offset=b};a.prototype.getOffset=function(){return this.offset};a.prototype.getModel=function(){return this.model};
a.prototype.getModelItems=function(){return this.modelItems};a.prototype.getProxedModelItems=function(){return this.proxedModelItems};a.prototype.getProxyModel=function(){return this.proxyModel};a.prototype.getTableGroup=function(){return this.tableGroup};a.prototype.getFilterXFormulaRows=function(){return this.filterXFormulaRows};a.prototype.setStartTime=function(b){this.startTime=b};a.prototype.setStopTime=function(b){this.stopTime=b};a.prototype.getStartTime=function(b){return this.lastSampleTimestamp};
a.prototype.getStopTime=function(b){return b==ob.ASCENDING?this.stopTime:this.startTime};a.prototype.setLastSampleTime=function(b){this.lastSampleTimestamp=b};a.prototype.addFilterXFormulaRow=function(b,a){var c=this.filterXFormulaRows.get(this.filterXFormulaIndex);c?c.set(b,a):this.filterXFormulaRows.set(this.filterXFormulaIndex,(new Map).set(b,a))};a.prototype.incrementFilterXFormulaIndex=function(){this.filterXFormulaIndex++};a.prototype.clearFilterXFormulaRows=function(){this.filterXFormulaRows.clear();
this.filterXFormulaIndex=0};a.prototype.setDynamicDatalinkToMap=function(b){this.dynamicDatalinksMap.set(b.attr,b)};a.prototype.getDynamicDatalinkFromMap=function(b){return this.dynamicDatalinksMap.get(b)};a.prototype.addTagToSubscribe=function(b){-1==this.tagsToSubscribe.indexOf(b)&&this.tagsToSubscribe.push(b)};a.prototype.subscribeTags=function(){g.activeProject.getTagMgr().subscribeForTagsNotification(this.tagsToSubscribe)};a.prototype.unsubscribeTags=function(){g.activeProject.getTagMgr().unsubscribeForTagsNotification(this.totalTagsToUnsubscribe)};
a.prototype.destroy=function(){var b,a;c.prototype.destroy.call(this);this.unsubscribeTags();this._sortingToggleMap.clear();null===(b=this.debounce)||void 0===b?void 0:b.cancel();null===(a=this.tableDebounce)||void 0===a?void 0:a.cancel();return!0};return a}(l);g.fn.hmiTableGroupProxy=function(c,a,b,e){return new Ec(this,c,a,b,e)};g.addWidgetDefinition("hmiTableGroupProxy",Ec);var Kd=function(c){function a(b,a,h,d,f){var k=c.call(this,b.wgtId,a,h,d,f)||this;k.initPromiseReady();$hmi.isTestModeActive()||
k.parentWidget.waitWgtReady().then(function(){k._srv=g.activeProject.getCommunticationObj();k._srv.getConf().then(function(b){k._conf=b[k.configFileName];k.resolveWgtReady(!0)}).catch(function(){g.getAction("hmiActionShowMessage").execute(null,{msg:"Error loading audit trail configuration."},3);k.resolveWgtReady(!0)})});return k}p(a,c);a.prototype.isAuditTrailEnabled=function(){return this._conf.enable};a.prototype.getConf=function(){return this._conf};return a}(l);g.fn.hmiAuditTrailMgrWgt=function(c,
a,b,e){return new Kd(this,c,a,b,e)};g.addWidgetDefinition("hmiAuditTrailMgrWgt",Kd);var Rb=function(c){function a(b,e,h,d,f){b=c.call(this,b.wgtId,e,h,d,f)||this;b.duration=a.pageDurationMap[b.pageDuration];return b}p(a,c);a.prototype.setInitStopTime=function(){var b=g.getActiveProject().getSystemPropertiesMgr().getValue("System Time");this.setValue("MaxInSeconds",b,null,null)};a.prototype.updateSubscriptions=function(){for(var b in this._subscriptions)this._subscriptions[b].w.fetchData&&this._subscriptions[b].w.fetchData()};
a.prototype.setValue=function(b,e,h,d){switch(b){case "PageDuration":this.pageDuration!=e&&(this.pageDuration=e,this.duration=a.pageDurationMap[this.pageDuration],this.startTime=0===this.duration?1:this.stopTime-this.duration,this.sendUpdate("min",this.startTime,null),this.sendUpdate("max",this.stopTime,null));break;case "MaxInSeconds":this.stopTime!=e&&(this.stopTime=e,this.startTime=0===this.duration?1:this.stopTime-this.duration,this.sendUpdate("min",this.startTime,null),this.sendUpdate("max",
this.stopTime,null));break;case "dateFormat":this.dateFormat!=e&&(this.dateFormat=e);break;case "timeSpec":this.timeSpec!=e&&(this.timeSpec=e);break;default:c.prototype.setValue.call(this,b,e,h,d)}this.updateSubscriptions()};a.prototype.getValue=function(b){switch(b){case "PageDuration":return this.pageDuration;case "max":case "MaxInSeconds":return this.stopTime;case "min":case "StartTime":return this.startTime;case "duration":return this.duration;default:return c.prototype.getValue.call(this,b)}};
a.prototype.getStartTime=function(b){return b?this.startTime:this.stopTime};a.prototype.getStopTime=function(b){return b?this.stopTime:this.startTime};a.prototype.getTimeFrame=function(){return this.duration};a.prototype.getEventType=function(){return this.evType};a.prototype.getSubType=function(){return this.subType};a.prototype.getEventBufferName=function(){return this.eventBuffer};a.prototype.setParentBounds=function(b,a,c,d,f){};a.prototype.getParentBounds=function(b){return{x:0,y:0,width:0,height:0}};
a.pageDurationMap={0:0,1:60,2:300,3:600,4:1800,5:3600,6:7200,7:14400,8:28800,9:43200,10:86400,11:172800,12:432E3,13:604800,14:1209600,15:2419200,16:7776E3,17:15552E3,18:31536E3,19:63072E3,20:157766400};return a}(l);g.fn.hmiAuditBufferWgt=function(c,a,b,e){return new Rb(this,c,a,b,e)};g.addWidgetDefinition("hmiAuditBufferWgt",Rb);var Ld=function(){function c(a,b,c,h,d,f){this.returnTS=!0;this.deltaTime=this.nEvents=0;this.bounds=!1;this.eventType=a;this.subType=b;this.startTime=c;this.endTime=h;this.bufferId=
d;this.bufferName=f}c.prototype.setEventType=function(a){this.eventType=a};c.prototype.setSubType=function(a){this.subType=a};c.prototype.setStartTime=function(a){this.startTime=a};c.prototype.setEndTime=function(a){this.endTime=a};c.prototype.setBufferId=function(a){this.bufferId=a};c.prototype.setBufferName=function(a){this.bufferName=a};c.prototype.getEventType=function(){return this.eventType};c.prototype.getSubType=function(){return this.subType};c.prototype.getStartTime=function(){return this.startTime};
c.prototype.getEndTime=function(){return this.endTime};c.prototype.getBufferId=function(){return this.bufferId};c.prototype.getBufferName=function(){return this.bufferName};c.prototype.toURL=function(){return"eventType="+this.eventType+"&subType="+this.subType+"&returnTS="+this.returnTS+"&startTime="+this.startTime+"&endTime="+this.endTime+"&nEvents="+this.nEvents+"&deltaTime="+this.deltaTime+"&bounds="+this.bounds};return c}(),pb=function(){return function(){this.visible=!0}}(),Md=function(c){function a(b,
a,h,d,f){var k=c.call(this,b.wgtId,a,h,d,f)||this;k.setDefaultState();k.timer=null;k.currip=null;k.injectAuthScript();g.getEventMgr()&&(k.activateHandler=function(){k.imageElem=k.elem.firstElementChild;k.initEventHandlers();var b=navigator.userAgent;-1==b.indexOf("Trident")&&-1==b.indexOf("Edge")&&-1==b.indexOf("MSIE")||!k.isMjpeg?k.start():k.showIEMjpeg()},k.deactivateHandler=function(){l.prototype.executeDeactivationCallback.call(k)&&(k.stop(),k.isWgtActive=!1)},c.prototype.bindEvents.call(k,{loadWgt:k.activateHandler,
unloadWgt:k.deactivateHandler}));return k}p(a,c);a.prototype.setDefaultState=function(){this.rate=void 0!==this.rate?this.rate:5E3;this.mjpgrate=void 0!==this.mjpgrate?this.mjpgrate:5E3;this.user=void 0!==this.user?this.user:"";this.pwd=void 0!==this.pwd?this.pwd:"";this.mjpegip=void 0!==this.mjpegip?this.mjpegip:"";this.isMjpeg=void 0!==this.isMjpeg?this.isMjpeg:!1;this._renderMask=0};a.prototype.injectAuthScript=function(){var b=document.createElement("script");b.src=this.ip||this.mjpegip;document.head.appendChild(b);
document.head.removeChild(b)};a.prototype.initEventHandlers=function(){var b=this;this.imageElem.onerror=function(){null==document.getElementById(b.wgtId+".nosignal")&&(b._renderMask|=a._renderFlags.ADDNOSIGNAL,g.addToRender(b))};this.imageElem.onload=function(){null!=document.getElementById(b.wgtId+".nosignal")&&(b._renderMask|=a._renderFlags.RMNOSIGNAL,g.addToRender(b))}};a.prototype.createNoSignalHTMLElement=function(){var b=document.createElement("div"),a=document.createElement("h1");a.setAttribute("class",
"jm-h1");b.setAttribute("id",this.wgtId+".nosignal");b.style.width="100%";b.style.height="100%";b.style.backgroundColor="black";b.style.textAlign="center";b.style.position="absolute";b.style.left="0px";b.style.top="0px";a.style.color="blue";a.style.position="relative";a.style.top="50%";a.appendChild(document.createTextNode("NO SIGNAL"));b.appendChild(a);return b};a.prototype.appendNoSignalElement=function(){this.elem.getElementsByTagName("img")[0].style.display="none";this.elem.appendChild(this.createNoSignalHTMLElement())};
a.prototype.removeNoSignalElement=function(){this.elem.getElementsByTagName("img")[0].style.display="block";this.elem.removeChild(document.getElementById(this.wgtId+".nosignal"))};a.prototype.render=function(){c.prototype.render.call(this);this._renderMask&a._renderFlags.JPGREFRESH&&this.refreshJPEG();this._renderMask&a._renderFlags.MJPGREFRESH&&this.refreshMJPEG();this._renderMask&a._renderFlags.ADDNOSIGNAL&&this.appendNoSignalElement();this._renderMask&a._renderFlags.RMNOSIGNAL&&this.removeNoSignalElement();
this._renderMask=0};a.prototype.showIEMjpeg=function(){var b=$(this.elem).children(),a;a='<object id="Player" standby="Loading Axis Media Control components..." border="0" codeBase="/activex/AMC.cab#version=6,0,6,7" classid="CLSID:DE625294-70E6-45ED-B895-CFFA13AEB044" style="width:100%;height:100%;"><param name="StretchToFit" value="-1">'+('<param name="MediaURL" value="'+this.mjpegip+'">');a+='<param name="AutoStart" value="-1"></object>';b.replaceWith(a)};a.prototype.setOptions=function(b){c.prototype.setOptions.call(this,
b);null!=b&&(void 0!=b.user&&(this.user=b.user),void 0!=b.pwd&&(this.pwd=b.pwd),void 0!=b.rate&&(this.rate=b.rate),void 0!=b.mjpegip&&(this.mjpegip=b.mjpegip),void 0!=b.ip&&(this.ip=b.ip))};a.prototype.refreshMJPEG=function(){this.imageElem&&(this.imageElem.src=this.currip)};a.prototype.refreshJPEG=function(){this.imageElem&&(this.imageElem.src=this.currip+"?v="+(new Date).getTime())};a.prototype.start=function(){if(!this.bAltIPAddr){var b=this;this.timer&&clearInterval(this.timer);this.currip=this.ip?
this.ip:this.mjpegip;this.mjpegip?(this._renderMask|=a._renderFlags.MJPGREFRESH,g.addToRender(this),this.timer=window.setInterval(function(){b._renderMask|=a._renderFlags.MJPGREFRESH;g.addToRender(b)},this.mjpgrate)):(this._renderMask|=a._renderFlags.JPGREFRESH,g.addToRender(this),this.timer=window.setInterval(function(){b._renderMask|=a._renderFlags.JPGREFRESH;g.addToRender(b)},b.rate))}};a.prototype.stop=function(){this.timer&&clearInterval(this.timer);this.imageElem&&(this.imageElem.src="",this.imageElem.onerror=
null,this.imageElem=this.imageElem.onload=null)};a.prototype.setValue=function(b,a,h,d,f){d=!1;switch(b){case "user":void 0!=a&&a!=this.user&&(this.user=a,d=!0);break;case "pwd":void 0!=a&&a!=this.pwd&&(this.pwd=a,d=!0);break;case "rate":void 0!=a&&a!=this.rate&&(this.rate=a,d=!0);break;case "mjpegip":case "alt-ipaddress":void 0!=a&&a!=this.mjpegip&&(this.mjpegip=a,d=!0);break;case "ip":void 0!=a&&a!=this.ip&&(this.ip=a,d=!0);break;default:return c.prototype.setValue.call(this,b,a,h)}d&&(this.deactivateHandler(),
this.activateHandler())};a.prototype.getValue=function(b){switch(b){case "user":return this.user;case "pwd":return this.pwd;case "rate":return this.rate;case "mjpegip":case "alt-ipaddress":return this.mjpegip;case "ip":return this.ip;default:return c.prototype.getValue.call(this,b)}};a.prototype.destroy=function(){if(this.destroyed)return!1;c.prototype.unbindEvents.call(this,{loadWgt:this.activateHandler,unloadWgt:this.deactivateHandler});this.imageElem=null;clearInterval(this.timer);return c.prototype.destroy.call(this)};
a._renderFlags={JPGREFRESH:1,MJPGREFRESH:2,ADDNOSIGNAL:4,RMNOSIGNAL:8};a.jmType="IPCameraWgt";return a}(l);g.fn.hmiIPCamera=function(c,a,b,e){return new Md(this,c,a,b,e)};g.addWidgetDefinition("hmiIPCamera",Md);var Nd;(function(c){c[c.AUTO=0]="AUTO";c[c.NORMAL=1]="NORMAL";c[c.REVERSE=2]="REVERSE"})(Nd||(Nd={}));var Od=function(c){function a(b,e,h,d,f){b=c.call(this,b.wgtId,e,h,d,f)||this;b.lData="";b.setDefaultValues();b.itemData=0;b.select=b.elem.querySelector("select");b.count=b.select.childNodes.length;
b.authCode=b.getAuthorizations();b.isNotNative=b._isNativeSelectCompatible();b.keyValue=b.listData[b.mappedIndex];b.textValue=b.list[b.mappedIndex];b.hasEmptyElem=!1;b.comboIndex=b.mappedIndex;b.events={mousedown:!0,touchstart:!0};b.authCode==b.umgr.getWidgetAuthorizationCodes().RDONLY&&(b.enable=!1,b._renderMask|=a._renderFlags.DIS);b.isClone&&b.removeSelectricDOM();b.init();return b}p(a,c);a.prototype.setDefaultValues=function(){this.select=void 0!==this.select?this.select:null;this.enable=void 0!==
this.enable?this.enable:!0;this.lData=void 0!==this.lData?this.lData:null;this.keyValue=void 0!==this.keyValue?this.keyValue:null;this.textValue=void 0!==this.textValue?this.textValue:null;this.fontFamily=void 0!==this.fontFamily?this.fontFamily:null;this.borderColor=void 0!==this.borderColor?this.borderColor:"rgb(245,245,245)";this.borderWidth=void 0!==this.borderWidth?this.borderWidth:1;this.dropdownBgColor=void 0!==this.dropdownBgColor?this.dropdownBgColor:"rgb(255,255,255)";this.dropdownSelBgColor=
void 0!==this.dropdownSelBgColor?this.dropdownSelBgColor:"rgb(0,176,199)";this.dropdownFontColor=void 0!==this.dropdownFontColor?this.dropdownFontColor:"rgb(76,76,77)";this.dropdownSelFontColor=void 0!==this.dropdownSelFontColor?this.dropdownSelFontColor:"rgb(255,255,255)";this.dropdownBorderColor=void 0!==this.dropdownBorderColor?this.dropdownBorderColor:"rgb(200,200,200)";this.dropdownBorderWidth=void 0!==this.dropdownBorderWidth?this.dropdownBorderWidth:1;this.dropdownButtonWidth=void 0!==this.dropdownButtonWidth?
this.dropdownButtonWidth:30;this.dropdownButtonBgColor=void 0!==this.dropdownButtonBgColor?this.dropdownButtonBgColor:"rgb(245,245,245)";this.dropdownButtonImageWidth=void 0!==this.dropdownButtonImageWidth?this.dropdownButtonImageWidth:15;this.dropdownButtonImageHeight=void 0!==this.dropdownButtonImageHeight?this.dropdownButtonImageHeight:15};a.prototype.init=function(){this.doOnUpdateIndex();this.sendUpdate("index",this.comboIndex,null);this.sendUpdate("data",this.keyValue,null);this.sendUpdate("itemData",
this.keyValue,null);this.sendUpdate("text",this.textValue,null);this._renderMask|=a._renderFlags.INITWRAP;g.addToRender(this)};a.prototype.removeSelectricDOM=function(){var b=this.elem.querySelector(".selectric");b&&b.remove()};a.prototype._initSelectEvents=function(){var b=this;$(this.select).change(function(){b.onChange()})};a.prototype._initSelectricWrapper=function(){this.combowrap=new P(this);this.updateWrapper();this.updateLanguage();this.getAuthorizations()!=this.umgr.getWidgetAuthorizationCodes().RDONLY&&
this.combowrap.bindEvents()};a.prototype.doMouseDown=function(b){};a.prototype.doMouseUp=function(b){};a.prototype.isWgtEventsPreventDefault=function(){return this.isNotNative};a.prototype.render=function(){c.prototype.render.call(this);this._renderMask&a._renderFlags.INITWRAP&&(g.browserOptimizations.forceLayers&&($(this.elem).hasClass("jm-hacklayer")||$(this.elem).addClass("jm-hacklayer")),this.isNotNative?this._initSelectricWrapper():this._initSelectEvents());this._renderMask&a._renderFlags.NATIVECOMBOBOUNDS&&
(this.select.style.width=this.width+"px",this.select.style.height=this.height+"px");if(this._renderMask&a._renderFlags.CHANGE){if(this.hasEmptyElem){var b=this.select.querySelector("option[empty='true']");b&&b.remove();this.hasEmptyElem=!1}this.select.selectedIndex=this.mappedIndex}if(this._renderMask&a._renderFlags.EMPTY){if(!this.hasEmptyElem){var e=document.createElement("option");e.setAttribute("empty","true");e.setAttribute("selected","selected");e.setAttribute("style","display:none");this.select.prepend(e)}this.hasEmptyElem=
!0;this.select.selectedIndex=-1}this._renderMask&a._renderFlags.DIS&&(this.enable?($(this.select).removeAttr("disabled"),this.combowrap&&this.combowrap.bindEvents()):(this.combowrap&&this.combowrap.unbindEvents(),$(this.select).attr("disabled","")));if(this._renderMask&a._renderFlags.FILL){$(this.select).children().remove();e=document.createElement("option");e.setAttribute("empty","true");e.setAttribute("selected","selected");e.setAttribute("style","display:none");this.hasEmptyElem=!1;if(this.list){var b=
this.list,h=document.createDocumentFragment(),d;if(0>this.mappedIndex||this.mappedIndex>this.count-1)h.appendChild(e),this.hasEmptyElem=!0;for(var f=0,k=this.count;f<k;f++)d=document.createElement("option"),e=document.createTextNode(b[f]),d.appendChild(e),h.appendChild(d);this.select.prepend(h)}else this.select.prepend(e),this.hasEmptyElem=!0;this.select.selectedIndex=this.mappedIndex}this._renderMask&a._renderFlags.FONTSTYLES&&(this.elem.style.fontFamily=this.fontFamily,this.elem.style.color=this.fontColor,
this.elem.style.fontSize=this.fontSize+"px",this.elem.style.fontStyle=this.fontStyle,this.elem.style.fontWeight=1==this.fontBold?"bold":"initial",this.elem.style.textDecoration=this.fontUnderline?"underline":"none");this.combowrap&&this.updateWrapper();this._renderMask=0};a.prototype.addDataLink=function(b){c.prototype.addDataLink.call(this,b);this.initDataLinkSideEffects(b,b.attr)};a.prototype.initDataLinkSideEffects=function(b,c){if("mappedIndex"==c&&"r"==b.rw||this.authCode==this.umgr.getWidgetAuthorizationCodes().RDONLY)this.enable=
!1,this._renderMask|=a._renderFlags.DIS,g.addToRender(this);"list"==c&&this.hasPropInDatalinks("List")};a.prototype.doOnUpdateIndex=function(){0>this.mappedIndex||this.mappedIndex>this.count-1?(this.mappedIndex=-1,this._renderMask|=a._renderFlags.EMPTY):this._renderMask|=a._renderFlags.CHANGE;this.select.options[this.mappedIndex]?(this.keyValue=void 0!==this.listData[this.mappedIndex]?this.listData[this.mappedIndex]:"",this.textValue=void 0!==this.list[this.mappedIndex]?this.list[this.mappedIndex]:
""):this.textValue=this.keyValue=""};a.prototype.updateListIndex=function(){for(var b=[],a=0;a<this.list.length;a++)this.listIndex[a]?b.push(this.listIndex[a]):b.push(a);this.listIndex=b};a.prototype.updateListData=function(){for(var b=[],a=0;a<this.list.length;a++)this.listData[a]?b.push(this.listData[a]):b.push("");this.listData=b};a.prototype.setValue=function(b,e,h,d){var f=!1;if(this.isBadValue(e,!1,h))return!1;switch(b){case "index":e="string"==typeof e?parseInt(e):e;this.comboIndex==e||isNaN(e)||
(this.comboIndex=e,this.mappedIndex=this.listIndex.indexOf(this.comboIndex),this.lData=this.listData[this.mappedIndex],this.textValue=this.list[this.mappedIndex],this.doOnUpdateIndex(),this.sendUpdate("index",this.comboIndex,null),this.sendUpdate("data",this.lData,null),this.sendUpdate("itemData",this.lData,null),this.sendUpdate("text",this.textValue,null),this.doWriteValue("index",this.comboIndex),this.doWriteValue("data",this.lData),f=!0);break;case "disabled":void 0!==e&&this.enable!=!e&&(this.enable=
!e,f=!0,this._renderMask|=a._renderFlags.DIS,this.sendUpdate(b,this.enable,h));break;case "data":if(this.lData!=e&&null!=e){this.lData=e;this.updateListIndex();this.updateListData();b=-1;for(e=0;e<this.listData.length;e++)if(this.listData[e]==this.lData){b=e;break}this.comboIndex=b=void 0!==this.listIndex[b]?this.listIndex[b]:-1;this.mappedIndex=this.listIndex.indexOf(this.comboIndex);this.textValue=this.list[this.mappedIndex];this.doOnUpdateIndex();this.sendUpdate("index",this.comboIndex,null);this.sendUpdate("data",
this.lData,h);this.sendUpdate("itemData",this.lData,null);this.sendUpdate("text",this.textValue,null);this.doWriteValue("index",b);this.doWriteValue("data",this.lData);f=!0}break;case "list":this.list!=e&&(this.list=void 0!=e?e instanceof Array?e:e.split(","):[],this.count=this.list.length,this.updateListIndex(),this.updateListData(),this.mappedIndex=this.listIndex.indexOf(this.comboIndex),this.doOnUpdateIndex(),this._renderMask|=a._renderFlags.FILL,this.sendUpdate(b,this.list instanceof Array?this.list.join(","):
this.list,h),f=!0);break;case "font-family":this.fontFamily!=e&&(this.fontFamily=e,this._renderMask|=a._renderFlags.FONTSTYLES,f=!0,this.sendUpdate(b,e,h));break;case "font-color":this.fontColor!=e&&(this.fontColor=e,this._renderMask|=a._renderFlags.FONTSTYLES,f=!0,this.sendUpdate(b,e,h));break;case "font-size":this.fontSize!=e&&(this.fontSize=e,this._renderMask|=a._renderFlags.FONTSTYLES,f=!0,this.sendUpdate(b,e,h));break;case "font-style":this.fontStyle!=e&&(this.fontStyle=e,this._renderMask|=a._renderFlags.FONTSTYLES,
f=!0,this.sendUpdate(b,e,h));break;case "font-weight":this.fontBold!=e&&(this.fontBold=e,this._renderMask|=a._renderFlags.FONTSTYLES,f=!0,this.sendUpdate(b,e,h));break;case "font-underline":this.fontUnderline!=e&&(this.fontUnderline=e,this._renderMask|=a._renderFlags.FONTSTYLES,f=!0,this.sendUpdate(b,this.fontUnderline,h,null));break;case "fill":case "borderColor":case "dropdownBgColor":case "dropdownSelBgColor":case "dropdownFontColor":case "dropdownSelFontColor":case "dropdownBorderColor":case "dropdownButtonBgColor":case "bgColor":this[b]!=
e&&(this[b]=this.project.validateColor(e)?e:"#000",this.sendUpdate(b,this.strokeColor,h),f=!0);break;case "borderWidth":case "dropdownBorderWidth":case "dropdownButtonWidth":case "dropdownButtonImageWidth":case "dropdownButtonImageHeight":case "dropdownItemHeight":this[b]!=e&&(this[b]=0<=parseInt(e)?parseInt(e):0,f);break;default:c.prototype.setValue.call(this,b,e,h,d)}f&&g.addToRender(this);return!0};a.prototype.getValue=function(b){switch(b){case "itemData":case "data":return this.keyValue;case "index":return this.listIndex[this.mappedIndex];
case "list":return this.list instanceof Array?this.list.join(","):this.list;case "text":return this.textValue;case "font-bold":return this.fontBold;case "fill":case "font-color":return this.fontColor;case "font-family":return this.fontFamily;case "font-size":return this.fontSize;case "font-style":return this.fontStyle;case "font-underline":return this.fontUnderline;default:return l.prototype.getValue.call(this,b)}};a.prototype.getText=function(b){return this.getPageMLTextMgr().getText(b,this)};a.prototype.updateLanguage=
function(){if(this.allowUpdateLanguageOnProps(["List"])){var b=this.getPageMLTextMgr(),a=b.getCurrentFont(),b=b.getCurrentLanguage(),c=this.getText(String(this.mlIds[0])),d=void 0;this.mlMap&&(d=this.mlMap[b]);void 0!=d&&(a=d);a!=this.fontFamily&&this.setValue("font-family",a,null,null);if(!this.isDynamicLinkedProperty("list")&&null!=c&&(this.lang!=b||this.isClone)){a=t.getModule("Tag");d=[];this.lang=b;if(c instanceof Array)d=c;else for(b=0;b<this.mlIds.length;b++)d.push(this.getText(String(this.mlIds[b])));
this.setValue("list",d,a.QUALITY_GOOD)}}};a.prototype.onChange=function(b){this.hasEmptyElem&&--b;this.setValue("index",null!=this.listIndex[b]?this.listIndex[b]:-1,null);this.setValue("data",null!=this.listData[b]?this.listData[b]:"",null)};a.prototype.onClose=function(){this.isNotNative&&this.combowrap&&this.combowrap.detachClone()};a.prototype.updateWrapper=function(){this.combowrap&&this.combowrap.update(this.select.selectedIndex)};a.prototype.setParentBounds=function(b,a,h,d,f){c.prototype.setParentBounds.call(this,
b,a,h,d,f);this.updateOnResize()};a.prototype.updateOnResize=function(b){c.prototype.updateOnResize.call(this,b);this.combowrap?(this.removeComboWrapper(),this._renderMask|=a._renderFlags.INITWRAP):this._renderMask|=a._renderFlags.NATIVECOMBOBOUNDS;g.addToRender(this)};a.prototype.destroy=function(){if(this.destroyed)return!1;c.prototype.destroy.call(this);this.removeComboWrapper();return!0};a.prototype.removeComboWrapper=function(){this.combowrap?(this.combowrap.removeObjects(),delete this.combowrap,
$(this.elem).append(this.select)):$(this.select).off()};a.jmType="ComboBoxWgt";a._renderFlags={CHANGE:1,DIS:2,EMPTY:4,FILL:8,INITWRAP:16,NATIVECOMBOBOUNDS:32,FONTSTYLES:64,COMBOSTYLES:128};return a}(l);g.fn.hmiComboBox=function(c,a,b,e){return new Od(this,c,a,b,e)};g.addWidgetDefinition("hmiComboBox",Od);var ba;(function(c){c[c.HISTORY=0]="HISTORY";c[c.REALTIME=1]="REALTIME"})(ba||(ba={}));var bc=function(c){function a(b,a,h,d,f){b=c.call(this,b.wgtId,a,h,d,f)||this;b.timer=null;b.debounceTime=500;
b.setDefaultState();b.trnWndId&&(b.trnWnd=b.parentWidget.getWidgetByCondition(function(b){return"TrendWindowWgt"==b.getJMType()}),b.trnWnd.subscribeWgt(b,function(){}));b.srv=g.getActiveProject().getCommunticationObj();b.bufferType==ba.REALTIME?(b.samplingTime*=1E3,b.timerRealTime=null):b.bufferType==ba.HISTORY&&(b.refreshHistory=3E3,b.isDirty=!0);var k=b;g.getEventMgr()&&(k=b,b.activateHandler=function(){l.prototype.executeActivationCallback.call(k)&&(k.load(),k.isWgtActive=!0)},b.deactivateHandler=
function(){l.prototype.executeDeactivationCallback.call(k)&&(k.unload(),k.isWgtActive=!1)},c.prototype.bindEvents.call(b,{loadWgt:b.activateHandler,unloadWgt:b.deactivateHandler}));return b}p(a,c);a.prototype.setDefaultState=function(){var b=t.import("Quality");this.bufferSize=void 0!==this.bufferSize?this.bufferSize:1E3;this.bufferType=void 0!==this.bufferType?this.bufferType:1;this.dynamicTrendName="";this.hasDynamicTrendName=!1;this.currValueQuality=new b(192);this.nPoints=void 0!==this.nPoints?
this.nPoints:0;this.nextInsert=void 0!==this.nextInsert?this.nextInsert:0;this.isCyclic=void 0!==this.isCyclic?this.isCyclic:!1;this.startTimeIdx=void 0!==this.startTimeIdx?this.startTimeIdx:0;this.stopTimeIdx=void 0!==this.stopTimeIdx?this.stopTimeIdx:0;this.value=void 0!==this.value?this.value:null;this.timerRealTime=void 0!==this.timerRealTime?this.timerRealTime:null;this.currValueTs=void 0!==this.currValueTs?this.currValueTs:null;this.lastReadTagTs=void 0!==this.lastReadTagTs?this.lastReadTagTs:
null;this.outOfSyncGap=void 0!==this.outOfSyncGap?this.outOfSyncGap:0;this.rIdal=void 0!==this.rIdal?this.rIdal:null;this.hTrendName=void 0!==this.hTrendName?this.hTrendName:null;this.hTrendPrefix=void 0!==this.hTrendPrefix?this.hTrendPrefix:null;this.windowSTime=void 0!==this.windowSTime?this.windowSTime:null;this.windowETime=void 0!==this.windowETime?this.windowETime:null;this.hMaxNSamples=void 0!==this.hMaxNSamples?this.hMaxNSamples:0};a.prototype.load=function(){this.buffer=Array(this.bufferSize);
this.auxBuff=[];this.nextInsert=0;this.bufferType==ba.REALTIME&&(this.isCyclic=!0,this.startRealTimeSampling())};a.prototype.unload=function(){null!==this.timerRealTime&&(window.clearInterval(this.timerRealTime),this.timerRealTime=null);this.auxBuff=this.buffer=null};a.prototype.startRealTimeSampling=function(){var b=this;null===this.timerRealTime&&(this.timerRealTime=window.setInterval(function(){var a,c=Date.now();b.currValueTs!=b.lastReadTagTs?(a=(new Date(b.currValueTs)).getTime(),b.outOfSyncGap=
c-a,b.lastReadTagTs=b.currValueTs):a=c-b.outOfSyncGap;b.addPoint(a,b.value,b.currValueQuality);a=b._orderByTime();b.sendUpdate("web-value",a,null)},this.samplingTime))};a.prototype.addPoint=function(b,a,c){this.nextInsert<this.bufferSize&&(this.buffer[this.nextInsert]=new fa(b,a,c),this.stopTimeIdx=this.nextInsert);this.nextInsert++;this.nPoints++;this.nPoints>=this.bufferSize&&(this.nPoints=this.bufferSize,this.isCyclic&&this.nextInsert>=this.bufferSize&&(this.nextInsert=0),this.isCyclic&&(this.startTimeIdx=
this.nextInsert))};a.prototype.addDataLink=function(b){c.prototype.addDataLink.call(this,b);"trend"==b.attr&&(this.hasDynamicTrendName=!0)};a.prototype.setValue=function(b,a,c,d,f){switch(b){case "Value":this.currValueQuality=c;if(this.hasDynamicTrendName&&c&&!c.isQualityGood()||this.isBadValue(a,!1,c))return this.value=void 0,!1;switch(this.bufferType){case ba.REALTIME:if(this.value!=a||this.currValueTs!=f)this.value=a,this.currValueTs=f,this.sendUpdate(b,this.value,c);break;case ba.HISTORY:if(this.buffer=
a)this.generateGhostBufferSamples(),this.sendUpdate("web-value",this.auxBuff,null)}break;case "trend":if(c&&!c.isQualityGood())return!1;this.bufferType==ba.REALTIME?this.dynamicTrendName!=a&&(this.dynamicTrendName=a,this.clearBufferData(),this.updateRealTimeValueDataLink(this.dynamicTrendName)):this.bufferType==ba.HISTORY&&this.dynamicTrendName!=a&&(this.dynamicTrendName=a,this.clearBufferData(),this.hTrendName=a,this.updateHistoricValueDataLink(this.dynamicTrendName))}return!0};a.prototype.updateHistoricValueDataLink=
function(b){for(var a in this.dataLinks){var c=this.dataLinks[a],d=c.getDataSrc();if("Value"==c.getAttribute()&&d.getUserId()!=this.studioId){c.unmount();c.updateDataSourceAttribute(b,-1);c.mount();break}}};a.prototype.updateRealTimeValueDataLink=function(b){var a=this,c=!1,d;for(d in this.dataLinks){var f=this.dataLinks[d],g=f.getDataSrc();if("Value"==f.getAttribute()&&g.getUserId()!=this.studioId){f.updateDataSourceAttribute(b,-1);"TagMgrWgt"==g.getJMType()&&(g.isTagSubscribed(b)||g.subscribeDynamicTags());
f.update();c=!0;break}}c||(c=this.project.getPageMgr())&&(c.isPrecaching()?c.waitPrecacheEnd().then(function(){return a.createRealTimeValueDataLink(b)}):this.createRealTimeValueDataLink(b))};a.prototype.createRealTimeValueDataLink=function(b){var a=this.project.getTagMgr();g.createDataLink(this,a,{rw:"r",attr:"Value",tag:b,srcType:"Tag",dataSource:"_TagMgr",_tag:"",tagIndex:-1,wT:0}).update().mount();a.subscribeDynamicTags()};a.prototype.clearBufferData=function(){for(var b in this.dataLinks){var a=
this.dataLinks[b];if(a.getDataSrc().getUserId()==this.studioId&&"Value"==a.getTag()){b=a.getTargetWidget();this.bufferType==ba.REALTIME?"TrendCurveWgt"==b.getJMType()&&(null!==this.timerRealTime&&(window.clearInterval(this.timerRealTime),this.timerRealTime=null),this.value=void 0,this.currValueTs=null,this.buffer=Array(this.bufferSize),this.auxBuff=[],this.nextInsert=0,this.lastReadTagTs=this.currValueTs=null,this.outOfSyncGap=0,this.sendUpdate("web-value",this.buffer,null),this.startRealTimeSampling()):
this.bufferType==ba.HISTORY&&(this.buffer=[],this.auxBuff=[],this.nextInsert=0,this.sendUpdate("web-value",this.buffer,null));break}}};a.prototype.generateGhostBufferSamples=function(){var b=!1,a=this.buffer.length;this._prevQuality=this._prevValue=this._prevTimeStamp=null;this.auxBuff=[];for(var c=0;c<a&&(c==a-1&&(b=!0),this.addBufferPoint(this.buffer[c],b));c++);};a.prototype.addBufferPoint=function(b,a){var c=t.import("Quality"),d=!1;if(!this.buffer)return d;var f=b.ms,g=b.v,l=b.rt,c=new c(b.q),
m=0,n,m=Math.max(l,this.deltaTime);if(!this._prevTimeStamp)return d=this.inflateAndAddPoint(f,g,c),this._prevTimeStamp=f,this._prevValue=g,this._prevQuality=c,d;var l=this.windowETime,p=this.project.getSystemPropertiesMgr(),p=p?p.getTime():(new Date).getTime();a?(n=f-this._prevTimeStamp,n>m&&(n=this._prevTimeStamp+n/m*m,n=f-n<=m/2?n-m:n,n<this._prevTimeStamp&&(n+=m),n>=this._prevTimeStamp&&n<=f&&(d=this.inflateAndAddPoint(n,this._prevValue,this._prevQuality))),g!=this._prevValue?d=this.inflateAndAddPoint(f,
g,c):l<p-m&&(d=this.inflateAndAddPoint(f,g,c))):(n=f-this._prevTimeStamp,n>m&&(n=this._prevTimeStamp+n/m*m,n=f-n<=m/2?n-m:n,n<this._prevTimeStamp&&(n+=m),n>=this._prevTimeStamp&&n<=f&&this.inflateAndAddPoint(n,this._prevValue,this._prevQuality)),d=this.inflateAndAddPoint(f,g,c),this._prevTimeStamp=f,this._prevValue=g,this._prevQuality=c);return d};a.prototype.inflateAndAddPoint=function(b,a,c){this.auxBuff.push(new fa(b,a,c));return!0};a.prototype.getTrendST=function(){if(this.hTrendName)return $hmi.activeProject.getWidget("_TrendMgr",
!0).getConfiguration()[this.hTrendPrefix].st};a.prototype.getValue=function(b){if("Value"==b)return this.bufferType==ba.REALTIME?this.value:this.buffer;if("trend"==b){if(this.bufferType==ba.REALTIME)return this.dynamicTrendName}else return c.prototype.getValue.call(this,b)};a.prototype._orderByTime=function(){return 0==this.startTimeIdx?this.buffer.slice(0,this.stopTimeIdx+1):this.buffer.slice(this.startTimeIdx,this.bufferSize).concat(this.buffer.slice(0,this.stopTimeIdx+1))};a.prototype.subscribeDataLink=
function(b){c.prototype.subscribeDataLink.call(this,b);if(this.bufferType==ba.HISTORY){var a=b.dataSrc;a&&"IdalTrendWgt"==a.getJMType()&&"Value"==b.attr&&(this.rIdal=a,this.hTrendName=b.tag,this.hTrendPrefix=this.hTrendName.split(".")[0])}this.bufferType!=ba.REALTIME&&this.bufferType!=ba.HISTORY||b.tgtWgt.constructor!=C||"web-value"==b.attr||g.createDataLink(b.tgtWgt,this,{rw:b.rw,attr:"web-value",tag:"web-value",srcType:b.srcType,tagIndex:-1,xforms:b.xforms}).mount()};a.prototype.setHistoricParams=
function(b,a,c,d){var f=this,k;if(this.windowSTime!=b&&this.windowETime!=a||c!=this.hMaxNSamples||this.pageDuration!=d)this.windowSTime=b,this.windowETime=a,this.setMaxSamplesNum(c),this.setPageDuration(d),this.rIdal&&(b=g.import("_debounce"),null===(k=this.debounce)||void 0===k?void 0:k.cancel(),this.debounce=b(function(){return f.rIdal.updateBufferTimeDuration(f)},this.debounceTime),this.debounce())};a.prototype.setDeltaTime=function(b){this.deltaTime=b};a.prototype.setPageDuration=function(b){this.pageDuration=
b};a.prototype.setMaxSamplesNum=function(b){this.hMaxNSamples=b};a.prototype.isHistoric=function(){return this.bufferType==ba.HISTORY};a.prototype.getStartTime=function(){return this.windowSTime};a.prototype.getStopTime=function(){return this.windowETime};a.prototype.getTrendName=function(){return this.hTrendName};a.prototype.getTrendNamePrefix=function(){return this.hTrendPrefix};a.prototype.getMaxSamplesNum=function(){return this.hMaxNSamples};a.prototype.getDeltaTime=function(){return this.deltaTime};
a.prototype.getPageDuration=function(){return this.pageDuration};a.prototype.destroy=function(){if(this.destroyed)return!1;this.unload();clearTimeout(this.timer);c.prototype.unbindEvents.call(this,{loadWgt:this.activateHandler,unloadWgt:this.deactivateHandler});return this.destroyed=!0};a.jmType="TrendBufferWgt";return a}(l);g.fn.hmiTrendBufferWgt=function(c,a,b,e){return new bc(this,c,a,b,e)};g.addWidgetDefinition("hmiTrendBufferWgt",bc);var bg=function(c){function a(b,a,h,d,f,g){return c.call(this,
b,a,h,d,f,g)||this}p(a,c);return a}(Ld),cg="FTP HTTP CGI SOAP ICEE LOCAL SYSTEM_IDAL".split(" "),dg="LOGIN LOGOUT ACK_ALARM ACTIVATE_ALARM ENABLE_ALARM DEACTIVATE_ALARM RESET_ALARM WRITE_TAG DISABLE_ALARM DOWNLOAD_RECIPE UPLOAD_RECIPE DUMP_RECIPE RESTORE_RECIPE RESET_RECIPE RENAME_RECIPE RENAME_RECIPE_SET RENAME_RECIPE_ELEMENT ADD_RECIPE_SET DEL_RECIPE_SET DUMP_ALL_RECIPE RESTORE_ALL_RECIPE RESET_ALL_RECIPE DATATRANSFER_WRITE_TAG CHANGE_PASSWORD ADDUSER DELETEUSER EDITUSER DUMP_TREND_BUFFER DUMP_ALARM_BUFFER DUMP_AUDIT_BUFFER DELETE_TREND_BUFFER DELETE_ALARM_BUFFER DELETE_AUDIT_BUFFER SYSTEM_RESET SYSTEM_RESTART SYSTEM_POWERON SYSTEM_UPDATE SYSTEM_BACKUP FTP_GET FTP_PUT OPEN_TEXT_EDITOR SAVE_TEXT_EDITOR LOG_MESSAGE DOWNLOAD_PROJECT SHOW_PROJECT_MANAGER SHOW_SYSTEM_SETTINGS PRINT_GFX_REPORT PRINT_EVENT PRINT_TEXT PRINT_BYTE PRINT_ABORT PRINT_PAUSE PRINT_RESUME PRINT_EMPTY_QUEUE RECIPE_WRITE_TAG SYSTEM_TIMECHANGE MOUNT_DEVICE RECIPE_ELEMENT_CHANGE".split(" "),
Pd=function(c){function a(b,a){var h=c.call(this)||this;h.date="";h.information="";h.interface="";h.operation="";h.recordId="";h.status="";h.time="";h.formattedTS="";h.userName="";if(a){var d=b.getFormattedTimestamp(1E3*a.ts),f=a.v_r[2].split(";");h.type=a.t;h.subtype=a.s;h.archiveType=a.at;h.recordId=a.id.toString();h.formattedTS=d.full;h.date=d.date;h.time=d.time;h.interface=cg[Number(a.v_r[0])];h.operation=dg[Number(a.v_r[1])];d=Number(f.shift());h.status=w.PROXY_S_OK==d?"S_OK":w.PROXY_E_FAIL==
d?"E_FAIL":w.PROXY_E_INVALIDARG==d?"E_INVALIDARG":w.PROXY_S_NODATA==d?"S_NODATA":w.PROXY_S_MOREDATA==d?"S_MOREDATA":w.PROXY_S_INACTIVE_NEED_NOTIFY==d?"S_INACTIVE_NEED_NOTIFY":w.PROXY_S_NEED_NOTIFY==d?"S_NEED_NOTIFY":w.PROXY_S_NEEDNOT_NOTIFY==d?"S_NEEDNOT_NOTIFY":w.PROXY_S_OK_PWD_WILL_EXPIRE==d?"S_OK_PWD_WILL_EXPIRE":w.PROXY_S_OK_NEED_PASWD_CHANGE==d?"S_OK_NEED_PASWD_CHANGE":w.PROXY_E_UNKNOWNTAG==d?"E_UNKNOWNTAG":w.PROXY_E_UNKNOWNGROUP==d?"E_UNKNOWNGROUP":w.PROXY_E_UNKNOWNTREND==d?"E_UNKNOWNTREND":
w.PROXY_E_UNKNOWNALARM==d?"E_UNKNOWNALARM":w.PROXY_E_INACTIVETAG==d?"E_INACTIVETAG":w.PROXY_E_INACTIVEGROUP==d?"E_INACTIVEGROUP":w.PROXY_E_INACTIVEALARM==d?"E_INACTIVEALARM":w.PROXY_E_READ_FORBIDDEN==d?"E_READ_FORBIDDEN":w.PROXY_E_WRITE_FORBIDDEN==d?"E_WRITE_FORBIDDEN":w.PROXY_E_BORDERS_EXCEEDED==d?"E_BORDERS_EXCEEDED":w.PROXY_E_NOT_BINDED_TO_PROTOCOL==d?"E_NOT_BINDED_TO_PROTOCOL":w.PROXY_E_NOT_BINDED_TO_TAG==d?"E_NOT_BINDED_TO_TAG":w.PROXY_METHOD_NOT_SUPPORTED==d?"METHOD_NOT_SUPPORTED":w.PROXY_E_NONEXISTING_SUBTYPE==
d?"E_NONEXISTING_SUBTYPE":w.PROXY_E_NONEXISTING_TYPE==d?"E_NONEXISTING_TYPE":w.PROXY_E_UNKNOWNARCHIVE==d?"E_UNKNOWNARCHIVE":w.PROXY_E_NO_OBJECTS_FOUND==d?"E_NO_OBJECTS_FOUND":w.PROXY_E_CONFIGMODE_REQUIRED==d?"E_CONFIGMODE_REQUIRED":w.PROXY_E_COULD_NOT_START==d?"E_COULD_NOT_START":w.PROXY_E_COULD_NOT_STOP==d?"E_COULD_NOT_STOP":w.PROXY_E_COULD_NOT_RELOAD_FROM_FILE==d?"E_COULD_NOT_RELOAD_FROM_FILE":w.PROXY_E_COULD_NOT_RESET_WARM==d?"E_COULD_NOT_RESET_WARM":w.PROXY_E_COULD_NOT_RESET_COLD==d?"E_COULD_NOT_RESET_COLD":
w.PROXY_E_COULD_NOT_RESET_HARD==d?"E_COULD_NOT_RESET_HARD":w.PROXY_E_MODE_SWITCH_ALREADY_UNDERWAY==d?"E_MODE_SWITCH_ALREADY_UNDERWAY":w.PROXY_E_ALREADYINOPERATINGMODE==d?"E_ALREADYINOPERATINGMODE":w.PROXY_E_ALREADYINCONFIGMODE==d?"E_ALREADYINCONFIGMODE":w.PROXY_E_FILENOTEXIST==d?"E_FILENOTEXIST":w.PROXY_E_FILEOPENFAIL==d?"E_FILEOPENFAIL":w.PROXY_E_FILEREADFAIL==d?"E_FILEREADFAIL":w.PROXY_E_PATHCREATEFAIL==d?"E_PATHCREATEFAIL":w.PROXY_E_FILECREATEFAIL==d?"E_FILECREATEFAIL":w.PROXY_E_FILEWRITEFAIL==
d?"E_FILEWRITEFAIL":w.PROXY_E_PROPERTYMAP_FILE_NOT_FOUND==d?"E_PROPERTYMAP_FILE_NOT_FOUND":w.PROXY_E_PROPERTY_NOT_MAPPED==d?"E_PROPERTY_NOT_MAPPED":w.PROXY_E_RESOURCE_LOCATOR_NOT_FOUND==d?"E_RESOURCE_LOCATOR_NOT_FOUND":w.PROXY_E_INVALID_PROPERTY==d?"E_INVALID_PROPERTY":w.PROXY_E_UNKNOWN_GROUP_TYPE==d?"E_UNKNOWN_GROUP_TYPE":w.PROXY_E_CONFIG_FILE_NOT_FOUND==d?"E_CONFIG_FILE_NOT_FOUND":w.PROXY_E_ALREADYEXISTS==d?"E_ALREADYEXISTS":w.PROXY_E_INVALID_RESOURCE_LOCATOR==d?"E_INVALID_RESOURCE_LOCATOR":w.PROXY_E_NO_PROPERTY_FOUND==
d?"E_NO_PROPERTY_FOUND":w.PROXY_E_PARAMETER_DOES_NOT_EXIST==d?"E_PARAMETER_DOES_NOT_EXIST":w.PROXY_E_MODULE_NOT_PRESENT_FOR_THIS_PARAMETER==d?"E_MODULE_NOT_PRESENT_FOR_THIS_PARAMETER":w.PROXY_E_REQUIRE_DEINIT==d?"E_REQUIRE_DEINIT":w.PROXY_E_UNAUTHORIZED_USER==d?"E_UNAUTHORIZED_USER":w.PROXY_E_FORBIDDEN==d?"E_FORBIDDEN":w.PROXY_E_PROXY_NOT_INITED==d?"E_PROXY_NOT_INITED":w.PROXY_E_UNKNOWNLEASEID==d?"E_UNKNOWNLEASEI":w.PROXY_E_INACTIVETREND==d?"E_INACTIVETREND":w.PROXY_E_COMM_BUSY==d?"E_COMM_BUSY":w.PROXY_E_NO_SESSION_EXIST==
d?"E_NO_SESSION_EXIST":w.PROXY_E_PASS_DONT_MATCH==d?"E_PASS_DONT_MATCH":w.PROXY_E_USER_ALREADY_EXIST==d?"E_USER_ALREADY_EXIST":w.PROXY_E_NO_GROUP_SPECIFIED==d?"E_NO_GROUP_SPECIFIED":w.PROXY_E_GROUP_DONT_EXIST==d?"E_GROUP_DONT_EXIST":w.PROXY_E_USER_DONT_EXIST==d?"E_USER_DONT_EXIST":w.PROXY_E_ALARM_NOTENABLED==d?"E_ALARM_NOTENABLED":w.PROXY_E_UNKNOWN_SUBSCRIPTION==d?"E_UNKNOWN_SUBSCRIPTION":w.PROXY_E_SESSION_EXPIRED==d?"E_SESSION_EXPIRED":w.PROXY_E_SESSION_ALREADY_EXIST==d?"E_SESSION_ALREADY_EXIS":
w.PROXY_E_LOGIN_FAIL==d?"E_LOGIN_FAIL":w.PROXY_E_RE_LOGIN_ATTEMPT==d?"E_RE_LOGIN_ATTEMPT":w.PROXY_E_NEED_LOGIN==d?"E_NEED_LOGIN":w.PROXY_E_FTP_READ_FORBIDDEN==d?"E_FTP_READ_FORBIDDEN":w.PROXY_E_FTP_WRITE_FORBIDDEN==d?"E_FTP_WRITE_FORBIDDEN":w.PROXY_E_SIMILAR_PREV_PSWD==d?"E_SIMILAR_PREV_PSWD":w.PROXY_E_PASSWORD_TOO_SHORT==d?"E_PASSWORD_TOO_SHORT":w.PROXY_E_MUST_CONTAIN_NUMBERS==d?"E_MUST_CONTAIN_NUMBERS":w.PROXY_E_MUST_CONTAIN_SPECIAL_CHAR==d?"E_MUST_CONTAIN_SPECIAL_CHAR":w.PROXY_E_CHANGE_PASSWORD==
d?"E_CHANGE_PASSWORD":w.PROXY_E_ACCES_DENIED==d?"E_ACCES_DENIED":w.PROXY_E_ILLEGAL_FORMAT==d?"E_ILLEGAL_FORMAT":w.PROXY_E_NOT_ALLOWED==d?"E_NOT_ALLOWED":w.PROXY_E_PASSWORD_EXPIRED==d?"E_PASSWORD_EXPIRED":"E_FAIL";h.userName=f.shift();h.information=f.join(";")}else h.recordId=b.getTitleValue("recordID"),h.interface=b.getTitleValue("Interface"),h.operation=b.getTitleValue("Operation"),h.status=b.getTitleValue("Status"),h.userName=b.getTitleValue("UserName"),h.information=b.getTitleValue("Information"),
h.formattedTS=b.getTitleValue("Timestamp"),h.date=b.getTitleValue("Date"),h.time=b.getTitleValue("Time");return h}p(a,c);a.prototype.getDynamicFieldData=function(b){if("Operation"===b)return this.operation;if("Interface"===b)return this.interface;if("Timestamp"===b)return this.formattedTS;if("Status"===b)return this.status;if("Date"===b)return this.date;if("Time"===b)return this.time;if("recordID"===b)return this.recordId.toString();if("UserName"===b)return this.userName;if("Information"===b)return this.information};
a.prototype.getBGColor=function(){return"trasparent"};a.prototype.setVisibility=function(b){this.visible=b};a.prototype.getVisibility=function(){return this.visible};return a}(pb),w;(function(c){c[c.PROXY_S_OK=1]="PROXY_S_OK";c[c.PROXY_S_NODATA=2]="PROXY_S_NODATA";c[c.PROXY_S_MOREDATA=3]="PROXY_S_MOREDATA";c[c.PROXY_S_INACTIVE_NEED_NOTIFY=4]="PROXY_S_INACTIVE_NEED_NOTIFY";c[c.PROXY_S_NEED_NOTIFY=5]="PROXY_S_NEED_NOTIFY";c[c.PROXY_S_NEEDNOT_NOTIFY=6]="PROXY_S_NEEDNOT_NOTIFY";c[c.PROXY_S_OK_PWD_WILL_EXPIRE=
7]="PROXY_S_OK_PWD_WILL_EXPIRE";c[c.PROXY_S_OK_NEED_PASWD_CHANGE=8]="PROXY_S_OK_NEED_PASWD_CHANGE";c[c.PROXY_E_FAIL=-1]="PROXY_E_FAIL";c[c.PROXY_E_INVALIDARG=-2]="PROXY_E_INVALIDARG";c[c.PROXY_E_UNKNOWNTAG=-3]="PROXY_E_UNKNOWNTAG";c[c.PROXY_E_UNKNOWNGROUP=-4]="PROXY_E_UNKNOWNGROUP";c[c.PROXY_E_UNKNOWNTREND=-5]="PROXY_E_UNKNOWNTREND";c[c.PROXY_E_UNKNOWNALARM=-6]="PROXY_E_UNKNOWNALARM";c[c.PROXY_E_INACTIVETAG=-7]="PROXY_E_INACTIVETAG";c[c.PROXY_E_INACTIVEGROUP=-8]="PROXY_E_INACTIVEGROUP";c[c.PROXY_E_INACTIVEALARM=
-9]="PROXY_E_INACTIVEALARM";c[c.PROXY_E_READ_FORBIDDEN=-10]="PROXY_E_READ_FORBIDDEN";c[c.PROXY_E_WRITE_FORBIDDEN=-11]="PROXY_E_WRITE_FORBIDDEN";c[c.PROXY_E_BORDERS_EXCEEDED=-12]="PROXY_E_BORDERS_EXCEEDED";c[c.PROXY_E_NOT_BINDED_TO_PROTOCOL=-13]="PROXY_E_NOT_BINDED_TO_PROTOCOL";c[c.PROXY_E_NOT_BINDED_TO_TAG=-14]="PROXY_E_NOT_BINDED_TO_TAG";c[c.PROXY_METHOD_NOT_SUPPORTED=15]="PROXY_METHOD_NOT_SUPPORTED";c[c.PROXY_E_NONEXISTING_SUBTYPE=-16]="PROXY_E_NONEXISTING_SUBTYPE";c[c.PROXY_E_NONEXISTING_TYPE=
-17]="PROXY_E_NONEXISTING_TYPE";c[c.PROXY_E_UNKNOWNARCHIVE=-18]="PROXY_E_UNKNOWNARCHIVE";c[c.PROXY_E_NO_OBJECTS_FOUND=-19]="PROXY_E_NO_OBJECTS_FOUND";c[c.PROXY_E_CONFIGMODE_REQUIRED=-20]="PROXY_E_CONFIGMODE_REQUIRED";c[c.PROXY_E_COULD_NOT_START=-21]="PROXY_E_COULD_NOT_START";c[c.PROXY_E_COULD_NOT_STOP=-22]="PROXY_E_COULD_NOT_STOP";c[c.PROXY_E_COULD_NOT_RELOAD_FROM_FILE=-23]="PROXY_E_COULD_NOT_RELOAD_FROM_FILE";c[c.PROXY_E_COULD_NOT_RESET_WARM=-24]="PROXY_E_COULD_NOT_RESET_WARM";c[c.PROXY_E_COULD_NOT_RESET_COLD=
-25]="PROXY_E_COULD_NOT_RESET_COLD";c[c.PROXY_E_COULD_NOT_RESET_HARD=-26]="PROXY_E_COULD_NOT_RESET_HARD";c[c.PROXY_E_MODE_SWITCH_ALREADY_UNDERWAY=-27]="PROXY_E_MODE_SWITCH_ALREADY_UNDERWAY";c[c.PROXY_E_ALREADYINOPERATINGMODE=-28]="PROXY_E_ALREADYINOPERATINGMODE";c[c.PROXY_E_ALREADYINCONFIGMODE=-29]="PROXY_E_ALREADYINCONFIGMODE";c[c.PROXY_E_FILENOTEXIST=-30]="PROXY_E_FILENOTEXIST";c[c.PROXY_E_FILEOPENFAIL=-31]="PROXY_E_FILEOPENFAIL";c[c.PROXY_E_FILEREADFAIL=-32]="PROXY_E_FILEREADFAIL";c[c.PROXY_E_PATHCREATEFAIL=
-33]="PROXY_E_PATHCREATEFAIL";c[c.PROXY_E_FILECREATEFAIL=-34]="PROXY_E_FILECREATEFAIL";c[c.PROXY_E_FILEWRITEFAIL=-35]="PROXY_E_FILEWRITEFAIL";c[c.PROXY_E_PROPERTYMAP_FILE_NOT_FOUND=-36]="PROXY_E_PROPERTYMAP_FILE_NOT_FOUND";c[c.PROXY_E_PROPERTY_NOT_MAPPED=-37]="PROXY_E_PROPERTY_NOT_MAPPED";c[c.PROXY_E_RESOURCE_LOCATOR_NOT_FOUND=-38]="PROXY_E_RESOURCE_LOCATOR_NOT_FOUND";c[c.PROXY_E_INVALID_PROPERTY=-39]="PROXY_E_INVALID_PROPERTY";c[c.PROXY_E_UNKNOWN_GROUP_TYPE=-40]="PROXY_E_UNKNOWN_GROUP_TYPE";c[c.PROXY_E_CONFIG_FILE_NOT_FOUND=
-41]="PROXY_E_CONFIG_FILE_NOT_FOUND";c[c.PROXY_E_ALREADYEXISTS=-42]="PROXY_E_ALREADYEXISTS";c[c.PROXY_E_INVALID_RESOURCE_LOCATOR=-43]="PROXY_E_INVALID_RESOURCE_LOCATOR";c[c.PROXY_E_NO_PROPERTY_FOUND=-44]="PROXY_E_NO_PROPERTY_FOUND";c[c.PROXY_E_PARAMETER_DOES_NOT_EXIST=-45]="PROXY_E_PARAMETER_DOES_NOT_EXIST";c[c.PROXY_E_MODULE_NOT_PRESENT_FOR_THIS_PARAMETER=-46]="PROXY_E_MODULE_NOT_PRESENT_FOR_THIS_PARAMETER";c[c.PROXY_E_REQUIRE_DEINIT=-47]="PROXY_E_REQUIRE_DEINIT";c[c.PROXY_E_UNAUTHORIZED_USER=-48]=
"PROXY_E_UNAUTHORIZED_USER";c[c.PROXY_E_FORBIDDEN=-49]="PROXY_E_FORBIDDEN";c[c.PROXY_E_PROXY_NOT_INITED=-50]="PROXY_E_PROXY_NOT_INITED";c[c.PROXY_E_UNKNOWNLEASEID=-51]="PROXY_E_UNKNOWNLEASEID";c[c.PROXY_E_INACTIVETREND=-52]="PROXY_E_INACTIVETREND";c[c.PROXY_E_COMM_BUSY=-53]="PROXY_E_COMM_BUSY";c[c.PROXY_E_UNKNOWN_SUBSCRIPTION=-54]="PROXY_E_UNKNOWN_SUBSCRIPTION";c[c.PROXY_E_ALARM_NOTENABLED=-55]="PROXY_E_ALARM_NOTENABLED";c[c.PROXY_E_USER_DONT_EXIST=-56]="PROXY_E_USER_DONT_EXIST";c[c.PROXY_E_GROUP_DONT_EXIST=
-57]="PROXY_E_GROUP_DONT_EXIST";c[c.PROXY_E_NO_GROUP_SPECIFIED=-58]="PROXY_E_NO_GROUP_SPECIFIED";c[c.PROXY_E_USER_ALREADY_EXIST=-59]="PROXY_E_USER_ALREADY_EXIST";c[c.PROXY_E_PASS_DONT_MATCH=-60]="PROXY_E_PASS_DONT_MATCH";c[c.PROXY_E_NO_SESSION_EXIST=-61]="PROXY_E_NO_SESSION_EXIST";c[c.PROXY_E_SESSION_EXPIRED=-62]="PROXY_E_SESSION_EXPIRED";c[c.PROXY_E_SESSION_ALREADY_EXIST=-63]="PROXY_E_SESSION_ALREADY_EXIST";c[c.PROXY_E_LOGIN_FAIL=-64]="PROXY_E_LOGIN_FAIL";c[c.PROXY_E_RE_LOGIN_ATTEMPT=-65]="PROXY_E_RE_LOGIN_ATTEMPT";
c[c.PROXY_E_NEED_LOGIN=-66]="PROXY_E_NEED_LOGIN";c[c.PROXY_E_FTP_READ_FORBIDDEN=-67]="PROXY_E_FTP_READ_FORBIDDEN";c[c.PROXY_E_FTP_WRITE_FORBIDDEN=-68]="PROXY_E_FTP_WRITE_FORBIDDEN";c[c.PROXY_E_NOT_ALLOWED=-69]="PROXY_E_NOT_ALLOWED";c[c.PROXY_E_ILLEGAL_FORMAT=-70]="PROXY_E_ILLEGAL_FORMAT";c[c.PROXY_E_ACCES_DENIED=-71]="PROXY_E_ACCES_DENIED";c[c.PROXY_E_CHANGE_PASSWORD=-72]="PROXY_E_CHANGE_PASSWORD";c[c.PROXY_E_MUST_CONTAIN_SPECIAL_CHAR=-73]="PROXY_E_MUST_CONTAIN_SPECIAL_CHAR";c[c.PROXY_E_MUST_CONTAIN_NUMBERS=
-74]="PROXY_E_MUST_CONTAIN_NUMBERS";c[c.PROXY_E_PASSWORD_TOO_SHORT=-75]="PROXY_E_PASSWORD_TOO_SHORT";c[c.PROXY_E_SIMILAR_PREV_PSWD=-76]="PROXY_E_SIMILAR_PREV_PSWD";c[c.PROXY_E_PASSWORD_EXPIRED=-77]="PROXY_E_PASSWORD_EXPIRED";c[c.PROXY_E_TOO_MANY_USERS=-78]="PROXY_E_TOO_MANY_USERS";c[c.PROXY_E_DEBUGGER_ACTIVE=-79]="PROXY_E_DEBUGGER_ACTIVE";c[c.PROXY_E_OPERATION_TIMEOUTED=-80]="PROXY_E_OPERATION_TIMEOUTED";c[c.PROXY_E_COULD_NOT_CONNECT=-82]="PROXY_E_COULD_NOT_CONNECT";c[c.PROXY_E_UNIMPLEMENTED=-83]=
"PROXY_E_UNIMPLEMENTED";c[c.PROXY_E_MUST_CONTAIN_NUMBERS_AND_SP_CHAR=-84]="PROXY_E_MUST_CONTAIN_NUMBERS_AND_SP_CHAR";c[c.PROXY_E_USER_MADE_INACTIVE=-85]="PROXY_E_USER_MADE_INACTIVE"})(w||(w={}));var jc=function(){function c(a){var b;this.getTableDataSource=function(b){var a;return $.ajax({type:"GET",dataType:"json",url:this.webProjectUrl+"/datasources/"+b,headers:{"X-CSRF-TOKEN":null===(a=window.localStorage)||void 0===a?void 0:a.getItem("csrf")}})};this.configuration={};this.defConf=null;this.projectPath=
"";this.loginStatus=!1;this.conf={exception:{ipad1:!1},ssemode:0};this.url=window.location.protocol+"//"+window.location.host;this.pathName=window.location.pathname;this.projectName=a.projectName;var c=-1,c=this.pathName.indexOf("/web/web/pages");-1==c&&(c=this.pathName.indexOf("/web/web/umtemplates"));-1==c&&(c=this.pathName.indexOf("/web/web/_"));this.endpoint="";-1<c&&(c=this.pathName.substring(0,c).split("/"),this.endpoint=c.slice(0,c.length-1).join("/"),this.url+=this.endpoint);for(var h in a)this[h]=
a[h];Jc({"X-CSRF-TOKEN":null===(b=window.localStorage)||void 0===b?void 0:b.getItem("csrf")})}c.prototype.loadLoginUI=function(a,b){location.href=this.url+"/index.html"+(a?"?denyDefUser=true":"?denyDefUser=false")+(b?"&forceLogin=true":"&forceLogin=false")};c.prototype.loadIndex=function(){location.href=this.url+"/index.html"};c.prototype.getProjectInformation=function(){var a=this;return-1!=this[this.active].status?this.getProperty("projectRelativePath",!1).then(function(b){var c=b.getMessageStatus().getValue();
c==y.status.S_OK?(a.projectPath=b.getValue().substring(10),a.webProjectUrl=a.url+"/"+a.projectPath+"/web/web",a.loginStatus=!0):c==y.status.E_PROPERTY_NOT_MAPPED&&(a.webProjectUrl=a.url+"/web",a.loginStatus=!0)},function(b){b.getMessageStatus().getValue()==y.status.E_NEED_LOGIN&&(location.href=a.url+a.getLoginRoute())}):Promise.resolve(void 0)};c.prototype.getOptions=function(){return this.conf};c.prototype.setUrl=function(a){this.url=a};c.prototype.isLogged=function(){return this.loginStatus};c.prototype.getProperty=
function(a,b){return x({url:this.url+"/cgi/getProperties",data:"n=1&it1="+a,async:!b,cache:!1}).then(function(b){var a=new ra;b=b.split("\t");var c=b[1].trim();return"S_OK"==c?a.setState(b[0],b[2],c):a.setState(b[0],null,c)},function(b){var a=new ra;return b.responseText?a.setState(null,null,b.responseText.trim().replace("#","")):a.setState(null,null,"E_TIMEOUT")})};c.prototype.activateTag=function(a,b,c){return x({type:"POST",url:this.url+"/cgi/"+(b?"":"de")+"activateTags",data:"n=1&t1="+a,async:c})};
c.prototype.activateTagSync=function(a,b){return ca({type:"GET",url:this.url+"/cgi/"+(b?"":"de")+"activateTags",data:"n=1&t1="+a,cache:!1})};c.prototype.requestConf=function(){this.defConf=x({type:"GET",url:this.webProjectUrl+"/config/conf.json",cache:!1}).then(function(a){return a?JSON.parse(a):{}})};c.prototype.getConf=function(){return this.defConf};c.prototype.getAlarmConf=function(){return x({type:"GET",url:this.webProjectUrl+"/config/alarms.json",cache:!1}).then(function(a){return null!=a?JSON.parse(a):
{}},function(){return{}})};c.prototype._getConf=function(a){return x({type:"GET",url:this.webProjectUrl+"/config/"+a,cache:!1}).then(function(b){return b?JSON.parse(b):{}})};c.prototype.getPropsMap=function(){return this._getConf("propsMap.json")};c.prototype.getGroupsConf=function(){return this._getConf("groups.json")};c.prototype.getTagsConf=function(){return this._getConf("tags.json")};c.prototype.getTrendsConf=function(){return this._getConf("trends.json")};c.prototype.getRecipesConf=function(){return this._getConf("recipes.json")};
c.prototype.getSchedulesConf=function(){return this._getConf("schedules.json")};c.prototype.readTags=function(a,b){for(var c="",h=a.length,d=0;d<h;d++)c+="&t"+(d+1)+"="+a[d];var c="n="+h+c+"&nocache=1",f=this,g=t.getModule("Tag");return this.activateTags(a,b).then(function(a){var d;if(0<=a.indexOf("S_OK"))return $.ajax({type:"POST",dataType:"json",url:f.url+"/cgi/readTags.json",data:c,async:!b,headers:{"X-CSRF-TOKEN":null===(d=window.localStorage)||void 0===d?void 0:d.getItem("csrf")}})}).then(function(b){var a=
[];if(null!=b)for(var c=0;c<b.tgs.length;c++){var e=b.tgs[c];a.push((new g).setState(e.name,-1,e.value,e.code,e.quality))}return a}).catch(function(b){return[]})};c.prototype.activateTags=function(a,b){return this._activateTags(a,!0,b)};c.prototype.deactivateTags=function(a,b){return this._activateTags(a,!1,b)};c.prototype._activateTags=function(a,b,c){for(var h="",d=a.length,f=0;f<d;f++)h+="&t"+(f+1)+"="+a[f];return x({type:"POST",url:this.url+"/cgi/"+(b?"":"de")+"activateTags",data:"n="+d+h,async:!c})};
c.prototype.readTag=function(a){return this._readTagsJsonAsynch(a.name,a.index)};c.prototype.readTagSync=function(a){return this._readTagsJsonSync(a.name,a.index)};c.prototype._readTagsJsonSync=function(a,b){var c=this.url+"/cgi/readTags.json",h="returnType=true&returnTS=true&n=1&t1="+encodeURIComponent(a)+"."+b+"&nocache=1",d=new H,f=this.activateTagSync(a,!0);200<=f.status&&400>f.status?(f=f.data,0<=f.indexOf("S_OK")?(c=ca({url:c,data:h}),200<=c.status&&400>c.status?(c=c.data,null!=c?(c=JSON.parse(c).tgs[0],
d.setState(c.quality,c.value,c.type,c.code,c.ts),this.activateTag(a,!1,!0)):d.setMessageCode(y.status.E_FAIL)):d.setMessageCode(y.status.E_TIMEOUT)):0<=f.indexOf("E_UNKNOWNTAG")?d.setMessageCode(y.status.E_UNKNOWNTAG):d.setMessageCode(y.status.E_FAIL)):d.setMessageCode(y.status.E_TIMEOUT);return d};c.prototype._readTagsJsonAsynch=function(a,b){var c=this.url+"/cgi/readTags.json",h="returnType=true&returnTS=true&n=1&t1="+encodeURIComponent(a)+"."+b+"&nocache=1",d=this;return this.activateTag(a,!0,
!0).then(function(b){if(0<=b.indexOf("S_OK"))return $.getJSON(c,h);if(0<=b.indexOf("E_UNKNOWNTAG")){b=b.split("\t");var a=new y("E_UNKNOWNTAG");g.showErrorMessage("ServerInterface","ActivateTag",a.toString()+": "+b[0])}return null}).then(function(b){var c=new H;null!=b&&(b=b.tgs[0],c.setState(b.quality,b.value,b.type,b.code,b.ts),d.activateTag(a,!1,!0));return c}).catch(function(){var b=new H;b.setMessageCode(y.status.E_TIMEOUT);return b})};c.prototype.writeTag=function(a,b,c,h){return h?this._writeTagSync(a,
b,c):this._writeTagAsync(a,b,c)};c.prototype._writeTagAsync=function(a,b,c){a="n=1&t1="+encodeURIComponent(a.name)+"."+a.index+"&v1="+encodeURIComponent(b)+"&nocache=1";return x({type:"POST",url:this.url+"/cgi/writeTags.json",data:a,timeout:3E4,async:!0}).then(function(b){if(null!=b){var a=JSON.parse(b);c.setState(a.tgs[0])}return a})};c.prototype._writeTagSync=function(a,b,c){c=this.url+"/cgi/writeTags.json";b="n=1&t1="+encodeURIComponent(a.name)+"."+a.index+"&v1="+encodeURIComponent(b)+"&nocache=1";
a=new H;c=ca({type:"POST",url:c,data:b,timeout:3E4});200<=c.status&&400>c.status?(c=c.data,null!=c?(c=JSON.parse(c).tgs[0],a.setState(c.quality,c.value,c.type,c.code,c.ts)):a.setMessageCode(y.status.E_FAIL)):a.setMessageCode(y.status.E_TIMEOUT);return a};c.prototype.readGroup=function(a,b,c){return c?this.readGroupJsonSync(a,b):this.readGroupJsonAsync(a,b)};c.prototype.readGroupJsonAsync=function(a,b){return x({type:"GET",url:this.url+"/cgi/readGroups.json",data:"n=1&gr1="+encodeURIComponent(a),cache:!1,
timeout:12E3}).then(function(a){return a?(a=JSON.parse(a).gs[0],b.setState(a.g.name,a.g.code,a.tgs),b):{}})};c.prototype.readGroupJsonSync=function(a,b){var c;return $.ajax({type:"GET",dataType:"JSON",url:this.url+"/cgi/readGroups.json",data:"n=1&gr1="+encodeURIComponent(a),cache:!1,timeout:12E3,async:!1,headers:{"X-CSRF-TOKEN":null===(c=window.localStorage)||void 0===c?void 0:c.getItem("csrf")}}).then(function(a){if(a){a=JSON.parse(a);var c=a.gs[0];b.setState(c.g.name,c.g.code,c.tgs);return a}return{}})};
c.prototype.readGroups=function(a,b,c){return c?this.readGroupsSync(a,b):this.readGroupsAsync(a,b)};c.prototype.readGroupsSync=function(a,b){for(var c=this,h,d=a.length,f="",g=1;g<=d;g++)f+="gr"+g+"="+a[g-1],g!=d&&(f+="&");return $.ajax({type:"GET",dataType:"JSON",url:this.url+"/cgi/readGroups.json",data:"n="+d+"&"+encodeURIComponent(f),cache:!1,timeout:12E3,async:!1,headers:{"X-CSRF-TOKEN":null===(h=window.localStorage)||void 0===h?void 0:h.getItem("csrf")}}).then(function(a){a&&c.consumeReadGroups(a,
b);return b})};c.prototype.readGroupsAsync=function(a,b){for(var c=this,h=a.length,d="",f=1;f<=h;f++)d+="gr"+f+"="+a[f-1],f!=h&&(d+="&");return x({type:"GET",url:this.url+"/cgi/readGroups.json",data:"n="+h+"&"+encodeURIComponent(d),cache:!1,async:!0,timeout:12E3}).then(function(a){a&&(a=JSON.parse(a),c.consumeReadGroups(a,b));return b})};c.prototype.consumeReadGroups=function(a,b){for(var c=t.getModule("Tag"),h=0;h<a.gs.length;h++){var d=a.gs[h],f=[];if(d.tgs)for(var g=d.tgs.length,l=0;l<g;l++){var m=
d.tgs[l];f.push((new c).setState(m.name,-1,m.value,m.code,m.quality))}b[h].setState(d.g.name,d.g.code,f)}};c.prototype.activateGroup=function(a,b,c){return c?this._activateGroupsJsonSync([a],[b],!0):this._activateGroupsJsonAsync([a],[b],!0)};c.prototype.deactivateGroup=function(a,b,c){return c?this._activateGroupsJsonSync([a],[b],!1):this._activateGroupsJsonAsync([a],[b],!1)};c.prototype.activateGroups=function(a,b,c){return c?this._activateGroupsJsonSync(a,b,!0):this._activateGroupsJsonAsync(a,b,
!0)};c.prototype.deactivateGroups=function(a,b,c){return c?this._activateGroupsJsonSync(a,b,!1):this._activateGroupsJsonAsync(a,b,!1)};c.prototype._activateGroupsJsonAsync=function(a,b,c){for(var h=this,d=this.url,f=a.length,g="",l=1;l<=f;l++)g+="gr"+l+"="+a[l-1],l!=f&&(g+="&");return x({type:"GET",url:c?d+"/cgi/activateGroups.json":d+"/cgi/deactivateGroups.json",data:"n="+f+"&"+encodeURIComponent(g),async:!0}).then(function(a){a&&(a=JSON.parse(a),h.consumeActivateGroupResponse(a,c,b));return b})};
c.prototype._activateGroupsJsonSync=function(a,b,c){for(var h=this,d,f=this.url,g=a.length,l="",m=1;m<=g;m++)l+="gr"+m+"="+a[m-1],m!=g&&(l+="&");return $.ajax({type:"GET",dataType:"JSON",url:c?f+"/cgi/activateGroups.json":f+"/cgi/deactivateGroups.json",data:"n="+g+"&"+encodeURIComponent(l),cache:!1,timeout:12E3,async:!1,headers:{"X-CSRF-TOKEN":null===(d=window.localStorage)||void 0===d?void 0:d.getItem("csrf")}}).then(function(a){h.consumeActivateGroupResponse(a,c,b);return b})};c.prototype.consumeActivateGroupResponse=
function(a,b,c){if(a)for(var h=0;h<a.gs.length;h++){var d=a.gs[h];b&&c[h].setState(d.name,d.code,null)}};c.prototype.getDLSSettings=function(a){return x({type:"GET",url:this.url+"/cgi/getDLSSettings",async:!a}).then(function(b){b=b.split("\n");var a={};"#S_OK"==b[0]?(a.status=b[0],a.stdoff=parseFloat(b[1]),a.stdw=parseFloat(b[2]),a.stdd=parseFloat(b[3]),a.stdm=parseFloat(b[4]),a.stdhh=parseFloat(b[5]),a.stdmm=parseFloat(b[6]),a.dlsoff=parseFloat(b[7]),a.dlsw=parseFloat(b[8]),a.dlsd=parseFloat(b[9]),
a.dlsm=parseFloat(b[10]),a.dlshh=parseFloat(b[11]),a.dlsmm=parseFloat(b[12]),a.mode=parseFloat(b[13])):a.status=b[0];return a})};c.prototype.getLocalTime=function(a){return x({type:"GET",url:this.url+"/cgi/getLocalTime",async:!a}).then(function(b){b=b.split("\n");var a={};"#S_OK"==b[0]?(a.status=b[0],a.time=b[1]):a.status=b[0];return a})};c.prototype.setLocalTime=function(a,b,c,h,d,f,g){return x({type:"GET",url:this.url+"/cgi/setLocalTime",data:"sec="+a+"&min="+b+"&hour="+c+"&day="+h+"&month="+d+
"&year="+f,async:!g}).then(function(a){return{status:a}})};c.prototype.getTime=function(a){return x({type:"GET",url:this.url+"/cgi/getTime?nocache=1",async:!a}).then(function(a){a=a.split("\n");var c={};"#S_OK"==a[0]?(c.status=a[0],c.time=1E3*parseFloat(a[1])):c.status=a[0];return c})};c.prototype.setTime=function(a,b){return x({type:"GET",url:this.url+"/cgi/setTime",data:"time="+a,async:!b}).then(function(a){return{status:a}})};c.prototype.readAlarms=function(a,b){for(var c="",h=0,d=a.length,f=0;f<
d;f++)c+="&al"+ ++h+"="+a[f];return x({type:"POST",url:this.url+"/cgi/readAlarms",data:"n="+h+c,timeout:12E3,async:!b}).then(function(a){return a})};c.prototype.resetAlarms=function(a,b){for(var c="",h=0,d=a.length,f=0;f<d;f++)c+="&al"+ ++h+"="+a[f];return x({type:"POST",url:this.url+"/cgi/resetAlarms",data:"n="+h+c,async:!b})};c.prototype.acknowledgeAlarms=function(a,b){for(var c="",h=0,d=a.length,f=0;f<d;f++)c+="&al"+ ++h+"="+a[f];return x({type:"POST",url:this.url+"/cgi/acknowledgeAlarms",data:"n="+
h+c,async:!b})};c.prototype.enableAlarms=function(a,b,c){for(var h="",d=0,f=a.length,g=0;g<f;g++)h+="&al"+ ++d+"="+a[g];return x({type:"POST",url:this.url+"/cgi/enableAlarms",data:"n="+d+h+"&enableflag="+b,async:!c})};c.prototype.saveConfiguration=function(a){return x({type:"GET",url:this.url+"/cgi/saveConfiguration",cache:!1,async:!a})};c.prototype.readEvent=function(a,b){return this._GET(this.url+"/cgi/readEvent.json",a.toURL(),!1)};c.prototype.getLoginRoute=function(){return"/public/login.html?_="+
(new Date).getTime()};c.prototype.deleteEventArchive=function(a){return x({type:"GET",url:this.url+"/cgi/deleteEventArchive",data:"archive="+a,timeout:12E3})};c.prototype.deleteTrend=function(a,b){return this._GET(this.url+"/cgi/deleteTrendFile.json","tr="+encodeURIComponent(a),b)};c.prototype.dumpTrend=function(a,b){var c=this.url+"/cgi/dumpTrendFile.json",h="tr="+encodeURIComponent(a.n)+"&folder="+a.f+"&dformat="+a.fmt+"&dtPrefix="+a.dt+"&localTs="+a.dts;a.fnformat&&(h+="&fformat="+encodeURIComponent(a.fnformat));
a.csvfields&&(h+="&csvfields="+a.csvfields);a.csvlogs&&(h+="&csvlogs="+a.csvlogs);a.dtformat&&(h+="&dtformat="+a.dtformat);a.langcode&&(h+="&lang="+a.langcode);return this._POST(c,h,b)};c.prototype.readTrend=function(a,b,c,h,d){a="tr="+encodeURIComponent(a)+"&returnTS=true&returnRT=false&startTime="+parseInt((b/1E3).toString())+"&endTime="+parseInt((c/1E3).toString());a=h?a+("&nSamples="+h):a+"&nSamples=0";a=(d?a+("&deltaTime="+d):a+"&deltaTime=0")+"&bounds=true";var f=t.getModule("Quality");return x({type:"GET",
url:this.url+"/cgi/readTrend.json",data:a,timeout:12E3}).then(function(a){a=JSON.parse(a);var b={n:a.n,d:null};if("S_OK"==a.code||"S_MOREDATA"==a.code){var c=a.d.length;b.d=Array(c);for(var d=0;d<c;d++){var e=a.d[d],h=new f(e.q);h.isQualityBad()&&(e.v=void 0);b.d[d]=new fa(1E3*e.rts,e.v,h)}}return{s:b,c:a.code}})};c.prototype._GET=function(a,b,c){return this._request("GET",a,b,c)};c.prototype._POST=function(a,b,c){return this._request("POST",a,b,c)};c.prototype._request=function(a,b,c,h){return x({type:a,
url:b,data:c,cache:!1,timeout:12E3,async:!h}).then(function(a){return JSON.parse(a)})};c.prototype._GET_SYNC=function(a,b){var c=ca({type:"GET",url:a,data:b,cache:!1,timeout:12E3});return JSON.parse(c.data)};c.prototype.downloadRecipe=function(a,b,c){return this._GET(this.url+"/cgi/downloadRecipe.json","rc="+a+"&st="+b,c)};c.prototype.uploadRecipe=function(a,b,c){return this._GET(this.url+"/cgi/uploadRecipe.json","rc="+a+"&st="+b,c)};c.prototype.setCurrentRecipe=function(a,b,c){var h=this.url+"/cgi/setCurrRecipe.json";
a="rc="+a;null!==b&&void 0!==b&&(a+="&st="+b);return this._GET(h,a,c)};c.prototype.setRecipeSet=function(a,b,c){return this._GET(this.url+"/cgi/setRecipeSet.json","rc="+a+"&st="+b,c)};c.prototype.resetRecipe=function(a,b){return this._GET(this.url+"/cgi/resetRecipe.json","rc="+a,b)};c.prototype.getRecipeList=function(a){return this._GET(this.url+"/cgi/getRecipeList.json","",a).then(function(a){return"S_OK"==a.code?a.rc:null})};c.prototype.addRecipeDataSet=function(a,b,c,h,d){return this._GET(this.url+
"/cgi/addRecipeDataSet.json","rc="+a+"&cp="+b+"&ns="+c+"&nt="+h,d)};c.prototype.delRecipeDataSet=function(a,b,c){return this._GET(this.url+"/cgi/delRecipeDataSet.json","rc="+a+"&s="+b,c)};c.prototype.dumpRecipeData=function(a,b,c,h,d,f,g,l){var m=this.url+"/cgi/dumpRecipe.json";a="rc="+a+"&ds="+b+"&path="+encodeURIComponent(c)+"&fname="+encodeURIComponent(h)+"&dt="+f+"&ts="+g;void 0!=d&&(a+="&tname="+d);return this._GET(m,a,l)};c.prototype.restoreRecipeData=function(a,b,c,h,d,f,g,l,m){var n=this.url+
"/cgi/restoreRecipe.json";a="rc="+a+"&st="+b+"&path="+encodeURIComponent(c)+"&fname="+encodeURIComponent(h)+"&rt="+l+"&matchname="+g+"&browse="+f;void 0!=d&&(a+="&tname="+d);return this._GET(n,a,m)};c.prototype.getRecipeSetList=function(a,b){return this._GET(this.url+"/cgi/getRecipeSets.json","rc="+a,b)};c.prototype._decodeRecipe=function(a){var b;a.p&&a.p.s&&a.p.s.el?b=new ya(a.p.s.el.id,a.p.s.el.n,a.p.s.el.v):a.p&&a.p.s?b=new sa(a.p.s.id,a.p.s.n,a.p.s.v):a.p&&(b=new la(a.p.id,a.p.n,a.p.status,a.p.slist,
a.p.selset,a.p.lastset));return b};c.prototype.getRecipeParams=function(a,b,c){var h=this.url+"/cgi/getRecipeParams.json",d="";"all"==b&&(d="rc="+a+"&getid=true&getlastdwnset=true&getselset=true&getstatus=true&getsetlist=true");var f=this;return this._GET(h,d,c).then(function(a){if("S_OK"==a.code)return f._decodeRecipe(a)})};c.prototype.setRecipeParam=function(a,b,c){return this._GET(this.url+"/cgi/setRecipeParam.json","rc="+a+"&v="+b,c)};c.prototype.setRecipeSetParam=function(a,b,c,h,d){return this._GET(this.url+
"/cgi/setRecipeSetParam.json","rc="+a+"&s="+b+"&a="+c+"&v="+h,d)};c.prototype.setRecipeElemParam=function(a,b,c,h,d,f){return this._GET(this.url+"/cgi/setRecipeElemParam.json","rc="+a+"&s="+b+"&e="+c+"&a="+h+"&v="+d,f)};c.prototype._getRFlag=function(a){var b="";a=a.toLowerCase();"name"==a?b+="&getname=true":"status"==a?b+="&getstatus=true":"value"==a&&(b+="&getvalue=true");return b};c.prototype.getRecipeParam=function(a,b,c){var h=this,d=this.url+"/cgi/getRecipeParams.json",f="&getid=true"+this._getRFlag(b);
return c?(a=this._GET_SYNC(d,"rc="+a+f))&&"S_OK"==a.code?{v:this._decodeRecipe(a)[b]}:{err:a.code}:this._GET(d,"rc="+a+f,c).then(function(a){return a&&"S_OK"==a.code?{v:h._decodeRecipe(a)[b]}:{err:a.code}})};c.prototype.getRecipeSetParam=function(a,b,c,h){var d=this,f=this.url+"/cgi/getRecipeSetsParams.json",g="&getid=true"+this._getRFlag(c);return h?(a=this._GET_SYNC(f,"rc="+a+"&st="+b+g))&&"S_OK"==a.code?{v:this._decodeRecipe(a)[c]}:{err:a.code}:this._GET(f,"rc="+a+"&st="+b+g,!1).then(function(a){return a&&
"S_OK"==a.code?{v:d._decodeRecipe(a)[c]}:{err:a.code}})};c.prototype.getRecipeElemParam=function(a,b,c,h){var d=this.url+"/cgi/getRecipeSetsParams.json",f="&getid=true&getelems=true"+this._getRFlag(h);return(a=this._GET_SYNC(d,"rc="+a+"&st="+b+"&i="+c+f))&&"S_OK"==a.code?{v:this._decodeRecipe(a)[h]}:{err:a.code}};c.prototype.changePwd=function(a,b,c,h){return this._GET(this.url+"/cgi/changePassword","username="+a+"&oldpswd="+b+"&newpswd="+c,h)};c.prototype.logOut=function(){this.loginStatus=!1;return x({type:"GET",
url:this.url+"/cgi/logout",cache:!1})};c.prototype.getResource=function(a){return x({type:"GET",url:"../modules/resources/"+a,cache:!1})};c.prototype.getPrecachedPages=function(){var a=window.location.href.substring(0,window.location.href.lastIndexOf("/")+1);return x({type:"GET",url:a+"precached.html",cache:!1}).then(function(a){var c=document.createElement("div");c.innerHTML=a;return c})};c.formatTagOperationRequest=function(a){var b=Array(a.length+1);b[0]="n="+a.length;return a.reduce(function(a,
b,c){c+=1;a[c]="t"+c+"="+b.name;void 0!==b.arrayIndex&&(a[c]+="."+b.arrayIndex);b=b.params;for(var f in b)a[c]+="&"+f+c+"="+b[f];return a},b).join("&")};c.prototype.stepTags=function(a){a=c.formatTagOperationRequest(a);return x({type:"POST",url:this.url+"/cgi/stepTags.json",data:a,timeout:3E4,async:!0}).then(function(a){return null!=a?JSON.parse(a):null})};c.prototype.stepTagsSync=function(a){a=c.formatTagOperationRequest(a);a=ca({type:"POST",url:this.url+"/cgi/stepTags.json",data:a});return a.data?
JSON.parse(a.data):null};c.prototype.setBitTags=function(a){a=c.formatTagOperationRequest(a);return x({type:"POST",url:this.url+"/cgi/setBitTags.json",data:a,timeout:3E4,async:!0}).then(function(a){return null!=a?JSON.parse(a):null})};c.prototype.setBitTagsSync=function(a){a=c.formatTagOperationRequest(a);a=ca({type:"POST",url:this.url+"/cgi/setBitTags.json",data:a});return a.data?JSON.parse(a.data):null};c.prototype.resetBitTags=function(a){a=c.formatTagOperationRequest(a);return x({type:"POST",
url:this.url+"/cgi/resetBitTags.json",data:a,timeout:3E4,async:!0}).then(function(a){return null!=a?JSON.parse(a):null})};c.prototype.resetBitTagsSync=function(a){a=c.formatTagOperationRequest(a);a=ca({type:"POST",url:this.url+"/cgi/resetBitTags.json",data:a});return a.data?JSON.parse(a.data):null};c.prototype.toggleBitTags=function(a){a=c.formatTagOperationRequest(a);return x({type:"POST",url:this.url+"/cgi/toggleBitTags.json",data:a,timeout:3E4,async:!0}).then(function(a){return null!=a?JSON.parse(a):
null})};c.prototype.toggleBitTagsSync=function(a){a=c.formatTagOperationRequest(a);a=ca({type:"POST",url:this.url+"/cgi/toggleBitTags.json",data:a});return a.data?JSON.parse(a.data):null};c.prototype.getClientID=function(){return x({type:"GET",url:this.url+"/cgi/getClientID.json"}).then(function(a){return null!=a?JSON.parse(a):null})};c.prototype.writeMessage=function(a){var b=this.url+"/cgi/writeMessage";a="messageData="+encodeURIComponent(JSON.stringify(a));return x({type:"POST",url:b,data:a,timeout:3E4,
async:!0}).then(function(a){return a})};c.prototype.readData=function(a){var b=this.url+"/cgi/ReadData.json";a="variables="+encodeURIComponent(JSON.stringify(a));return x({type:"POST",url:b,data:a,timeout:3E4,async:!0}).then(function(a){return a})};c.prototype.readAllTimer=function(){return x({type:"GET",url:this.url+"/cgi/readalltimer.json",timeout:3E4,async:!0}).then(function(a){return JSON.parse(a)})};c.prototype.getNetworkInterfaces=function(){return x({type:"GET",url:this.url+"/cgi/SIOCTL?cmd=477",
timeout:3E4,async:!0}).then(function(a){a=a.split("\n")[1];a=atob(a);a=a.substring(a.indexOf("{"),a.lastIndexOf("}")+1);return JSON.parse(a)})};c.prototype.subscribeNotification=function(a,b){return null};c.prototype.unsubscribeNotification=function(a,b){};c.prototype.subscribeAlarms=function(a,b){return null};c.prototype.subscribeEvent=function(a,b){return null};c.prototype.unsubscribeEvent=function(a){};c.prototype.subscribeGroups=function(a,b){return null};c.prototype.unsubscribeGroups=function(a){};
c.prototype.subscribeTags=function(a,b){return null};c.prototype.unsubscribeTags=function(a){};c.prototype.subscribeRecipe=function(a,b){return null};c.prototype.subscribeRecipeSetList=function(a,b){return null};c.prototype.subscribeRecipeSet=function(a,b,c){return null};c.prototype.subscribeRecipeSetElem=function(a,b,c,h){return null};c.prototype.isSessionAlive=function(){return null};c.prototype.getConnectionStatus=function(){return null};c.prototype.onConnectionReady=function(a){};c.prototype.enableOption=
function(a){};c.prototype.subscribeTrend=function(a,b){return null};c.prototype.unsubscribeTrend=function(a,b){return null};c.prototype.readSubTrends=function(a,b,c,h,d,f,g,l){};c.prototype.updateTrendSubscription=function(a){};c.prototype.unsubscribeRecipeSetList=function(a){};c.prototype.unsubscribeRecipe=function(a){};c.prototype.unsubscribeRecipeSet=function(a,b){};c.prototype.unsubscribeRecipeSetElem=function(a,b,c){};c.prototype.setRecipeNotificationRate=function(a){};c.prototype.subscribeToMessageEvent=
function(a){return!1};c.prototype.unsubscribeFromMessageEvent=function(){};return c}(),ob;(function(c){c[c.ASCENDING=0]="ASCENDING";c[c.DESCENDING=1]="DESCENDING"})(ob||(ob={}));var Qd;(function(c){c[c.HEADER=0]="HEADER";c[c.BODY=1]="BODY"})(Qd||(Qd={}));var Ra=function(c){function a(a,e,h,d,f){var k=c.call(this,a.wgtId,e,h,d,f)||this;k.rawModel=[];k.dtlkList=[];k.table=null;k.proxyTable=null;k.refreshMode=!1;k.init=!1;k.hasFilter=!1;k.isTableDataSource=!0;k.initDateFormatter();"TableDataSrcWgt"===
k.getJMType()&&(k.initDateFormatter(),k.initPromiseReady(),k.initRawModel());g.getEventMgr()&&(k.activateHandler=function(){c.prototype.executeActivationCallback.call(k)&&(k.isWgtActive=!0,k.load())},k.deactivateHandler=function(){c.prototype.executeDeactivationCallback.call(k)&&(k.isWgtActive=!1,k.unload())},c.prototype.bindEvents.call(k,{loadWgt:k.activateHandler,unloadWgt:k.deactivateHandler}));return k}p(a,c);a.prototype.load=function(){this.init=!0;this.update()};a.prototype.unload=function(){this.dtlkList=
[]};a.prototype.updateModels=function(){var a=this;if(this.init){var c=function(){for(var c in a._subscriptions)a._subscriptions[c].w.noMoreData=!1,a.executeModelUpdate(a._subscriptions[c].w,!0)};g.isTestModeActive()?c():this.waitWgtReady().then(function(){c()})}};a.prototype.initDateFormatter=function(){this.dateFormat&&(this.dateFormatter=new cb,this.dateFormatter.setFormat(this.dateFormat,{longDateFormat:this.project.getValue("longDateFormat"),shortDateFormat:this.project.getValue("shortDateFormat"),
serverOffset:this.project.getSystemPropertiesMgr().getServerOffset()}))};a.prototype.notifyUpdate=function(){this.load()};a.prototype.getFormattedTimestamp=function(a,c){this.dateFormatter.setDate(a);c&&this.dateFormatter.showMilliSeconds();var h=this.dateFormatter.formatDateTime(this.timeSpec),d=this.dateFormatter.formatDateTimeAndSplit(this.timeSpec);return{date:d[0],time:d[1],full:h}};a.prototype.getRawModel=function(){var a=this;$hmi.activeProject.getCommunticationObj().getTableDataSource(this.fileName).then(function(c){a.rawModel=
Object.freeze(c);a.resolveWgtReady(!0)},function(){g.getAction("hmiActionShowMessage").execute(null,{msg:"Error loading table raw model !"},3);a.resolveWgtReady(!0)})};a.prototype.initRawModel=function(){var a=this;!$hmi.isTestModeActive()&&this.parentWidget instanceof eb?this.parentWidget.waitWgtReady().then(function(){a.getRawModel()}):this.getRawModel()};a.prototype.formatProperty=function(a,c){var h=a.getAttribute(),d=a.tgtWgt.studioId,f=c.studioId,g="",l=d.indexOf(f);-1!=l&&(g+=d.substr(l+f.length+
1),g+=""==g?h:"."+h);return g};a.prototype.getFilterFromRawModel=function(a,c){var h=a.getTableGroup();if("Formula"===h.filterSrcType){h=h.getDatalink("filter");if(null==h||null==h.xforms)return!1;var h=h.xforms[0],d=h.getCompiledExpression(),f=[],k;for(k in h.dataLinks){var l=h.dataLinks[k],m=c[l.tag],n=m;if(void 0!==m)if(m instanceof Object)if("ml"==m._c)var p=g.activeProject.getMultiLanguageMgr().getCurrentLangCode(),n=m.mltext[p],d=d.replace(l.attr,'"'+m.mltext[p]+'"');else p=m.v.indexOf(":"),
m=m.v.substring(0,p+1)+l.attr+m.v.substring(p+1),f.push(m);else d=d.replace(new RegExp("\\"+l.attr,"g"),'"'+m+'"');else f.push(l.writeToString());a.addFilterXFormulaRow(l.attr,n)}return 0===f.length?eval(d):{_c:"dl",v:"="+d+";["+f.join(";")+"]"}}return""==h.filterColName?!0:c[h.filterColName]};a.prototype.getSortingFromRawModel=function(a,c){for(var g=a.getTableGroup().getSortingRules(),d=[],f=0;f<g.length;f++)d.push(c[g[f]._c]||"");return d};a.prototype.populateModelBody=function(a,c){for(var g=
[],d=a.getTableGroup(),f=0;f<c.length;f++){var k=c[f],l=k.rT,m=this.dtlkList[l]||[],n={};if(d.hasRowAtIndex(l)){n._t=l;n._v=[];d.rowsBgTag&&(n._bg=k[d.rowsBgTag]);n._f=this.getFilterFromRawModel(a,k);n._s=this.getSortingFromRawModel(a,k);a.incrementFilterXFormulaIndex();for(l=0;l<m.length;l++){var p=m[l].getTag();n._v.push(k[p])}g.push(n)}}return g};a.prototype.generatePropsHeader=function(a){this.dtlkList=[];var c=a.getTableGroup(),g=c.getSortedProtoWidgets();a={_h:[]};for(var d in g){a._h[d]=[];
a._s=[];for(var f in g[d]){var k=a._h[d][f]=[],l=g[d][f],m=[];l.getDataLinksByDataSrc(this,m);for(var n=0;n<m.length;n++){var p=m[n];k.push(this.formatProperty(p,l));null==this.dtlkList[d]&&(this.dtlkList[d]=[]);this.dtlkList[d].push(p)}}}d=c.getSortingRules();for(f=0;f<d.length;f++)a._s.push(d[f]);return a};a.prototype.addHeaderTemplate=function(a){if(this.hasStaticHeader){var c=a.getTableGroup();a=this.rawModel[0];var g=a.rT,d=this.dtlkList[g]||[],f={_h:!0};f._t=g;f._v=[];c.rowsBgTag&&(f._bg=a[c.rowsBgTag]);
f._f=!0;for(c=0;c<d.length;c++)g=d[c].getTag(),f._v.push(a[g]);return f}return null};a.prototype.resetModel=function(a){a.resetModel();a.appendProps(this.generatePropsHeader(a));a.appendHeader(this.addHeaderTemplate(a))};a.prototype.appendBodyFragment=function(a,c){a.appendBody(this.populateModelBody(a,c));a.setOffset(a.getOffset()+c.length);a.evaluateModel()};a.prototype.executeModelUpdate=function(a,c){c&&this.resetModel(a);var g=a.getOffset();g>=this.rawModel.length&&(a.noMoreData=!0,a.evaluateModel());
var d=this.rawModel;this.hasStaticHeader&&(d=this.rawModel.slice(1));this.isFetchEnabled&&(d=d.slice(g,g+this.fetchRows));0<d.length?this.appendBodyFragment(a,d):(a.noMoreData=!0,a.evaluateModel())};a.prototype.injectBgColor=function(a,c){a._bg=c.getBGColor()};a.prototype.injectValue=function(a,c,g){a._v.push(c.getDynamicFieldData(g))};a.prototype.getFilter=function(a,c){var h=a.getTableGroup();if("Formula"===h.filterSrcType){h=h.getDatalink("filter");if(null==h)return;var h=h.xforms[0],d=h.getCompiledExpression(),
f=[],k;for(k in h.dataLinks){var l=h.dataLinks[k],m=l.tag;if(null!==m){var n=c.getDynamicFieldData(m),m=n;if(void 0!==n)if(n instanceof Object)if("ml"==n._c)var p=g.activeProject.getMultiLanguageMgr().getCurrentLangCode(),d=d.replace(l.attr,'"'+n.mltext[p]+'"');else p=n.v.indexOf(":"),n=n.v.substring(0,p+1)+l.attr+n.v.substring(p+1),f.push(n);else d=d.replace(new RegExp("\\"+l.attr,"g"),'"'+n+'"');else f.push(l.writeToString());a.addFilterXFormulaRow(l.attr,m)}}return 0===f.length?eval(d):{_c:"dl",
v:"="+d+";["+f.join(";")+"]"}}return""==h.filterColName?!0:c.getDynamicFieldData(h.filterColName)};a.prototype.getSorting=function(a,c){for(var g=a.getTableGroup().getSortingRules(),d=[],f=0;f<g.length;f++)d.push(c.getDynamicFieldData(g[f]._c)||"");return d};a.prototype.applyFilters=function(a,c,g,d){c._f=this.getFilter(a,g)};a.prototype.applySorting=function(a,c,g){c._s=this.getSorting(a,g)};a.prototype.injectTemplateValues=function(a,c,g,d){d=this.dtlkList[d];this.injectBgColor(g,c);for(var f in d)this.injectValue(g,
c,d[f].tag),void 0===g._h&&0!=g._f&&this.applyFilters(a,g,c,d[f].tag),void 0==g._h&&this.applySorting(a,g,c)};a.prototype.addPropsToJSONModel=function(a){return this.generatePropsHeader(a)};a.prototype.addTemplateToJSONModel=function(a,c,g,d){g={_t:d,_v:[],_f:!0};0===d&&(g._h=!0);this.injectTemplateValues(a,c,g,d);return g};a.prototype.getTitleValue=function(a){var c=this.isTemplateWgt?this.parentPage.getTemplateMLTextMgr():this.parentPage.getPageMLTextMgr(),g=c.getMultiLanguagesMgr();return c.texts[this.mlTextsMap[a]][g.curLangId]};
a.prototype.setParentBounds=function(a,c,g,d,f){};a.prototype.getParentBounds=function(a){return{x:0,y:0,width:0,height:0}};a.prototype.fetchMore=function(a){this.isFetchEnabled&&this.executeModelUpdate(a.getProxyTable(),!1)};a.prototype.update=function(){this.updateModels()};a.prototype.updateLanguage=function(){this.update()};a.prototype.refresh=function(){this.update()};a.prototype.getFetchRows=function(){return this.fetchRows};a.prototype.destroy=function(){this.proxyTable=this.table=this.rawModel=
null;return c.prototype.destroy.call(this)};a.jmType="TableDataSrcWgt";return a}(l);g.fn.hmiTableDataSrcWgt=function(c,a,b,e){return new Ra(this,c,a,b,e)};g.addWidgetDefinition("hmiTableDataSrcWgt",Ra);var Rd=function(c){function a(a,e,h,d,f){a=c.call(this,a,e,h,d,f)||this;a.srv=g.activeProject.getCommunticationObj();a.auditMgr=g.activeProject.getWidget("_AuditTrailMgr",!0);a.auditBuffer=null;a.enabled=!1;a.fetchRows=0;a.isFetchEnabled=!1;a.hasFilter=!0;return a}p(a,c);a.prototype.load=function(){if(this.enabled=
this.auditMgr.isAuditTrailEnabled())this.auditBuffer=g.getWidget(this.bufferId,!0),this.auditBuffer.subscribeWgt(this,function(){}),this.dateFormat=this.auditBuffer.getValue("dateFormat"),this.auditBuffer.setInitStopTime(),this.initDateFormatter(),this.initAuditEvent(),this.init=!0,this.fetchData()};a.prototype.unload=function(){};a.prototype.initAuditEvent=function(){var a=this.auditBuffer.getEventType(),c=this.auditBuffer.getSubType(),g=this.auditBuffer.getStartTime(0===this.sortingMode),d=this.auditBuffer.getStopTime(0===
this.sortingMode),f=this.bufferId,k=this.auditBuffer.getEventBufferName();this.auditEvent=new bg(a,c,g,d,f,k)};a.prototype.applyFilters=function(a,c,g,d){var f=!0;this.filterCol1==d&&(f=(new RegExp(this.filterExp1,"i")).test(g.getDynamicFieldData(d)));f&&this.filterCol2==d&&(f=(new RegExp(this.filterExp2,"i")).test(g.getDynamicFieldData(d)));c._f=f?this.getFilter(a,g):f};a.prototype.updateTimeRange=function(){this.auditEvent.setStartTime(this.auditBuffer.getStartTime(0===this.sortingMode));this.auditEvent.setEndTime(this.auditBuffer.getStopTime(0===
this.sortingMode))};a.prototype.addHeaderTemplate=function(a){return this.hasStaticHeader?this.addTemplateToJSONModel(a,new Pd(this),!0,0):null};a.prototype.addBodyTemplates=function(a,c){for(var g=[],d=0;d<c.length;d++){var f=1<a.getTableGroup().getGridRowsNumber()?1:0;g.push(this.addTemplateToJSONModel(a,new Pd(this,c[d]),!1,f));a.incrementFilterXFormulaIndex()}return g};a.prototype.resetModel=function(a){a.resetModel();a.appendProps(this.addPropsToJSONModel(a));a.appendHeader(this.addHeaderTemplate(a))};
a.prototype.appendBodyFragment=function(a,c){var g=this.addBodyTemplates(a,c);a.appendBody(g);a.setOffset(a.getOffset()+c.length-1);a.evaluateModel()};a.prototype.executeAuditsUpdate=function(a,c){var h=this;this.updateTimeRange();this.srv.readEvent(this.auditEvent,null).then(function(d){var f=d.st;if(18!==d.t)throw"Wrong event archive";c&&h.resetModel(a);h.appendBodyFragment(a,"S_NODATA"===f?[]:d.data)}).catch(function(a){g.getAction("hmiActionShowMessage").execute(null,{msg:"Fetch audits failed: "+
a},3)})};a.prototype.fetchData=function(){if(this.init)for(var a in this._subscriptions)this.executeAuditsUpdate(this._subscriptions[a].w,!0)};a.prototype.fetchMore=function(a){};a.prototype.updateLanguage=function(){this.fetchData()};a.prototype.refresh=function(){this.fetchData()};a.prototype.updateStyle=function(a){!a.longDateFormat&&!a.shortDateFormat||"SHORT-DATE"!=this.dateFormat&&"LONG-DATE"!=this.dateFormat||(this.dateFormatter.setFormat(this.dateFormat,{longDateFormat:this.project.getValue("longDateFormat"),
shortDateFormat:this.project.getValue("shortDateFormat"),serverOffset:this.project.getSystemPropertiesMgr().getServerOffset()}),this.fetchData())};a.prototype.setValue=function(a,e,g,d){var f=!1;switch(a){case "sortingMode":e!==this.sortingMode&&(this.sortingMode=e);break;case "hasStaticHeader":e!==this.hasStaticHeader&&(this.hasStaticHeader=e);break;case "filterCol1":e!==this.filterCol1&&(this.filterCol1=e,f=!0);break;case "filterCol2":e!==this.filterCol2&&(this.filterCol2=e,f=!0);break;case "filterExp1":e!==
this.filterExp1&&(this.filterExp1=e,f=!0);break;case "filterExp2":e!==this.filterExp2&&(this.filterExp2=e,f=!0);break;default:c.prototype.setValue.call(this,a,e,g,d)}f&&this.fetchData()};a.jmType="TableAuditSrcWgt";return a}(Ra);g.fn.hmiTableAuditSrcWgt=function(c,a,b,e){return new Rd(this,c,a,b,e)};g.addWidgetDefinition("hmiTableAuditSrcWgt",Rd);var Td=function(c){function a(b,e,h,d,f){b=c.call(this,b,e,h,d,f)||this;b.startTime=0;b.stopTime=0;b.datalinksMap={};b.columnNames=[];b.initDateFormatter();
b.srv=g.getActiveProject().getCommunticationObj();b.trendMgr=g.getActiveProject().getWidget("_TrendMgr",!0);b.samplingTime=b.trendMgr.getSamplingTime(b.trendName);b.trendMgr.subscribeWgt(b,function(){});b.duration=a.pageDurationMap[b.pageDuration];return b}p(a,c);a.prototype.load=function(){var a=this;this.trendMgr.waitWgtReady().then(function(){var c=(new Date).getTime();a.stopTime=c<a.startTime?a.getNextMinute():c;c=Math.ceil(a.stopTime-1E3*a.duration);0>=c&&(c=(new Date).getTime());a.startTime=
c;a.sendUpdate("StartTime",Math.ceil(a.startTime/1E3),null);a.sendUpdate("stopTime",Math.ceil(a.stopTime/1E3),null);a.columnNames=a.trendMgr.getSubTrendNames(a.trendName);a.initSubTrendFormats();a.createDatalinks();a.init=!0;a.fetchData()})};a.prototype.unload=function(){c.prototype.unload.call(this);for(var a in this.datalinksMap){for(var e=0;e<this.datalinksMap[a].length;e++)this.datalinksMap[a][e].unmount();delete this.datalinksMap[a]}};a.prototype.getLastSampleTS=function(a){return this.sortingMode==
ob.ASCENDING?a?a+this.samplingTime:this.startTime:a?a-this.samplingTime:this.stopTime};a.prototype.initSubTrendFormats=function(){var a=this.trendMgr.getSubTrends(this.trendName),c;for(c in a){var g=a[c];this.trendMgr.setUsingFormat(c,g.numberFormat);g.ldValue&&this.trendMgr.setLeadingDigits(c,g.ldValue);g.ddValue&&this.trendMgr.setDecimalDigits(c,g.ddValue)}};a.prototype.addHeaderTemplate=function(a){return this.hasStaticHeader?this.addTemplateToJSONModel(a,new Sd(this),!0,0):null};a.prototype.getSubTrendTitle=
function(a){var c=(this.isTemplateWgt?this.parentPage.getTemplateMLTextMgr():this.parentPage.getPageMLTextMgr()).getMultiLanguagesMgr().getCurrentLangCode();a=this.trendMgr.getTitleValue(this.trendName,a);return"string"==typeof a?a:a.mltext[c]};a.prototype.addBodyTemplates=function(a,c){var g=[];if(c[0])for(var d=c[0].d,f=t.import("Quality"),k=1<a.getTableGroup().getGridRowsNumber()?1:0,l=0;l<d.length;l++){var m=[];if((new f(d[l].q)).isQualityGood()){m.push(d[l].ms);for(var n=0;n<c.length;n++)m.push(c[n].d[l].v);
g.push(this.addTemplateToJSONModel(a,new Sd(this,m),!1,k));a.incrementFilterXFormulaIndex()}l==d.length-1&&a.setLastSampleTime(this.getLastSampleTS(d[l].ms))}return g};a.prototype.resetModel=function(a){a.resetModel();a.appendProps(this.addPropsToJSONModel(a));a.appendHeader(this.addHeaderTemplate(a))};a.prototype.appendBodyFragment=function(a,c){var g=this.addBodyTemplates(a,c);a.appendBody(g);a.setOffset(a.getOffset()+c[0].d.length-1);a.evaluateModel()};a.prototype.executeReadTrend=function(a,c){var g=
this;c&&(a.setStartTime(this.startTime),a.setStopTime(this.stopTime),a.setLastSampleTime(this.getLastSampleTS()));var d=a.getStartTime(this.sortingMode),f=a.getStopTime(this.sortingMode),k=this.trendName,l=this.fetchRows;this.sortingMode==ob.ASCENDING&&d>f||this.sortingMode==ob.DESCENDING&&f>d?(a.noMoreData=!0,a.evaluateModel()):this.srv.readSubTrends(this.wgtId,d,f,k,l,0,!1,function(d,f){c&&g.resetModel(a);0==f.length||"S_NODATA"==f[0].c||0==f[0].d.length?(a.noMoreData=!0,a.evaluateModel()):g.appendBodyFragment(a,
f)})};a.prototype.fetchData=function(){if(this.init)for(var a in this._subscriptions){var c=this._subscriptions[a].w;c.noMoreData=!1;this.executeReadTrend(c,!0)}};a.prototype.fetchMore=function(a){this.executeReadTrend(a.getProxyTable(),!1)};a.prototype.updateLanguage=function(){this.fetchData()};a.prototype.getColumnNames=function(){return this.columnNames};a.prototype.hasHighResolutionSampling=function(){return this.trendMgr.hasHighResolutionSampling(this.trendName)};a.prototype.getFormatOptions=
function(a){return this.trendMgr.getFormatOptions(a)};a.prototype.getNextMinute=function(){var a=new Date;a.setMinutes(a.getMinutes()+1);a.setSeconds(0);return a.getTime()};a.prototype.setValue=function(b,e,g,d){var f=!1,k="";-1!=b.indexOf("%")&&(k=b.split("%"),b=k[0],k=k[1]);switch(b){case "pageDuration":this.pageDuration!=e&&(this.pageDuration=Number(e),this.duration=a.pageDurationMap[this.pageDuration],b=0===this.duration?1:Math.ceil(this.stopTime-1E3*this.duration),0>=b&&(b=(new Date).getTime()),
this.startTime=b,this.sendUpdate("pageDuration",this.pageDuration,g),this.sendUpdate("StartTime",Math.ceil(this.startTime/1E3),g),f=!0);break;case "stopTime":e*=1E3;this.stopTime!=e&&(this.stopTime=e<this.startTime?this.getNextMinute():e,b=0===this.duration?1:Math.ceil(this.stopTime-1E3*this.duration),0>=b&&(b=(new Date).getTime()),this.startTime=b,this.sendUpdate("StartTime",Math.ceil(this.startTime/1E3),g),this.sendUpdate("stopTime",Math.ceil(this.stopTime/1E3),g),f=!0);break;case "StartTime":e*=
1E3;this.startTime!=e&&(this.startTime=0<this.duration?0>=e?(new Date).getTime():e:1,this.sendUpdate("StartTime",Math.ceil(this.startTime/1E3),g));break;case "leadingDigits":this.trendMgr&&""!=k&&(this.trendMgr.setLeadingDigits(k,e),f=!0);break;case "decimalDigits":this.trendMgr&&""!=k&&(this.trendMgr.setDecimalDigits(k,e),f=!0);break;case "usingFormat":this.trendMgr&&""!=k&&(this.trendMgr.setUsingFormat(k,e),f=!0);break;default:c.prototype.setValue.call(this,b,e,g,d)}f&&this.fetchData()};a.prototype.getValue=
function(a){if("StartTime"===a)return Math.ceil(this.startTime/1E3);if("stopTime"===a)return Math.ceil(this.stopTime/1E3);if("pageDuration"===a)return this.pageDuration;c.prototype.getValue.call(this,a)};a.prototype.getTSSortingMode=function(){return this.sortingMode};a.prototype.createDatalinks=function(){var a=this,c=this.trendMgr.getSubTrends(this.trendName),h=function(c,d,e){var f=g.activeProject.getTagMgr();void 0===a.datalinksMap[c]&&(a.datalinksMap[c]=[]);a.datalinksMap[c].push(g.hmiAttach(a,
f.wgtId,{tag:d,srcType:"Tag",rw:"rw",attr:e,tagType:"",wT:0}))},d;for(d in c){var f=c[d];f.ldTag&&h(d,f.ldTag,"leadingDigits%"+d);f.ddTag&&h(d,f.ddTag,"decimalDigits%"+d);f.customTag&&h(d,f.customTag,"usingFormat%"+d)}};a.prototype.getSubTrendMLVariables=function(a){return this.trendMgr.getSubTrendMLVariables(this.trendName,a)};a.prototype.refresh=function(){this.setValue("stopTime",Math.ceil((new Date).getTime()/1E3),null,null)};a.prototype.moveBackward=function(){0<this.duration&&this.setValue("stopTime",
Math.ceil(this.startTime/1E3),null,null)};a.prototype.moveForward=function(){0<this.duration&&this.setValue("stopTime",Math.ceil(this.stopTime/1E3)+this.duration,null,null)};a.prototype.destroy=function(){c.prototype.destroy.call(this)};a.prototype.updateStyle=function(a){!a.longDateFormat&&!a.shortDateFormat||"SHORT-DATE"!=this.dateFormat&&"LONG-DATE"!=this.dateFormat||(this.dateFormatter.setFormat(this.dateFormat,{longDateFormat:this.project.getValue("longDateFormat"),shortDateFormat:this.project.getValue("shortDateFormat"),
serverOffset:this.project.getSystemPropertiesMgr().getServerOffset()}),this.fetchData())};a.jmType="TableTrendSrcWgt";a.pageDurationMap={0:0,1:60,2:300,3:600,4:1800,5:3600,6:7200,7:14400,8:28800,9:43200,10:86400,11:172800,12:432E3,13:604800,14:1209600,15:2419200,16:7776E3,17:15552E3,18:31536E3,19:63072E3,20:157766400};return a}(Ra);g.fn.hmiTableTrendSrcWgt=function(c,a,b,e){return new Td(this,c,a,b,e)};g.addWidgetDefinition("hmiTableTrendSrcWgt",Td);var Sd=function(c){function a(a,e){var g=c.call(this)||
this,d=a.getColumnNames();if(e)for(var f=0;f<d.length;f++)g[d[f]]="TimeStamp"==d[f]?g.formatTimestamp(a,e[f]):g.formatValue(a,d[f],e[f]);else for(f=0;f<d.length;f++)g[d[f]]="TimeStamp"!=d[f]?a.getSubTrendTitle(d[f]):d[f];return g}p(a,c);a.prototype.formatValue=function(a,c,h){return g.import("TextFormatUtil").formatText(a.getFormatOptions(c),h,null,!1,-1)};a.prototype.formatTimestamp=function(a,c){return a.getFormattedTimestamp(c,a.hasHighResolutionSampling()).full};a.prototype.getDynamicFieldData=
function(a){if(void 0!==this[a])return this[a]};a.prototype.getBGColor=function(){return"trasparent"};a.prototype.setVisibility=function(a){this.visible=a};a.prototype.getVisibility=function(){return this.visible};return a}(pb),Vd=function(c){function a(a,e,h,d,f){a=c.call(this,a,e,h,d,f)||this;a.srv=g.activeProject.getCommunticationObj();a.eventBuffer=null;a.idalEvents=[];a.filterKeys="alTS alDateTime alName alEventType alState alValue alDescription alGroups alBGColor alFGColor alAlarmID alPLCDateTime alIsTriggered alCustomField1 alCustomField2".split(" ");
a.fetchRows=0;a.isFetchEnabled=!1;a.hasFilter=!0;return a}p(a,c);a.prototype.load=function(){var a=this;g.activeProject.getWidget("_AlarmsMgr",!0).waitWgtReady().then(function(){a.eventBuffer=g.getWidget(a.bufferId,!0);a.eventBuffer.subscribeWgt(a,a.fetchData.bind(a));a.dateFormat=a.eventBuffer.getValue("dateFormat");a.timeSpec=a.eventBuffer.getValue("timeSpec");a.eventBuffer.setInitStopTime();a.initDateFormatter();a.initAlarmEvent();a.init=!0;a.fetchData()})};a.prototype.unload=function(){};a.prototype.initAlarmEvent=
function(){var a=this.eventBuffer.getEventType(),c=this.eventBuffer.getSubType(),g=this.eventBuffer.getStartTime(0===this.sortingMode),d=this.eventBuffer.getStopTime(0===this.sortingMode),f=this.bufferId,k=this.eventBuffer.getEventBufferName();this.alarmEvent=new Hd(a,c,g,d,f,k)};a.prototype.updateTimeRange=function(){this.alarmEvent.setStartTime(this.eventBuffer.getStartTime(0===this.sortingMode));this.alarmEvent.setEndTime(this.eventBuffer.getStopTime(0===this.sortingMode))};a.prototype.applyFilters=
function(a,c,g,d){var f=!0;this.filterCol1==d&&(f=(new RegExp(this.filterExp1,"i")).test(g.getDynamicFieldData(d)));f&&this.filterCol2==d&&(f=(new RegExp(this.filterExp2,"i")).test(g.getDynamicFieldData(d)));c._f=f?this.getFilter(a,g):f};a.prototype.addHeaderTemplate=function(a){return this.hasStaticHeader?this.addTemplateToJSONModel(a,new Ud(this),!0,0):null};a.prototype.addBodyTemplates=function(a,c){for(var g=[],d=0;d<c.length;d++){var f=1<a.getTableGroup().getGridRowsNumber()?1:0;g.push(this.addTemplateToJSONModel(a,
new Ud(this,c[d]),!1,f));a.incrementFilterXFormulaIndex()}return g};a.prototype.resetModel=function(a){a.resetModel();a.appendProps(this.addPropsToJSONModel(a));a.appendHeader(this.addHeaderTemplate(a))};a.prototype.appendBodyFragment=function(a,c){var g=this.addBodyTemplates(a,c);a.appendBody(g);a.setOffset(a.getOffset()+c.length-1);a.evaluateModel()};a.prototype.executeAlarmsUpdate=function(a,c){var h=this;this.updateTimeRange();this.srv.readEvent(this.alarmEvent,null).then(function(d){var f=d.st;
if(14!==d.t)throw"Wrong event archive";c&&h.resetModel(a);h.appendBodyFragment(a,"S_NODATA"===f?[]:d.data)}).catch(function(a){g.getAction("hmiActionShowMessage").execute(null,{msg:"Fetch alarms failed: "+a},3)})};a.prototype.fetchData=function(){if(this.init)for(var a in this._subscriptions)this.executeAlarmsUpdate(this._subscriptions[a].w,!0)};a.prototype.fetchMore=function(a){};a.prototype.updateLanguage=function(){this.fetchData()};a.prototype.refresh=function(){this.fetchData()};a.prototype.updateStyle=
function(a){!a.longDateFormat&&!a.shortDateFormat||"SHORT-DATE"!=this.dateFormat&&"LONG-DATE"!=this.dateFormat||(this.dateFormatter.setFormat(this.dateFormat,{longDateFormat:this.project.getValue("longDateFormat"),shortDateFormat:this.project.getValue("shortDateFormat"),serverOffset:this.project.getSystemPropertiesMgr().getServerOffset()}),this.fetchData())};a.prototype.setValue=function(a,e,g,d){var f=!1;switch(a){case "sortingMode":e!==this.sortingMode&&(this.sortingMode=e);break;case "hasStaticHeader":e!==
this.hasStaticHeader&&(this.hasStaticHeader=e);break;case "filterCol1Idx":e!==this.filterCol1Idx&&(this.filterCol1Idx=e,this.filterCol1=this.filterKeys[Number(this.filterCol1Idx)],f=!0);break;case "filterCol2Idx":e!==this.filterCol2Idx&&(this.filterCol2Idx=e,this.filterCol2=this.filterKeys[Number(this.filterCol2Idx)],f=!0);break;case "filterExp1":e!==this.filterExp1&&(this.filterExp1=e,f=!0);break;case "filterExp2":e!==this.filterExp2&&(this.filterExp2=e,f=!0);break;default:c.prototype.setValue.call(this,
a,e,g,d)}f&&this.fetchData()};a.jmType="TableHistoricAlarmSrcWgt";return a}(Ra);g.fn.hmiTableHistoricAlarmSrcWgt=function(c,a,b,e){return new Vd(this,c,a,b,e)};g.addWidgetDefinition("hmiTableHistoricAlarmSrcWgt",Vd);var Hd=function(c){function a(a,e,g,d,f,k){return c.call(this,a,e,g,d,f,k)||this}p(a,c);a.prototype.getId=function(){return String(this.eventType+this.subType+this.startTime+this.endTime)};return a}(Ld),Ud=function(c){function a(a,e){var h=c.call(this)||this;h.alAlarmID="";h.alBGColor=
"";h.alCustomField1="";h.alCustomField2="";h.alDateTime="";h.alDescription="";h.alEventType="";h.alFGColor="";h.alGroups="";h.alIsTriggered="";h.alName="";h.alPLCDateTime="";h.alState="";h.alTS="";h.alValue="";if(e){var d=e.v,f=g.activeProject.getAlarmsMgr();h.stateCode=d.st;h.id=d.id;h.ts=e.ts;h.ms=e.ms;h.srcWgt=a;h.alName=f.getAlarmNameById(d.id);h.alValue=d.v.toString();h.alAlarmID=d.id.toString();h.alPLCDateTime=d.ts.toString();h.alEventType=f.getEventTypeString(e.t);h.alGroups=f.getAlarmProp(h.alName,
"gr");h.setDateTimeFields();h.setFieldsLiveTags(d.d);h.setIsTriggeredAsString();h.setStateAsString();h.setColorsAsString()}else h.alName=a.getTitleValue("alName"),h.alTS=a.getTitleValue("alTS"),h.alValue=a.getTitleValue("alValue"),h.alDescription=a.getTitleValue("alDescription"),h.alAlarmID=a.getTitleValue("alAlarmID"),h.alDateTime=a.getTitleValue("alDateTime"),h.alIsTriggered=a.getTitleValue("alIsTriggered"),h.alState=a.getTitleValue("alState"),h.alCustomField1=a.getTitleValue("alCustomField1"),
h.alCustomField2=a.getTitleValue("alCustomField2"),h.alFGColor=a.getTitleValue("alFGColor"),h.alBGColor=a.getTitleValue("alBGColor"),h.alGroups=a.getTitleValue("alGroups"),h.alPLCDateTime=a.getTitleValue("alPLCDateTime"),h.alEventType=a.getTitleValue("alEventType");return h}p(a,c);a.prototype.setDateTimeFields=function(){var a=1E3*this.ts+this.ms;this.alTS=this.srcWgt.getFormattedTimestamp(a).full;this.alDateTime=a.toString()};a.prototype.setFieldsLiveTags=function(a){var c=g.activeProject.getAlarmsMgr(),
h=c.getAlarmsConfiguration().alarms[this.alName],d=c.getAlarmById(this.id.toString());a||(a=d.getValue("liveTags"));var f=c.getDescriptionText(h.d),k=c.getCustomField1Text(h.cF1),h=c.getCustomField2Text(h.cF2),l=d.getDescriptionTags(),m=d.getCustomField1Tags(),d=d.getCustomField2Tags();this.alDescription=c.replaceHistLiveTags(f,l,a);this.alCustomField1=c.replaceHistLiveTags(k,m,a);this.alCustomField2=c.replaceHistLiveTags(h,d,a)};a.prototype.setStateAsString=function(){this.alState=g.activeProject.getAlarmsMgr().getAlarmById(this.id.toString()).stateToString(this.stateCode)};
a.prototype.setColorsAsString=function(){var a=g.activeProject.getAlarmsMgr().getAlarmById(this.id.toString()).getColorsByStateCode(this.stateCode);this.alBGColor=a.bg;this.alFGColor=a.fg};a.prototype.setIsTriggeredAsString=function(){this.alIsTriggered=g.activeProject.getAlarmsMgr().getAlarmById(this.id.toString()).isTriggered()?"1":"0"};a.prototype.getDynamicFieldData=function(a){switch(a){case "alAlarmID":return this.alAlarmID;case "alBGColor":return this.alBGColor;case "alCustomField1":return this.alCustomField1;
case "alCustomField2":return this.alCustomField2;case "alDateTime":return this.alDateTime;case "alDescription":return this.alDescription;case "alEventType":return this.alEventType;case "alFGColor":return this.alFGColor;case "alGroups":return this.alGroups;case "alIsTriggered":return this.alIsTriggered;case "alName":return this.alName;case "alPLCDateTime":return this.alPLCDateTime;case "alState":return this.alState;case "alTS":return this.alTS;case "alValue":return this.alValue}};a.prototype.getBGColor=
function(){return this.alBGColor};a.prototype.setVisibility=function(a){this.visible=a};a.prototype.getVisibility=function(){return this.visible};return a}(pb),Xd=function(c){function a(a,e,g,d,f){a=c.call(this,a,e,g,d,f)||this;a.visibleSamples=[];a.filterKeys="alName alGroups alSelect alEnable alValue alState alDescription alDate alTime alSeverity alDateTime alUserAction comment BGColor FGColor alCustomField1 alCustomField2".split(" ");a.fetchRows=0;a.isFetchEnabled=!1;a.hasFilter=!0;return a}p(a,
c);a.prototype.load=function(){var a=this,c=g.activeProject.getAlarmsMgr();c.subscribeWgt(this,this.notifyUpdate.bind(this));c.waitWgtReady().then(function(){a.init=!0;a.notifyUpdate()})};a.prototype.unload=function(){g.activeProject.getAlarmsMgr().unsubscribeWgt(this)};a.prototype.applyFilters=function(a,c,g,d){var f=!0;this.filterCol1==d&&(f=(new RegExp(this.filterExp1,"i")).test(g.getDynamicFieldData(d)));f&&this.filterCol2==d&&(f=(new RegExp(this.filterExp2,"i")).test(g.getDynamicFieldData(d)));
f?c._f=this.getFilter(a,g):(c._f=f,"object"==typeof c._f?g.setVisibility(!0):g.setVisibility(c._f))};a.prototype.addHeaderTemplate=function(a){return this.hasStaticHeader?this.addTemplateToJSONModel(a,new Wd(this),!0,0):null};a.prototype.addBodyTemplates=function(a,c){var g=[],d;for(d in c){var f=new Wd(this,c[d].al),k=1<a.getTableGroup().getGridRowsNumber()?1:0;g.push(this.addTemplateToJSONModel(a,f,!1,k));a.incrementFilterXFormulaIndex();this.addToVisibleAlarms(f)}return g};a.prototype.resetModel=
function(a){a.resetModel();a.appendProps(this.addPropsToJSONModel(a));a.appendHeader(this.addHeaderTemplate(a))};a.prototype.appendBodyFragment=function(a,c){var g=this.addBodyTemplates(a,c);a.appendBody(g);a.setOffset(a.getOffset()+c.length-1);a.evaluateModel()};a.prototype.executeAlarmsUpdate=function(a,c){var h=g.activeProject.getAlarmsMgr().getAlarmsBuffer();c&&this.resetModel(a);this.appendBodyFragment(a,h)};a.prototype.fetchData=function(){if(this.init)for(var a in this._subscriptions)this.executeAlarmsUpdate(this._subscriptions[a].w,
!0)};a.prototype.fetchMore=function(a){};a.prototype.addToVisibleAlarms=function(a){a.getVisibility()&&this.visibleSamples.push(a.getAlarmName())};a.prototype.notifyUpdate=function(){this.fetchData()};a.prototype.setValue=function(a,e,g,d){var f=!1;switch(a){case "hasStaticHeader":e!==this.hasStaticHeader&&(this.hasStaticHeader=e);f=!0;break;case "filterCol1":e!==this.filterCol1&&(this.filterCol1=e,f=!0);break;case "filterCol2":e!==this.filterCol2&&(this.filterCol2=e,f=!0);break;case "filterExp1":e!==
this.filterExp1&&(this.filterExp1=e,f=!0);break;case "filterExp2":e!==this.filterExp2&&(this.filterExp2=e,f=!0);break;default:c.prototype.setValue.call(this,a,e,g,d)}f&&this.fetchData()};a.prototype.updateLanguage=function(){this.fetchData()};a.prototype.refresh=function(){this.fetchData()};a.prototype.updateStyle=function(a){this.fetchData()};a.prototype.selectAllAlarmsOnSrc=function(){g.activeProject.getAlarmsMgr().doSelectAlarms(this.visibleSamples)};a.jmType="hmiTableAlarmSrcWgt";return a}(Ra);
g.fn.hmiTableAlarmSrcWgt=function(c,a,b,e){return new Xd(this,c,a,b,e)};g.addWidgetDefinition("hmiTableAlarmSrcWgt",Xd);var Wd=function(c){function a(a,e){var h=c.call(this)||this;h.alCustomField1="";h.alCustomField2="";h.alTime="";h.alDate="";h.alDescription="";h.alGroups="";h.alName="";h.alState="";h.alValue="";h.alSeverity="";h.comment="";h.BGColor="transparent";e?(g.activeProject.getAlarmsMgr(),h.stateCode=e.alState,h.alName=e.alName,h.BGColor=e.BGColor,h.alValue=e.alValue,h.alSeverity=e.alSeverity,
h.alGroups=e.getValue("alGroups"),h.alState=e.stateToString(h.stateCode),h.alarm=e,h.setDateTimeFields(),h.setFieldsDatalinks(),h.setFieldsLiveTags()):(h.BGColor=a.getTitleValue("BGColor"),h.alCustomField1=a.getTitleValue("alCustomField1"),h.alCustomField2=a.getTitleValue("alCustomField2"),h.alDate=a.getTitleValue("alDate"),h.alDateTime=a.getTitleValue("alDateTime"),h.alDescription=a.getTitleValue("alDescription"),h.FGColor=a.getTitleValue("FGColor"),h.alGroups=a.getTitleValue("alGroups"),h.alName=
a.getTitleValue("alName"),h.alState=a.getTitleValue("alState"),h.alValue=a.getTitleValue("alValue"),h.alEnable=a.getTitleValue("alEnable"),h.alSelect=a.getTitleValue("alSelect"),h.alSeverity=a.getTitleValue("alSeverity"),h.alTime=a.getTitleValue("alTime"),h.alUserAction=a.getTitleValue("alUserAction"),h.comment=a.getTitleValue("comment"));return h}p(a,c);a.prototype.setDateTimeFields=function(){if(this.alarm.alDateTime){var a=new Date(this.alarm.alDateTime),a=new Date(a.getTime()-6E4*a.getTimezoneOffset()),
c=new cb(a,"DD MMM YYYY");this.alDateTime=Math.round(a.getTime()/1E3);this.alDate=c.formatDateTimeValue();c.setFormat("hh:mm:ss");this.alTime=c.formatDateTimeValue()}};a.prototype.setFieldsDatalinks=function(){var a=g.activeProject.getAlarmsMgr().getIndexOfAlarm(this.alName);this.alUserAction={_c:"dl",v:"alUserAction["+a+"]:_AlarmsMgr|R/W"};this.alSelect={_c:"dl",v:"alSelect["+a+"]:_AlarmsMgr|R/W"};this.alEnable={_c:"dl",v:"alEnable["+a+"]:_AlarmsMgr|R/W"};this.FGColor={_c:"dl",v:"FGColor["+a+"]:_AlarmsMgr|R/W"}};
a.prototype.setFieldsLiveTags=function(){var a=g.activeProject.getAlarmsMgr(),c=a.getAlarmsConfiguration().alarms[this.alName],h=this.alarm.getValue("liveTags"),d=a.getDescriptionText(c.d),f=a.getCustomField1Text(c.cF1),c=a.getCustomField2Text(c.cF2),k=this.alarm.getDescriptionTags(),l=this.alarm.getCustomField1Tags(),m=this.alarm.getCustomField2Tags();this.alDescription=a.replaceHistLiveTags(d,k,h);this.alCustomField1=a.replaceHistLiveTags(f,l,h);this.alCustomField2=a.replaceHistLiveTags(c,m,h)};
a.prototype.getAlarmName=function(){return this.alName};a.prototype.getDynamicFieldData=function(a){switch(a){case "BGColor":return this.BGColor;case "alCustomField1":return this.alCustomField1;case "alCustomField2":return this.alCustomField2;case "alDate":return this.alDate;case "alDateTime":return this.alDateTime;case "alDescription":return this.alDescription;case "FGColor":return this.FGColor;case "alGroups":return this.alGroups;case "alName":return this.alName;case "alState":return this.alState;
case "alValue":return this.alValue;case "alEnable":return this.alEnable;case "alSelect":return this.alSelect;case "alSeverity":return this.alSeverity;case "alTime":return this.alTime;case "alUserAction":return this.alUserAction;case "comment":return this.comment}};a.prototype.getBGColor=function(){return this.BGColor};a.prototype.setVisibility=function(a){this.visible=a};a.prototype.getVisibility=function(){return this.visible};return a}(pb),Zd=function(c){function a(a,e,g,d,f){a=c.call(this,a,e,
g,d,f)||this;a.sortingMode=0;a.columnNamesOrderMap=new Map;return a}p(a,c);a.prototype.load=function(){var a=this;this.dbconnector=g.getWidget("_DBConnectorMgr",!0);this.dbconnector.waitWgtReady().then(function(){a.init=!0;a.fetchData()})};a.prototype.unload=function(){};a.prototype.getFilter=function(a,c){var g=this,d=a.getTableGroup(),f=function(a){a=Number(a.split("Column")[1]);return 0<a?g.getColumnNames()[a-1]:null};if("Formula"===d.filterSrcType){var d=d.getDatalink("filter").xforms[0],k=d.getCompiledExpression(),
l=[],m;for(m in d.dataLinks){var n=d.dataLinks[m],p=f(n.tag);null!==p&&(p=c.getDynamicFieldData(p),void 0!==p?p instanceof Object?l.push(p.v+n.attr):k=k.replace(n.attr,'"'+p+'"'):l.push(n.writeToString()))}return 0===l.length?eval(k):{_c:"dl",v:"="+k+";["+l.join(";")+"]"}}return""==d.filterColName?!0:c.getDynamicFieldData(f(d.filterColName))};a.prototype.injectTemplateValues=function(a,c,g,d){d=this.dtlkList[d];this.injectBgColor(g,c);for(var f in d){var k=Number(d[f].tag.split("Column")[1]);0<k&&
(k=this.getColumnNames()[k-1],this.injectValue(g,c,k),void 0===g._h&&(g._f=this.getFilter(a,c)))}};a.prototype.addHeaderTemplate=function(a){return this.hasStaticHeader?this.addTemplateToJSONModel(a,new Yd(this),!0,0):null};a.prototype.addBodyTemplates=function(a,c){if(0<this.getColumnNames().length){for(var g=[],d=0;d<c.length;d++){var f=1<a.getTableGroup().getGridRowsNumber()?1:0;g.push(this.addTemplateToJSONModel(a,new Yd(this,c[d]),!1,f));a.incrementFilterXFormulaIndex()}return g}return[]};a.prototype.resetModel=
function(a){a.resetModel();a.appendProps(this.addPropsToJSONModel(a));a.appendHeader(this.addHeaderTemplate(a))};a.prototype.appendBodyFragment=function(a,c){var g=this.addBodyTemplates(a,c);a.appendBody(g);a.setOffset(a.getOffset()+c.length-1);a.evaluateModel()};a.prototype.generateColumnNamesOrderMap=function(a){var c=this.getColumnNames();a=a.map(function(a){return a.toLowerCase()});for(var c=c.map(function(a){return a.toLowerCase()}),g=0;g<c.length;g++)this.columnNamesOrderMap.set(g,a.indexOf(c[g]))};
a.prototype.executeQuery=function(a,c){var h=this,d=this.dbconnector.getDBLinkByName(this.dbLink);if(d){c&&(a.setOffset(0),a.setRefreshMode(c));var f=this.dbQuery,k=a.getOffset();d.processDBQuery({dbquery:f,fetchEnabled:this.isFetchEnabled,offset:k,rowsToFetch:this.fetchRows}).then(function(d){a.showTableLoading();g.projectInterface.dbQuery(h.dbLink,d,function(d,f){if(0==d&&0<f.length){var g=JSON.parse(f);a.noMoreData=!1;h.generateColumnNamesOrderMap(g.rsCols);c&&h.resetModel(a);h.appendBodyFragment(a,
g.rsData)}else a.noMoreData=!0,a.evaluateModel()},1)})}else g.getAction("hmiActionShowMessage").execute(null,{msg:"Database link not defined !"},3)};a.prototype.fetchData=function(){if(this.init)for(var a in this._subscriptions)this._subscriptions[a].w.noMoreData=!1,this.executeQuery(this._subscriptions[a].w,!0)};a.prototype.fetchMore=function(a){this.isFetchEnabled&&this.executeQuery(a.getProxyTable(),!1)};a.prototype.getColumnNames=function(){return this.columnNames};a.prototype.getColumnNamesOrderMap=
function(){return this.columnNamesOrderMap};a.prototype.refresh=function(){this.fetchData()};a.prototype.updateLanguage=function(){this.fetchData()};a.prototype.setValue=function(a,e,g,d){switch(a){case "sortingMode":e!==this.sortingMode&&(this.sortingMode=e);break;case "hasStaticHeader":e!==this.hasStaticHeader&&(this.hasStaticHeader=e);break;default:c.prototype.setValue.call(this,a,e,g,d)}};a.jmType="TableDBSrcWgt";return a}(Ra);g.fn.hmiTableDBSrcWgt=function(c,a,b,e){return new Zd(this,c,a,b,e)};
g.addWidgetDefinition("hmiTableDBSrcWgt",Zd);var Yd=function(c){function a(a,e){var g=c.call(this)||this,d=a.getColumnNames();if(e)for(var f=a.getColumnNamesOrderMap(),k=0;k<d.length;k++)g[d[k]]=e[f.get(k)];else for(k=0;k<d.length;k++)g[d[k]]=d[k];return g}p(a,c);a.prototype.getDynamicFieldData=function(a){if(void 0!==this[a])return this[a]};a.prototype.getBGColor=function(){return"trasparent"};a.prototype.setVisibility=function(a){this.visible=a};a.prototype.getVisibility=function(){return this.visible};
return a}(pb),qb;(function(c){c[c.SQL4AUTOMATION=0]="SQL4AUTOMATION";c[c.MYSQL=1]="MYSQL";c[c.MARIADB=2]="MARIADB";c[c.PSQL=3]="PSQL";c[c.ODBC=4]="ODBC"})(qb||(qb={}));var ae=function(c){function a(a,e,h,d,f){var k=c.call(this,a.wgtId,e,h,d,f)||this;k.dblinks=new Map;k.dbqueryCbs=new Map;k.configFileName="dbconnector.json";k.initPromiseReady();k.enable&&!$hmi.isTestModeActive()&&k.parentWidget.waitWgtReady().then(function(){k.srv=k.parentWidget.getCommunticationObj();k.srv.getConf().then(function(a){k.generateDBLinkInstances(a[k.configFileName]);
k.resolveWgtReady(!0)}).catch(function(a){g.getAction("hmiActionShowMessage").execute(null,{msg:"Error loading DBConnector configuration file. Reloading..."},3);setTimeout(function(){k.project.getCommunticationObj().loadIndex()},2E3)})});k.resolveWgtReady(!0);return k}p(a,c);a.prototype.generateDBLinkInstances=function(a){a=a.dblinks;for(var c in a){var g=c;this.dblinks.set(g,new $d(g,a[c].dbtype))}};a.prototype.isEnable=function(){return this.enable};a.prototype.getDBLinkByName=function(a){return this.dblinks.get(a)};
a.prototype.registerDBQueryCb=function(a,c){this.dbqueryCbs.set(a,c)};a.prototype.executeDBQueryCb=function(a){var c,g;a.v instanceof Object?(c=a.v.dbsessionid,g=Number(a.v.ec),a=JSON.stringify(a.v)):(c=a.dbsessionid,g=Number(a.ec),a=a.v);var d=this.dbqueryCbs.get(c);d&&(d(g,a),this.dbqueryCbs.delete(c))};return a}(l);g.fn.hmiDBConnectorMgrWgt=function(c,a,b,e){return new ae(this,c,a,b,e)};g.addWidgetDefinition("hmiDBConnectorMgrWgt",ae);var $d=function(){function c(a,b){this.name=a;this.dbtype=b}
Object.defineProperty(c.prototype,"dbtype",{get:function(){return this._dbtype},set:function(a){this._dbtype=a},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"name",{get:function(){return this._name},set:function(a){this._name=a},enumerable:!1,configurable:!0});c.prototype.removeQueryQuotes=function(a){return a.replace(/["']/g,"")};c.prototype.appendFetchMoreLimit=function(a,b,c,g){if(b&&(a=a.trim(),0<a.length&&0<=c&&0<=g))switch(this.dbtype){case qb.SQL4AUTOMATION:case qb.MYSQL:case qb.MARIADB:";"==
a.slice(-1)&&(a=a.slice(0,-1));a+=" LIMIT "+String(c)+","+String(g)+";";break;case qb.PSQL:";"==a.slice(-1)&&(a=a.slice(0,-1)),a+=" LIMIT "+String(g)+" OFFSET "+String(c)+";"}return a};c.prototype.resolveQueryLiveTags=function(a){return fd(this,void 0,void 0,function(){var b,c,h,d,f,k;return gd(this,function(l){switch(l.label){case 0:b=/\$\((.*?)\)/g;c=a.match(b);if(null===c)return[3,4];h=g.activeProject.getTagMgr();d=0;l.label=1;case 1:if(!(d<c.length))return[3,4];f=c[d].substring(2,c[d].length-
1);return[4,h.getValue(f)];case 2:k=l.sent(),null!=k&&(a=a.replace(c[d],k)),l.label=3;case 3:return d++,[3,1];case 4:return[2,a]}})})};c.prototype.processDBQuery=function(a){return fd(this,void 0,void 0,function(){var b,c,g,d;return gd(this,function(f){switch(f.label){case 0:return b=a.dbquery,c=a.fetchEnabled,g=a.offset,d=a.rowsToFetch,[4,this.resolveQueryLiveTags(b)];case 1:return b=f.sent(),b=this.appendFetchMoreLimit(b,c,g,d),[2,b]}})})};return c}();t.addModule("DBLink",$d);var Sa;(function(c){c[c.EVERY=
2]="EVERY";c[c.HOURLY=3]="HOURLY";c[c.DAILY=4]="DAILY";c[c.WEEKLY=5]="WEEKLY";c[c.MONTHLY=6]="MONTHLY";c[c.YEARLY=7]="YEARLY";c[c.BYDATE=8]="BYDATE"})(Sa||(Sa={}));var rb;(function(c){c[c.TIME=1]="TIME";c[c.SUNRISEP=2]="SUNRISEP";c[c.SUNRISEM=3]="SUNRISEM";c[c.SUNSETP=4]="SUNSETP";c[c.SUNSETM=5]="SUNSETM";c[c.RANDOM10=6]="RANDOM10";c[c.RANDOM20=7]="RANDOM20"})(rb||(rb={}));var be=function(c){function a(a,e){var h=c.call(this)||this;h.enable="";h.edit="";h.name="";h.mlType="";h.mlMode="";h.time="";
h.occurrence="";h.condition="None";if(e){var d=g.activeProject.getWidget("_ScheduleMgr",!0),f=d.getMlType(),k=d.getMlMode();h.name=e.getValue("id");h.mlType=d.getMLText(f[e.getValue("schType")]);h.mlMode=d.getMLText(k[e.getValue("mode")]);h.condition=h.getCondition(e);h.typeIndex=h.getTypeIndex(e);h.modeIndex=h.getModeIndex(e);h.occurrence=h.getOccurrence(e);h.time=h.getTime(e);h.setFieldsDatalinks(a)}else h.enable=a.getTitleValue("Enable"),h.name=a.getTitleValue("Name"),h.mlType=a.getTitleValue("Type"),
h.mlMode=a.getTitleValue("Mode"),h.condition=a.getTitleValue("Condition"),h.typeIndex=a.getTitleValue("TypeIndex"),h.modeIndex=a.getTitleValue("ModeIndex"),h.time=a.getTitleValue("Time"),h.occurrence=a.getTitleValue("Occurrence"),h.edit=a.getTitleValue("Edit");return h}p(a,c);a.prototype.setFieldsDatalinks=function(a){this.enable={_c:"dl",v:"enable%"+this.name+":_ScheduleMgr|R/W"};this.edit={_c:"dl",v:"edit%"+this.name+":_ScheduleMgr|R/W"}};a.prototype.getCondition=function(a){a=a.getValue("condition");
return void 0!==a&&""!==a.tag?a.arrayType?a.tag+"["+a.index+"]":a.tag:"None"};a.prototype.getDaysOfWeek=function(a){if("*"==a)return"M T W T F S S";if(""==a)return"_ _ _ _ _ _ _";var c=t.import("Schedule"),g="";a=a.split(",");for(var d=1;7>d;d++)g=-1!=a.indexOf(d.toString())?g+(c.weekDays[d]+" "):g+"_ ";return g=-1!=a.indexOf("0")?g+c.weekDays[0]:g+"_"};a.prototype.getOccurrence=function(a){var c,g=this,d=t.import("Schedule"),f=(c={},c[Sa.WEEKLY]=function(){var c=a.getValue("dayOfWeek");return void 0!==
c?g.getDaysOfWeek(c):""},c[Sa.BYDATE]=function(){var c=a.getValue("month"),e=a.getValue("dayOfMonth"),f=a.getValue("year");return void 0!==c&&void 0!==e&&void 0!==f?d.months[Number(c)]+" "+e+","+f:""},c[Sa.MONTHLY]=function(){var c=a.getValue("dayOfMonth");return void 0!==c?"Day : "+c:""},c[Sa.YEARLY]=function(){var c=a.getValue("month"),e=a.getValue("dayOfMonth");return void 0!==c&&void 0!==e?d.months[Number(c)]+" "+e:""},c);return f[this.typeIndex]?f[this.typeIndex]():""};a.prototype.getTime=function(a){var c=
a.getValue("hour"),g=a.getValue("minute");a=a.getValue("second");var d="";if("*"==c||"00"==c)c="0";if("*"==g||"00"==g)g="0";if("*"==a||"00"==a)a="0";10>Number(c)&&(c="0"+c);10>Number(g)&&(g="0"+g);10>Number(a)&&(a="0"+a);this.typeIndex===Sa.EVERY?d=c+":"+g+":"+a:this.typeIndex==Sa.HOURLY?d="00:"+g:(this.isOffsetBasedMode(),d=c+":"+g);return d};a.prototype.getTypeIndex=function(a){var c=t.import("Schedule");a=a.getValue("schType");return c.types.indexOf(a)+c.TYPE_NATIVE_OFFSET};a.prototype.getModeIndex=
function(a){var c=t.import("Schedule");a=a.getValue("mode");return c.modes.indexOf(a)+c.MODE_NATIVE_OFFSET};a.prototype.isOffsetBasedMode=function(){return this.modeIndex===rb.SUNRISEP||this.modeIndex===rb.SUNRISEM||this.modeIndex===rb.SUNSETP||this.modeIndex===rb.SUNSETM};a.prototype.getDynamicFieldData=function(a){switch(a){case "Enable":return this.enable;case "Name":return this.name;case "Type":return this.mlType;case "TypeIndex":return this.typeIndex;case "Mode":return this.mlMode;case "ModeIndex":return this.modeIndex;
case "Time":return this.time;case "Occurrence":return this.occurrence;case "Condition":return this.condition;case "EditAction":return this.edit}};a.prototype.getBGColor=function(){return"transparent"};a.prototype.setVisibility=function(a){this.visible=a};a.prototype.getVisibility=function(){return this.visible};return a}(pb),ce=function(c){function a(a,e,g,d,f){a=c.call(this,a,e,g,d,f)||this;a.fetchRows=0;a.isFetchEnabled=!1;return a}p(a,c);a.prototype.load=function(){var a=this;this.schedulemgr=
g.getWidget("_ScheduleMgr",!0);this.schedulemgr.waitWgtReady().then(function(){a.init=!0;a.schedulemgr.subscribeWgt(a,a.refresh.bind(a));a.schedulesMap=a.schedulemgr.getFilteredSchedules(a.scheduleList);a.refresh()})};a.prototype.unload=function(){};a.prototype.addHeaderTemplate=function(a){return this.hasStaticHeader?this.addTemplateToJSONModel(a,new be(this),!0,0):null};a.prototype.addBodyTemplates=function(a,c){var g=this,d=[];c.forEach(function(c,e){var l=1<a.getTableGroup().getGridRowsNumber()?
1:0;d.push(g.addTemplateToJSONModel(a,new be(g,c),!1,l));a.incrementFilterXFormulaIndex()});return d};a.prototype.resetModel=function(a){a.resetModel();a.appendProps(this.addPropsToJSONModel(a));a.appendHeader(this.addHeaderTemplate(a))};a.prototype.appendBodyFragment=function(a,c){var g=this.addBodyTemplates(a,c);a.appendBody(g);a.setOffset(a.getOffset()+c.size-1);a.evaluateModel()};a.prototype.executeSchedulesUpdate=function(a,c){c&&this.resetModel(a);this.appendBodyFragment(a,this.schedulesMap)};
a.prototype.fetchData=function(){if(this.init)for(var a in this._subscriptions)this.executeSchedulesUpdate(this._subscriptions[a].w,!0)};a.prototype.fetchMore=function(a){};a.prototype.setValue=function(a,e,g,d){var f=!1;switch(a){case "hasStaticHeader":e!==this.hasStaticHeader&&(this.hasStaticHeader=e,f=!0);break;default:c.prototype.setValue.call(this,a,e,g,d)}f&&this.refresh()};a.prototype.refresh=function(){this.fetchData()};a.prototype.updateLanguage=function(){this.fetchData()};a.jmType="hmiTableScheduleSrcWgt";
return a}(Ra);g.fn.hmiTableScheduleSrcWgt=function(c,a,b,e){return new ce(this,c,a,b,e)};g.addWidgetDefinition("hmiTableScheduleSrcWgt",ce);var de=function(){function c(a){this.id="";this.executeonlyatstartup=this.onstartup=this.enable=!1;this.schType=this.dayOfWeek=this.year=this.month=this.dayOfMonth=this.hour=this.minute=this.second=this.mode="";this.timezone=this.condition=null;this.edit=!1;this.id=a.id;this.enable=a.enable;this.onstartup=a.onstartup;this.executeonlyatstartup=a.executeonlyatstartup;
this.mode=a.mode;this.second=a.second;this.minute=a.minute;this.hour=a.hour;this.dayOfMonth=a.dayOfMonth;this.month=a.month;this.year=a.year;this.dayOfWeek=a.dayOfWeek;this.schType=a.schType;this.condition=a.condition;this.timezone=a.timezone}c.prototype.updateProperty=function(a,b){return this[a]!==b?(this[a]=b,!0):!1};c.prototype.update=function(a){for(var b in a)this.updateProperty(b,a[b])};c.prototype.getValue=function(a){return this[a]};c.types="Every;Hourly;Daily;Weekly;Monthly;Yearly;By Date".split(";");
c.modes="Time Sunrise+ Sunrise- Sunset+ Sunset- Random10 Random20".split(" ");c.months="JAN FEB MAR APR MAY JUN JUL AUG SEP OCT NOV DEC".split(" ");c.weekDays="SMTWTFS".split("");c.TYPE_NATIVE_OFFSET=2;c.MODE_NATIVE_OFFSET=1;return c}();t.export("Schedule",de);var ee=function(c){function a(a,e,h,d,f){var k=c.call(this,a.wgtId,e,h,d,f)||this;k.mltextconfig=null;k.schedulesMap=new Map;k.initPromiseReady();$hmi.isTestModeActive()||k.parentWidget.waitWgtReady().then(function(){k.srv=g.activeProject.getCommunticationObj();
k.loadScheduleMLTexts()});return k}p(a,c);a.prototype.loadScheduleMLTexts=function(){var a=this;this.srv.getConf().then(function(c){a.mltextconfig=c["schedules.json"];a.initSchedules();a.resolveWgtReady(!0)}).catch(function(){g.getAction("hmiActionShowMessage").execute(null,{msg:"Error loading scheduler configuration. Reloading..."},1);setTimeout(function(){location.href=window.location.protocol+"//"+location.host+"/index.html"},2E3)})};a.prototype.initSchedules=function(){var a=this;this.srv.readAllTimer().then(function(c){for(var g=
0;g<c.length;g++)a.schedulesMap.set(c[g].id,new de(c[g]))})};a.prototype.updateSubscriptions=function(){for(var a in this._subscriptions)this._subscriptions[a].getCallbacks()[0]()};a.prototype.refresh=function(a){for(var c=0;c<a.length;c++){var g=this.schedulesMap.get(a[c].id);g&&g.update(a[c])}this.updateSubscriptions()};a.prototype.getMLTexts=function(){return this.mltextconfig.mlTexts};a.prototype.getMlType=function(){return this.mltextconfig.mlType};a.prototype.getMlMode=function(){return this.mltextconfig.mlMode};
a.prototype.getSchedules=function(){return this.schedulesMap};a.prototype.getMLText=function(a){var c=g.activeProject.getMultiLanguageMgr().getCurrentLanguage();return this.getMLTexts()[a][c]};a.prototype.getFilteredSchedules=function(a){for(var c=new Map,g=0;g<a.length;g++)c.set(a[g],this.schedulesMap.get(a[g]));return c};a.prototype.setValue=function(a,e,h,d){if(-1!=a.indexOf("%"))switch(e=function(a){g.getAction("hmiActionShowMessage").execute(null,{msg:a})},h=a.split("%")[0],a=a.split("%")[1],
h){case "enable":g.mouseMgr.currentWgt=null;e("Limited functionality: editing of "+a+" Enable flag is not currently supported.");this.updateSubscriptions();break;case "edit":g.mouseMgr.currentWgt=null,e("Limited functionality: editing of "+a+" settings is not currently supported."),this.updateSubscriptions()}else c.prototype.setValue.call(this,a,e,h,d)};a.prototype.getValue=function(a){if(-1!=a.indexOf("%")){var e=a.split("%")[0];a=a.split("%")[1];return this.schedulesMap.get(a).getValue(e)}c.prototype.getValue.call(this,
a)};a.jmType="ScheduleMgrWgt";return a}(l);g.fn.hmiScheduleMgrWgt=function(c,a,b,e){return new ee(this,c,a,b,e)};g.addWidgetDefinition("hmiScheduleMgrWgt",ee);var fe=function(c){function a(a,e,g,d,f){a=c.call(this,a.wgtId,e,g,d,f)||this;a.layers=[];return a}p(a,c);a.prototype.addLayer=function(a){this.layers.push(a);a.index===this.currentIndex&&(a.visible=!0)};a.prototype.updateVisibleLayer=function(){var a=this;this.layers.forEach(function(a){a.setValue("visible",!1,null);a.group.setValue("visible",
!1,null)});var c=this.layers.find(function(c){return c.getValue("index")===a.currentIndex});null===c||void 0===c?void 0:c.setValue("visible",!0,null);null===c||void 0===c?void 0:c.group.setValue("visible",!0,null)};a.prototype.setDefaultState=function(){this.currentIndex=void 0===this.currentIndex?0:this.currentIndex};a.prototype.setValue=function(a,e,h,d,f){var k=!1;switch(a){case "currentIndex":"undefined"!==typeof e&&this.currentIndex!==e&&0<=e&&e<this.layers.length&&(this.currentIndex=e,this.updateVisibleLayer());
break;case "colorBackground":this.colorBackground!==e&&(this.colorBackground=e,k=!0);break;case "width":case "height":c.prototype.setValue.call(this,a,e,h,d,f);this.layers.forEach(function(c){return c.setValue(a,e,h,d,f)});break;default:c.prototype.setValue.call(this,a,e,h,d,f)}k&&g.addToRender(this);return!0};a.prototype.getValue=function(a,e){switch(a){case "currentIndex":return this.currentIndex;case "colorBackground":return this.colorBackground;default:return c.prototype.getValue.call(this,a,
e)}};a.prototype.render=function(){if(!c.prototype.render.call(this))return!1;this.elem.style.backgroundColor="none"===this.colorBackground?"transparent":this.colorBackground;return!0};a.jmType="StackWgt";return a}(l);g.fn.hmiStack=function(c,a,b,e){return new fe(this,c,a,b,e)};g.addWidgetDefinition("hmiStack",fe);var Bc=function(c){function a(a,e,g,d,f){a=c.call(this,a.wgtId,e,g,d,f)||this;a.visible=!1;a.setDefaultState();f.addLayer(a);f.getValue("currentIndex")===a.index&&a.setAsVisible(!0);return a}
p(a,c);a.prototype.setDefaultState=function(){this.index=void 0===this.index?0:this.index};a.prototype.setGroup=function(a){this.group=a;this.group.setAsVisible(!0)};a.prototype.setValue=function(a,e,g,d,f){switch(a){case "width":case "height":this.group.setValue(a,e,g,d);break;default:c.prototype.setValue.call(this,a,e,g,d,f)}return!0};a.prototype.getValue=function(a,e){switch(a){case "index":return this.index;default:return c.prototype.getValue.call(this,a,e)}};a.prototype.render=function(){return c.prototype.render.call(this)?
!0:!1};a.jmType="LayerWgt";return a}(l);g.fn.hmiLayer=function(c,a,b,e){return new Bc(this,c,a,b,e)};g.addWidgetDefinition("hmiLayer",Bc);var ge=function(c){function a(b,e,h,d,f){b=c.call(this,b.wgtId,e,h,d,f)||this;b.elem&&(b.canvasElement=b.elem.querySelector("#"+CSS.escape(b.wgtId+".cnv")),b.canvasContext=b.canvasElement.getContext("2d"),b.lightColorHex=b.getHexColorFormat(b.lightColor),b.darkColorHex=b.getHexColorFormat(b.darkColor),b.updateURL(),b._renderMask|=a._renderFlags.DRAWCNV,g.addToRender(b));
return b}p(a,c);a.prototype.resolveRemoteIP=function(){var a=this;return new Promise(function(c,h){g.activeProject.getCommunticationObj().getNetworkInterfaces().then(function(d){if((d=d.adap)&&d instanceof Array){for(var f=0;f<d.length;f++)d[f].id==a.adapter&&c(d[f].netip);c(a.ipaddress)}}).catch(function(){return h(a.ipaddress)})})};a.prototype.getURLString=function(a){a=this.prefix+(a?this.remoteIPAddress:this.ipaddress)+("80"!=this.port?":"+this.port:"");""!=this.page&&(a+="/index.html?loadPage="+
this.page);return a};a.prototype.updateURL=function(){var b=this;""==this.adapter?(this.builtURL=this.getURLString(!1),this._renderMask|=a._renderFlags.DRAWCNV,g.addToRender(this)):this.resolveRemoteIP().then(function(c){b.remoteIPAddress=c;b.builtURL=b.getURLString(!0);b._renderMask|=a._renderFlags.DRAWCNV;g.addToRender(b)})};a.prototype.getHexColorFormat=function(a){return-1!=a.indexOf("rgb")?(a=a.split("(")[1].split(")")[0].split(","),a=a.map(function(a){a=parseInt(a).toString(16);return 1==a.length?
"0"+a:a}),"#"+a.join("")):"transparent"==a||"none"==a?"#00000000":a};a.prototype.isValidColor=function(a){var c=document.createElement("div");c.id="divValidColor";c.style.borderColor="";c.style.borderColor=a;return 0==c.style.borderColor.length?!1:!0};a.prototype.drawCanvas=function(){var a=this;this.canvasElement&&QRCode.toCanvas(this.canvasElement,this.builtURL,{width:Math.min(this.width,this.height),color:{light:this.lightColorHex,dark:this.darkColorHex}},function(c,g){c&&a.canvasContext.clearRect(0,
0,a.width,a.height)})};a.prototype.setValue=function(b,e,h,d,f){var k=!1,l=!1;switch(b){case "ipaddrss":e!=this.ipaddress&&(this.ipaddress=e,this.sendUpdate(b,e,h),l=!0);break;case "prefix":e!=this.prefix&&(this.prefix=e,this.sendUpdate(b,e,h),l=!0);break;case "ethernet":e!=this.adapter&&(this.adapter=e,this.sendUpdate(b,e,h),l=!0);break;case "page":e!=this.page&&(this.page=e,this.sendUpdate(b,e,h),l=!0);break;case "ethernetport":e!=this.port&&(this.port=e,this.sendUpdate(b,e,h),l=!0);break;case "stroke":e!=
this.darkColor&&this.isValidColor(e)&&(this.darkColor=e,this.darkColorHex=-1!=this.darkColor.indexOf("rgb")?this.getHexColorFormat(this.darkColor):this.darkColor,this.sendUpdate(b,e,h),this._renderMask|=a._renderFlags.DRAWCNV,k=!0);break;case "fill":e!=this.lightColor&&this.isValidColor(e)&&(this.lightColor=e,this.lightColorHex=-1!=this.lightColor.indexOf("rgb")?this.getHexColorFormat(this.lightColor):this.lightColor,this.sendUpdate(b,e,h),this._renderMask|=a._renderFlags.DRAWCNV,k=!0);break;default:c.prototype.setValue.call(this,
b,e,h,d,f)}l&&this.updateURL();k&&g.addToRender(this);return!0};a.prototype.getValue=function(a,e){return"ipaddrss"==a?this.ipaddress:"prefix"==a?this.prefix:"ethernet"==a?this.adapter:"page"==a?this.page:"ethernetport"==a?this.port:c.prototype.getValue.call(this,a,e)};a.prototype.render=function(){if(!c.prototype.render.call(this))return!1;this._renderMask&a._renderFlags.DRAWCNV&&this.drawCanvas();this._renderMask&cc._renderFlags.RESIZE&&this.canvasElement&&(this.canvasElement.width=this.width,this.canvasElement.height=
this.height,this.canvasContext=this.canvasElement.getContext("2d"),this.drawCanvas());this._renderMask=0;return!0};a.prototype.setParentBounds=function(a,e,h,d,f){c.prototype.setParentBounds.call(this,a,e,h,d,f);this._renderMask|=cc._renderFlags.RESIZE;g.addToRender(this)};a.jmType="QRCodeWgt";a._renderFlags={DRAWCNV:2,RESIZE:4};return a}(l);g.fn.hmiQRCodeWgt=function(c,a,b,e){return new ge(this,c,a,b,e)};g.addWidgetDefinition("hmiQRCodeWgt",ge);var ea;(function(c){c[c.Horizontal=1]="Horizontal";
c[c.Vertical=2]="Vertical"})(ea||(ea={}));var he=function(c){function a(a,e,g,d,f){a=c.call(this,a,e,g,d,f)||this;a.tabsElements=[];a.scrollingPos={top:0,left:0,x:0,y:0};a.renderArray=[];a.options=g;a.handleTabClick=a.onTabClick.bind(a);a.handleTabMouseDown=a.onTabMouseDown.bind(a);a.handleTabMouseMove=a.onTabMouseMove.bind(a);a.handleTabMouseUp=a.onTabMouseUp.bind(a);a.tabsElements={};g=0;for(e=Array.from(a.elem.querySelectorAll("div.tab"));g<e.length;g++)d=e[g],f=parseInt(d.getAttribute("tab-index")),
d.addEventListener("click",a.handleTabClick),d.addEventListener("mousedown",a.handleTabMouseDown),d.addEventListener("mouseup",a.handleTabMouseUp),a.tabsElements[f]=d;a.tabsContainer=a.elem.querySelector("div.tabs-container");a.handleScrollMouseDownHandler=a.onScrollMouseDownHandler.bind(a);a.handleScrollMouseMoveHandler=a.onScrollMouseMoveHandler.bind(a);a.handleScrollMouseUpHandler=a.onScrollMouseUpHandler.bind(a);a.viewportLeft=a.elem.querySelector("div.viewport.left");a.viewportRight=a.elem.querySelector("div.viewport.right");
c.prototype.bindEvents.call(a,{loadWgt:a.activateHandler.bind(a),unloadWgt:a.deactivateHandler.bind(a)});a.updateFontStyles();return a}p(a,c);a.prototype.activateHandler=function(){var a=this,c,g,d,f,k=this.isLiveTagsEnabled()&&this.hasDynamicVariables(),l;for(l in this.tabsElements)this.tabsElements[l].addEventListener("click",this.handleTabClick),this.tabsElements[l].addEventListener("mousedown",this.handleTabMouseDown),k&&this.loadDynamicTagsForText(parseInt(l));k&&this.project.getTagMgr().subscribeDynamicTags();
null===(c=this.tabsContainer)||void 0===c?void 0:c.addEventListener("mousedown",this.handleScrollMouseDownHandler);null===(g=this.tabsContainer)||void 0===g?void 0:g.addEventListener("scroll",this.scrollListener.bind(this));null===(d=this.viewportLeft)||void 0===d?void 0:d.addEventListener("click",this.handleViewportLeftClick.bind(this));null===(f=this.viewportRight)||void 0===f?void 0:f.addEventListener("click",this.handleViewportRightClick.bind(this));setTimeout(function(){a.optionallyShowViewport()},
0)};a.prototype.deactivateHandler=function(){for(var a in this.tabsElements)this.tabsElements[a].removeEventListener("click",this.handleTabClick);this.tabsContainer.removeEventListener("mousedown",this.handleScrollMouseDownHandler);document.removeEventListener("mouseup",this.handleScrollMouseUpHandler);this.tabsContainer.removeEventListener("scroll",this.scrollListener);this.viewportLeft.removeEventListener("click",this.handleViewportLeftClick);this.viewportRight.removeEventListener("click",this.handleViewportRightClick);
this.isLiveTagsEnabled()&&this.hasDynamicVariables()&&this.unloadDynamicDataLinks()};a.prototype.setDefaultState=function(){};a.prototype.setValue=function(a,e,h,d,f){c.prototype.setValue.call(this,a,e,h,d);switch(a){case "viewportPosition":e=0>e?0:1<e?1:e;this.options[a]!==e&&(this.options[a]=e,this.sendUpdate(a,e,h,d),this.renderArray.push(a));break;case "currentIndex":this.options[a]!==e&&(this.options[a]=e,this.sendUpdate(a,e,h,d),this.renderArray.push(a));break;case "buttonExpanding":case "iconExpanding":case "iconPosition":case "minimumButtonSize":case "minimumIconHeight":case "minimumIconWidth":case "opacityUnselectedButton":case "styleColorAlternativeButtonBackground":case "styleColorBackground":case "styleColorButtonBackground":case "styleColorButtonBackgroundNotSelected":case "styleColorButtonBackgroundPressed":case "styleColorDividingLine":case "styleColorForeground":case "styleColorForegroundNotSelected":case "styleColorSelectedButtonLine":case "styleColorTabLineBottomRight":case "styleColorTabLineLeftBottom":case "styleColorTabLineRightTop":case "styleColorTabLineTopLeft":case "styleColorViewportButtonBackground":case "styleColorViewportButtonBackgroundDisabled":case "styleEnableAlternativeColor":case "styleEnableSelectedButtonLine":case "stylePaddingBottom":case "stylePaddingLeft":case "stylePaddingRight":case "stylePaddingTop":case "styleSizeButtonSpacing":case "styleSizeCorrectionBorder":case "styleSizeDividingLine":case "styleSizeSpacing":case "styleSizeTabLineBottomRight":case "styleSizeTabLineLeftBottom":case "styleSizeTabLineRightTop":case "styleSizeTabLineTopLeft":case "tabStyle":case "textElideMode":case "viewportButtonsMode":case "viewportButtonsSize":this.options[a]!==
e&&(this.options[a]=e,this.renderArray.push(a));break;case "styleColorTabLineHLeft":case "styleColorTabLineVBottom":this.setValue("styleColorTabLineLeftBottom",e,h,d,f);break;case "styleColorTabLineHRight":case "styleColorTabLineVTop":this.setValue("styleColorTabLineRightTop",e,h,d,f);break;case "styleColorTabLineHTop":case "styleColorTabLineVLeft":this.setValue("styleColorTabLineTopLeft",e,h,d,f);break;case "styleColorTabLineHBottom":case "styleColorTabLineVRight":this.setValue("styleColorTabLineBottomRight",
e,h,d,f);break;case "styleSizeTabLineHLeft":case "styleSizeTabLineVBottom":this.setValue("styleSizeTabLineLeftBottom",e,h,d,f);break;case "styleSizeTabLineHRight":case "styleSizeTabLineVTop":this.setValue("styleSizeTabLineRightTop",e,h,d,f);break;case "styleSizeTabLineHTop":case "styleSizeTabLineVLeft":this.setValue("styleSizeTabLineTopLeft",e,h,d,f);break;case "styleSizeTabLineHBottom":case "styleSizeTabLineVRight":this.setValue("styleSizeTabLineBottomRight",e,h,d,f);break;case "colorAccent":this.options[a]!==
e&&(this.options[a]=e,this.setValue("styleColorTabLineLeftBottom",e,h,d,f),this.setValue("styleColorTabLineRightTop",e,h,d,f),this.setValue("styleColorTabLineTopLeft",e,h,d,f),this.setValue("styleColorTabLineBottomRight",e,h,d,f),this.setValue("styleColorDividingLine",e,h,d,f),this.setValue("styleColorSelectedButtonLine",Rc(window.tinycolor(e),.25,!0).toRgbString(),h,d,f),-1!==this.options.tabStyle&&(Gc[this.options.tabStyle].buttonsBackground?(this.setValue("styleColorButtonBackground",e,h,d,f),
this.setValue("styleColorViewportButtonBackground",e,h,d,f)):(this.setValue("styleColorButtonBackground","transparent",h,d,f),this.setValue("styleColorViewportButtonBackground","transparent",h,d,f))));break;case "colorBackground":this.options[a]!==e&&(this.options[a]=e,-1!==this.options.tabStyle&&(Gc[this.options.tabStyle].background?this.setValue("styleColorBackground",e,h,d,f):this.setValue("styleColorBackground","transparent",h,d,f),Gc[this.options.tabStyle].buttonsBackground?(this.setValue("styleColorButtonBackgroundNotSelected",
e,h,d,f),this.setValue("styleColorAlternativeButtonBackground",Rc(window.tinycolor(e),.05,!0).toRgbString(),h,d,f),this.setValue("styleColorViewportButtonBackgroundDisabled",e,h,d,f)):(this.setValue("styleColorButtonBackgroundNotSelected","transparent",h,d,f),this.setValue("styleColorAlternativeButtonBackground","transparent",h,d,f),this.setValue("styleColorViewportButtonBackgroundDisabled","transparent",h,d,f))));break;case "colorForeground":this.options[a]!==e&&(this.options[a]=e,this.setValue("styleColorForeground",
e,h,d,f));break;default:if(this.isLiveTagsEnabled()&&0==a.indexOf("${")&&this.variablesAreInitialized()){if(this.updateVariable(a,e)){e=!1;for(var k in this.tabsElements)e=e||this.updateVariableInTexts(a,parseInt(k));e&&this.renderArray.push("tabTexts")}}else c.prototype.setValue.call(this,a,e,h,d)}0<this.renderArray.length&&g.addToRender(this);return!0};a.prototype.getValue=function(a,e){switch(a){case "bold":case "buttonExpanding":case "colorAccent":case "colorBackground":case "colorForeground":case "currentIndex":case "font-family":case "iconExpanding":case "iconPosition":case "minimumButtonSize":case "minimumIconHeight":case "minimumIconWidth":case "opacityUnselectedButton":case "styleColorAlternativeButtonBackground":case "styleColorBackground":case "styleColorButtonBackground":case "styleColorButtonBackgroundNotSelected":case "styleColorButtonBackgroundPressed":case "styleColorDividingLine":case "styleColorForeground":case "styleColorForegroundNotSelected":case "styleColorSelectedButtonLine":case "styleColorTabLineBottomRight":case "styleColorTabLineLeftBottom":case "styleColorTabLineRightTop":case "styleColorTabLineTopLeft":case "styleColorViewportButtonBackground":case "styleColorViewportButtonBackgroundDisabled":case "styleEnableAlternativeColor":case "styleEnableSelectedButtonLine":case "stylePaddingBottom":case "stylePaddingLeft":case "stylePaddingRight":case "stylePaddingTop":case "styleSizeButtonSpacing":case "styleSizeCorrectionBorder":case "styleSizeDividingLine":case "styleSizeSpacing":case "styleSizeTabLineBottomRight":case "styleSizeTabLineLeftBottom":case "styleSizeTabLineRightTop":case "styleSizeTabLineTopLeft":case "tabStyle":case "textElideMode":case "viewportButtonsMode":case "viewportButtonsSize":case "viewportPosition":return this.options[a];
case "styleColorTabLineHLeft":case "styleColorTabLineVBottom":return this.getValue("styleColorTabLineLeftBottom",e);case "styleColorTabLineHRight":case "styleColorTabLineVTop":return this.getValue("styleColorTabLineRightTop",e);case "styleColorTabLineHTop":case "styleColorTabLineVLeft":return this.getValue("styleColorTabLineTopLeft",e);case "styleColorTabLineHBottom":case "styleColorTabLineVRight":return this.getValue("styleColorTabLineBottomRight",e);case "styleSizeTabLineHLeft":case "styleSizeTabLineVBottom":return this.getValue("styleSizeTabLineLeftBottom",
e);case "styleSizeTabLineHRight":case "styleSizeTabLineVTop":return this.getValue("styleSizeTabLineRightTop",e);case "styleSizeTabLineHTop":case "styleSizeTabLineVLeft":return this.getValue("styleSizeTabLineTopLeft",e);case "styleSizeTabLineHBottom":case "styleSizeTabLineVRight":return this.getValue("styleSizeTabLineBottomRight",e);default:return c.prototype.getValue.call(this,a,e)}};a.prototype.updateLanguage=function(){var a=this,c=this.getPageMLTextMgr().getCurrentFont();"undefined"===typeof this.fontFamily&&
c!==this.fontFamily&&this.setValue("font-family",c,null,null);var c=[],h;for(h in this.tabsElements){var d=this.options.tabs[parseInt(h)].mlid;d&&(c[h]=this.getPageMLTextMgr().getText(d))}if(this.isLiveTagsEnabled()&&this.textsCanContainsVariables(c))this.parseNewTextVariables(c),this.renderArray.push("tabTexts"),g.addToRender(this);else if(this.isLiveTagsEnabled()&&this.dynamicVariablesArePresent())this.unloadAllVariables(),this.renderArray.push("tabTexts"),g.addToRender(this);else{h={};for(d=0;d<
c.length;d++){var f=c[d];h[c.indexOf(f)]=f}this.updateTabsText(h)}setTimeout(function(){a.optionallyShowViewport()},0)};a.prototype.updateTabsText=function(a){for(var c in this.tabsElements)"undefined"!==typeof a[c]&&(this.tabsElements[c].getElementsByClassName("text")[0].innerText=a[c])};a.prototype.onTabClick=function(a){var e=a.clientY-this.scrollingPos.y;if(5>Math.abs(a.clientX-this.scrollingPos.x)&&5>Math.abs(e)){var h=parseInt(a.currentTarget.getAttribute("tab-index"));this.setValue("currentIndex",
h,null);this.doWriteValue("currentIndex",h).then();var d=c.prototype.getActions.call(this);if(d.onMouseClick)for(e=0,d=d.onMouseClick.filter(function(a){return a.actionGroup===h});e<d.length;e++)g.doAction(this.wgtId,d[e])}a.currentTarget.removeEventListener("mousemove",this.handleTabMouseMove)};a.prototype.onTabMouseDown=function(a){a.currentTarget.style["background-color"]=this.options.styleColorButtonBackgroundPressed;a.currentTarget.addEventListener("mousemove",this.handleTabMouseMove)};a.prototype.onTabMouseMove=
function(a){this.resetTabStyle(parseInt(a.currentTarget.getAttribute("tab-index")));a.currentTarget.removeEventListener("mousemove",this.handleTabMouseMove)};a.prototype.onTabMouseUp=function(a){a.currentTarget.style.backgroundColor="transparent";a.currentTarget.removeEventListener("mousemove",this.handleTabMouseMove)};a.prototype.optionallyShowViewport=function(){0===this.options.viewportButtonsMode&&(this.tabsContainer.scrollWidth>this.tabsContainer.offsetWidth||this.tabsContainer.scrollHeight>
this.tabsContainer.offsetHeight?this.elem.classList.add("show-viewport"):this.elem.classList.remove("show-viewport"));this.scrollListener()};a.prototype.onScrollMouseDownHandler=function(a){this.tabsContainer.addEventListener("mousemove",this.handleScrollMouseMoveHandler);document.addEventListener("mouseup",this.handleScrollMouseUpHandler);this.scrollingPos={left:a.currentTarget.scrollLeft,top:a.currentTarget.scrollTop,x:a.clientX,y:a.clientY}};a.prototype.onScrollMouseMoveHandler=function(a){var c=
a.clientX-this.scrollingPos.x;this.tabsContainer.scrollTop=this.scrollingPos.top-(a.clientY-this.scrollingPos.y);this.tabsContainer.scrollLeft=this.scrollingPos.left-c};a.prototype.onScrollMouseUpHandler=function(){this.tabsContainer.removeEventListener("mousemove",this.handleScrollMouseMoveHandler)};a.prototype.scrollListener=function(){0===this.tabsContainer.scrollLeft&&0===this.tabsContainer.scrollTop?(this.viewportLeft.style["background-color"]=this.options.styleColorViewportButtonBackgroundDisabled,
this.viewportLeft.querySelector("svg").style.stroke=this.options.styleColorViewportButtonBackgroundDisabled,this.viewportLeft.querySelector("g").style.opacity="0.3",this.viewportLeft.classList.add("disabled")):(this.viewportLeft.style["background-color"]=this.options.styleColorViewportButtonBackground,this.viewportLeft.querySelector("svg").style.stroke=this.options.styleColorViewportButtonBackground,this.viewportLeft.querySelector("g").style.opacity="1",this.viewportLeft.classList.remove("disabled"));
this.tabsContainer.scrollLeft+this.tabsContainer.offsetWidth===this.tabsContainer.scrollWidth&&this.tabsContainer.scrollTop+this.tabsContainer.offsetHeight===this.tabsContainer.scrollHeight?(this.viewportRight.style["background-color"]=this.options.styleColorViewportButtonBackgroundDisabled,this.viewportRight.querySelector("svg").style.stroke=this.options.styleColorViewportButtonBackgroundDisabled,this.viewportRight.querySelector("g").style.opacity="0.3",this.viewportRight.classList.add("disabled")):
(this.viewportRight.style["background-color"]=this.options.styleColorViewportButtonBackground,this.viewportRight.querySelector("svg").style.stroke=this.options.styleColorViewportButtonBackground,this.viewportRight.querySelector("g").style.opacity="1",this.viewportRight.classList.remove("disabled"))};a.prototype.handleViewportLeftClick=function(){this.scrollTabsContainer(-50)};a.prototype.handleViewportRightClick=function(){this.scrollTabsContainer(50)};a.prototype.scrollTabsContainer=function(a){this.options.orientation===
ea.Vertical?this.tabsContainer.scrollTop+=a:this.tabsContainer.scrollLeft+=a};a.prototype.resetTabStyle=function(a){this.tabsElements[a].style["background-color"]="";this.tabsElements[a].style.color=this.options.styleColorForegroundNotSelected;this.tabsElements[a].style["text-decoration-line"]=this.fontUnderline?"underline":"none";this.tabsElements[a].style["text-decoration-color"]=this.options.styleColorForeground;this.tabsElements[a].style["font-weight"]="bold";this.tabsElements[a].style["background-color"]=
this.options.styleEnableAlternativeColor?1===parseInt(a)%2?this.options.styleColorButtonBackgroundNotSelected:this.options.styleColorAlternativeButtonBackground:this.options.styleColorButtonBackgroundNotSelected};a.prototype.render=function(){if(!c.prototype.render.call(this))return!1;for(var a=0,e=this.renderArray;a<e.length;a++){var g=e[a];switch(g){case "buttonExpanding":for(var g=0,d=Array.from(this.tabsContainer.querySelectorAll(".tab-wrapper"));g<d.length;g++)d[g].style.flex=this.options.buttonExpanding?
"1 0":"0 0";break;case "currentIndex":if(0===this.options.behaviour)for(var f in this.tabsElements)parseInt(f)===this.options.currentIndex?(this.tabsElements[f].style["background-color"]=this.options.styleColorButtonBackground,this.tabsElements[f].style.color=this.options.styleColorForeground,this.tabsElements[f].classList.add("selected")):(this.resetTabStyle(f),this.tabsElements[f].classList.remove("selected"));break;case "iconPosition":g=void 0;switch(this.options.iconPosition){case 2:g="column-reverse";
break;case 1:g="row";break;case 3:g="column";break;case 0:g="row-reverse"}for(f in this.tabsElements)this.tabsElements[f].querySelector(".tab-content").style["flex-direction"]=g;break;case "minimumButtonSize":for(var d=0,k=Array.from(this.tabsContainer.querySelectorAll(".tab-wrapper"));d<k.length;d++)g=k[d],this.options.orientation===ea.Vertical?g.style["min-height"]=this.options.minimumButtonSize+"px":0===this.options.textElideMode?g.style["min-width"]=this.options.minimumButtonSize+"px":(g.style["min-width"]=
"fit-content",g.style["flex-basis"]=this.options.minimumButtonSize+"px");break;case "minimumIconHeight":for(f in this.tabsElements)(g=this.tabsElements[f].querySelector(".tab-content").querySelector(".icon"))&&(g.style["min-height"]=this.options.minimumIconHeight+"px");break;case "minimumIconWidth":for(f in this.tabsElements)(g=this.tabsElements[f].querySelector(".tab-content").querySelector(".icon"))&&(g.style["min-width"]=this.options.minimumIconWidth+"px");break;case "styleColorAlternativeButtonBackground":if(0===
this.options.behaviour&&this.options.styleEnableAlternativeColor)for(f in this.tabsElements)parseInt(f)!==this.options.currentIndex&&0===parseInt(f)%2&&(this.tabsElements[f].style["background-color"]=this.options.styleColorAlternativeButtonBackground);break;case "styleColorBackground":this.tabsContainer.style["background-color"]=this.options.styleColorBackground;break;case "styleColorButtonBackground":if(0===this.options.behaviour)for(f in this.tabsElements)parseInt(f)===this.options.currentIndex&&
(this.tabsElements[f].style["background-color"]=this.options.styleColorButtonBackground);break;case "styleColorButtonBackgroundNotSelected":if(0===this.options.behaviour)for(f in this.tabsElements)parseInt(f)!==this.options.currentIndex&&(this.options.styleEnableAlternativeColor?1===parseInt(f)%2&&(this.tabsElements[f].style["background-color"]=this.options.styleColorButtonBackgroundNotSelected):this.tabsElements[f].style["background-color"]=this.options.styleColorButtonBackgroundNotSelected);break;
case "styleColorDividingLine":d=0;for(k=Array.from(this.tabsContainer.querySelectorAll(".tab-wrapper"));d<k.length;d++)if(g=k[d],g=g.querySelector(".dividing-line"))g.style["background-color"]=this.options.styleColorDividingLine;break;case "styleColorForeground":if(0===this.options.behaviour)for(f in this.tabsElements)parseInt(f)===this.options.currentIndex&&(this.tabsElements[f].style.color=this.options.styleColorForeground);this.viewportLeft.querySelector("svg").querySelector("g").setAttribute("fill",
this.options.styleColorForeground);this.viewportRight.querySelector("svg").querySelector("g").setAttribute("fill",this.options.styleColorForeground);break;case "styleColorForegroundNotSelected":if(0===this.options.behaviour)for(f in this.tabsElements)parseInt(f)!==this.options.currentIndex&&(this.tabsElements[f].style.color=this.options.styleColorForegroundNotSelected);break;case "styleColorSelectedButtonLine":for(f in this.tabsElements)this.tabsElements[f].querySelector(".button-line").style["background-color"]=
this.options.styleColorSelectedButtonLine;break;case "styleColorTabLineBottomRight":this.options.orientation===ea.Vertical?this.elem.style["border-right-color"]=this.options.styleColorTabLineBottomRight:this.elem.style["border-bottom-color"]=this.options.styleColorTabLineBottomRight;break;case "styleColorTabLineLeftBottom":this.options.orientation===ea.Vertical?this.elem.style["border-bottom-color"]=this.options.styleColorTabLineLeftBottom:this.elem.style["border-left-color"]=this.options.styleColorTabLineLeftBottom;
break;case "styleColorTabLineRightTop":this.options.orientation===ea.Vertical?this.elem.style["border-top-color"]=this.options.styleColorTabLineRightTop:this.elem.style["border-right-color"]=this.options.styleColorTabLineRightTop;break;case "styleColorTabLineTopLeft":this.options.orientation===ea.Vertical?this.elem.style["border-left-color"]=this.options.styleColorTabLineTopLeft:this.elem.style["border-top-color"]=this.options.styleColorTabLineTopLeft;break;case "styleColorViewportButtonBackground":this.viewportLeft.classList.value.includes("disabled")||
(this.viewportLeft.style["background-color"]=this.options.styleColorViewportButtonBackground);this.viewportRight.classList.value.includes("disabled")||(this.viewportRight.style["background-color"]=this.options.styleColorViewportButtonBackground);break;case "styleColorViewportButtonBackgroundDisabled":this.viewportLeft.classList.value.includes("disabled")&&(this.viewportLeft.style["background-color"]=this.options.styleColorViewportButtonBackgroundDisabled);this.viewportRight.classList.value.includes("disabled")&&
(this.viewportRight.style["background-color"]=this.options.styleColorViewportButtonBackgroundDisabled);break;case "styleEnableAlternativeColor":if(0===this.options.behaviour)for(f in this.tabsElements)parseInt(f)!==this.options.currentIndex&&(this.tabsElements[f].style["background-color"]=this.options.styleEnableAlternativeColor?1===parseInt(f)%2?this.options.styleColorButtonBackgroundNotSelected:this.options.styleColorAlternativeButtonBackground:this.options.styleColorButtonBackgroundNotSelected);
break;case "styleEnableSelectedButtonLine":for(f in this.tabsElements)this.tabsElements[f].querySelector(".button-line").style.display=this.options.styleEnableSelectedButtonLine?"block":"none";break;case "stylePaddingBottom":for(f in this.tabsElements)this.tabsElements[f].style["padding-bottom"]=this.options.stylePaddingBottom+"px";break;case "stylePaddingLeft":for(f in this.tabsElements)this.tabsElements[f].style["padding-left"]=this.options.stylePaddingLeft+"px";break;case "stylePaddingRight":for(f in this.tabsElements)this.tabsElements[f].style["padding-right"]=
this.options.stylePaddingRight+"px";break;case "stylePaddingTop":for(f in this.tabsElements)this.tabsElements[f].style["padding-top"]=this.options.stylePaddingTop+"px";break;case "styleSizeButtonSpacing":for(f in this.tabsElements)(g=this.tabsElements[f].querySelector(".tab-content").querySelector(".icon"))&&(g.style.margin=this.options.styleSizeButtonSpacing+"px");break;case "styleSizeCorrectionBorder":for(f in this.tabsElements)this.tabsElements[f].style["border-width"]=this.options.styleSizeCorrectionBorder+
"px";break;case "styleSizeDividingLine":d=0;for(k=Array.from(this.tabsContainer.querySelectorAll(".tab-wrapper"));d<k.length;d++)if(g=k[d],g=g.querySelector(".dividing-line"))g.style["min-width"]=this.options.styleSizeDividingLine;break;case "styleSizeSpacing":for(f in this.tabsElements)this.options.orientation===ea.Vertical?this.tabsElements[f].style["margin-bottom"]=this.options.styleSizeSpacing+"px":this.tabsElements[f].style["margin-right"]=this.options.styleSizeSpacing+"px";break;case "styleSizeTabLineBottomRight":this.options.orientation===
ea.Vertical?this.elem.style["border-right-width"]=this.options.styleSizeTabLineBottomRight+"px":this.elem.style["border-bottom-width"]=this.options.styleSizeTabLineBottomRight+"px";break;case "styleSizeTabLineLeftBottom":this.options.orientation===ea.Vertical?this.elem.style["border-bottom-width"]=this.options.styleSizeTabLineLeftBottom+"px":this.elem.style["border-left-width"]=this.options.styleSizeTabLineLeftBottom+"px";break;case "styleSizeTabLineRightTop":this.options.orientation===ea.Vertical?
this.elem.style["border-top-width"]=this.options.styleSizeTabLineRightTop+"px":this.elem.style["border-right-width"]=this.options.styleSizeTabLineRightTop+"px";break;case "styleSizeTabLineTopLeft":this.options.orientation===ea.Vertical?this.elem.style["border-left-width"]=this.options.styleSizeTabLineTopLeft+"px":this.elem.style["border-top-width"]=this.options.styleSizeTabLineTopLeft+"px";break;case "textElideMode":for(f in this.tabsElements)g=this.tabsElements[f].querySelector(".tab-content"),g.style["min-width"]=
1===this.options.textElideMode&&2!==this.options.orientation?"fit-content":"",0===this.options.textElideMode||this.options.orientation===ea.Vertical?g.querySelector(".text").classList.add("elide"):g.querySelector(".text").classList.remove("elide"),g=this.tabsElements[f].parentElement,2!==this.options.orientation&&0===this.options.textElideMode?g.style["min-width"]=this.options.minimumButtonSize+"px":(g.style["min-width"]="fit-content",g.style["flex-basis"]=this.options.minimumButtonSize+"px");break;
case "viewportButtonsMode":0===this.options.viewportButtonsMode?this.optionallyShowViewport():1===this.options.viewportButtonsMode?this.elem.classList.add("show-viewport"):2===this.options.viewportButtonsMode&&this.elem.classList.remove("show-viewport");break;case "viewportButtonsSize":this.options.orientation===ea.Vertical?(this.viewportLeft.style.height=this.options.viewportButtonsSize+"px",this.viewportRight.style.height=this.options.viewportButtonsSize+"px"):(this.viewportLeft.style.width=this.options.viewportButtonsSize+
"px",this.viewportRight.style.width=this.options.viewportButtonsSize+"px");break;case "viewportPosition":this.options.orientation===ea.Vertical?this.tabsContainer.scrollTop=this.tabsContainer.clientHeight*this.options[g]:this.tabsContainer.scrollLeft=this.tabsContainer.clientWidth*this.options[g];break;case "tabTexts":this.updateTabsText(this.getValueOfAllDynamicTexts())}}this.renderArray=[];return!0};a.prototype.updateFontStyles=function(){this.elem.style.fontFamily=this.fontFamily;this.elem.style.fontSize=
this.fontSize+"px";this.elem.style.fontStyle=this.fontStyle;this.elem.style.fontWeight=this.fontBold?"bold":"normal"};return a}(fc);g.fn.hmiTabBar=function(c,a,b,e){return new he(this,c,a,b,e)};g.addWidgetDefinition("hmiTabBar",he);var Gc={0:{alternativeColor:!1,background:!0,selectedButtonLine:!0,buttonsBackground:!0},1:{alternativeColor:!0,background:!0,selectedButtonLine:!0,buttonsBackground:!0},2:{alternativeColor:!1,background:!1,selectedButtonLine:!1,buttonsBackground:!0},3:{alternativeColor:!1,
background:!0,selectedButtonLine:!0,buttonsBackground:!1},4:{alternativeColor:!1,background:!1,selectedButtonLine:!0,buttonsBackground:!1}};N.prototype._generateGetterAndSetter=function(c){return{get:function(){return this.wgt.getValue(c)},set:function(a){this.wgt.setValue(c,a)}}};N.prototype._generateFun=function(c){var a=this.wgt;return function(){return a[c].apply(a,arguments)}};Object.defineProperty(N.prototype,"objectName",{get:function(){return this.wgt.studioId}});Object.defineProperty(N.prototype,
"id",{get:function(){return this.wgt.studioId}});Object.defineProperty(N.prototype,"Id",{get:function(){return this.wgt.studioId}});Object.defineProperty(N.prototype,"x",{get:function(){return parseFloat(this.wgt.getValue("x"))},set:function(c){this.wgt.setValue("x",c)}});Object.defineProperty(N.prototype,"y",{get:function(){return parseFloat(this.wgt.getValue("y"))},set:function(c){"number"==typeof c&&this.wgt.setValue("y",c)}});Object.defineProperty(N.prototype,"width",{get:function(){var c=g.getActivePage();
return c.isFitToSizeEnable()?Number(Math.round(this.wgt.boundingRect.width/c.getScaleFactors().x+"e3")+"e-3"):this.wgt.boundingRect.width},set:function(c){2>c&&(c=2);var a=g.getActivePage(),b=this.wgt.boundingRect.height;a.isFitToSizeEnable()&&(b=Number(Math.round(b/a.getScaleFactors().y+"e3")+"e-3"));this.wgt.setParentBounds(this.wgt.left,this.wgt.top,c,b,this.wgt.parentWidget)}});Object.defineProperty(N.prototype,"height",{get:function(){var c=g.getActivePage();return c.isFitToSizeEnable()?Number(Math.round(this.wgt.boundingRect.height/
c.getScaleFactors().y+"e3")+"e-3"):this.wgt.boundingRect.height},set:function(c){2>c&&(c=2);var a=g.getActivePage(),b=this.wgt.boundingRect.width;a.isFitToSizeEnable()&&(b=Number(Math.round(b/a.getScaleFactors().x+"e3")+"e-3"));this.wgt.setParentBounds(this.wgt.left,this.wgt.top,b,c,this.wgt.parentWidget)}});Object.defineProperty(N.prototype,"opacity",{get:function(){return parseFloat(this.wgt.getValue("opacity"))},set:function(c){"number"==typeof c&&this.wgt.setValue("opacity",c)}});Object.defineProperty(N.prototype,
"rotation",{get:function(){return parseFloat(this.wgt.getValue("currentRot"))},set:function(c){"number"==typeof c&&this.wgt.setValue("rot",c)}});Object.defineProperty(N.prototype,"value",{get:function(){return this.wgt.getValue("value")},set:function(c){this.wgt.setValue("value",c)}});Object.defineProperty(N.prototype,"userValue",{get:function(){return this.wgt._userValue},set:function(c){this.wgt._userValue=c}});Object.defineProperty(N.prototype,"context2d",{get:function(){return this.wgt.context2d}});
N.prototype.getProperty=function(c,a){return this[c]?this[c]:this.wgt.getProperty(c,a)};N.prototype.getParameter=function(c,a){return this.getProperty(c,a)};N.prototype.setProperty=function(c,a,b){this.wgt&&this.wgt.setProperty(c,a,b)};N.prototype.getWidget=function(c){(c=this.wgt.getWidget(c,!0,this.isTemplate))&&(c=new N(c));return c};N.prototype.__implementsProperty=function(c,a){this.wgt.__implementsProperty&&this.wgt.__implementsProperty(c,a)};N.prototype.update=function(){this.wgt&&this.wgt.update()};
g.addWidgetDefinition("hmiIWidget",N);Z.prototype=Object.create(N.prototype);Z.prototype.constructor=Z;Object.defineProperty(Z.prototype,"backgroundColor",{get:function(){return this.wgt.getValue("backgroundColor")},set:function(c){this.wgt.setValue("color",c)}});Object.defineProperty(Z.prototype,"width",{get:function(){return this.wgt.getValue("width")}});Object.defineProperty(Z.prototype,"height",{get:function(){return this.wgt.getValue("height")}});Z.prototype.setTimeout=function(c,a){"string"==
typeof c&&(c=-1!=c.indexOf("(")&&c.indexOf("(")?this.__eval__(c.split("(")[0]):this.__eval__(c));var b=setTimeout(c,a);this._timeoutIDs[b]=1;return b};Z.prototype.clearTimeout=function(c){clearTimeout(c);delete this._timeoutIDs[c]};Z.prototype.setInterval=function(c,a){"string"==typeof c&&(c=-1!=c.indexOf("(")&&c.indexOf("(")?this.__eval__(c.split("(")[0]):this.__eval__(c));var b=setInterval(c,a);this._timeoutIDs[b]=1;return b};Z.prototype.clearInterval=function(c){clearInterval(c);delete this._timeoutIDs[c]};
Z.prototype.clearAllTimeouts=function(){for(var c in this._timeoutIDs)clearTimeout(c),clearInterval(c)};Z.prototype.getWidget=function(c){if(c=this.wgt.getWidget(c,!0,this.isTemplate))switch(c.getJMType()){case "TableGroupWgt":c=new Ha(c);break;default:c=new N(c)}return c};Z.prototype.getProperty=function(c,a){return this[c]?this[c]:this.wgt.getValue(c)};Z.prototype.bindJSCallback=function(c){this.wgt.bindJSCallback(c)};g.addWidgetDefinition("hmiIPage",Z);E.prototype=Object.create(Z.prototype);E.prototype.constructor=
E;E.prototype._doAction=function(c,a,b){g.isProjectReady&&(b?c.execute(a,b):c.execute(a))};E.prototype.nextPage=function(){var c=g.getAction("hmiActionNextPage");this._doAction(c,g.getFocusPage().wgtId)};E.prototype.prevPage=function(){var c=g.getAction("hmiActionPrevPage");this._doAction(c,g.getFocusPage().wgtId)};E.prototype.homePage=function(){var c=g.getAction("hmiActionHomePage");this._doAction(c,g.getFocusPage().wgtId)};E.prototype.loadPage=function(c){var a=g.getAction("hmiActionLoadPage");
c=c.split(".jmx")[0].toLowerCase();var b=g.getActiveProject().getPageMgr();a.setOptions({c:"LoadPage",p:{pg:b.map[c]}});g.doAction(g.getFocusPage().wgtId,a,{})};E.prototype.showDialog=function(c){var a=g.getAction("hmiActionShowDialog"),b=g.getActiveProject().getPageMgr();c=c.split(".jmx")[0].toLowerCase();b=b.getWebPage(c)||c;this._doAction(a,null,{pg:b})};E.prototype.showMessage=function(c){var a=g.getAction("hmiActionShowMessage");this._doAction(a,null,{msg:c})};E.prototype.closeDialog=function(c){c=
g.getAction("hmiActionCloseDialog");this._doAction(c,null,{pg:g.getFocusPage().studioId.toLowerCase()})};E.prototype.lastVisitedPage=function(){var c=g.getAction("hmiActionLastPage");this._doAction(c,g.getFocusPage().wgtId)};E.prototype.ackAlarms=function(){var c=g.getAction("hmiActionAckAlarm");this._doAction(c,null,{alID:"selected"})};E.prototype.enableAlarms=function(){var c=g.getAction("hmiActionEnableAlarm");this._doAction(c,null)};E.prototype.downloadRecipe=function(c,a){var b=g.getAction("hmiActionDownLoadRecipe");
this._doAction(b,g.getFocusPage().wgtId,{r:c,s:a})};E.prototype.uploadRecipe=function(c,a){var b=g.getAction("hmiActionUpLoadRecipe");this._doAction(b,g.getFocusPage().wgtId,{r:c,s:a})};E.prototype.getRecipeItem=function(c,a,b){return this.wgt.getWidget("_RecipeMgr",!0).getValue(c+"."+a+"."+b+".Value")};E.prototype.setRecipeItem=function(c,a,b,e){return this.wgt.getWidget("_RecipeMgr",!0).setValue(c+"."+a+"."+b+".Value",e)};E.prototype.selectAllAlarms=function(c){var a=g.getAction("hmiActionSelectAllAlarms"),
b;"undefined"!=typeof c&&(b={enable:c});this._doAction(a,null,b)};E.prototype.resetAlarms=function(){var c=g.getAction("hmiActionResetAlarm");this._doAction(c,null)};E.prototype.getTag=function(c,a,b,e,g){return this.wgt.getTag(c,a,b,e,g)};E.prototype.setTag=function(c,a,b,e){if("string"!==typeof a&&a instanceof Array){var g;g="[";for(var d=0;d<a.length;d++)0<d&&(g+=","),g+="number"===typeof a[d]?a[d].toString():a[d];a=g+"]"}return e?this.wgt.setTag(c,a,b,e)?0:-1:this.wgt.setTag(c,a,b,e)};E.prototype.getGroup=
function(c,a,b){return this.wgt.getGroup(c,a,b)};E.prototype.getClientType=function(){return this.wgt.getClientType()};E.prototype.on=function(c,a){return this.wgt.on(c,a)};E.prototype.off=function(c){return this.wgt.off(c)};E.prototype.bindJSCallback=function(c){this.wgt.bindJSCallback(c)};E.prototype.dbInit=function(c,a){var b=g.getAction("hmiActionDBInit");g.actionMgr.execute(b,{link:c,sql:a},this.wgt.wgtId,"DBInit")};E.prototype.dbWriteTags=function(c,a,b){var e=g.getAction("hmiActionDBWriteTags");
g.actionMgr.execute(e,{link:c,sql:a,tags:b},this.wgt.wgtId,"DBWriteTags")};E.prototype.dbReadTags=function(c,a,b){var e=g.getAction("hmiActionDBReadTags");g.actionMgr.execute(e,{link:c,sql:a,tags:b},this.wgt.wgtId,"DBReadTags")};E.prototype.dbWriteGroups=function(c,a,b){var e=g.getAction("hmiActionDBWriteGroups");g.actionMgr.execute(e,{link:c,sql:a,groups:b},this.wgt.wgtId,"DBWriteGroups")};E.prototype.dbReadGroups=function(c,a,b){var e=g.getAction("hmiActionDBReadGroups");g.actionMgr.execute(e,{link:c,
sql:a,groups:b},this.wgt.wgtId,"DBReadGroups")};E.prototype.dbWriteTrends=function(c,a,b,e){var h=g.getAction("hmiActionDBWriteTrends");g.actionMgr.execute(h,{link:c,sql:a,trend:b,durationIdx:e},this.wgt.wgtId,"DBWriteTrends")};E.prototype.dbWriteEvents=function(c,a,b,e){var h=g.getAction("hmiActionDBWriteEvents");g.actionMgr.execute(h,{link:c,sql:a,eventArchive:b,durationIdx:e},this.wgt.wgtId,"DBWriteEvents")};E.prototype.dbWriteRecipes=function(c,a,b){var e=g.getAction("hmiActionDBWriteRecipes");
g.actionMgr.execute(e,{link:c,sql:a,recipes:b},this.wgt.wgtId,"DBWriteRecipes")};E.prototype.dbReadRecipes=function(c,a,b){var e=g.getAction("hmiActionDBReadRecipes");g.actionMgr.execute(e,{link:c,sql:a,recipes:b},this.wgt.wgtId,"DBReadRecipes")};E.prototype.dbResetErrors=function(c){var a=g.getAction("hmiActionDBResetErrors");g.actionMgr.execute(a,{link:c},this.wgt.wgtId,"DBResetErrors")};E.prototype.dbQuery=function(c,a,b,e){e=null==e?0:Number(e);var h=g.getAction("hmiActionDBQuery");g.actionMgr.execute(h,
{link:c,sql:a,cb:b,rsType:e},this.wgt.wgtId,"DBQuery")};E.prototype.logout=function(c){var a=g.getAction("hmiActionLogOut");g.actionMgr.execute(a,{allowDefaultUser:c},this.wgt.wgtId,"LogOutAction")};g.addWidgetDefinition("hmiIProject",E);Ha.prototype=Object.create(N.prototype);Ha.prototype.constructor=Ha;Ha.prototype.setSortingRules=function(c){this.wgt&&this.wgt.setSortingRulesJS(c)};Ha.prototype.mapToModel=function(c){return this.wgt?this.wgt.mapToModel(c):-1};Ha.prototype.model=function(){if(this.wgt)return this.wgt.getModel()};
Ha.prototype.getPropertyIndex=function(c,a,b,e){return this.wgt?this.wgt.getPropertyIndex(c,a,b,e):-1};g.addWidgetDefinition("hmiITableWgt",Ha);return g}();
